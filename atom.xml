<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>SwiftGG</title>
  
  <subtitle>èµ°å¿ƒçš„ Swift ç¿»è¯‘ç»„</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://swift.gg/"/>
  <updated>2020-04-11T08:27:36.496Z</updated>
  <id>https://swift.gg/</id>
  
  <author>
    <name>SwiftGG</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Swift ä¸­ç±»å‹åˆ«åçš„ç”¨é€”</title>
    <link href="https://swift.gg/2020/04/11/2019-05-15-the-usefulness-of-typealiases/"/>
    <id>https://swift.gg/2020/04/11/2019-05-15-the-usefulness-of-typealiases/</id>
    <published>2020-04-11T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.496Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šBenedikt Terhechteï¼Œ<a href="http://appventure.me/posts/2019-5-15-the-usefulness-of-typealiases-in-swift.html" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2019-05-15<br>è¯‘è€…ï¼š<a href="https://github.com/Ji4n1ng" target="_blank" rel="noopener">Ji4n1ng</a>ï¼›æ ¡å¯¹ï¼š<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼Œ<a href="https://nemocdz.github.io/" target="_blank" rel="noopener">Nemocdz</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><h2 id="ä»€ä¹ˆæ˜¯-typealiasï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-typealiasï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ typealiasï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ <code>typealias</code>ï¼Ÿ</h2><p>å½“æˆ‘ä»¬å›å¿†é‚£äº› Swift å¼ºå¤§çš„è¯­è¨€ç‰¹æ€§æ—¶ï¼Œå¾ˆå°‘æœ‰äººä¼šé¦–å…ˆæƒ³åˆ° <code>typealias</code>ã€‚ç„¶è€Œï¼Œè®¸å¤šæƒ…å†µä¸‹ç±»å‹åˆ«åä¼šå¾ˆæœ‰ç”¨ã€‚æœ¬æ–‡å°†ç®€è¦ä»‹ç» <code>typealias</code> æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•å®šä¹‰å®ƒï¼Œå¹¶åˆ—å‡ºå¤šä¸ªç¤ºä¾‹è¯´æ˜å¦‚ä½•åœ¨è‡ªå·±çš„ä»£ç ä¸­ä½¿ç”¨å®ƒä»¬ã€‚è®©æˆ‘ä»¬å¼€å§‹æ·±å…¥äº†è§£å§ï¼</p><a id="more"></a><p>é¡¾åæ€ä¹‰ï¼Œ<code>typealias</code> æ˜¯ç‰¹å®šç±»å‹çš„åˆ«åã€‚ç±»å‹ï¼Œä¾‹å¦‚ <code>Int</code>ã€<code>Double</code>ã€<code>UIViewController</code> æˆ–ä¸€ç§è‡ªå®šä¹‰ç±»å‹ã€‚<code>Int32</code> å’Œ <code>Int8</code> æ˜¯ä¸åŒçš„ç±»å‹ã€‚æ¢å¥è¯è¯´ï¼Œç±»å‹åˆ«ååœ¨ä½ çš„ä»£ç åº“é‡Œæ’å…¥ç°æœ‰ç±»å‹çš„å¦ä¸€ä¸ªåç§°ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">Money</span> = <span class="type">Int</span></span><br></pre></td></tr></table></figure><p>ä¸º <code>Int</code> ç±»å‹åˆ›å»ºåˆ«åã€‚è¿™æ ·å°±å¯ä»¥åœ¨ä»£ç ä¸­çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ <code>Money</code>ï¼Œå°±åƒæ˜¯ <code>Int</code> ä¸€æ ·ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Bank</span> </span>&#123;</span><br><span class="line">  <span class="keyword">typealias</span> <span class="type">Money</span> = <span class="type">Int</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> credit: <span class="type">Money</span> = <span class="number">0</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">deposit</span><span class="params">(amount: Money)</span></span> &#123;</span><br><span class="line">    credit += amount</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">withdraw</span><span class="params">(amount: Money)</span></span> &#123;</span><br><span class="line">    credit -= amount</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æœ‰ä¸€ä¸ªç»“æ„ä½“ <code>Bank</code> æ¥ç®¡ç†é’±ã€‚ä½†æ˜¯ï¼Œæ²¡æœ‰ä½¿ç”¨ <code>Int</code> ä½œä¸ºé‡‘é¢ï¼Œè€Œæ˜¯ä½¿ç”¨ <code>Money</code> ç±»å‹ã€‚å¯ä»¥çœ‹å‡º <code>+=</code> å’Œ <code>-=</code> è¿ç®—ç¬¦ä»ç„¶å¯ä»¥æŒ‰é¢„æœŸå·¥ä½œã€‚</p><p>è¿˜å¯ä»¥æ··åˆä½¿ç”¨ç±»å‹åˆ«åå’ŒåŸå§‹ç±»å‹ï¼Œä»¥åŠåŒ¹é…äºŒè€…ã€‚å¯ä»¥è¿™ä¹ˆåšæ˜¯å› ä¸ºå¯¹äº Swift ç¼–è¯‘å™¨æ¥è¯´ï¼Œå®ƒä»¬éƒ½è§£æä¸ºåŒä¸€ä¸ªä¸œè¥¿ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Bank</span> </span>&#123;</span><br><span class="line">  <span class="keyword">typealias</span> <span class="type">DepositMoney</span> = <span class="type">Int</span></span><br><span class="line">  <span class="keyword">typealias</span> <span class="type">WithdrawMoney</span> = <span class="type">Int</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> credit: <span class="type">Int</span> = <span class="number">0</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">deposit</span><span class="params">(amount: DepositMoney)</span></span> &#123;</span><br><span class="line">    credit += amount</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">withdraw</span><span class="params">(amount: WithdrawMoney)</span></span> &#123;</span><br><span class="line">    credit -= amount</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ··åˆä½¿ç”¨äº† <code>Int</code> åŠå…¶ä¸åŒè‡ªå®šä¹‰ç±»å‹åˆ«å <code>DepositMoney</code> å’Œ <code>WithdrawMoney</code>ã€‚</p><h3 id="æ³›å‹ç±»å‹åˆ«å"><a href="#æ³›å‹ç±»å‹åˆ«å" class="headerlink" title="æ³›å‹ç±»å‹åˆ«å"></a>æ³›å‹ç±»å‹åˆ«å</h3><p>é™¤ä¸Šè¿°å†…å®¹å¤–ï¼Œç±»å‹åˆ«åä¹Ÿå¯ä»¥å…·æœ‰æ³›å‹å‚æ•°ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">MyArray</span>&lt;<span class="type">T</span>&gt; = <span class="type">Array</span>&lt;<span class="type">T</span>&gt;</span><br><span class="line"><span class="keyword">let</span> newArray: <span class="type">MyArray</span> = <span class="type">MyArray</span>(arrayLiteral: <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ï¼Œä¸º <code>MyArray</code> å®šä¹‰äº†ä¸€ä¸ªç±»å‹åˆ«åï¼Œè¯¥åˆ«åä¸å¸¸è§„æ•°ç»„ä¸€æ ·ã€‚æœ€åï¼Œç±»å‹åˆ«åçš„æ³›å‹å‚æ•°ç”šè‡³å¯ä»¥å…·æœ‰çº¦æŸã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ–°çš„ <code>MyArray</code> åªä¿ç•™éµå¾ª <code>StringProtocol</code> çš„ç±»å‹ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">MyArray</span>&lt;<span class="type">T</span>&gt; = <span class="type">Array</span>&lt;<span class="type">T</span>&gt; <span class="keyword">where</span> <span class="type">T</span>: <span class="type">StringProtocol</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªä¸é”™çš„ç‰¹æ€§ï¼Œä½ å¯ä»¥å¿«é€Ÿä¸ºç‰¹å®šç±»å‹å®šä¹‰æ•°ç»„ï¼Œè€Œä¸å¿…å°† <code>Array</code> å­ç±»åŒ–ã€‚è¯´åˆ°è¿™é‡Œï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ç±»å‹åˆ«åçš„ä¸€äº›å®è·µåº”ç”¨ã€‚</p><h2 id="å®è·µåº”ç”¨"><a href="#å®è·µåº”ç”¨" class="headerlink" title="å®è·µåº”ç”¨"></a>å®è·µåº”ç”¨</h2><h3 id="æ›´æ¸…æ™°çš„ä»£ç "><a href="#æ›´æ¸…æ™°çš„ä»£ç " class="headerlink" title="æ›´æ¸…æ™°çš„ä»£ç "></a>æ›´æ¸…æ™°çš„ä»£ç </h3><p>ç¬¬ä¸€ä¸ªï¼ŒåŒæ—¶ä¹Ÿæ˜¾è€Œæ˜“è§çš„ç”¨ä¾‹ï¼Œæˆ‘ä»¬å·²ç»ç®€è¦ä»‹ç»è¿‡äº†ã€‚ç±»å‹åˆ«åå¯ä»¥ä½¿ä»£ç æ›´å…·å«ä¹‰ã€‚åœ¨ <code>typealias Money = Int</code> ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº† <code>Money</code> ç±»å‹â€”â€”ä¸€ä¸ªæ¸…æ™°çš„æ¦‚å¿µã€‚åƒ <code>let amount: Money = 0</code> è¿™æ ·æ¥ä½¿ç”¨å®ƒï¼Œæ¯” <code>let amount: Int = 0</code> æ›´å®¹æ˜“ç†è§£ã€‚åœ¨ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œä½ ç«‹åˆ»å°±æ˜ç™½è¿™æ˜¯<em>é‡‘é’±</em>çš„<em>æ•°é¢</em>ã€‚è€Œåœ¨ç¬¬äºŒä¸ªç¤ºä¾‹ä¸­ï¼Œå®ƒå¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ï¼šè‡ªè¡Œè½¦çš„æ•°é‡ã€å­—ç¬¦çš„æ•°é‡ã€ç”œç”œåœˆçš„æ•°é‡â€”â€”è¿™è°çŸ¥é“ï¼</p><p>è¿™æ˜¾ç„¶ä¸æ˜¯éƒ½å¿…è¦çš„ã€‚å¦‚æœå‡½æ•°ç­¾åå·²ç»æ¸…æ¥šåœ°è¯´æ˜äº†å‚æ•°çš„ç±»å‹ï¼ˆ<code>func orderDonuts(amount: Int)</code>ï¼‰ï¼Œé‚£ä¹ˆåŒ…å«å…¶ä»–çš„ç±»å‹åˆ«åå°†æ˜¯ä¸å¿…è¦çš„å¼€é”€ã€‚å¦ä¸€æ–¹é¢ï¼Œå¯¹äºå˜é‡å’Œå¸¸é‡æ¥è¯´ï¼Œå®ƒé€šå¸¸å¯ä»¥æé«˜å¯è¯»æ€§å¹¶æå¤§åœ°å¸®åŠ©ç¼–å†™æ–‡æ¡£ã€‚</p><h3 id="æ›´ç®€å•çš„å¯é€‰é—­åŒ…"><a href="#æ›´ç®€å•çš„å¯é€‰é—­åŒ…" class="headerlink" title="æ›´ç®€å•çš„å¯é€‰é—­åŒ…"></a>æ›´ç®€å•çš„å¯é€‰é—­åŒ…</h3><p>Swift ä¸­çš„å¯é€‰é—­åŒ…æœ‰ç‚¹ç¬¨æ‹™ã€‚æ¥å—ä¸€ä¸ª <code>Int</code> å‚æ•°å¹¶è¿”å› <code>Int</code> çš„é—­åŒ…çš„å¸¸è§„å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(action: <span class="params">(Int)</span></span></span> -&gt; <span class="type">Int</span>) &#123; ... &#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œå¦‚æœè¦ä½¿æ­¤é—­åŒ…ä¸ºå¯é€‰å‹ï¼Œåˆ™ä¸èƒ½ä»…æ·»åŠ é—®å·ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(action: <span class="params">(Int)</span></span></span> -&gt; <span class="type">Int?</span>) &#123; ... &#125;</span><br></pre></td></tr></table></figure><p>æ¯•ç«Ÿï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå¯é€‰å‹çš„é—­åŒ…ï¼Œè€Œæ˜¯<em>ä¸€ä¸ªè¿”å›å¯é€‰ <code>Int</code></em> çš„é—­åŒ…ã€‚æ­£ç¡®çš„æ–¹æ³•æ˜¯æ·»åŠ æ‹¬å·ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(action: <span class="params">(<span class="params">(Int)</span></span></span></span> -&gt; <span class="type">Int</span>)?) &#123; ... &#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰å¤šä¸ªè¿™æ ·çš„é—­åŒ…ï¼Œè¿™å°†å˜å¾—å°¤ä¸ºéš¾çœ‹ã€‚ä¸‹é¢ï¼Œæœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥å¤„ç†æˆåŠŸå’Œå¤±è´¥æƒ…å†µï¼Œä»¥åŠéšç€æ“ä½œçš„è¿›è¡Œè°ƒç”¨ä¸€ä¸ªé™„åŠ çš„é—­åŒ…ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(success: <span class="params">(<span class="params">(Int)</span></span></span></span> -&gt; <span class="type">Int</span>)?,</span><br><span class="line">            failure: ((<span class="type">Error</span>) -&gt; <span class="type">Void</span>)?,</span><br><span class="line">            progress: ((<span class="type">Double</span>) -&gt; <span class="type">Void</span>)?) &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å°æ®µä»£ç åŒ…å«<em>å¾ˆå¤š</em>æ‹¬å·ã€‚ç”±äºæˆ‘ä»¬ä¸æ‰“ç®—æˆä¸º lisperï¼ˆè¯‘è€…æ³¨ï¼šlisp è¯­è¨€ä½¿ç”¨è€…ï¼‰ï¼Œå› æ­¤æƒ³é€šè¿‡å¯¹ä¸åŒçš„é—­åŒ…ä½¿ç”¨ç±»å‹åˆ«åæ¥è§£å†³æ­¤é—®é¢˜ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">Success</span> = (<span class="type">Int</span>) -&gt; <span class="type">Int</span></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">Failure</span> = (<span class="type">Error</span>) -&gt; <span class="type">Void</span></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">Progress</span> = (<span class="type">Double</span>) -&gt; <span class="type">Void</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle2</span><span class="params">(success: Success?, failure: Failure?, progress: Progress?)</span></span> &#123; ... &#125;</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼Œè¿™ä¸ªå‡½æ•°çœ‹èµ·æ¥ç¡®å®æ›´å…·å¯è¯»æ€§ã€‚è™½ç„¶è¿™å¾ˆå¥½ï¼Œä½†æˆ‘ä»¬ç¡®å®é€šè¿‡ä½¿ç”¨ä¸‰è¡Œ <code>typealias</code> å¼•å…¥äº†å…¶ä»–è¯­æ³•ã€‚ä½†æ˜¯ï¼Œä»é•¿è¿œæ¥çœ‹ï¼Œè¿™å®é™…ä¸Šå¯èƒ½å¯¹æˆ‘ä»¬æœ‰å¸®åŠ©ï¼Œå°±åƒæˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çœ‹åˆ°çš„ã€‚</p><h3 id="é›†ä¸­å®šä¹‰"><a href="#é›†ä¸­å®šä¹‰" class="headerlink" title="é›†ä¸­å®šä¹‰"></a>é›†ä¸­å®šä¹‰</h3><p>è¿™äº›ç‰¹å®šç±»å‹ä¸ä»…ä»…å¯ä»¥ç”¨åœ¨å‰é¢ç¤ºä¾‹çš„é‚£äº›æ“ä½œå¤„ç†å™¨ä¸­ã€‚ä¸‹é¢æ˜¯ç»è¿‡ç•¥å¾®ä¿®æ”¹ï¼Œæ›´ç¬¦åˆå®é™…ä½¿ç”¨çš„æ“ä½œå¤„ç†å™¨ç±»ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Dispatcher</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> successHandler: ((<span class="type">Int</span>) -&gt; <span class="type">Void</span>)?</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> errorHandler: ((<span class="type">Error</span>) -&gt; <span class="type">Void</span>)?</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(success: <span class="params">(<span class="params">(Int)</span></span></span></span> -&gt; <span class="type">Void</span>)?, error: ((<span class="type">Error</span>) -&gt; <span class="type">Void</span>)?) &#123;</span><br><span class="line">    <span class="keyword">self</span>.successHandler = success</span><br><span class="line">    <span class="keyword">self</span>.errorHandler = error</span><br><span class="line">    internalHandle()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(success: <span class="params">(<span class="params">(Int)</span></span></span></span> -&gt; <span class="type">Void</span>)?) &#123;</span><br><span class="line">   <span class="keyword">self</span>.successHandler = success</span><br><span class="line">    internalHandle()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(error: <span class="params">(<span class="params">(Int)</span></span></span></span>-&gt; <span class="type">Void?</span>)) &#123;</span><br><span class="line">    <span class="keyword">self</span>.errorHandler = error</span><br><span class="line">    internalHandle()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">internalHandle</span><span class="params">()</span></span> &#123;</span><br><span class="line">   ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥ç»“æ„ä½“å¼•å…¥äº†ä¸¤ä¸ªé—­åŒ…ï¼Œä¸€ä¸ªç”¨äºæˆåŠŸæƒ…å†µï¼Œä¸€ä¸ªç”¨äºé”™è¯¯æƒ…å†µã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›æä¾›æ›´æ–¹ä¾¿çš„å‡½æ•°ï¼Œè°ƒç”¨å…¶ä¸­ä¸€ä¸ªå¤„ç†å™¨å³å¯ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¦‚æœè¦å‘æˆåŠŸå’Œé”™è¯¯å¤„ç†å™¨æ·»åŠ å¦ä¸€ä¸ªå‚æ•°ï¼ˆä¾‹å¦‚ <code>HTTPResponse</code>ï¼‰ï¼Œé‚£ä¹ˆéœ€è¦æ›´æ”¹å¾ˆå¤šä»£ç ã€‚åœ¨ä¸‰ä¸ªåœ°æ–¹ï¼Œ<code>((Int) -&gt; Void)?</code> éœ€è¦å˜æˆ <code>((Int, HTTPResponse) -&gt; Void)?</code>ã€‚é”™è¯¯å¤„ç†å™¨ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚é€šè¿‡ä½¿ç”¨å¤šä¸ªç±»å‹åˆ«åï¼Œå¯ä»¥é¿å…è¿™ç§æƒ…å†µï¼Œåªéœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹ä¿®æ”¹ç±»å‹ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Dispatcher</span> </span>&#123;</span><br><span class="line">  <span class="keyword">typealias</span> <span class="type">Success</span> = (<span class="type">Int</span>, <span class="type">HTTPResponse</span>) -&gt; <span class="type">Void</span></span><br><span class="line">  <span class="keyword">typealias</span> <span class="type">Failure</span> = (<span class="type">Error</span>, <span class="type">HTTPResponse</span>) -&gt; <span class="type">Void</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> successHandler: <span class="type">Success?</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> errorHandler: <span class="type">Failure?</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(success: Success?, error: Failure?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.successHandler = success</span><br><span class="line">    <span class="keyword">self</span>.errorHandler = error</span><br><span class="line">    internalHandle()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(success: Success?)</span></span> &#123;</span><br><span class="line">   <span class="keyword">self</span>.successHandler = success</span><br><span class="line">    internalHandle()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(error: Failure?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.errorHandler = error</span><br><span class="line">    internalHandle()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">internalHandle</span><span class="params">()</span></span> &#123;</span><br><span class="line">   ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ä»…æ˜“äºé˜…è¯»ï¼Œè€Œä¸”éšç€åœ¨æ›´å¤šåœ°æ–¹ä½¿ç”¨è¯¥ç±»å‹ï¼Œå®ƒä¹Ÿä¼šç»§ç»­å‘æŒ¥å®ƒçš„ä½œç”¨ã€‚</p><h3 id="æ³›å‹åˆ«å"><a href="#æ³›å‹åˆ«å" class="headerlink" title="æ³›å‹åˆ«å"></a>æ³›å‹åˆ«å</h3><p>ç±»å‹åˆ«åä¹Ÿå¯ä»¥æ˜¯æ³›å‹çš„ã€‚ä¸€ä¸ªç®€å•çš„ç”¨ä¾‹æ˜¯å¼ºåˆ¶æ‰§è¡Œå…·æœ‰ç‰¹æ®Šå«ä¹‰çš„å®¹å™¨ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤„ç†å›¾ä¹¦çš„åº”ç”¨ã€‚ä¸€æœ¬ä¹¦ç”±ç« èŠ‚ç»„æˆï¼Œç« èŠ‚ç”±é¡µé¢ç»„æˆã€‚ä»æ ¹æœ¬ä¸Šè®²ï¼Œè¿™äº›åªæ˜¯æ•°ç»„ã€‚ä¸‹é¢æ˜¯ <code>typealias</code>ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">typealias</span> <span class="type">Chapter</span> = <span class="type">Array</span>&lt;<span class="type">Page</span>&gt;</span><br><span class="line"><span class="keyword">typealias</span> <span class="type">Book</span> = <span class="type">Array</span>&lt;<span class="type">Chapter</span>&gt;</span><br></pre></td></tr></table></figure><p>ä¸ä»…ä½¿ç”¨æ•°ç»„ç›¸æ¯”ï¼Œè¿™æœ‰ä¸¤ä¸ªå¥½å¤„ã€‚</p><ol><li>è¯¥ä»£ç æ›´å…·è§£é‡Šæ€§ã€‚</li><li>åŒ…è£…é¡µé¢çš„æ•°ç»„<em>åª</em>èƒ½åŒ…å«é¡µé¢ï¼Œè€Œä¸èƒ½åŒ…å«å…¶å®ƒçš„ã€‚</li></ol><p>å›é¡¾æˆ‘ä»¬å…ˆå‰ä½¿ç”¨<em>æˆåŠŸ</em>å’Œ<em>å¤±è´¥</em>å¤„ç†ç¨‹åºçš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨æ³›å‹å¤„ç†ç¨‹åºæ¥è¿›ä¸€æ­¥æ”¹è¿›ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">Handler</span>&lt;<span class="type">In</span>&gt; = (<span class="type">In</span>, <span class="type">HTTPResponse?</span>, <span class="type">Context</span>) -&gt; <span class="type">Void</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(success: Handler&lt;Int&gt;?, </span></span></span><br><span class="line"><span class="function"><span class="params">            failure: Handler&lt;Error&gt;?,</span></span></span><br><span class="line"><span class="function"><span class="params">           progress: Handler&lt;Double&gt;?,)</span></span></span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„ç»„åˆç¡®å®éå¸¸æ£’ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿç¼–å†™ä¸€ä¸ªæ›´ç®€å•çš„å‡½æ•°ï¼Œå¹¶å¯ä»¥åœ¨ä¸€ä¸ªåœ°æ–¹ç¼–è¾‘ <code>Handler</code>ã€‚</p><p>è¿™ç§æ–¹æ³•å¯¹äºè‡ªå®šä¹‰çš„ç±»å‹ä¹Ÿéå¸¸æœ‰ç”¨ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ³›å‹å®šä¹‰ï¼Œç„¶åå®šä¹‰è¯¦ç»†çš„ç±»å‹åˆ«åï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ComputationResult</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> result: <span class="type">T</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">DataResult</span> = <span class="type">ComputationResult</span>&lt;<span class="type">Data</span>&gt;</span><br><span class="line"><span class="keyword">typealias</span> <span class="type">StringResult</span> = <span class="type">ComputationResult</span>&lt;<span class="type">String</span>&gt;</span><br><span class="line"><span class="keyword">typealias</span> <span class="type">IntResult</span> = <span class="type">ComputationResult</span>&lt;<span class="type">Int</span>&gt;</span><br></pre></td></tr></table></figure><p>å†è¯´ä¸€éï¼Œç±»å‹åˆ«åå…è®¸æˆ‘ä»¬ç¼–å†™æ›´å°‘çš„ä»£ç å¹¶ç®€åŒ–ä»£ç ä¸­çš„å®šä¹‰ã€‚</p><h3 id="åƒå‡½æ•°ä¸€æ ·çš„å…ƒç»„"><a href="#åƒå‡½æ•°ä¸€æ ·çš„å…ƒç»„" class="headerlink" title="åƒå‡½æ•°ä¸€æ ·çš„å…ƒç»„"></a>åƒå‡½æ•°ä¸€æ ·çš„å…ƒç»„</h3><p>åŒæ ·ï¼Œå¯ä»¥ä½¿ç”¨æ³›å‹å’Œå…ƒç»„æ¥å®šä¹‰ç±»å‹ï¼Œè€Œä¸æ˜¯å¿…é¡»ç”¨ç»“æ„ä½“ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬è®¾æƒ³äº†ä¸€ç§é—ä¼ ç®—æ³•çš„æ•°æ®ç±»å‹ï¼Œå®ƒå¯ä»¥åœ¨å¤šä»£ä¸­ä¿®æ”¹å…¶å€¼ <code>T</code>ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">Generation</span>&lt;<span class="type">T</span>: <span class="type">Numeric</span>&gt; = (initial: <span class="type">T</span>, seed: <span class="type">T</span>, <span class="built_in">count</span>: <span class="type">Int</span>, current: <span class="type">T</span>)</span><br></pre></td></tr></table></figure><p>å¦‚æœå®šä¹‰è¿™æ ·çš„ç±»å‹åˆ«åï¼Œåˆ™å®é™…ä¸Šå¯ä»¥åƒåˆå§‹åŒ–ä¸€ä¸ªç»“æ„ä½“é‚£æ ·å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> firstGeneration = <span class="type">Generation</span>(initial: <span class="number">10</span>, seed: <span class="number">42</span>, <span class="built_in">count</span>: <span class="number">0</span>, current: <span class="number">10</span>)</span><br></pre></td></tr></table></figure><p>å°½ç®¡å®ƒçœ‹èµ·æ¥ç¡®å®åƒä¸€ä¸ªç»“æ„ä½“ï¼Œä½†å®ƒåªæ˜¯ä¸€ä¸ªå…ƒç»„çš„ç±»å‹åˆ«åã€‚</p><h3 id="ç»„åˆåè®®"><a href="#ç»„åˆåè®®" class="headerlink" title="ç»„åˆåè®®"></a>ç»„åˆåè®®</h3><p>æœ‰æ—¶ï¼Œä½ ä¼šé‡åˆ°ä¸€ç§æƒ…å†µï¼Œä½ æœ‰å¤šä¸ªåè®®ï¼Œè€Œä¸”éœ€è¦ä½¿ç”¨ä¸€ä¸ªç‰¹å®šç±»å‹æ¥æŠŠè¿™äº›åè®®éƒ½å®ç°ã€‚è¿™ç§æƒ…å†µé€šå¸¸å‘ç”Ÿåœ¨å½“ä½ å®šä¹‰äº†ä¸€ä¸ªåè®®å±‚æ¥æé«˜çµæ´»æ€§æ—¶ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">CanRead</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">CanWrite</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">CanAuthorize</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">CanCreateUser</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">Administrator</span> = <span class="type">CanRead</span> &amp; <span class="type">CanWrite</span> &amp; <span class="type">CanAuthorize</span> &amp; <span class="type">CanCreateUser</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">User</span> = <span class="type">CanRead</span> &amp; <span class="type">CanWrite</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">Consumer</span> = <span class="type">CanRead</span></span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†æƒé™å±‚ã€‚ç®¡ç†å‘˜å¯ä»¥åšæ‰€æœ‰äº‹æƒ…ï¼Œç”¨æˆ·å¯ä»¥è¯»å†™ï¼Œè€Œæ¶ˆè´¹è€…åªèƒ½è¯»ã€‚</p><h3 id="å…³è”ç±»å‹"><a href="#å…³è”ç±»å‹" class="headerlink" title="å…³è”ç±»å‹"></a>å…³è”ç±»å‹</h3><p>è¿™è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ï¼Œä½†æ˜¯åè®®çš„å…³è”ç±»å‹ä¹Ÿå¯ä»¥é€šè¿‡ç±»å‹åˆ«åæ¥å®šä¹‰ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line"> <span class="keyword">associatedtype</span> <span class="type">Payload</span>: <span class="type">Numeric</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Implementation</span>: <span class="title">Example</span> </span>&#123;</span><br><span class="line">  <span class="keyword">typealias</span> <span class="type">Payload</span> = <span class="type">Int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><p>å°½ç®¡ç±»å‹åˆ«åæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œä½†å®ƒä»¬æœ‰ä¸€ä¸ªå°ç¼ºç‚¹ï¼šå¦‚æœä½ ä¸ç†Ÿæ‚‰ä»£ç åº“ï¼Œé‚£ä¹ˆå¯¹ä¸‹é¢è¿™ä¸¤ä¸ªå®šä¹‰çš„ç†è§£ä¼šæœ‰å¾ˆå¤§åŒºåˆ«ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">first</span><span class="params">(action: <span class="params">(Int, Error?)</span></span></span> -&gt; <span class="type">Void</span>) &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">second</span><span class="params">(action: Success)</span></span> &#123;&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªä¸æ˜¯ç«‹å³å°±èƒ½æ˜ç™½çš„ã€‚<code>Success</code> æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿå¦‚ä½•æ„é€ å®ƒï¼Ÿä½ å¿…é¡»åœ¨ Xcode ä¸­æŒ‰ä½ Option å•å‡»å®ƒï¼Œä»¥äº†è§£å®ƒçš„åŠŸèƒ½å’Œå·¥ä½œæ–¹å¼ã€‚è¿™ä¼šå¸¦æ¥é¢å¤–çš„å·¥ä½œé‡ã€‚å¦‚æœä½¿ç”¨äº†è®¸å¤šç±»å‹åˆ«åï¼Œåˆ™å°†èŠ±è´¹æ›´å¤šçš„æ—¶é—´ã€‚è¿™æ²¡æœ‰å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œï¼ˆé€šå¸¸ï¼‰åªèƒ½ä¾èµ–äºç”¨ä¾‹ã€‚</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>æˆ‘å¸Œæœ›ä½ èƒ½å–œæ¬¢è¿™ç¯‡å…³äºç±»å‹åˆ«åå¯èƒ½æ€§çš„å°æ€»ç»“ã€‚å¦‚æœä½ æœ‰ä»»ä½•åé¦ˆæ„è§ï¼Œ<a href="https://twitter.com/terhechte" target="_blank" rel="noopener">å¯ä»¥åœ¨ Twitter ä¸Šæ‰¾åˆ°æˆ‘</a>ã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡æè¿°äº†ç±»å‹åˆ«åçš„å·§å¦™ç”¨é€”
    
    </summary>
    
      <category term="APPVENTURE" scheme="https://swift.gg/categories/APPVENTURE/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>NSPredicate</title>
    <link href="https://swift.gg/2019/11/19/nspredicate-objective-c/"/>
    <id>https://swift.gg/2019/11/19/nspredicate-objective-c/</id>
    <published>2019-11-19T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šJordan Morganï¼Œ<a href="https://www.swiftjectivec.com/nspredicate-objective-c/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-05-18<br>è¯‘è€…ï¼š<a href="https://github.com/alejx" target="_blank" rel="noopener">çŸ³æ¦´</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://nemocdz.github.io/" target="_blank" rel="noopener">Nemocdz</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>Swift åˆšå‡ºç°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å› å®ƒæ¯” Objective-C ç®€æ´è€Œç€è¿·ã€‚æ¥ç€å®ƒå¾ˆå¿«æ‰“å¼€äº†é¢å‘åè®®ç¼–ç¨‹çš„å¤§é—¨ã€‚å¹¶ä¸”ï¼Œè®©æˆ‘ä»¬å¿˜æ‰å¼•ç”¨ç±»å‹å’Œç±»ï¼Œè¿˜æœ‰å¾ˆå¤šã€‚</p><p>ç¡®å®ï¼Œè¿™äº›ä¸œè¥¿éƒ½æ˜¯å¾ˆæ£’çš„å·¥å…·ï¼Œéƒ½æœ‰ä¼˜ç§€çš„ç”¨ä¾‹ã€‚ä½†æˆ‘æ„Ÿè§‰å®ƒä»¬ç»å¸¸è¢«æ§ä½œé“¶å¼¹ï¼Œåœ¨å†³å®šæ¶æ„æ—¶ç¼ºä¹è¶³å¤Ÿçš„è€ƒè™‘ã€‚</p><a id="more"></a><p>å› æ­¤åœ¨ 2018 å¹´ï¼ŒæŠ€æœ¯åšå®¢ä¸­å……æ–¥ç€å„ç§ Swift é»‘é­”æ³•ï¼ˆæˆ‘çš„åšå®¢ä¹Ÿä¸ä¾‹å¤–ğŸ¤·ğŸ»â€â™‚ï¸ï¼‰ï¼Œä¼šè®®æ¼”è®²ä¹Ÿéƒ½åœ¨è®¨è®º Swift çš„å‡½æ•°å¼ç¼–ç¨‹æœªæ¥ï¼ˆæ²¡é”™ï¼Œæˆ‘ä¹Ÿåšäº†è¿™ç§æ¼”è®²ğŸ™‹ğŸ»â€â™‚ï¸ï¼‰ã€‚</p><p>æ‰€æœ‰äººéƒ½å¯¹åœ¨ Swift ä¸­ä½¿ç”¨é›†åˆæ„Ÿåˆ°æ¿€åŠ¨ï¼Œ<strong>ä½†æ˜¯</strong>æˆ‘ä»¬ä» iOS 3 å¼€å§‹å°±å¯ä»¥ç”¨ Objective-C æ¥åš<em>ç›¸ä¼¼</em>çš„äº‹äº†ã€‚æ‰€ä»¥ä»Šå¤©æˆ‘ä¼šè®¨è®º <code>NSPredicate</code> çš„å¨åŠ›ï¼Œä»¥åŠå¦‚ä½•ç”¨ğŸ¦–ç­›é€‰é›†åˆã€‚</p><p>æœ‰å¿…è¦æä¸€ä¸‹ï¼šæˆ‘ä»¬æœ€è¿‘çœ‹åˆ°äº†ä¸€äº›å¼€å‘è€…ä¸€å¼€å§‹å­¦äº† Swiftï¼Œåæ¥åˆå¾—å›å»ç»´æŠ¤ Objective-C çš„ä»£ç ã€‚å¦‚æœè¯´çš„å°±æ˜¯ä½ ï¼Œé‚£ä½ å¾ˆå¯èƒ½æ­£åœ¨å‘æ„å¦‚ä½•ä¼˜é›…åœ°åœ¨ Objective-C ä¸­å¤„ç†é›†åˆã€‚</p><p>è¿™é‡Œè®²çš„ä¸œè¥¿å¯èƒ½å¯¹ä½ æœ‰ç”¨ã€‚</p><h2 id="ç”¨ä¾‹"><a href="#ç”¨ä¾‹" class="headerlink" title="ç”¨ä¾‹"></a>ç”¨ä¾‹</h2><p>è¿‘å‡ å¹´æ¥ï¼ŒObjective-C çš„é›†åˆæœ‰äº†é•¿è¶³çš„è¿›æ­¥ã€‚è¿˜åœ¨å‡ å¹´ä»¥å‰ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»æ•™è¿™æ„šè ¢çš„ç¼–è¯‘å™¨ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSString *aString = (NSString *)[anArray indexOfObject:0];</span><br></pre></td></tr></table></figure><p>æ„Ÿè°¢è€å¤©ã€åº“æ¯”æè¯º[^1]å’Œæœ‹å‹ä»¬Â©ç»ˆäºç”¨ç±»å‹æ“¦é™¤çš„æ–¹å¼æ·»åŠ äº†æ³›å‹ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„è¿›æ­¥ï¼š</p><p>[^1]: è¯‘è€…æ³¨ï¼šCupertino, CAï¼Œè‹¹æœæ€»éƒ¨æ‰€åœ¨åŸå¸‚ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSArray *anArray = @[@&quot;Sup&quot;];</span><br><span class="line">NSString *aString = [anArray firstObject];</span><br></pre></td></tr></table></figure><p>ä½†æ— è®ºæ˜¯ä¸æ˜¯æ³›å‹ï¼Œæˆ‘ä»¬ç»å¸¸é€šè¿‡ä¸ä¸‹é¢ç±»ä¼¼çš„æ–¹æ³•ä¸ Objective-C é›†åˆä¸­çš„å†…å®¹äº¤äº’ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">for (NSString *str in anArray)</span><br><span class="line">&#123;</span><br><span class="line">    if ([str isEqualToString:@&quot;The Key&quot;])</span><br><span class="line">    &#123;</span><br><span class="line">        // åšäº›ä»€ä¹ˆ</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆå¤šæƒ…å†µä¸‹ï¼Œè¿™æ ·å†™æ˜¯å¯ä»¥æ¥å—çš„ã€‚ä½†æ˜¯å½“éœ€æ±‚è¶Šæ¥è¶Šå¤æ‚ï¼Œå…³ç³»æ›´åŠ å¤šç§å¤šæ ·ï¼Œä»£ç å°±ä¼šå˜å¾—ä¸ç¡®å®šã€‚å¦‚æœä½ éµä»ä»£ç æ›´å°‘æ›´ç¨³å®šæ›´å®¹æ˜“ç»´æŠ¤çš„è§‚å¿µï¼Œé‚£ä¹ˆè¿™ç§ç®€å•çš„æŸ¥è¯¢é›†åˆæ“ä½œä¹Ÿå¯èƒ½æˆä¸ºå›°æ‰°ã€‚</p><p>Predicate å¯ä»¥æ”¹å–„è¿™ä¸ªçŠ¶å†µã€‚ä¸æ˜¯è¦åœ¨ä»£ç ä¸­è€äº›å°èªæ˜ï¼Œè€Œæ˜¯å†™å‡ºç®€æ´å’Œå®ç”¨çš„ä»£ç ã€‚</p><h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><p><code>NSPredicate</code> çš„æ ¸å¿ƒç”¨é€”æ˜¯é™åˆ¶æˆ–å®šä¹‰å¯¹å†…å­˜ä¸­çš„æ•°æ®è¿‡æ»¤ï¼Œæˆ–è¿›è¡Œå–å›æ—¶çš„å‚æ•°ã€‚å½“å®ƒå’Œ Core Data ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šå¦‚è™æ·»ç¿¼ã€‚å®ƒå’Œ SQL å¾ˆåƒï¼Œåªä¸è¿‡æ²¡é‚£ä¹ˆç³Ÿç³•*ã€‚</p><blockquote><p>å¼€ä¸ªç©ç¬‘ï¼Œåªæ˜¯æˆ‘å¯¹åŸºäºé›†åˆçš„æ“ä½œéƒ½æ— æ„ŸğŸ™ƒã€‚</p></blockquote><p>ä½ ç»™å®ƒæä¾›é€»è¾‘æ¡ä»¶ï¼Œç„¶åå°±ä¼šè¿”å›ç¬¦åˆæ¡ä»¶çš„ä¸œè¥¿ã€‚è¿™æ„å‘³ç€å®ƒå¯ä»¥æä¾›åŸºç¡€æ¯”è¾ƒã€å¤åˆ predicateã€KeyPath é›†åˆæŸ¥è¯¢ã€å­æŸ¥è¯¢ã€åˆè®¡ä»¥åŠæ›´å¤šçš„æ”¯æŒã€‚</p><p>å› ä¸ºå®ƒç”¨æ¥ç­›é€‰é›†åˆï¼Œå®ƒå¯ä»¥è·å¾— Foundation ç±»çš„åŸç”Ÿæ”¯æŒã€‚ä½¿ç”¨å¯å˜ç‰ˆæœ¬æ—¶æ”¯æŒç”¨ç»“æœç›´æ¥ä¿®æ”¹ï¼Œä¸å¯å˜ç‰ˆæœ¬ä¼šè¿”å›ä¸€ä¸ªæ–°å®ä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// ä¿®æ”¹åŸæ•°ç»„</span><br><span class="line">[mutableArray filterUsingPredicate:/*NSPredicate*/];</span><br><span class="line"></span><br><span class="line">// è¿”å›æ–°çš„æ•°ç»„</span><br><span class="line">[mutableArray filteredArrayUsingPredicate:/*NSPredicate*/];</span><br></pre></td></tr></table></figure><p>è™½ç„¶ predicate å¯ä»¥ä» <code>NSExpression</code>ã€<code>NSCompoundPredicate</code> æˆ– <code>NSComparsionPredicate</code> ä¸­å®ä¾‹åŒ–ï¼Œä½†å®ƒè¿˜å¯ä»¥ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²çš„è¯­æ³•ç”Ÿæˆã€‚è¿™å’Œå¯è§†åŒ–æ ¼å¼è¯­è¨€ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒå®šä¹‰æ’ç‰ˆçº¦æŸã€‚</p><p>åœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨èƒ½ç”¨å­—ç¬¦ä¸²è¯­æ³•ç”Ÿæˆçš„èƒ½åŠ›ã€‚</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>ä¸ºäº†æ›´å¥½çš„è¯´æ˜ï¼Œæ–‡ç« çš„å‰©ä½™éƒ¨åˆ†ä»¥ä¸‹é¢çš„ä»£ç ä¸ºå‰æã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// ä¼ªä»£ç </span><br><span class="line">Person:NSObject</span><br><span class="line">Identifier:NSString</span><br><span class="line">Name:NSString</span><br><span class="line">PayGrade:NSNumber</span><br><span class="line"></span><br><span class="line">// æŸä¸ªå«æœ‰ Person å®ä¾‹çš„å±æ€§</span><br><span class="line">NSArray *employees</span><br></pre></td></tr></table></figure><h2 id="æŸ¥è¯¢âš¡ï¸"><a href="#æŸ¥è¯¢âš¡ï¸" class="headerlink" title="æŸ¥è¯¢âš¡ï¸"></a>æŸ¥è¯¢âš¡ï¸</h2><p>æœ¬æ–‡å‰©ä¸‹éƒ½åœ¨ç”¨ç›´æ¥çš„ä¾‹å­æ¥ä»‹ç»å¦‚ä½•ç”¨å­—ç¬¦ä¸²æ ¼å¼è¯­æ³•æ¥é…ç½®æŸ¥è¯¢ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä»ä¸€ä¸ªç®€å•çš„æœç´¢çš„æƒ…æ™¯å¼€å§‹ã€‚å…ˆå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå«æœ‰è¡¨ç¤º <code>Person</code> å¯¹è±¡æ ‡è¯†ç¬¦çš„æ•°ç»„ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    @&quot;erersdg32453tr&quot;,  </span><br><span class="line">    @&quot;dfs8rw093jrkls&quot;,  </span><br><span class="line">    // etc</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡è¿™äº›è¯†åˆ«ç¬¦ä»ä¸€ä¸ªç°å­˜çš„ <code>Person</code> æ•°ç»„ä¸­è·å– <code>Person</code> å¯¹è±¡ã€‚å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåŒå±‚åµŒå¥—çš„ <code>for</code> å¾ªç¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// å‡è®¾ &quot;employees&quot; æ˜¯ä¸€ä¸ªå­˜æœ‰ Person å¯¹è±¡çš„æ•°ç»„</span><br><span class="line">NSArray  *morningEventAttendees = @[/*ä¸Šé¢çš„äººçš„è¯†åˆ«ç¬¦*/];</span><br><span class="line">NSMutableArray  *peopleAttendingMorningEvent = [NSMutableArray new];</span><br><span class="line"></span><br><span class="line">for (NSString *userID in morningEventAttendees)  </span><br><span class="line">&#123;  </span><br><span class="line">    for (Person *person in employees)  </span><br><span class="line">    &#123;  </span><br><span class="line">        if ([person.identifier isEqualToString:userID])  </span><br><span class="line">        &#123;  </span><br><span class="line">            [peopleAttending addObject:person];  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç°åœ¨ peopleAttendingMorningEvent é‡Œé¢å°±æœ‰æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿äº†</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ predicate æ¥è¾¾åˆ°å®Œå…¨ä¸€æ ·çš„æ•ˆæœï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSPredicate *morningAttendees = [NSPredicate predicateWithFormat:@&quot;SELF.identifier IN %@&quot;, peopleAttendingMorningEvent];</span><br><span class="line"></span><br><span class="line">NSArray *peopleAttendingMorningEvent = [employees filteredArrayUsingPredicate:morningAttendees];</span><br></pre></td></tr></table></figure><p>ğŸ’«ã€‚</p><p>Predicate çš„è¯­æ³•å…è®¸æˆ‘ä»¬ä½¿ç”¨ SELFï¼Œå®ƒåœ¨è¿™é‡Œå‘æŒ¥äº†å¾ˆå¤§çš„ä½œç”¨ã€‚å®ƒè¡¨ç¤ºæ•°ç»„é‡Œæ­£åœ¨è¢«æ“ä½œçš„å¯¹è±¡ï¼Œåœ¨è¿™é‡Œå°±æ˜¯ <code>Person</code> å¯¹è±¡ã€‚</p><blockquote><p>å¦ä¸€ä¸ªé¢å¤–çš„å¥½å¤„æ˜¯æˆ‘ä»¬ä¸ç”¨æŠŠæ•°ç»„å®šä¹‰æˆå¯å˜çš„äº†ã€‚</p></blockquote><p>æ­£æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ä¸ SELF æ‰€è¡¨ç¤ºå¯¹è±¡å…³è”çš„ KeyPathã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå¼•ç”¨äº† <code>identifier</code> å±æ€§ã€‚</p><p>å¦‚æœä½ å–œæ¬¢çš„è¯ï¼Œä»»ä½• KeyPath å¯ä»¥ç”¨æ”¾åœ¨ â€œ%Kâ€ ä½ç½®çš„å˜é‡æ¥è¡¨ç¤ºã€‚è¿™ä¸ªç‰ˆæœ¬å’Œä¸Šé¢çš„æ•ˆæœä¸€æ ·ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[NSPredicate predicateWithFormat:@&quot;SELF.%K IN %@&quot;, @&quot;identifier&quot;, peopleAttendingMorningEvent];</span><br></pre></td></tr></table></figure><h2 id="å¤åˆ-Predicate"><a href="#å¤åˆ-Predicate" class="headerlink" title="å¤åˆ Predicate"></a>å¤åˆ Predicate</h2><p>åˆå¹¶å¤šä¸ªæ¯”è¾ƒå¾ˆç®€å•ã€‚å‡è®¾æˆ‘ä»¬è¿˜éœ€è¦åƒä¸Šé¢ä¸€æ ·æ‰¾åˆ°æ‰€æœ‰å‚åŠ æ´»åŠ¨çš„äººï¼Œä½†è¿˜è¦æ»¡è¶³ä»–ä»¬çš„å·¥èµ„æ°´å¹³åœ¨ 50000 åˆ° 60000 ä¹‹é—´ã€‚</p><p>å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„æ–¹æ³•ï¼Œæˆ‘ä»¬çš„ if è¯­å¥åªä¼šè¶Šå†™è¶Šé•¿ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// å’Œä¸Šé¢çš„ä»£ç ä¸€æ ·</span><br><span class="line">if ([person.identifier isEqualToString:userID] &amp;&amp; (person.paygrade.integerValue &gt;= 5 &amp;&amp; person.paygrade.integerValue &lt;= 10))  </span><br><span class="line">&#123;  </span><br><span class="line">    [peopleAttending addObject:person];  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†ä½¿ç”¨ä¸€ä¸ªé‡æ„è¿‡çš„ predicate å¯ä»¥è®©æˆ‘ä»¬ç”¨ä¸€ç§æ›´ç¬¦åˆè¯­è¨€ä¹ æƒ¯çš„æ–¹å¼æ¥è§£å†³é—®é¢˜ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSPredicate *morningAttendees = [NSPredicate predicateWithFormat:@&quot;SELF.identifier IN %@ &amp;&amp; SELF.paygrade.integerValue BETWEEN &#123;50000, 60000&#125;&quot;, peopleAttendingMorningEvent];</span><br></pre></td></tr></table></figure><p>å®ƒå…è®¸ç”¨ä¸åŒçš„æ“ä½œç¬¦è¡¨ç¤ºåŒæ ·çš„ä½œç”¨ï¼Œå¯ä»¥æ ¹æ®ä½ çš„åå¥½æ¥æå‡å¯è¯»æ€§ã€‚æ¯”å¦‚ï¼š</p><ul><li>â€œ&amp;&amp;â€ æˆ– â€œANDâ€</li><li>â€œ||â€ æˆ– â€œORâ€</li><li>â€œ!â€ æˆ– â€œNOTâ€</li></ul><p>å¦‚ä½ æ‰€æƒ³ï¼Œå®ƒä»¬ç»å¸¸ä¼šåœ¨åŸºæœ¬æ¯”è¾ƒæ“ä½œä¹‹é—´å‡ºç°ï¼Œèšåˆåœ¨ä¸€ä¸ª predicate é‡Œã€‚</p><h2 id="å­—ç¬¦ä¸²æ¯”è¾ƒ"><a href="#å­—ç¬¦ä¸²æ¯”è¾ƒ" class="headerlink" title="å­—ç¬¦ä¸²æ¯”è¾ƒ"></a>å­—ç¬¦ä¸²æ¯”è¾ƒ</h2><p>æˆ‘ä»¬ç»å¸¸ä¼šå¤„ç†ä¸€äº›åŸºäºå­—ç¬¦ä¸²æ¯”è¾ƒçš„åŒ¹é…ã€‚å¤§å®¶éƒ½çŸ¥é“ Objective-C å¯¹å†—ä½™ä»£ç çš„æ— æ­¢å°½è¿½æ±‚ï¼Œåœ¨å¤„ç† NSString çš„æ—¶å€™ä¹Ÿä¸æ¯«ä¸å‡ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSString *name = @&quot;Jordan&quot;;</span><br><span class="line">name = [name stringByAppendingString:[NSString stringWithFormat:@&quot;%@ %@&quot;, @&quot;Wesley&quot;, @&quot;Morgan&quot;]];</span><br></pre></td></tr></table></figure><p>â€¦â€¦è€Œ Swift åˆ™ä¸€è¾¹å·ç¬‘ï¼Œä¸€è¾¹ä½è°ƒåœ°æŠŠå­—ç¬¦ä¸²ä»¬è¿æ¥èµ·æ¥ã€‚å¹¸äºæˆ‘ä»¬åœ¨ç”¨ <code>NSPredicate</code> æ¥æ¯”è¾ƒå­—ç¬¦ä¸²æ—¶ä¸ä¼šå†™å‡ºä¸Šé¢é‚£ä¹ˆå†—ä½™çš„ä»£ç ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// å‡è®¾ mutablePersonAr æ˜¯ä¸€ä¸ª Person æ•°ç»„ï¼Œé‡Œé¢æœ‰ &quot;Karl&quot; å’Œ &quot;Jordan&quot;</span><br><span class="line">NSPredicate *namesStartingWithK = [NSPredicate predicateWithFormat:@&quot;SELF.name BEGINSWITH &apos;K&apos;&quot;];</span><br><span class="line">// ç°åœ¨åªæœ‰ Karl äº†</span><br><span class="line">[mutablePersonAr filterUsingPredicate:namesStartingWithK];</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šä»»ä½•æ¯”è¾ƒéƒ½å¯ä»¥ç”¨ predicate è¯­æ³•ä¸­çš„ <code>CONTAINS</code>ã€<code>BEGINSWITH</code>ã€<code>ENDSWITH</code> å’Œ <code>LIKE</code> æ¥å®ç°ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// å‡è®¾ mutablePersonAr æ˜¯ä¸€ä¸ª Person æ•°ç»„ï¼Œé‡Œé¢æœ‰ &quot;Karl&quot; å’Œ &quot;Kathryn&quot;</span><br><span class="line">NSPredicate *namesStartingWithK = [NSPredicate predicateWithFormat:@&quot;SELF.name LIKE &apos;Kar*&apos;&quot;];</span><br><span class="line"></span><br><span class="line">// ç°åœ¨åªæœ‰ Karl äº†</span><br><span class="line">[mutablePersonAr filterUsingPredicate:namesStartingWithK];</span><br></pre></td></tr></table></figure><blockquote><p>ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ä¸Šé¢çš„æ˜Ÿå·äº†ï¼›å’Œå¾ˆå¤šçš„ DSL ä¸€æ ·ï¼Œè¿™ä¸ªæ˜Ÿå·ä»£è¡¨ä¸€ä¸ªé€šé…ç¬¦ã€‚</p></blockquote><p>å½“ä½ åœ¨ä¸€ä¸ªæŸ¥è¯¢é‡Œç»“åˆå¤šä¸ªæ¯”è¾ƒè¿ç®—ç¬¦æ—¶ï¼Œè¿™ç§ç®€æ´ç”¨æ³•çš„é‡è¦æ€§å°±ä¼šä½“ç°å‡ºæ¥äº†ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSString *predicateFormat = @&quot;(SELF.name LIKE &apos;Kar*&apos;) AND (SELF.paygrade.intValue &gt;= 10)&quot;;</span><br><span class="line"></span><br><span class="line">NSPredicate *namesStringWithK = [NSPredicate predicateWithFormat:predicateFormat];</span><br><span class="line"></span><br><span class="line">// ç°åœ¨åªæœ‰ Karl äº†</span><br><span class="line">[mutablePersonAr filterUsingPredicate:namesStartingWithK];</span><br></pre></td></tr></table></figure><p>æ›´è¿›ä¸€æ­¥ï¼Œå®ƒè¿˜æ”¯æŒç”¨ <code>MATCHES</code> è¯­æ³•å®ç° NSPredicate çš„ç±» SQL è¯­æ³•ä¸æ­£åˆ™è¡¨è¾¾å¼æ··ç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[NSPredicate predicateWithFormat:@&quot;SELF.phoneNumber MATCHES %@&quot;, phoneNumberRegex];</span><br></pre></td></tr></table></figure><p>ç„¶è€Œæ˜¯æ—¶å€™è¯¥æŒ‡å‡ºä¸€ç‚¹ï¼Œpredicate è¯­æ³•ååˆ†ä¸¥æ ¼ã€‚å®ƒå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚é™¤éä½ æ˜¯ Mavis Beacon[^2], å¦åˆ™ä½ æ€»ä¼šä¸€éåˆä¸€éåœ°ä¸å°å¿ƒæ‰“é”™å­—ã€‚</p><p>[^2]: è¯‘è€…æ³¨ï¼š<em>Mavis Beacon Teaches Typing</em>ï¼Œä¸€æ¬¾åœ¨ 1987 å¹´å‘å”®çš„æ•™ç›²æ‰“çš„è½¯ä»¶ã€‚</p><p>å¥½æ¶ˆæ¯æ˜¯ä½ ä¼šå¾ˆå¿«çš„å‘ç°é—®é¢˜â€Šâ€” è¿è¡Œæ—¶çš„å¼‚å¸¸åœ¨ç­‰ç€ä½ ã€‚æˆ‘ä»¬è·å¾—äº†èƒ½åŠ›å’Œçµæ´»æ€§ï¼Œä½†åœ¨æŸç§ç¨‹åº¦ä¸Šå¤±å»äº†é™æ€æ£€æŸ¥çš„å®‰å…¨æ€§ã€‚</p><p>ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œè¿™æ®µä»ä¸Šé¢ä»£ç ç¨å¾®ä¿®æ”¹è€Œæ¥çš„ä»£ç ä¼šå¯¼è‡´å´©æºƒã€‚ä½ èƒ½çœ‹å‡ºæ¥æ˜¯ä¸ºä»€ä¹ˆå—ï¼Ÿ</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSString *predicateFormat = @&quot;SELF.name LIKE &apos;Kar*&apos;) AND (SELF.paygrade.intValue &gt;= 10)&quot;</span><br><span class="line"></span><br><span class="line">NSPredicate *namesStartingWithK = [NSPredicate predicateWithFormat:predicateFormat];</span><br><span class="line"></span><br><span class="line">// ç°åœ¨åªæœ‰ Karl äº† </span><br><span class="line">[mutablePersonAr filterUsingPredicate:namesStartingWithK];</span><br></pre></td></tr></table></figure><p>ä¸ºäº†å‡è½»è¿™äº›é—®é¢˜ï¼Œæˆ‘ç»å¸¸æŠŠ predicate å’Œ <code>NSStringFromSelector()</code> ç»“åˆåœ¨ä¸€èµ·ç”¨ï¼Œä»¥æ­¤åº”å¯¹é”™åˆ«å­—å’Œä¸ºä»¥åçš„é‡æ„æä¾›å¤šä¸€å±‚å®‰å…¨ä¿éšœã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSString *predicateFormat = @&quot;(SELF.%@ LIKE &apos;Kar*&apos;) AND (SELF.paygrade.intValue &gt;= 10)&quot;</span><br><span class="line"></span><br><span class="line">NSString *kpName = NSStringFromSelector(@selector(identifier));  </span><br><span class="line">NSString *kpPaygrade = NSStringFromSelector(@selector(paygrade));</span><br><span class="line"></span><br><span class="line">NSPredicate *namesStartingWithK = [NSPredicate predicateWithFormat:predicateFormat, kpName, kpPaygrade];</span><br><span class="line"></span><br><span class="line">// ç°åœ¨åªæœ‰ Karl äº†</span><br><span class="line">[mutablePersonAr filterUsingPredicate:namesStartingWithK];</span><br></pre></td></tr></table></figure><p>æœ‰ç‚¹å¤æ‚äº†ï¼Ÿç¡®å®ã€‚æ›´å®‰å…¨äº†ï¼Ÿæ¯«æ— ç–‘é—®ã€‚</p><h2 id="KeyPath-é›†åˆæŸ¥è¯¢"><a href="#KeyPath-é›†åˆæŸ¥è¯¢" class="headerlink" title="KeyPath é›†åˆæŸ¥è¯¢"></a>KeyPath é›†åˆæŸ¥è¯¢</h2><p>ç”±äºåŸºäº KeyPath çš„ç”¨æ³•ï¼Œ<code>NSPredicate</code> æ‹¥æœ‰ä¸€å…¨å¥—å·¥å…·å»æ“ä½œå®ƒä»¬ï¼Œä»¥æä¾›ä¸€ä¸ªæ›´å¥½çš„æœç´¢ã€‚è€ƒè™‘ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// å‡è®¾ä¸€ä¸ª Person å¯¹è±¡ç°åœ¨æœ‰ä¸€ä¸ªä¸‹é¢çš„å±æ€§ï¼š</span><br><span class="line">// NSArray *previousPay</span><br><span class="line"></span><br><span class="line">// æ‰¾åˆ°æ‰€æœ‰æ»¡è¶³è¿‡å»å·¥èµ„çš„å¹³å‡å€¼å¤§äº 10 çš„äºº</span><br><span class="line">NSString *predicateFormat = @&quot;SELF.previousPay.@avg.doubleValue &gt; 10&quot;;</span><br><span class="line">NSPredicate *previousPayOverTen = [NSPredicate predicateWithFormat:predicateFormat];</span><br><span class="line"></span><br><span class="line">// æ‰€æœ‰è¿‡å»å·¥èµ„çš„å¹³å‡å€¼å¤§äº 10 çš„äºº</span><br><span class="line">[mutablePersonAr filterUsingPredicate:previousPayOverTen];</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥æŠŠ <code>@avg</code> æ¢æˆï¼š  </p><ul><li><code>@sum</code></li><li><code>@max</code></li><li><code>@min</code></li><li><code>@count</code></li></ul><p>æƒ³è±¡ä¸‹å¦‚æœä¸ä½¿ç”¨ predicate æƒ…å†µä¸‹å®ŒæˆåŒæ ·çš„å·¥ä½œï¼Œå°±ä¸å¾—ä¸å†™å¤§é‡å°½ç®¡å¾ˆç®€å•çš„ä»£ç ã€‚ä½ å¯ä»¥å¼€å§‹å°†è¿™äº›æŠ€å·§ç”¨åœ¨ä½ æ—¥å¸¸çš„å·¥å…·é“¾é‡Œã€‚</p><h2 id="å¯¹æ•°ç»„çš„æ·±ç©¶"><a href="#å¯¹æ•°ç»„çš„æ·±ç©¶" class="headerlink" title="å¯¹æ•°ç»„çš„æ·±ç©¶"></a>å¯¹æ•°ç»„çš„æ·±ç©¶</h2><p>å’Œ KeyPath æŸ¥è¯¢å¾ˆåƒï¼Œpredicate ä¹Ÿæ”¯æŒä»¥æ›´ç»†çš„ç»´åº¦æ£€æŸ¥æ•°ç»„ï¼š</p><ul><li><code>array[FIRST]</code></li><li><code>array[LAST]</code></li><li><code>array[SIZE]</code></li><li><code>array[index]</code></li></ul><p>åº”ç”¨åœ¨ä¸Šé¢çš„ä»£ç æ ·ä¾‹ä¸Šï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿™æ ·æŸ¥è¯¢ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// æ‰¾åˆ°æ‰€æœ‰è¿‡å»æœ‰ä¸‰ä»½ä¸åŒå·¥èµ„çš„äºº</span><br><span class="line">NSString *predicateFormat = @&quot;previousPay[SIZE] == 3&quot;;</span><br><span class="line"></span><br><span class="line">NSPredicate *threePreviousSalaries = [NSPredicate predicateWithFormat:predicateFormat];</span><br><span class="line"></span><br><span class="line">// è¿™äº› Person å¯¹è±¡è¿‡å»æœ‰ä¸‰ä»½ä¸åŒçš„å·¥èµ„</span><br><span class="line">[mutablePersonAr filterUsingPredicate:threePreviousSalaries];</span><br></pre></td></tr></table></figure><p>å’Œåœ¨ä¸Šé¢æåˆ°çš„ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åº”ç”¨å¤šä¸ªæ¡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// æ‰¾åˆ°æ‰€æœ‰è¿‡å»æœ‰ä¸‰ä¸ªä¸åŒçš„å·¥èµ„ä»¥åŠç¬¬ä¸€ä»½å·¥èµ„å¤§äº 8 çš„äºº</span><br><span class="line">NSString *predicateFormat = @&quot;(previousPay[SIZE] == 3) AND (previousPay[FIRST].intValue &gt; 8)&quot;;</span><br><span class="line"></span><br><span class="line">NSPredicate *predicate = [NSPredicate predicateWithFormat:predicateFormat];</span><br><span class="line">[mutablePersonAr filterUsingPredicate:predicate];</span><br></pre></td></tr></table></figure><p>æ›´åŠ æ·±å…¥ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ“ä½œç¬¦æ¥å®ç°æ›´å¤æ‚çš„æ“ä½œï¼š</p><ul><li><code>@distinctUnionOfArrays</code></li><li><code>@unionOfArrays</code></li><li><code>@unionOfObjects</code></li><li><code>@distinctUnionOfObjects</code></li></ul><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå«æœ‰ <code>Person</code> å¯¹è±¡çš„æ•°ç»„ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯æ‰¾å‡ºåœ¨æ‰€æœ‰æ•°ç»„ä¸­è¯†åˆ«ç¬¦ä¸åŒçš„ <code>Person</code> å®ä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// å‡è®¾ p1/2/3/4 éƒ½æ˜¯ Person å¯¹è±¡</span><br><span class="line">NSArray  *&gt; *previousEmployees = @[@[p1],@[p2,p1,p2],@[p1],@[p4,p2],@[p4],@[p4],@[p1]];</span><br><span class="line"></span><br><span class="line">// è·å–æ‰€æœ‰ä¸åŒçš„ ID</span><br><span class="line">NSArray *unqiuePreviousEmployeeIDs = [previousEmployees valueForKeyPath:@&quot;@distinctUnionOfObjects.identifier&quot;];</span><br><span class="line"></span><br><span class="line">// ç°åœ¨æ•°ç»„é‡Œåº”è¯¥åªå«æœ‰ä¸åŒçš„ ID</span><br></pre></td></tr></table></figure><p>å‰å®³å§ï¼</p><p>è¿˜æœ‰æ›´å¥½ç©çš„å‘¢ï¼Œè¿˜æ”¯æŒå­æŸ¥è¯¢ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// å‡è®¾ Person å¯¹è±¡æœ‰äº†ä¸€ä¸ªæ–°çš„å±æ€§è¡¨ç¤ºä»–ä»¬çš„é˜Ÿä¼ï¼š</span><br><span class="line">// NSArray  *team;</span><br><span class="line">  </span><br><span class="line">// ä»é›‡å‘˜æ•°ç»„ä¸­æ‰¾å‡ºè¿™æ ·çš„äººï¼Œä»–ä»¬çš„å›¢é˜Ÿä¸­æœ‰äººæ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼šæ²¡æœ‰å†å²å·¥èµ„æ•°æ®å¹¶ä¸”å·¥èµ„å¤§äº 1</span><br><span class="line">NSString *predicateFormat = @&quot;SUBQUERY(team, $teamMember, $teamMember.paygrade.intValue &gt; 1 AND $teamMember.previousPay == nil).@count &gt; 0&quot;;</span><br><span class="line"></span><br><span class="line">NSPredicate *predicate = [NSPredicate predicateWithFormat:predicateFormat];</span><br><span class="line">[employeeAr filterUsingPredicate:predicate];</span><br></pre></td></tr></table></figure><p>å½“ä½ å‘ç°ä½ éœ€è¦åœ¨ä¸€ä¸ªå«æœ‰å¯¹è±¡çš„æ•°ç»„é‡Œæœç´¢ï¼Œè€Œè¿™äº›å¯¹è±¡å«æœ‰çš„å±æ€§æœ¬èº«å°±æ˜¯ä¸€ä¸ªé›†åˆçš„æ—¶å€™ï¼Œå­æŸ¥è¯¢ååˆ†æœ‰ç”¨ã€‚æ‰€ä»¥åœ¨ä¸Šé¢çš„ä¾‹å­é‡Œï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª <code>Person</code> å¯¹è±¡çš„æ•°ç»„ï¼Œå¹¶ä¸”æŸ¥è¯¢å®ƒçš„ <code>teamMember</code> æ•°ç»„ã€‚</p><h2 id="ä¾¿æ·æ‰æ˜¯å…³é”®-3"><a href="#ä¾¿æ·æ‰æ˜¯å…³é”®-3" class="headerlink" title="ä¾¿æ·æ‰æ˜¯å…³é”®[^3]"></a>ä¾¿æ·æ‰æ˜¯å…³é”®[^3]</h2><p>[^3]: è¯‘è€…æ³¨ï¼šæ­¤å¤„åŸä½œè€…ç”¨äº†åŒå…³ã€‚åŸæ–‡æ˜¯ â€œConvenience is Key(Path)â€ï¼Œæ—¢æœ‰ä¾¿æ·æ˜¯å…³é”®çš„æ„æ€ï¼Œåˆåœ¨æš—æŒ‡è¿™é‡Œçš„å…³é”®å…¶å®æ˜¯ Key Pathã€‚</p><p>å°½ç®¡ <code>NSPredicate</code> æ˜¯ä¸ºäº†æœç´¢è€Œè®¾è®¡å‡ºæ¥çš„ï¼Œä½†å¦‚æœä½ ä¸æŠŠå®ƒç”¨åœ¨å’ŒåŸæœ¬è®¾è®¡<em>ç¨å¾®</em>åç¦»çš„åœ°æ–¹é‚£å®ƒå°±ä¸æ˜¯ Objective-C äº†ã€‚è¿™é‡Œä¹Ÿä¸ä¾‹å¤–ã€‚</p><p>å½“ä½ æƒ³åˆ° predicateï¼Œä½ æƒ³åˆ°çš„æ˜¯ä»ä¸€ä¸ªé›†åˆé‡Œç­›é€‰ â€” ä¹Ÿå°±æ˜¯è¯´å®ƒçš„è¿”å›å€¼ï¼ˆæˆ–æ›´æ”¹è¿‡çš„åŸæ¥æ•°ç»„ï¼‰è¿˜å«æœ‰ç›¸åŒçš„ä¸œè¥¿ã€‚</p><p>ä½†æ˜¯ä¹Ÿå¯ä»¥è®©ä»–ä»¬å«æœ‰<em>ä¸</em>åŒçš„ä¸œè¥¿ã€‚å…¶å®æˆ‘ä»¬åœ¨ä¹‹å‰çš„ä»£ç ä¸­å·²ç»è¿™æ ·æ“ä½œè¿‡äº†ã€‚ä¸Šé¢çš„äºŒç»´æ•°ç»„è¢«ç”¨æ¥è¿”å›ä¸€ä¸ªè¯†åˆ«ç¬¦çš„æ•°ç»„ â€” <code>NSString</code> å®ä¾‹ã€‚KeyPath è®©è¿™äº›å˜å¾—å¯èƒ½ã€‚</p><p>è¿™æœ‰ä¸€ä¸ªæ›´ç›´æ¥çš„ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªé•¿åº¦å¤§äº 10 çš„è¯†åˆ«ç¬¦å­—ç¬¦ä¸²çš„æ•°ç»„</span><br><span class="line">NSString *predicateFormat = @&quot;SELF.identifier.length &gt; 10&quot;;</span><br><span class="line">NSPredicate *predicate = [NSPredicate predicateWithFormat:predicateFormat];</span><br><span class="line">NSArray  *longEmployeeIDs = [[employeeArray filteredArrayUsingPredicate:predicate] valueForKey:@&quot;identifier&quot;];</span><br><span class="line"></span><br><span class="line">// ç°åœ¨ longEmployeeIDs å·²ç»ä¸å«æœ‰ Person å¯¹è±¡äº†ï¼Œåªæœ‰å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é©¬ä¸Šåœ¨ Objective-C çš„é›†åˆé‡Œä½¿ç”¨è¿™äº›è¯­æ³•ç³–ï¼Œè¿™æ ·å°±å¯ä»¥ä¸ä½¿ç”¨åµŒå¥—å¾ªç¯ä»ä¸€ä¸ªç‰¹å®šçš„å­é›†ä¸­æå–æ•°æ®ã€‚ä½¿ç”¨ <code>NSPredicate</code> å¯ä»¥è®©çœ¼ç›è½»æ¾å¾ˆå¤šã€‚</p><p>è™½ç„¶ Swift ä»è¯­è¨€çº§åˆ«æ”¯æŒå¯¹é›†åˆè¿›è¡Œåˆ‡ç‰‡æ“ä½œï¼Œä½†ä½¿ç”¨åˆ›å»ºçš„ NSPredicate å¯¹è±¡æ¥è§£å†³ç›¸åŒçš„é—®é¢˜ä¹Ÿä¸éš¾ã€‚å¦‚æœä½ å‘ç°ä½ åœ¨ç»´æŠ¤ä¸€ä¸ªæˆç†Ÿçš„ä»£ç åº“ï¼Œæˆ–æ˜¯éœ€è¦ç”¨ä¸Šå¤æ—¶ä»£ Objective-C çš„æ–°é¡¹ç›®ï¼Œéšå¿ƒæ‰€æ¬²çš„ä½¿ç”¨ predicate å§ã€‚</p><p>ä¸‹æ¬¡è§å§âœŒï¸ã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šJordan Morganï¼Œ&lt;a href=&quot;https://www.swiftjectivec.com/nspredicate-objective-c/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-05-18&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://github.com/alejx&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;çŸ³æ¦´&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://numbbbbb.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;numbbbbb&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://nemocdz.github.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Nemocdz&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/Pancf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Pancf&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;Swift åˆšå‡ºç°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å› å®ƒæ¯” Objective-C ç®€æ´è€Œç€è¿·ã€‚æ¥ç€å®ƒå¾ˆå¿«æ‰“å¼€äº†é¢å‘åè®®ç¼–ç¨‹çš„å¤§é—¨ã€‚å¹¶ä¸”ï¼Œè®©æˆ‘ä»¬å¿˜æ‰å¼•ç”¨ç±»å‹å’Œç±»ï¼Œè¿˜æœ‰å¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;ç¡®å®ï¼Œè¿™äº›ä¸œè¥¿éƒ½æ˜¯å¾ˆæ£’çš„å·¥å…·ï¼Œéƒ½æœ‰ä¼˜ç§€çš„ç”¨ä¾‹ã€‚ä½†æˆ‘æ„Ÿè§‰å®ƒä»¬ç»å¸¸è¢«æ§ä½œé“¶å¼¹ï¼Œåœ¨å†³å®šæ¶æ„æ—¶ç¼ºä¹è¶³å¤Ÿçš„è€ƒè™‘ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="swiftjectivec" scheme="https://swift.gg/categories/swiftjectivec/"/>
    
    
      <category term="Objective-C" scheme="https://swift.gg/tags/Objective-C/"/>
    
      <category term="NSPredicate" scheme="https://swift.gg/tags/NSPredicate/"/>
    
  </entry>
  
  <entry>
    <title>è°ƒè¯•å†…å­˜ä¸è¶³é—®é¢˜ï¼šä½¿ç”¨è¿è¡Œæ—¶é­”æ³•æ•è·å¸ƒå±€åé¦ˆå¾ªç¯</title>
    <link href="https://swift.gg/2019/11/11/layout-feedback-loop/"/>
    <id>https://swift.gg/2019/11/11/layout-feedback-loop/</id>
    <published>2019-11-11T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šRuslan Serebriakovï¼Œ<a href="https://www.appcoda.com/layout-feedback-loop/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2019-01-10<br>è¯‘è€…ï¼šSunset Wanï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://nemocdz.github.io/" target="_blank" rel="noopener">Nemocdz</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>è®©æˆ‘ä»¬æƒ³è±¡è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šä½ æœ‰ä¸€ä¸ªå¾ˆæˆåŠŸçš„åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºæœ‰å¤§é‡çš„æ—¥æ´»ç”¨æˆ·å¹¶ä¸”å´©æºƒç‡ä¸º 0ã€‚ä½ å¾ˆå¼€å¿ƒå¹¶ä¸”è®¤ä¸ºç”Ÿæ´»å¾ˆç¾å¥½ã€‚ä½†æ˜¯æŸå¤©å¼€å§‹ï¼Œä½ åœ¨åº”ç”¨å•†åº—ä¸Šçœ‹åˆ°å…³äºåº”ç”¨ç¨‹åºæ€»æ˜¯å´©æºƒçš„è´Ÿé¢è¯„ä»·ã€‚æ£€æŸ¥ Fabric ä¹Ÿæ²¡æœ‰èµ·åˆ°ä»»ä½•å¸®åŠ©â€”â€”â€”â€”æ²¡æœ‰å‡ºç°æ–°çš„å´©æºƒè®°å½•ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªç°è±¡å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯å†…å­˜ä¸è¶³ï¼ˆOut Of Memoryï¼‰ï¼Œä»è€Œå¯¼è‡´åº”ç”¨ç¨‹åºè¿è¡Œç»ˆæ­¢ã€‚<br><a id="more"></a></p><p>å½“ä½ åœ¨ç»ˆç«¯ç”¨æˆ·çš„è®¾å¤‡ä¸Šä½¿ç”¨ RAM æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥å†³å®šæ˜¯å¦ä¸ºå…¶ä»–è¿›ç¨‹è€Œå›æ”¶è¯¥å†…å­˜ï¼Œå¹¶ç»ˆæ­¢ä½ çš„åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬æŠŠå®ƒç§°ä½œå†…å­˜ä¸è¶³å¼‚å¸¸ç»ˆæ­¢ã€‚<br>å¯èƒ½æœ‰å„ç§åŸå› ï¼š</p><ul><li>å¾ªç¯å¼•ç”¨;</li><li>ç«äº‰æ¡ä»¶;</li><li>åºŸå¼ƒçš„çº¿ç¨‹;</li><li>æ­»é”;</li><li>å¸ƒå±€åé¦ˆå¾ªç¯ã€‚</li></ul><p>Apple æä¾›äº†å¾ˆå¤šæ–¹æ³•æ¥è§£å†³è¿™ç±»é—®é¢˜ï¼š</p><ul><li>Instruments é‡Œçš„ Allocations å’Œ Leaks å·¥å…·ç”¨äºè§£å†³å¾ªç¯å¼•ç”¨å’Œ <a href="https://developer.apple.com/videos/play/wwdc2015/230/" target="_blank" rel="noopener">å…¶ä»–ç±»å‹çš„æ³„æ¼</a></li><li>åœ¨ Xcode 8 ä¸­å¼•å…¥çš„ <a href="https://developer.apple.com/videos/play/wwdc2016/410/" target="_blank" rel="noopener">Memory Debugger</a> ä»£æ›¿äº† Allocations å’Œ Leaks çš„ä¸€éƒ¨åˆ†åŠŸèƒ½</li><li><a href="https://developer.apple.com/videos/play/wwdc2016/412/" target="_blank" rel="noopener">Thread Sanitizer</a> å¸®åŠ©ä½ æ‰¾åˆ°ç«äº‰æ¡ä»¶ã€åºŸå¼ƒçš„çº¿ç¨‹æˆ–è€…æ­»é”</li></ul><h2 id="å¸ƒå±€åé¦ˆå¾ªç¯"><a href="#å¸ƒå±€åé¦ˆå¾ªç¯" class="headerlink" title="å¸ƒå±€åé¦ˆå¾ªç¯"></a>å¸ƒå±€åé¦ˆå¾ªç¯</h2><p>ä¸‹é¢æˆ‘ä»¬æ¥è®¨è®ºä¸‹å¸ƒå±€åé¦ˆå¾ªç¯ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªé¢‘ç¹å‡ºç°çš„é—®é¢˜ï¼Œä¸€æ—¦é‡åˆ°äº†ï¼Œå¯èƒ½è®©ä½ å¾ˆå¤´ç—›ã€‚</p><blockquote><p>å½“è§†å›¾æ­£åœ¨è¿è¡Œå®ƒä»¬çš„å¸ƒå±€ä»£ç ï¼Œä½†æŸç§æ–¹æ³•å¯¼è‡´å®ƒä»¬å†ä¸€æ¬¡å¼€å§‹å¸ƒå±€ä¼ é€’ï¼Œæ­¤æ—¶å¸ƒå±€åé¦ˆå¾ªç¯å°±ä¼šå‡ºç°ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºæŸä¸ªè§†å›¾æ­£åœ¨æ”¹å˜æŸä¸ªçˆ¶è§†å›¾çš„å¤§å°ï¼Œæˆ–è€…å› ä¸ºä½ æœ‰ä¸€ä¸ªæ¨¡æ£±ä¸¤å¯çš„å¸ƒå±€ã€‚æ— è®ºå“ªç§åŸå› ï¼Œè¿™ä¸ªé—®é¢˜çš„è¡¨ç°æ˜¯ä½ çš„ CPU ä½¿ç”¨è¢«å æ»¡å’Œ RAM ä½¿ç”¨é‡ç¨³æ­¥ä¸Šå‡ï¼Œå› ä¸ºä½ çš„è§†å›¾æ­£åœ¨ä¸€æ¬¡åˆä¸€æ¬¡åœ°è¿è¡Œå®ƒä»¬çš„å¸ƒå±€ä»£ç ï¼Œå´æ²¡æœ‰è¿”å›ã€‚<br>- <a href="https://www.hackingwithswift.com/articles/59/debugging-auto-layout-feedback-loops" target="_blank" rel="noopener">æ¥è‡ª HackingWithSwift çš„ Paul Hudson</a></p></blockquote><p>å¹¸è¿çš„æ˜¯ï¼Œåœ¨ WWDC 16 ä¸­ Apple èŠ±äº†æ•´æ•´ 15 åˆ†é’Ÿï¼ˆï¼ï¼‰æ¥ä»‹ç»â€œå¸ƒå±€åé¦ˆå¾ªç¯è°ƒè¯•å™¨â€ã€‚è¿™ä¸ªè°ƒè¯•å™¨æœ‰åŠ©äºè¯†åˆ«åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­å‘ç”Ÿå¾ªç¯çš„æ—¶é—´ç‚¹ã€‚è¿™å°±æ˜¯ä¸€ä¸ªç¬¦å·æ–­ç‚¹ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼éå¸¸ç®€å•ï¼šå®ƒä¼šè®¡ç®—åœ¨å•ä¸ª run loop è¿­ä»£ä¸­è°ƒç”¨æ¯ä¸ªè§†å›¾ä¸Šçš„ <code>layoutSubviews()</code> æ–¹æ³•çš„æ¬¡æ•°ã€‚ä¸€æ—¦è¿™ä¸ªè®¡æ•°å€¼è¶…è¿‡æŸä¸ªä¸´ç•Œå€¼ï¼ˆæ¯”å¦‚ï¼Œ100ï¼‰ï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºå°†ä¼šåœåœ¨è¿™ä¸ªæ–­ç‚¹å¹¶æ‰“å°å‡ºæ—¥å¿—ï¼Œæ¥å¸®åŠ©ä½ æ‰¾åˆ°æ ¹æœ¬åŸå› ã€‚<a href="https://www.hackingwithswift.com/articles/59/debugging-auto-layout-feedback-loops" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a> å¿«é€Ÿåœ°ä»‹ç»å¦‚ä½•ä½¿ç”¨è¿™ä¸ªè°ƒè¯•å™¨ã€‚</p><p>è¿™ä¸ªæ–¹æ³•åœ¨ä½ å¯ä»¥é‡ç°é—®é¢˜çš„æƒ…å†µä¸‹ååˆ†æœ‰æ•ˆã€‚ä½†æ˜¯å¦‚æœä½ æœ‰å‡ åä¸ªå±å¹•ï¼Œå‡ ç™¾ä¸ªè§†å›¾ï¼Œä½†åº”ç”¨å•†åº—ä¸­ä½ çš„åº”ç”¨ç¨‹åºçš„è¯„ä»·ä»…ä»…æ˜¯ï¼šâ€œè¿™ä¸ªåº”ç”¨ç¨‹åºç³Ÿé€äº†ï¼Œæ€»æ˜¯å´©æºƒï¼Œå†ä¹Ÿä¸ç”¨äº†ï¼â€ã€‚ä½ å¸Œæœ›å¯ä»¥å°†è¿™äº›äººå¸¦åˆ°åŠå…¬å®¤å¹¶ä¸ºä»–ä»¬è®¾ç½®å¸ƒå±€åé¦ˆå¾ªç¯è°ƒè¯•å™¨ã€‚è™½ç„¶å› ä¸ºé€šç”¨æ•°æ®ä¿æŠ¤æ¡ä¾‹ï¼ˆGDPRï¼‰ï¼Œè¿™éƒ¨åˆ†æ— æ³•å®Œå…¨å®ç°ï¼Œä½†æ˜¯ä½ å¯ä»¥å°è¯•æŠŠ <code>UIViewLayoutFeedbackLoopDebuggingThreshold</code> çš„ä»£ç å¤åˆ¶åˆ°ç”Ÿäº§ä»£ç ä¸­ã€‚</p><p>è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ç¬¦å·æ–­ç‚¹æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼šå®ƒä¼šè®¡ç®— <code>layoutSubviews()</code> çš„è°ƒç”¨æ¬¡æ•°å¹¶åœ¨å•ä¸ª run loop è¿­ä»£ä¸­è¶…è¿‡æŸä¸ªä¸´ç•Œå€¼æ—¶å‘é€ä¸€ä¸ªäº‹ä»¶ã€‚å¬èµ·æ¥å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿ</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">class TrackableView: UIView &#123;</span><br><span class="line">    var counter: Int = 0</span><br><span class="line"> </span><br><span class="line">    override func layoutSubviews() &#123;</span><br><span class="line">        super.layoutSubviews()</span><br><span class="line"> </span><br><span class="line">        counter += 1;</span><br><span class="line">        if (counter == 100) &#123;</span><br><span class="line">            YourAnalyticsFramework.event(name: &quot;loop&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸€ä¸ªè§†å›¾ï¼Œè¿™æ®µä»£ç è¿è¡Œæ­£å¸¸ã€‚ä½†æ˜¯ç°åœ¨ä½ æƒ³è¦åœ¨å¦ä¸€ä¸ªè§†å›¾ä¸Šå®ç°å®ƒã€‚å½“ç„¶ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª <code>UIView</code> çš„å­ç±»ï¼Œåœ¨è¿™é‡Œå®ç°å®ƒå¹¶ä½¿ä½ é¡¹ç›®ä¸­çš„æ‰€æœ‰è§†å›¾éƒ½ç»§æ‰¿è¿™ä¸ªå­ç±»ã€‚ç„¶åä¸º <code>UITableView</code>ï¼Œ<code>UIScrollView</code>ï¼Œ<code>UIStackView</code> ç­‰åšåŒæ ·çš„äº‹æƒ…ã€‚</p><p>ä½ å¸Œæœ›å¯ä»¥å°†æ­¤é€»è¾‘æ³¨å…¥ä½ æƒ³è¦çš„ä»»ä½•ç±»ï¼Œè€Œæ— éœ€ç¼–å†™å¤§é‡é‡å¤çš„ä»£ç ã€‚è¿™æ—¶å€™å°±å¯ä»¥å€ŸåŠ©è¿è¡Œæ—¶ç¼–ç¨‹äº†ã€‚</p><p>æˆ‘ä»¬ä¼šåšåŒæ ·çš„äº‹æƒ…â€”â€”åˆ›å»ºä¸€ä¸ªå­ç±»ï¼Œé‡å†™ <code>layoutSubviews()</code> æ–¹æ³•å¹¶è®¡ç®—å…¶è°ƒç”¨æ¬¡æ•°ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯æ‰€æœ‰è¿™äº›éƒ½å°†åœ¨è¿è¡Œæ—¶å®Œæˆï¼Œè€Œä¸æ˜¯åœ¨é¡¹ç›®ä¸­åˆ›å»ºé‡å¤çš„ç±»ã€‚</p><p>è®©æˆ‘ä»¬å¼€å§‹å§â€”â€”æˆ‘ä»¬å°†åˆ›å»ºè‡ªå®šä¹‰å­ç±»ï¼Œå¹¶å°†åŸå§‹è§†å›¾çš„ç±»æ›´æ”¹ä¸ºæ–°çš„å­ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">struct LayoutLoopHunter &#123;</span><br><span class="line"> </span><br><span class="line">    struct RuntimeConstants &#123;</span><br><span class="line">        static let Prefix = â€œruntimeâ€</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    static func setUp(for view: UIView, threshold: Int = 100, onLoop: @escaping () -&gt; ()) &#123;</span><br><span class="line">        // æˆ‘ä»¬æ ¹æ®åŠŸèƒ½çš„å‰ç¼€å’ŒåŸå§‹ç±»åä¸ºæ–°ç±»åˆ›å»ºåç§°ã€‚</span><br><span class="line">        let classFullName = â€œ\(RuntimeConstants.Prefix)_\(String(describing: view.self))â€</span><br><span class="line">        let originalClass = type(of: view)</span><br><span class="line"> </span><br><span class="line">        if let trackableClass = objc_allocateClassPair(originalClass, classFullName, 0) &#123;</span><br><span class="line">            // åœ¨å½“å‰è¿è¡Œæ—¶ä¼šè¯æœŸé—´å°šæœªåˆ›å»ºæ­¤ç±»ã€‚</span><br><span class="line">            // æ³¨å†Œè¿™ä¸ªç±»ï¼Œå¹¶ä¸”ç”¨åŸå§‹è§†å›¾çš„ç±»æ¥å’Œå®ƒäº¤æ¢ã€‚</span><br><span class="line">            objc_registerClassPair(trackableClass)</span><br><span class="line">            object_setClass(view, trackableClass)</span><br><span class="line">        &#125; else if let trackableClass = NSClassFromString(classFullName) &#123;</span><br><span class="line">            // æˆ‘ä»¬ä¹‹å‰åœ¨æ­¤è¿è¡Œæ—¶ä¼šè¯ä¸­åˆ†é…äº†ä¸€ä¸ªå…·æœ‰ç›¸åŒåç§°çš„ç±»ã€‚</span><br><span class="line">            // æˆ‘ä»¬å¯ä»¥ä»åŸå§‹å­—ç¬¦ä¸²ä¸­è·å–å®ƒï¼Œå¹¶ä»¥ç›¸åŒçš„æ–¹å¼ä¸æˆ‘ä»¬çš„è§†å›¾äº¤æ¢ã€‚</span><br><span class="line">            object_setClass(view, trackableClass)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>objc_allocateClassPair()</code> æ–¹æ³•çš„æ–‡æ¡£å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªæ–¹æ³•ä½•æ—¶å¤±è´¥ï¼š</p><blockquote><p>æ–°ç±»ï¼Œæˆ–è€…å¦‚æœæ— æ³•åˆ›å»ºç±»ï¼Œåˆ™ä¸º Nil ï¼ˆä¾‹å¦‚ï¼Œæ‰€éœ€åç§°å·²è¢«ä½¿ç”¨ï¼‰ã€‚</p></blockquote><p>è¿™å°±æ„å‘³ç€ä¸èƒ½æ‹¥æœ‰ä¸¤ä¸ªåŒåçš„ç±»ã€‚æˆ‘ä»¬çš„ç­–ç•¥æ˜¯ä¸ºå•ä¸ªè§†å›¾ç±»åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„è¿è¡Œæ—¶ç±»ã€‚è¿™å°±æ˜¯æˆ‘ä»¬åœ¨åŸå§‹ç±»åå‰åŠ ä¸Šå‰ç¼€æ¥å½¢æˆæ–°ç±»çš„åç§°çš„åŸå› ã€‚</p><p>ç°åœ¨æ·»åŠ ä¸€ä¸ªè®¡æ•°å™¨åˆ°å­ç±»ä¸­ã€‚ç†è®ºä¸Šï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><ol><li>æ·»åŠ ä¸€ä¸ªä¿å­˜è®¡æ•°å™¨çš„å±æ€§ã€‚</li><li>ä¸ºè¿™ä¸ªç±»åˆ›å»ºä¸€ä¸ªå…³è”å¯¹è±¡ï¼ˆAssociated objectï¼‰ã€‚</li></ol><p>ä½†æ˜¯ç›®å‰ï¼Œ<strong>åªæœ‰ä¸€ä¸ªæ–¹æ³•å¥æ•ˆ</strong>ã€‚ä½ å¯ä»¥æƒ³è±¡å±æ€§æ˜¯å­˜å‚¨åœ¨åˆ†é…ç»™ç±»çš„å†…å­˜é‡Œçš„ä¸œè¥¿ï¼Œç„¶è€Œå…³è”å¯¹è±¡åˆ™å‚¨å­˜åœ¨ä¸€ä¸ªå®Œå…¨ä¸åŒçš„åœ°æ–¹ã€‚å› ä¸ºåˆ†é…ç»™å·²å­˜åœ¨å¯¹è±¡çš„å†…å­˜æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è‡ªå®šä¹‰ç±»ä¸Šæ–°æ·»åŠ çš„å±æ€§å°†ä¼šä»å…¶ä»–èµ„æºé‡Œâ€œçªƒå–â€å†…å­˜ã€‚å®ƒå¯èƒ½å¯¼è‡´æ„æ–™ä¹‹å¤–çš„è¡Œä¸ºå’Œéš¾ä»¥è°ƒè¯•çš„ç¨‹åºå´©æºƒï¼ˆç‚¹å‡» <a href="https://stackoverflow.com/questions/3346427/object-setclass-to-bigger-class" target="_blank" rel="noopener">è¿™é‡Œ</a> æŸ¥çœ‹æ›´å¤šä¿¡æ¯ï¼‰ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨å…³è”å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œå®ƒä»¬å°†ä¼šå­˜å‚¨åœ¨è¿è¡Œæ—¶åˆ›å»ºçš„ä¸€ä¸ªå“ˆå¸Œè¡¨é‡Œï¼Œè¿™æ˜¯å®Œå…¨å®‰å…¨çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">static var CounterKey = &quot;_counter&quot;</span><br><span class="line"> </span><br><span class="line">...</span><br><span class="line"> </span><br><span class="line">objc_setAssociatedObject(trackableClass, &amp;RuntimeConstants.CounterKey, 0, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br></pre></td></tr></table></figure><p>å½“æ–°çš„å­ç±»è¢«åˆ›å»ºæ—¶ï¼Œè®¡æ•°å™¨åˆå€¼è®¾ç½®ä¸º 0ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å®ç°è¿™ä¸ªæ–°çš„<code>layoutSubviews()</code> æ–¹æ³•ï¼Œå¹¶å°†å®ƒæ·»åŠ åˆ°æˆ‘ä»¬çš„ç±»ä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">let layoutSubviews: @convention(block) (Any?) -&gt; () = &#123; nullableSelf in</span><br><span class="line">    guard let _self = nullableSelf else &#123; return &#125;</span><br><span class="line"> </span><br><span class="line">    if let counter = objc_getAssociatedObject(_self, &amp;RuntimeConstants.CounterKey) as? Int &#123;</span><br><span class="line">        if counter == threshold &#123;</span><br><span class="line">            onLoop()</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        objc_setAssociatedObject(trackableClass, &amp;RuntimeConstants.CounterKey, counter+1, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">let implementation = imp_implementationWithBlock(layoutSubviews)</span><br><span class="line">class_addMethod(trackableClass, #selector(originalClass.layoutSubviews), implementation, &quot;v@:&quot;)</span><br></pre></td></tr></table></figure><p>ä¸ºäº†ç†è§£ä¸Šé¢è¿™æ®µä»£ç å®é™…ä¸Šåœ¨å¹²ä»€ä¹ˆï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªæ¥è‡ª <code>&lt;objc/runtime.h&gt;</code> çš„ç»“æ„ä½“ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">struct objc_method &#123;</span><br><span class="line">    SEL method_name;</span><br><span class="line">    char *method_types;</span><br><span class="line">    IMP method_imp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°½ç®¡æˆ‘ä»¬å†ä¹Ÿä¸ä¼šåœ¨ Swift ä¸­ç›´æ¥ä½¿ç”¨è¿™ä¸ªç»“æ„ä½“ï¼Œä½†å®ƒå¾ˆæ¸…æ¥šåœ°è§£é‡Šäº†ä¸€ä¸ªæ–¹æ³•å®é™…ä¸Šæ˜¯ç”±ä»€ä¹ˆç»„æˆçš„ï¼š</p><ul><li>æ–¹æ³•çš„å®ç°ï¼Œè¿™æ˜¯è°ƒç”¨æ–¹æ³•æ—¶è¦æ‰§è¡Œçš„å®é™…å‡½æ•°ã€‚å®ƒçš„å‰ä¸¤ä¸ªå½¢å‚æ€»æ˜¯æ–¹æ³•æ¥æ”¶è€…å’Œæ¶ˆæ¯é€‰æ‹©å™¨ã€‚</li><li>åŒ…å«æ–¹æ³•ç­¾åçš„æ–¹æ³•ç±»å‹å­—ç¬¦ä¸²ã€‚ä½ å¯ä»¥åœ¨ <a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtTypeEncodings.html" target="_blank" rel="noopener">è¿™é‡Œ</a> è¯¦ç»†äº†è§£å…¶æ ¼å¼ã€‚ä½†æ˜¯åœ¨ç°åœ¨çš„æƒ…å†µä¸‹ï¼Œéœ€è¦æ˜ç¡®è¯´æ˜çš„å­—ç¬¦ä¸²æ˜¯ <code>â€œv@:â€</code>ã€‚ä½œä¸ºè¿”å›ç±»å‹ï¼Œ<code>v</code> ä»£è¡¨ <code>void</code>ï¼Œè€Œ <code>@</code> å’Œ <code>:</code> åˆ†åˆ«ä»£è¡¨æ¥æ”¶è€…å’Œæ¶ˆæ¯é€‰æ‹©å™¨ã€‚</li><li>é€‰æ‹©å™¨ä½œä¸ºé”®ï¼Œç”¨äºåœ¨è¿è¡Œæ—¶æŸ¥æ‰¾æ–¹æ³•çš„å®ç°ã€‚</li></ul><p>ä½ å¯ä»¥æŠŠ Witness Tableï¼ˆåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå®ƒä¹Ÿè¢«ç§°ä½œæ–¹æ³•æ´¾å‘è¡¨ï¼‰æƒ³è±¡æˆä¸€ä¸ªç®€å•çš„å­—å…¸æ•°æ®ç»“æ„ã€‚é‚£ä¹ˆé€‰æ‹©å™¨ä¸ºé”®ï¼Œä¸”å®ç°éƒ¨åˆ†åˆ™ä¸ºå¯¹åº”çš„å€¼ã€‚<br>åœ¨ä¸‹é¢è¿™è¡Œä»£ç ä¸­:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">class_addMethod(trackableClass,#selector(originalClass.layoutSubviews), implementation, &quot;v@:&quot;)</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬æ‰€åšçš„æ˜¯ç»™ <code>layoutSubviews()</code> æ–¹æ³•å¯¹åº”çš„é”®åˆ†é…æ–°å€¼ã€‚    </p><p>è¿™ä¸ªæ–¹æ³•ç›´æˆªäº†å½“ã€‚æˆ‘ä»¬è·å¾—è¿™ä¸ªè®¡æ•°å™¨ï¼Œä½¿å®ƒçš„è®¡æ•°å€¼åŠ ä¸€ã€‚å¦‚æœè®¡æ•°å€¼è¶…è¿‡ä¸´ç•Œå€¼ï¼Œæˆ‘ä»¬ä¼šå‘é€åˆ†æäº‹ä»¶ï¼Œå…¶ä¸­åŒ…å«ç±»åå’Œæƒ³è¦çš„ä»»ä½•æ•°æ®ä½“ã€‚</p><p>è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹å¦‚ä½•å¯¹å…³è”å¯¹è±¡å®ç°å’Œä½¿ç”¨é”®ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">static var CounterKey = â€œ_counterâ€</span><br><span class="line">...</span><br><span class="line"> </span><br><span class="line">objc_setAssociatedObject(trackableClass, &amp;RuntimeConstants.CounterKey, counter+1, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨ <code>var</code> æ¥ä¿®é¥°è®¡æ•°å™¨çš„é”®è¿™ä¸ªé™æ€å±æ€§å¹¶åœ¨ä¼ é€’åˆ°å…¶ä»–åœ°æ–¹æ—¶ä½¿ç”¨å¼•ç”¨ï¼Ÿç­”æ¡ˆéšè—åœ¨ Swift è¯­è¨€åŸºç¡€â€”â€”å­—ç¬¦ä¸²ä¹‹ä¸­ã€‚å­—ç¬¦ä¸²åƒå…¶ä»–æ‰€æœ‰çš„å€¼ç±»å‹ä¸€æ ·ï¼Œæ˜¯æŒ‰å€¼ä¼ é€’çš„ã€‚é‚£ä¹ˆï¼Œå½“ä½ æŠŠå®ƒä¼ å…¥è¿™ä¸ªé—­åŒ…æ—¶ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°†ä¼šè¢«å¤åˆ¶åˆ°ä¸€ä¸ªä¸åŒçš„åœ°å€ï¼Œè¿™ä¼šå¯¼è‡´åœ¨å…³è”å¯¹è±¡è¡¨ä¸­äº§ç”Ÿä¸€ä¸ªå®Œå…¨ä¸åŒçš„é”®ã€‚<code>&amp;</code> ç¬¦å·æ€»æ˜¯ä¿è¯å°†ç›¸åŒçš„åœ°å€ä½œä¸ºé”®å‚æ•°çš„å€¼ã€‚ä½ å¯ä»¥å°è¯•ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">func printAddress(_ string: UnsafeRawPointer) &#123;</span><br><span class="line">    print(&quot;\(string)&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let str = &quot;test&quot;</span><br><span class="line"></span><br><span class="line">printAddress(str)</span><br><span class="line">printAddress(str)</span><br><span class="line">let closure = &#123;</span><br><span class="line">    printAddress(str)</span><br><span class="line">    printAddress(str)</span><br><span class="line">&#125;</span><br><span class="line">closure()</span><br><span class="line">// æœ€åä¸¤ä¸ªå‡½æ•°è°ƒç”¨çš„åœ°å€å°†å§‹ç»ˆä¸åŒ</span><br></pre></td></tr></table></figure><p>ç”¨å¼•ç”¨çš„æ–¹å¼æ¥ä¼ é€’é”®çš„ä¸»æ„æ€»æ˜¯å¥½çš„ï¼Œå› ä¸ºæœ‰æ—¶ï¼Œå³ä½¿ä½ æ²¡æœ‰ä½¿ç”¨é—­åŒ…ï¼Œå˜é‡çš„åœ°å€ä»å¯èƒ½å› å†…å­˜ç®¡ç†è€Œæ›´æ”¹ã€‚åœ¨æˆ‘ä»¬ä¾‹å­ä¸­ï¼Œå¦‚æœä½ æŠŠä¸Šé¢çš„ä»£ç è¿è¡Œå¤šæ¬¡ï¼Œå³ä½¿æ˜¯å‰ä¸¤ä¸ª printAddress() çš„è°ƒç”¨ä¹Ÿå¯èƒ½ä¼šè¾“å‡ºä¸åŒçš„åœ°å€ã€‚</p><p>è®©æˆ‘ä»¬å›åˆ°è¿è¡Œæ—¶çš„é­”æ³•é‡Œæ¥ã€‚åœ¨æ–° <code>layoutSubviews()</code> çš„å®ç°é‡Œï¼Œè¿˜æœ‰ä¸€ä»¶å¾ˆé‡è¦çš„äº‹æƒ…æ²¡æœ‰å®Œæˆã€‚è¿™ä»¶äº‹æ˜¯æ¯æ¬¡é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ—¶é€šå¸¸éƒ½ä¼šåšçš„äº‹æƒ…â€”â€”è°ƒç”¨çˆ¶ç±»å®ç°ã€‚<code>layoutSubviews()</code> çš„æ–‡æ¡£é‡Œæåˆ°ï¼š</p><blockquote><p>åœ¨ iOS 5.1 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•çš„é»˜è®¤å®ç°ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚è€Œä¹‹åçš„é»˜è®¤å®ç°ä¼šä½¿ç”¨ä½ è®¾ç½®çš„ä»»ä½•çº¦æŸæ¥ç¡®å®šä»»ä½•å­è§†å›¾çš„å¤§å°å’Œä½ç½®ã€‚</p></blockquote><p>ä¸ºäº†é¿å…å‘ç”Ÿä¸€äº›éš¾ä»¥é¢„æ–™çš„å¸ƒå±€è¡Œä¸ºï¼Œæˆ‘ä»¬å¾—è°ƒç”¨çˆ¶ç±»çš„å®ç°ï¼Œä½†è¿™ä¸åƒå¹³å¸¸é‚£æ ·ç®€å•æ˜äº†ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">let selector = #selector(originalClass.layoutSubviews)</span><br><span class="line">let originalImpl = class_getMethodImplementation(originalClass, selector)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// @convention(c) å‘ŠçŸ¥ Swift è¿™æ˜¯ä¸€ä¸ªè£¸å‡½æ•°æŒ‡é’ˆï¼ˆæ²¡æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡ï¼‰</span><br><span class="line">// æ‰€æœ‰çš„ Obj-C æ–¹æ³•å‡½æ•°æŠŠæ¥æ”¶è€…å’Œæ¶ˆæ¯å½“ä½œå‰ä¸¤ä¸ªå‚æ•°</span><br><span class="line">// æ‰€ä»¥è¿™æ„å‘³ç€ä¸€ä¸ªç±»å‹ä¸º `() -&gt; Void` çš„æ–¹æ³•ï¼Œè¿™ä¸ `layoutSubview` æ–¹æ³•ç›¸ç¬¦</span><br><span class="line">typealias ObjCVoidVoidFn = @convention(c) (Any, Selector) -&gt; Void</span><br><span class="line">let originalLayoutSubviews = unsafeBitCast(originalImpl, to: ObjCVoidVoidFn.self)</span><br><span class="line">originalLayoutSubviews(view, selector)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå®é™…å‘ç”Ÿçš„æ˜¯ï¼šæˆ‘ä»¬æ£€ç´¢æ–¹æ³•æ‰€éœ€çš„å®ç°éƒ¨åˆ†ï¼Œå¹¶ç›´æ¥ä»ä»£ç ä¸­è°ƒç”¨å®ƒï¼Œè€Œä¸æ˜¯ç”¨å¸¸è§çš„æ–¹å¼æ¥è°ƒç”¨æ–¹æ³•ï¼ˆå³æ‰§è¡Œä¸€ä¸ªä¼šåœ¨ Witness Table ä¸­å¯»æ‰¾å¯¹åº”å®ç°çš„é€‰æ‹©å™¨ï¼‰ã€‚</p><p>ç›®å‰ä¸ºæ­¢ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ç°éƒ¨åˆ†ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">static func setUp(for view: UIView, threshold: Int = 100, onLoop: @escaping () -&gt; ()) &#123;</span><br><span class="line">    // æˆ‘ä»¬æ ¹æ®åŠŸèƒ½çš„å‰ç¼€å’ŒåŸå§‹ç±»åä¸ºæ–°ç±»åˆ›å»ºåç§°</span><br><span class="line">    let classFullName = â€œ\(RuntimeConstants.Prefix)_\(String(describing: view.self))â€</span><br><span class="line">    let originalClass = type(of: view)</span><br><span class="line"></span><br><span class="line">    if let trackableClass = objc_allocateClassPair(originalClass, classFullName, 0) &#123;</span><br><span class="line">        // åœ¨å½“å‰è¿è¡Œæ—¶ä¼šè¯æœŸé—´å°šæœªåˆ›å»ºæ­¤ç±»</span><br><span class="line">        // æ³¨å†Œè¿™ä¸ªç±»å¹¶å°†å…¶ä¸åŸå§‹è§†å›¾çš„ç±»äº¤æ¢</span><br><span class="line">        objc_registerClassPair(trackableClass)</span><br><span class="line">        object_setClass(view, trackableClass)</span><br><span class="line"></span><br><span class="line">        // ç°åœ¨å¯ä»¥åˆ›å»ºå…³è”å¯¹è±¡</span><br><span class="line">        objc_setAssociatedObject(view, &amp;RuntimeConstants.CounterKey, 0, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br><span class="line"></span><br><span class="line">        // æ·»åŠ æˆ‘ä»¬è‡ªå·± layoutSubviews çš„å®ç°</span><br><span class="line">        let layoutSubviews: @convention(block) (Any?) -&gt; () = &#123; nullableSelf in</span><br><span class="line">            guard let _self = nullableSelf else &#123; return &#125;</span><br><span class="line"></span><br><span class="line">            let selector = #selector(originalClass.layoutSubviews)</span><br><span class="line">            let originalImpl = class_getMethodImplementation(originalClass, selector)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">            // @convention(c) å‘ŠçŸ¥ Swift è¿™æ˜¯ä¸€ä¸ªè£¸å‡½æ•°æŒ‡é’ˆï¼ˆæ²¡æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡ï¼‰</span><br><span class="line">            // æ‰€æœ‰çš„ Obj-C æ–¹æ³•å‡½æ•°æŠŠæ¥æ”¶è€…å’Œæ¶ˆæ¯å½“ä½œå‰ä¸¤ä¸ªå‚æ•°</span><br><span class="line">            // æ‰€ä»¥è¿™æ„å‘³ç€ä¸€ä¸ªç±»å‹ä¸º `() -&gt; Void` çš„æ–¹æ³•ï¼Œè¿™ä¸ `layoutSubview` æ–¹æ³•ç›¸ç¬¦</span><br><span class="line">            typealias ObjCVoidVoidFn = @convention(c) (Any, Selector) -&gt; Void</span><br><span class="line">            let originalLayoutSubviews = unsafeBitCast(originalImpl, to: ObjCVoidVoidFn.self)</span><br><span class="line">            originalLayoutSubviews(view, selector)</span><br><span class="line"></span><br><span class="line">            if let counter = objc_getAssociatedObject(_self, &amp;RuntimeConstants.CounterKey) as? Int &#123;</span><br><span class="line">                if counter == threshold &#123;</span><br><span class="line">                    onLoop()</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                objc_setAssociatedObject(view, &amp;RuntimeConstants.CounterKey, counter+1, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        let implementation = imp_implementationWithBlock(layoutSubviews)</span><br><span class="line">        class_addMethod(trackableClass, #selector(originalClass.layoutSubviews), implementation, â€œv@:â€œ)</span><br><span class="line">    &#125; else if let trackableClass = NSClassFromString(classFullName) &#123;</span><br><span class="line">        // æˆ‘ä»¬ä¹‹å‰åœ¨æ­¤è¿è¡Œæ—¶ä¼šè¯ä¸­åˆ†é…äº†ä¸€ä¸ªå…·æœ‰ç›¸åŒåç§°çš„ç±»</span><br><span class="line">        // æˆ‘ä»¬å¯ä»¥ä»åŸå§‹å­—ç¬¦ä¸²ä¸­è·å–å®ƒï¼Œå¹¶ä»¥ç›¸åŒçš„æ–¹å¼ä¸æˆ‘ä»¬çš„è§†å›¾äº¤æ¢</span><br><span class="line">        object_setClass(view, trackableClass)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®©æˆ‘ä»¬ä¸ºè§†å›¾åˆ›å»ºæ¨¡æ‹Ÿå¸ƒå±€å¾ªç¯ï¼Œå¹¶ä¸ºå…¶è®¾ç½®è®¡æ•°å™¨æ¥è¿›è¡Œæµ‹è¯•ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">class ViewController: UIViewController &#123;</span><br><span class="line">    override func viewDidLoad() &#123;</span><br><span class="line">        super.viewDidLoad()</span><br><span class="line"> </span><br><span class="line">        LayoutLoopHunter.setUp(for: view) &#123;</span><br><span class="line">            print(&quot;Hello, world&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    override func viewDidLayoutSubviews() &#123;</span><br><span class="line">        super.viewDidLayoutSubviews()</span><br><span class="line">        view.setNeedsLayout() // loop creation</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ˜¯ä¸æ˜¯å¿˜è®°äº†ä»€ä¹ˆäº‹æƒ…ï¼Ÿè®©æˆ‘ä»¬å†æ¬¡å›é¡¾ä¸€ä¸‹ <code>UIViewLayoutFeedbackLoopDebuggingThreshold</code> æ–­ç‚¹çš„å·¥ä½œåŸç†ï¼š</p><blockquote><p>åœ¨ç¡®è®¤ä¸ºåé¦ˆå¾ªç¯ä¹‹å‰ï¼Œå®šä¹‰æŸä¸ªè§†å›¾çš„å­è§†å›¾åœ¨å•ä¸ª run loop é‡Œå¿…é¡»å¸ƒå±€çš„æ¬¡æ•°</p></blockquote><p>æˆ‘ä»¬ä»æœªæŠŠâ€œå•ä¸ª run loop â€è¿™ä¸€æ¡ä»¶è€ƒè™‘è¿›æ¥ã€‚å¦‚æœè§†å›¾åœ¨å±å¹•ä¸Šåœç•™äº†ç›¸å½“é•¿çš„æ—¶é—´ï¼Œå¹¶ç»å¸¸è¢«åå¤å¸ƒå±€ï¼Œè®¡æ•°å™¨è¿Ÿæ—©ä¼šè¶…è¿‡ä¸´ç•Œå€¼ã€‚ä½†è¿™å¯ä¸æ˜¯å› ä¸ºå†…å­˜çš„é—®é¢˜ã€‚</p><p>æˆ‘ä»¬è¯¥æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿåªéœ€åœ¨æ¯æ¬¡ run loop è¿­ä»£æ—¶é‡ç½®è®¡æ•°å™¨ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª <a href="https://www.appcoda.com/grand-central-dispatch/" target="_blank" rel="noopener"><strong>DispatchWorkItem</strong></a>ï¼Œå®ƒé‡ç½®è®¡æ•°å™¨ï¼Œå¹¶åœ¨ä¸»é˜Ÿåˆ—ä¸Šå¼‚æ­¥ä¼ é€’å®ƒã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå®ƒä¼šåœ¨ run loop ä¸‹ä¸€æ¬¡è¿›å…¥ä¸»çº¿ç¨‹æ—¶è¢«è°ƒç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">static var ResetWorkItemKey = â€œ_resetWorkItemâ€</span><br><span class="line"> </span><br><span class="line">...</span><br><span class="line"> </span><br><span class="line">if let previousResetWorkItem = objc_getAssociatedObject(view, &amp;RuntimeConstants.ResetWorkItemKey) as? DispatchWorkItem &#123;</span><br><span class="line">    previousResetWorkItem.cancel()</span><br><span class="line">&#125;</span><br><span class="line">let currentResetWorkItem = DispatchWorkItem &#123; [weak view] in</span><br><span class="line">    guard let strongView = view else &#123; return &#125;</span><br><span class="line">    objc_setAssociatedObject(strongView, &amp;RuntimeConstants.CounterKey, 0, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br><span class="line">&#125;</span><br><span class="line">DispatchQueue.main.async(execute: currentResetWorkItem)</span><br><span class="line">objc_setAssociatedObject(view, &amp;RuntimeConstants.ResetWorkItemKey, currentResetWorkItem, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆçš„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">struct LayoutLoopHunter &#123;</span><br><span class="line"> </span><br><span class="line">    struct RuntimeConstants &#123;</span><br><span class="line">        static let Prefix = â€œruntimeâ€</span><br><span class="line"> </span><br><span class="line">        // Associated objects keys</span><br><span class="line">        // å…³è”å¯¹è±¡é”®</span><br><span class="line">        static var CounterKey = â€œ_counterâ€</span><br><span class="line">        static var ResetWorkItemKey = â€œ_resetWorkItemâ€</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    static func setUp(for view: UIView, threshold: Int = 100, onLoop: @escaping () -&gt; ()) &#123;</span><br><span class="line">        // æˆ‘ä»¬æ ¹æ®åŠŸèƒ½çš„å‰ç¼€å’ŒåŸå§‹ç±»åä¸ºæ–°ç±»åˆ›å»ºåç§°ã€‚</span><br><span class="line">        let classFullName = â€œ\(RuntimeConstants.Prefix)_\(String(describing: view.self))â€</span><br><span class="line">        let originalClass = type(of: view)</span><br><span class="line"> </span><br><span class="line">        if let trackableClass = objc_allocateClassPair(originalClass, classFullName, 0) &#123;</span><br><span class="line">            // åœ¨å½“å‰è¿è¡Œæ—¶ä¼šè¯æœŸé—´å°šæœªåˆ›å»ºæ­¤ç±»ã€‚</span><br><span class="line">            // æ³¨å†Œè¿™ä¸ªç±»ï¼Œå¹¶ä¸”ç”¨åŸå§‹è§†å›¾çš„ç±»æ¥å’Œå®ƒäº¤æ¢ã€‚</span><br><span class="line">            objc_registerClassPair(trackableClass)</span><br><span class="line">            object_setClass(view, trackableClass)</span><br><span class="line"> </span><br><span class="line">            // ç°åœ¨å¯ä»¥åˆ›å»ºå…³è”å¯¹è±¡</span><br><span class="line">            objc_setAssociatedObject(view, &amp;RuntimeConstants.CounterKey, 0, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br><span class="line"> </span><br><span class="line">            // æ·»åŠ æˆ‘ä»¬è‡ªå·± layoutSubviews çš„å®ç°</span><br><span class="line">            let layoutSubviews: @convention(block) (Any?) -&gt; () = &#123; nullableSelf in</span><br><span class="line">                guard let _self = nullableSelf else &#123; return &#125;</span><br><span class="line"> </span><br><span class="line">                let selector = #selector(originalClass.layoutSubviews)</span><br><span class="line">                let originalImpl = class_getMethodImplementation(originalClass, selector)</span><br><span class="line"> </span><br><span class="line">                // @convention(c) å‘ŠçŸ¥ Swift è¿™æ˜¯ä¸€ä¸ªè£¸å‡½æ•°æŒ‡é’ˆï¼ˆæ²¡æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡ï¼‰</span><br><span class="line">                // æ‰€æœ‰çš„ Obj-C æ–¹æ³•å‡½æ•°æŠŠæ¥æ”¶è€…å’Œæ¶ˆæ¯å½“ä½œå‰ä¸¤ä¸ªå‚æ•°</span><br><span class="line">                // æ‰€ä»¥è¿™æ„å‘³ç€ä¸€ä¸ªç±»å‹ä¸º `() -&gt; Void` çš„æ–¹æ³•ï¼Œè¿™ä¸ `layoutSubview` æ–¹æ³•ç›¸ç¬¦</span><br><span class="line">                typealias ObjCVoidVoidFn = @convention(c) (Any, Selector) -&gt; Void</span><br><span class="line">                let originalLayoutSubviews = unsafeBitCast(originalImpl, to: ObjCVoidVoidFn.self)</span><br><span class="line">                originalLayoutSubviews(view, selector)</span><br><span class="line"> </span><br><span class="line">                if let counter = objc_getAssociatedObject(_self, &amp;RuntimeConstants.CounterKey) as? Int &#123;</span><br><span class="line">                    if counter == threshold &#123;</span><br><span class="line">                        onLoop()</span><br><span class="line">                    &#125;</span><br><span class="line"> </span><br><span class="line">                    objc_setAssociatedObject(view, &amp;RuntimeConstants.CounterKey, counter+1, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                // ä¸ºé‡ç½®è®¡æ•°å™¨ï¼Œåœ¨æ¯ä¸ªæ–°çš„ run loop éå†ä¸­åˆ†å‘ work item</span><br><span class="line">                if let previousResetWorkItem = objc_getAssociatedObject(view, &amp;RuntimeConstants.ResetWorkItemKey) as? DispatchWorkItem &#123;</span><br><span class="line">                    previousResetWorkItem.cancel()</span><br><span class="line">                &#125;</span><br><span class="line">                let counterResetWorkItem = DispatchWorkItem &#123; [weak view] in</span><br><span class="line">                    guard let strongView = view else &#123; return &#125;</span><br><span class="line">                    objc_setAssociatedObject(strongView, &amp;RuntimeConstants.CounterKey, 0, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br><span class="line">                &#125;</span><br><span class="line">                DispatchQueue.main.async(execute: counterResetWorkItem)</span><br><span class="line">                objc_setAssociatedObject(view, &amp;RuntimeConstants.ResetWorkItemKey, counterResetWorkItem, .OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><br><span class="line">            &#125;</span><br><span class="line">            let implementation = imp_implementationWithBlock(layoutSubviews)</span><br><span class="line">            class_addMethod(trackableClass, #selector(originalClass.layoutSubviews), implementation, â€œv@:â€œ)</span><br><span class="line">        &#125; else if let trackableClass = NSClassFromString(classFullName) &#123;</span><br><span class="line">            // æˆ‘ä»¬ä¹‹å‰åœ¨æ­¤è¿è¡Œæ—¶ä¼šè¯ä¸­åˆ†é…äº†ä¸€ä¸ªå…·æœ‰ç›¸åŒåç§°çš„ç±»ã€‚</span><br><span class="line">            // æˆ‘ä»¬å¯ä»¥ä»åŸå§‹å­—ç¬¦ä¸²ä¸­è·å–å®ƒï¼Œå¹¶ä»¥ç›¸åŒçš„æ–¹å¼ä¸æˆ‘ä»¬çš„è§†å›¾äº¤æ¢ã€‚</span><br><span class="line">            object_setClass(view, trackableClass)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>æ˜¯çš„ï¼ç°åœ¨ä½ å¯ä»¥ä¸ºæ‰€æœ‰å¯ç–‘çš„è§†å›¾è®¾ç½®åˆ†æäº‹ä»¶äº†ï¼Œå‘å¸ƒåº”ç”¨ç¨‹åºï¼Œå¹¶æ‰¾åˆ°è¿™ä¸ªé—®é¢˜çš„ç¡®åˆ‡å‡ºå¤„ã€‚ä½ å¯ä»¥æŠŠè¿™ä¸ªé—®é¢˜çš„èŒƒå›´ç¼©å°åˆ°æŸä¸ªç‰¹å®šçš„è§†å›¾ï¼Œå¹¶åœ¨ç”¨æˆ·ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å€ŸåŠ©äºä»–ä»¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>æœ€åè¦æåˆ°çš„ä¸€ä»¶äº‹æ˜¯ï¼šèƒ½åŠ›è¶Šå¤§è´£ä»»è¶Šå¤§ã€‚è¿è¡Œæ—¶ç¼–ç¨‹éå¸¸å®¹æ˜“å‡ºé”™ï¼Œå› æ­¤å¾ˆå®¹æ˜“åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¸ºåº”ç”¨ç¨‹åºå¼•å…¥å¦ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ€»æ˜¯å»ºè®®å°†åº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰å±é™©ä»£ç åŒ…è£…åœ¨æŸç§å¯åœæ­¢å¼€å…³ä¸­ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨å‘ç°ä»£ç å¯¼è‡´é—®é¢˜æ—¶ä»åç«¯è§¦å‘å¼€å…³ç¦ç”¨è¯¥åŠŸèƒ½ã€‚è¿™æœ‰ä¸€ç¯‡ä»‹ç» Firebase çš„ Feature Flags çš„ <a href="https://medium.com/@rwbutler/feature-flags-a-b-testing-mvt-on-ios-718339ac7aa1" target="_blank" rel="noopener">å¥½æ–‡ç« </a></p><p>å®Œæ•´ä»£ç å¯ä»¥ä»è¿™ä¸ª <a href="https://github.com/rsrbk/LayoutLoopHunter" target="_blank" rel="noopener">GitHub ä»“åº“</a> é‡Œè·å–ï¼Œå¹¶ä¸”ä¹Ÿå°†ä¼šå‘å¸ƒåˆ° CocoPods ä¸Šï¼Œä»¥è·Ÿè¸ªé¡¹ç›®ä¸­çš„å¸ƒå±€å¾ªç¯ã€‚</p><p>é™„ï¼šæˆ‘æƒ³ç‰¹åˆ«æ„Ÿè°¢ <a href="https://github.com/sanekgusev" target="_blank" rel="noopener">Aleksandr Gusev</a> å¸®åŠ©å®¡é˜…å¹¶ä¸”ä¸ºæœ¬æ–‡æä¾›äº†å¾ˆå¤šæ„è§ã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡è¯¦ç»†è®²è§£äº†å¦‚ä½•åˆ©ç”¨åœ¨è¿è¡Œæ—¶ç¼–ç¨‹æ¥å¸®åŠ©å¼€å‘è€…è°ƒè¯•å¸ƒå±€åé¦ˆå¾ªç¯ã€‚
    
    </summary>
    
      <category term="AppCoda" scheme="https://swift.gg/categories/AppCoda/"/>
    
    
      <category term="æ•™ç¨‹" scheme="https://swift.gg/tags/%E6%95%99%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†æå¤æ‚åº¦</title>
    <link href="https://swift.gg/2019/11/06/analyzing-complexity/"/>
    <id>https://swift.gg/2019/11/06/analyzing-complexity/</id>
    <published>2019-11-06T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šSoroush Khanlouï¼Œ<a href="http://khanlou.com/2018/12/analyzing-complexity/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-12-17<br>è¯‘è€…ï¼š<a href="https://www.roczhang.com/" target="_blank" rel="noopener">RocZhang</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>åœ¨ Dave Abraham çš„ WWDC æ¼”è®² <a href="https://developer.apple.com/videos/play/wwdc2018/223/#" target="_blank" rel="noopener">Embracing Algorithmsï¼ˆæ‹¥æŠ±ç®—æ³•ï¼‰</a>ä¸­ï¼Œè°ˆåˆ°äº†è¦å‘ç°é€šç”¨çš„ç®—æ³•ï¼Œå¹¶å°†å…¶æå–åˆ°é€šç”¨ä¸”å¯æµ‹è¯•çš„å‡½æ•°ä¸­ã€‚åœ¨è¿™ä¸ªæ–¹å‘ä¸Šï¼Œæˆ‘å‘ç°ä¸€äº›å¯¹é›†åˆç±»å‹çš„å¤šæ¬¡æ“ä½œå¯ä»¥è¢«èšé½èµ·æ¥ï¼Œåˆå¹¶æˆå•æ¬¡æ“ä½œã€‚å¹¶ä¸”é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™äº›æ“ä½œè¢«åˆå¹¶ä¹‹åè¿˜èƒ½å¸¦æ¥æ€§èƒ½ä¸Šçš„æ”¶è·ã€‚</p><a id="more"></a><p>ç¬¬ä¸€ä¸ªä¾‹å­æ˜¯ Swift 3 æ·»åŠ çš„ä¸€ä¸ªæ–¹æ³•:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å½“ä½ çœ‹åˆ°:</span></span><br><span class="line">myArray.<span class="built_in">filter</span>(&#123; <span class="comment">/* some test */</span> &#125;).first</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ åº”è¯¥æŠŠå®ƒæ”¹æˆ:</span></span><br><span class="line">myArray.first(<span class="keyword">where</span>: &#123; <span class="comment">/* some test */</span> &#125;)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸¤ç§å†™æ³•çš„æ–­è¨€æè¿°é—­åŒ…å’Œæ“ä½œç»“æœéƒ½å®Œå…¨ç›¸åŒï¼Œä½†ä¸‹é¢çš„å†™æ³•æ›´ç®€çŸ­ï¼Œè¯­ä¹‰æ›´æ¸…æ™°ï¼Œè€Œä¸”æ€§èƒ½æ›´å¥½ã€‚å› ä¸ºå®ƒä¸ä¼šè¿›è¡Œæ–°æ•°ç»„çš„åˆ†é…ï¼Œä¹Ÿä¸éœ€è¦å¯¹æ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ æ˜¯å¦èƒ½å¤Ÿé€šè¿‡æµ‹è¯•éƒ½è¿›è¡Œåˆ¤æ–­ï¼Œåªéœ€è¦æ‰¾å‡ºç¬¬ä¸€ä¸ªå°±å¥½äº†ã€‚</p><p>å¦ä¸€ä¸ªä¾‹å­æ˜¯ <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0220-count-where.md" target="_blank" rel="noopener">æˆ‘å¸®åŠ©æ·»åŠ åˆ° Swift 5</a> ä¸­çš„ <code>count(where:)</code> å‡½æ•°:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å½“ä½ çœ‹åˆ°:</span></span><br><span class="line">myArray.<span class="built_in">filter</span>(&#123; <span class="comment">/* some test */</span> &#125;).<span class="built_in">count</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ åº”è¯¥æŠŠå®ƒæ”¹æˆ:</span></span><br><span class="line">myArray.<span class="built_in">count</span>(<span class="keyword">where</span>: &#123; <span class="comment">/* some test */</span> &#125;)</span><br></pre></td></tr></table></figure><p>è¿™åˆæ˜¯ä¸€ä¸ªæ›´çŸ­ã€æ›´æ¸…æ™°è€Œä¸”æ›´å¿«çš„ä¾‹å­ã€‚æ²¡æœ‰é¢å¤–è¦è¢«åˆ†é…çš„æ•°ç»„ï¼Œä¹Ÿæ²¡æœ‰å¤šä½™çš„æ“ä½œã€‚</p><p>åœ¨æˆ‘ä»¬çš„ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæœ‰ä¸€ä¸ªé€šç”¨çš„èŒƒå¼ï¼Œéœ€è¦å…ˆå°†é›†åˆè¿›è¡Œ <code>sort</code>ï¼Œéšåå†è¿›è¡Œ <code>prefix</code> æ“ä½œã€‚ä¾‹å¦‚ä¸‹è¿°çš„ç¤ºä¾‹ä»£ç ï¼Œéœ€è¦æ‰¾å‡ºå‰ 20 å¼ æœ€æ–°åˆ›å»ºçš„å›¾åƒï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> images</span><br><span class="line">    .sorted(by: &#123; $<span class="number">0</span>.createdAt &gt; $<span class="number">1</span>.createdAt &#125;)</span><br><span class="line">    .<span class="keyword">prefix</span>(<span class="number">20</span>)</span><br></pre></td></tr></table></figure><p>åŒæ ·ï¼Œä¹Ÿå¯ä»¥æƒ³è±¡æˆåœ¨æ’è¡Œæ¦œä¸­æ‰¾åˆ°å‰ 5 ä½å¾—åˆ†æœ€é«˜çš„ç”¨æˆ·ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨è¿™ç±»èŒƒå¼ã€‚</p><p>æˆ‘ç›¯ç€è¿™æ®µä»£ç ç›´åˆ°æˆ‘çš„çœ¼ç›å¼€å§‹æµè¡€ï¼Œæ„Ÿåˆ°è¿™æ®µä»£ç å¯èƒ½å­˜åœ¨é—®é¢˜ã€‚æˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯åˆ†æå®ƒçš„æ—¶é—´å¤æ‚åº¦ã€‚å¦‚æœæŠŠåŸå§‹æ•°ç»„çš„é•¿åº¦ç”¨ n è¡¨ç¤ºï¼Œå†æŠŠæœ€åæƒ³è¦å¾—åˆ°çš„å…ƒç´ çš„æ•°ç›®ç”¨ m è¡¨ç¤ºï¼Œåœ¨åˆ†æä»£ç ä¹‹åå¯ä»¥å¾—å‡ºï¼Œæ’åºçš„å¤æ‚åº¦æ˜¯ O(nlogn)ï¼Œå–å‰å­é›†åˆçš„æ“ä½œåˆ™æ›´å¿«ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼ˆå–å‰å­é›†åˆæ“ä½œæœ¬èº«æœ€æ…¢æ—¶å¯èƒ½ä¼šè¾¾åˆ° O(m)ï¼Œä½†å¯¹è¿™é‡Œæˆ‘ä»¬è¦å¤„ç†çš„æ•°ç»„è€Œè¨€ï¼Œç”±äºå®ƒæ˜¯å¯éšæœºè®¿é—®çš„é›†åˆï¼Œå› æ­¤å–å‰å­é›†åˆæ“ä½œèƒ½åœ¨å¸¸æ•°æ—¶é—´ä¸­å®Œæˆï¼‰ã€‚</p><p>è¿™æ­£æ˜¯è®©æˆ‘æ„Ÿåˆ°å›°æƒ‘çš„åœ°æ–¹ï¼šè·å–ä¸€ä¸ªåºåˆ—çš„æœ€å°å…ƒç´ ï¼ˆä½¿ç”¨ <code>min()</code> å‡½æ•°ï¼‰åªéœ€è¦å•æ¬¡éå†æ‰€æœ‰å…ƒç´ ï¼Œæˆ–è€…è¯´æ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚å°†å…¶æ‰€æœ‰å…ƒç´ è¿›è¡Œå®Œæ•´æ’åºéœ€è¦çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(nlogn)ã€‚è€Œä»é›†åˆä¸­è·å– m ä¸ªæ•°ï¼Œå½“ m æ¯” n å°æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦åº”è¯¥ä½äºå®ƒä»¬ä¹‹é—´ã€‚ä¸”å½“ m æ¯” n å°éå¸¸å¤šæ—¶ï¼Œæ—¶é—´å¤æ‚åº¦åº”è¯¥æ›´æ¥è¿‘ O(n)ã€‚</p><p>åœ¨æˆ‘ä»¬çš„ä¾‹å­é‡Œï¼Œå›¾ç‰‡çš„æ•°é‡ä¼šéå¸¸å¤§ï¼ˆn çº¦ä¸º 55000ï¼‰ï¼Œè€Œæˆ‘ä»¬æƒ³å¾—åˆ°çš„å…ƒç´ æ•°é‡å´å¾ˆå°ï¼ˆm ä¸º 20ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œåº”è¯¥å­˜åœ¨æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚æˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿä¼˜åŒ–æ’åºï¼Œä½¿å…¶ä»…æ’åºå‡ºå‰ m ä¸ªå…ƒç´ ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨è¿™ä¸ªæ–¹å‘ä¸Šè¿›è¡Œä¸€äº›ä¼˜åŒ–ã€‚æˆ‘å°†æ­¤å‡½æ•°å‘½åä¸º <code>smallest(_:by:)</code>ï¼Œå®ƒæ¥æ”¶ <code>sort</code> å’Œ <code>prefix</code> å‡½æ•°çš„æ‰€æœ‰å‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æåˆ°çš„ m å’Œç”¨äºæ’åºåšæ¯”è¾ƒçš„é—­åŒ…ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">smallest</span><span class="params">(<span class="number">_</span> m: Int, by areInIncreasingOrder: <span class="params">(Element, Element)</span></span></span> -&gt; <span class="type">Bool</span>) -&gt; [<span class="type">Element</span>] &#123;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆä»æ’åºå‰ m ä¸ªå…ƒç´ å¼€å§‹ï¼ˆå› ä¸º m æ¯”åºåˆ—çš„æ€»é•¿åº¦è¦å°å¾ˆå¤šï¼Œæ‰€ä»¥æ­¤æ“ä½œä¼šè¿›è¡Œçš„å¾ˆå¿«ï¼‰ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> result = <span class="keyword">self</span>.<span class="keyword">prefix</span>(m).sorted(by: areInIncreasingOrder)</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å†éå†æ‰€æœ‰å‰©ä¸‹çš„å…ƒç´ ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> <span class="keyword">self</span>.<span class="built_in">dropFirst</span>(m) &#123;</span><br></pre></td></tr></table></figure><p>å¯¹é›†åˆä¸­å‰©ä¸‹çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ° <code>result</code> ä¸­ç¬¬ä¸€ä¸ªæ¯”å®ƒå¤§çš„é¡¹çš„ç´¢å¼•ã€‚é€šè¿‡ <code>areInIncreasingOrder</code> å‡½æ•°ï¼Œæˆ‘ä»¬æŠŠ <code>element</code> ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ï¼Œå†æŠŠ <code>result</code> ä¸­çš„å…ƒç´ ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> insertionIndex = result.index(<span class="keyword">where</span>: &#123; areInIncreasingOrder(element, $<span class="number">0</span>) &#125;) &#123; <span class="comment">// è¯‘è€…æ³¨ï¼šæ­¤æ–¹æ³•åœ¨ Swift 4.2 åå·²æ›´åä¸º `firstIndex(where:)`</span></span><br></pre></td></tr></table></figure><p>å¦‚æœèƒ½å¤Ÿæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç´¢å¼•å€¼ï¼Œè¿™å°±è¡¨ç¤ºå­˜åœ¨æœ‰æ¯”æˆ‘ä»¬ <code>result</code> æ•°ç»„ä¸­çš„å…ƒç´ æ›´å°çš„å€¼ã€‚æˆ‘ä»¬æŠŠæ–°çš„å€¼æ’å…¥åˆ°è®¡ç®—å‡ºçš„ç´¢å¼•çš„ä½ç½®ï¼Œå®ƒä¾¿ä¼šè¢«æ­£ç¡®çš„æ’åºï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">result.insert(element, at: insertionIndex)</span><br></pre></td></tr></table></figure><p>å†å°†æœ€åä¸€ä¸ªå…ƒç´ ç§»é™¤ï¼ˆå› ä¸ºæˆ‘ä»¬åªéœ€è¦ m ä¸ªå…ƒç´ ï¼‰ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">result.removeLast()</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ç´¢å¼•ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¿½ç•¥è¿™ä¸ªå€¼ã€‚æœ€åï¼Œå½“ <code>for</code> å¾ªç¯å®Œæˆï¼Œä¾¿å¯å°† <code>result</code> è¿”å›ã€‚</p><p>å®Œæ•´çš„å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Sequence</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">smallest</span><span class="params">(<span class="number">_</span> m: Int, by areInIncreasingOrder: <span class="params">(Element, Element)</span></span></span> -&gt; <span class="type">Bool</span>) -&gt; [<span class="type">Element</span>] &#123;</span><br><span class="line">        <span class="keyword">var</span> result = <span class="keyword">self</span>.<span class="keyword">prefix</span>(m).sorted(by: areInIncreasingOrder)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> e <span class="keyword">in</span> <span class="keyword">self</span>.<span class="built_in">dropFirst</span>(n) &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> insertionIndex = result.index(<span class="keyword">where</span>: &#123; areInIncreasingOrder(e, $<span class="number">0</span>) &#125;) &#123;</span><br><span class="line">                result.insert(e, at: insertionIndex)</span><br><span class="line">                result.removeLast()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿™è®©ä½ æƒ³èµ·äº†ä¹‹å‰åœ¨è®¡ç®—æœºç§‘å­¦ä¸­å­¦è¿‡çš„è¯¾ç¨‹ï¼Œé‚£å°±å†å¥½ä¸è¿‡äº†ã€‚å®é™…ä¸Šè¿™é‡Œçš„ç®—æ³•å°±ç±»ä¼¼äºé€‰æ‹©æ’åºçš„è¿‡ç¨‹ï¼ˆä½†å®ƒä»¬å¹¶éå®Œå…¨ç›¸åŒï¼Œå› ä¸ºè¿™é‡Œä¼šé¢„å…ˆæ’åºä¸€éƒ¨åˆ†å…ƒç´ ï¼Œè€Œé€‰æ‹©æ’åºåˆ™ä¸åŒï¼Œæ˜¯å¯å˜åºåˆ—ç®—æ³•ï¼ˆmutating algorithmï¼‰ï¼‰ã€‚</p><p>è¿™é‡Œçš„æ—¶é—´å¤æ‚åº¦åˆ†æèµ·æ¥å¯èƒ½ä¼šæœ‰äº›å›°éš¾ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥å°è¯•è¿›è¡Œåˆ†æã€‚åˆå§‹éƒ¨åˆ†çš„æ’åºæ˜¯ O(mlogm)ï¼Œå¤–å±‚çš„å¾ªç¯æ˜¯ O(n)ã€‚æ¯æ¬¡çš„å¾ªç¯ä¸­ï¼Œä¼šåˆ†åˆ«è°ƒç”¨æ—¶é—´å¤æ‚åº¦éƒ½ä¸º O(m) çš„ <code>index(where:)</code> å’Œ <code>insert(_:at:)</code>ï¼ˆæ’å…¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(m) çš„åŸå› åœ¨äºï¼Œå®ƒå¯èƒ½éœ€è¦å°†æ‰€æœ‰çš„å…ƒç´ åç§»ï¼Œä¸ºæ–°å…ƒç´ è…¾å‡ºç©ºé—´ï¼‰ã€‚å› æ­¤ï¼Œæ€»æ—¶é—´å¤æ‚åº¦åº”ä¸º O(mlogm + n * (m + m))ï¼Œæˆ–è€…è¯´ O(mlogm + 2nm)ã€‚å¸¸æ•°é¡¹è¢«ç§»é™¤åï¼Œç•™ä¸‹çš„åˆ™æ˜¯ O(mlogm + nm)ã€‚</p><p>å½“ m æ¯” n å°å¾—å¤šæ—¶ï¼Œm é¡¹ä¼šæ¥è¿‘äºå¸¸æ•°ï¼Œæœ€ç»ˆæˆ‘ä»¬å¾—åˆ°çš„ä¼šæ˜¯ O(n)ã€‚ç›¸è¾ƒäºä¹‹å‰çš„ O(nlogn) è€Œè¨€ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ”¹è¿›ã€‚å¯¹åº”åˆ°ä¹‹å‰æåˆ°çš„ 55000 å¼ å›¾ç‰‡çš„ä¾‹å­ï¼Œè¿™å¯èƒ½ä¼šæ˜¯å¤šè¾¾ 5 å€çš„æ€§èƒ½æå‡ã€‚</p><p>å¤§ä½“ä¸Šæ¥è¯´ï¼Œè¿™é‡Œçš„å‡½æ•°æ˜¯å¯¹ <code>prefix</code> + <code>sort</code> å‡½æ•°çš„ä¼˜åŒ–ã€‚ä½†æˆ‘è¿˜æƒ³è¦å†è®¨è®ºä¸¤å¤„æ›´ç»†å°ä¸€äº›çš„ä¼˜åŒ–ã€‚</p><p>ä¸€å¤„å”¾æ‰‹å¯å¾—çš„ä¼˜åŒ–æ˜¯ï¼šæˆ‘ä»¬æ˜¯åœ¨ 55000 ä¸ªå…ƒç´ çš„æ•°ç»„ä¸­æŸ¥æ‰¾ 20 ä¸ªæœ€å°çš„å…ƒç´ ï¼Œå…¶ä¸­æˆ‘ä»¬æ£€æŸ¥çš„å¤§éƒ¨åˆ†ï¼ˆå‡ ä¹æ˜¯å…¨éƒ¨ï¼‰å…ƒç´ ä¸ä¼šè½å…¥åˆ°æœ€åçš„ <code>result</code> æ•°ç»„ä¸­ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å»æ£€æŸ¥å…ƒç´ æ˜¯å¦æ¯” <code>result</code> æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ è¦å¤§ï¼Œå¦‚æœæ˜¯ï¼Œå®ƒå°±å®Œå…¨å¯ä»¥è¢«è·³è¿‡ã€‚å› ä¸ºå½“å…ƒç´ æ¯” <code>result</code> ä¸­çš„æœ€åä¸€ä¸ªè¿˜è¦å¤§æ—¶ï¼Œå†å»æŸ¥æ‰¾æ’å…¥çš„ç´¢å¼•å°±æ²¡æœ‰ä»»ä½•æ„ä¹‰äº†ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> last = result.last, areInIncreasingOrder(last, e) &#123; <span class="keyword">continue</span> &#125;</span><br></pre></td></tr></table></figure><p>åœ¨æµ‹è¯•ä¸­ï¼Œæ­¤å¤„å¢åŠ çš„åˆ¤æ–­å¯ä»¥å‡å°‘çº¿æ€§æœç´¢ <code>result</code> æ•°ç»„ 99.5% çš„æ—¶é—´ï¼Œç®—æ³•æ•´ä½“ä¸Šåˆä¼šåŠ å¿«åå€å·¦å³ã€‚æ„Ÿè°¢ <a href="https://twitter.com/gregtitus" target="_blank" rel="noopener">Greg Titus</a> å‘Šè¯‰æˆ‘æ­¤å¤„å¯ä»¥ä¼˜åŒ–â”€â”€ä¹‹å‰æˆ‘å®Œå…¨æ²¡æœ‰æƒ³åˆ°è¿™ä¸€ç‚¹ã€‚</p><p>å¦‚æœæƒ³æ›´è¿‘ä¸€æ­¥çš„è¯ï¼Œè¿˜å¯ä»¥åšå¦ä¸€å¤„ï¼ˆç¨å¾®éš¾å®ç°ä¸€äº›ï¼‰çš„ä¼˜åŒ–ã€‚æ­¤ä¼˜åŒ–åŸºäºä¸¤å¤„äº‹å®ï¼šç¬¬ä¸€ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>index(where:)</code> æ¥æ‰¾å‡ºåº”åœ¨ <code>result</code> æ•°ç»„ä¸­è¿›è¡Œæ’å…¥çš„ä½ç½®ï¼›ç¬¬äºŒï¼Œ<code>result</code> æ•°ç»„æ€»æ˜¯ä¿æŒæœ‰åºçš„ã€‚<code>index(where:)</code> é€šå¸¸æƒ…å†µä¸‹æ˜¯ä¸€é¡¹çº¿æ€§æ“ä½œï¼Œä½†å¦‚æœæ˜¯åœ¨ä¸€ä¸ªå·²ç»æ’å¥½åºçš„æ•°ç»„ä¸­è¿›è¡Œæœç´¢ï¼Œæˆ‘ä»¬å¯ä»¥å°†çº¿æ€§æœç´¢æ›¿æ¢æˆäºŒåˆ†æœç´¢ã€‚æˆ‘å¯¹æ­¤è¿›è¡Œäº†å°è¯•ã€‚</p><p>ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„ç†è§£è¿™äº›ä¼˜åŒ–ä¼šå¦‚ä½•å½±å“ç®—æ³•çš„æ€§èƒ½ï¼ŒNate Cook å¸®åŠ©æˆ‘äº†è§£äº† Karoy Lorentey çš„ <a href="https://github.com/attaswift/Attabench" target="_blank" rel="noopener">Attabench å·¥å…·</a>ï¼Œå®ƒèƒ½å¤Ÿå¯¹è¿™äº›è§£å†³æ–¹æ¡ˆè¿›è¡ŒåŸºå‡†æµ‹è¯•ã€‚å› ä¸ºæˆªæ­¢ç›®å‰ï¼Œæˆ‘ä»¬å¯¹å¤æ‚åº¦çš„åˆ†æéƒ½æ˜¯åœç•™åœ¨ç†è®ºå±‚é¢çš„ï¼Œåœ¨çœŸæ­£å¯¹ä»£ç è¿›è¡Œå®é™…æµ‹è¯•ä¹‹å‰ï¼ˆæœ€ç†æƒ³çš„æƒ…å†µåº”è¯¥æ˜¯åœ¨çœŸå®çš„è®¾å¤‡ä¸Šï¼‰ï¼Œæ‰€æœ‰çš„ç»“è®ºéƒ½åªæ˜¯æœ‰æ ¹æ®çš„æ¨æµ‹ã€‚ä¾‹å¦‚ï¼Œé€šå¸¸æ¥è¯´æ’åºçš„å¤æ‚åº¦ä¸º O(nlogn)ï¼Œä½†ä¸åŒçš„ç®—æ³•å¤„ç†ä¸åŒç±»å‹çš„æ•°æ®æ—¶ï¼Œå…¶è¡¨ç°ä¹Ÿä¼šæœ‰æ‰€ä¸åŒã€‚å…·ä½“æ¥è¯´ï¼Œå·²ç»æ’å¥½åºçš„æ•°æ®åœ¨ç‰¹å®šçš„ç®—æ³•ä¸­å¯èƒ½ä¼šå˜å¾—æ›´å¿«æˆ–æ›´æ…¢ã€‚</p><p>Attabench çš„æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="http://khanlou.com/images/SmallestNProfile.png" alt></p><p>ï¼ˆæˆ‘è¿˜æ·»åŠ äº†ä¸€ä¸ª <a href="https://gist.github.com/timvermeulen/2174f84ade2d1f97c4d994b7a3156454" target="_blank" rel="noopener">ç”± Time Vermuelen æ‰€å†™çš„ä¼˜å…ˆé˜Ÿåˆ—/å †è§£å†³æ–¹æ¡ˆ</a>ï¼Œå› ä¸ºæœ‰äº›äººå¥½å¥‡å®ƒä¸å…¶ä»–æ–¹æ¡ˆæ¯”è¾ƒèµ·æ¥è¡¨ç°å¦‚ä½•ã€‚ï¼‰</p><p>é¦–å…ˆï¼Œæˆ‘å¯¹åœ¨æ•°ç»„ä¸­è¿›è¡Œå•æ¬¡æœç´¢æ¯”å¯¹æ•°ç»„è¿›è¡Œå®Œæ•´æ’åºè¦å¿«çš„çŒœæµ‹æ˜¯æ­£ç¡®çš„ã€‚å°¤å…¶æ˜¯åœ¨å®é™…é—®é¢˜ä¸­åºåˆ—å¯èƒ½ä¼šå¾ˆé•¿ï¼Œæ’åºçš„æ€§èƒ½åˆ™ä¼šå˜å¾—æ›´å·®ï¼Œä½†æˆ‘ä»¬çš„â€œç®€å•ä¼˜åŒ–â€ï¼ˆå›¾ä¸­çš„ â€œNaive Optimizationâ€ï¼‰å´èƒ½ä¿æŒåœ¨å¸¸æ•°æ°´å¹³ä¸Šï¼ˆY è½´è¡¨ç¤ºçš„æ˜¯å•ä¸ªå…ƒç´ ä¸Šæ‰€èŠ±çš„æ—¶é—´ï¼Œè€Œä¸æ˜¯æ€»æ—¶é—´ã€‚è¿™æ„å‘³ç€ O(n) çš„ç®—æ³•åœ¨å›¾ä¸­ä¼šæ˜¯ä¸€æ¡ç›´çº¿ï¼‰ã€‚</p><p>ç¬¬äºŒï¼Œå¯¹æœ€åä¸€ä¸ªå…ƒç´ çš„æ£€æŸ¥ï¼ˆå›¾ä¸­çš„ â€œLast Checkâ€ï¼‰å’ŒäºŒåˆ†æœç´¢ä¼˜åŒ–åœ¨ç‹¬ç«‹è¿è¡Œæ—¶å…·æœ‰å‡ ä¹å®Œå…¨ç›¸åŒçš„æ€§èƒ½è¡¨ç°ï¼ˆå®é™…ä¸Šä½ å¯èƒ½æ²¡æ³•çœ‹åˆ°æ©˜è‰²å’Œé»„è‰²çš„çº¿ï¼Œå› ä¸ºå®ƒä»¬è¢«ç»¿çº¿æŒ¡ä½äº†ï¼‰ï¼ŒæŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·ä½¿ç”¨æ—¶ä¹Ÿæ˜¯ä¸€æ ·ã€‚ä½†æ˜¯ç”±äºäºŒåˆ†æœç´¢éš¾ä»¥ç¼–å†™ï¼Œ<a href="https://ai.googleblog.com/2006/06/extra-extra-read-all-about-it-nearly.html" target="_blank" rel="noopener">ç”šè‡³æ›´éš¾æŠŠå®ƒå†™å¯¹</a>ï¼Œä½ ä¹Ÿå¯ä»¥è¯´æŠŠå®ƒåŠ ä¸Šæ˜¯ä¸å€¼å¾—çš„ã€‚</p><p>å¯¹æˆ‘è€Œè¨€ï¼Œè¿™é‡Œä¼ é€’å‡ºçš„å…³é”®ä¿¡æ¯æ˜¯æµ‹é‡å’Œä¼˜åŒ–å¾ˆéš¾ã€‚è™½ç„¶åˆ†æå¤æ‚åº¦è¿™ä»¶äº‹å¬èµ·æ¥æœ‰äº›å­¦æœ¯ï¼šâ€œæˆ‘ä»€ä¹ˆæ—¶å€™ä¼šåœ¨è‡ªå·±çš„èŒä¸šç”Ÿæ¶¯ä¸Šç”¨åˆ°è¿™ä¸ªï¼Ÿâ€ æœ‰äººä¼šé—®ã€‚ä½†ç†è§£ä½ çš„ç®—æ³•çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦èƒ½å¤Ÿå¸®åŠ©ä½ å†³å®šå‘å“ªä¸ªæ–¹å‘è¿›è¡Œæ¢ç´¢ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç†è§£æ’åºçš„æ—¶é—´å¤æ‚åº¦å¼•å¯¼æˆ‘ä»¬å¯¹é—®é¢˜äº§ç”Ÿäº†æ¦‚æ‹¬æ€§çš„è®¤çŸ¥ï¼Œå¾—åˆ°æˆæœã€‚æœ€åï¼Œé€šè¿‡ä½¿ç”¨å„ç§æ•°æ®è¿›è¡Œçš„è¿›ä¸€æ­¥çš„åŸºå‡†æµ‹è¯•ä¸åˆ†æï¼Œèƒ½å‘Šè¯‰æˆ‘ä»¬ä»£ç åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å°†å¦‚ä½•è¿ä½œçš„æœ€å‡†ç¡®çš„ä¿¡æ¯ã€‚</p><p>ä¸‹ä¸€æ¬¡å†çœ‹åˆ° <code>sort</code> åé¢ç´§è·Ÿç€ä¸€ä¸ª <code>prefix</code> æ—¶ï¼Œä¸å¦¨è€ƒè™‘å°†å®ƒæ›¿æ¢æˆ <code>smallest(_: by:)</code>ï¼Ÿ </p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡ä»‹ç»äº†åœ¨ Swift ä¸­å¦‚ä½•å¯¹ä¸€äº›é›†åˆç±»å‹çš„æ“ä½œè¿›è¡Œæ€§èƒ½åˆ†æä¸ä¼˜åŒ–ã€‚
    
    </summary>
    
      <category term="khanlou" scheme="https://swift.gg/categories/khanlou/"/>
    
      <category term="iOS" scheme="https://swift.gg/categories/khanlou/iOS/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
      <category term="Algorithm" scheme="https://swift.gg/tags/Algorithm/"/>
    
      <category term="Complexity" scheme="https://swift.gg/tags/Complexity/"/>
    
  </entry>
  
  <entry>
    <title>å›¾åƒæ¸²æŸ“ä¼˜åŒ–æŠ€å·§</title>
    <link href="https://swift.gg/2019/11/01/image-resizing/"/>
    <id>https://swift.gg/2019/11/01/image-resizing/</id>
    <published>2019-11-01T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šMatttï¼Œ<a href="https://nshipster.com/image-resizing/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2019-05-06<br>è¯‘è€…ï¼šericchuhongï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>é•¿æœŸä»¥æ¥ï¼ŒiOS å¼€å‘äººå‘˜ä¸€ç›´è¢«ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜å›°æ‰°ç€ï¼š</p><p><em>â€œå¦‚ä½•å¯¹ä¸€å¼ å›¾åƒè¿›è¡Œæ¸²æŸ“ä¼˜åŒ–ï¼Ÿâ€</em></p><p>è¿™ä¸ªä»¤äººå›°æ‰°çš„é—®é¢˜ï¼Œæ˜¯ç”±äºå¼€å‘è€…å’Œå¹³å°çš„ç›¸äº’ä¸ä¿¡ä»»å¼•èµ·çš„ã€‚å„ç§å„æ ·çš„ä»£ç ç¤ºä¾‹å……æ–¥ç€ Stack Overflowï¼Œæ¯ä¸ªäººéƒ½å£°ç§°åªæœ‰è‡ªå·±çš„æ–¹æ³•æ˜¯çœŸæ­£çš„è§£å†³æ–¹æ¡ˆ â€”â€” è€Œåˆ«äººçš„æ˜¯é”™çš„ã€‚</p><a id="more"></a><p>åœ¨æœ¬å‘¨çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç» 5 ç§ä¸åŒçš„ iOS å›¾åƒæ¸²æŸ“ä¼˜åŒ–æŠ€å·§ï¼ˆåœ¨ MacOS ä¸Šæ—¶é€‚å½“åœ°å°† <code>UIImage</code> è½¬æ¢æˆ <code>NSImage</code>ï¼‰ã€‚ç›¸æ¯”äºå¯¹æ¯ä¸€ç§æƒ…å†µéƒ½è§„å®šä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å°†ä»äººç±»å·¥ç¨‹å­¦å’Œæ€§èƒ½è¡¨ç°æ–¹é¢è¿›è¡Œè¡¡é‡ï¼Œä»¥ä¾¿ä½ æ›´å¥½åœ°ç†è§£ä»€ä¹ˆæ—¶è¯¥ç”¨å“ªä¸€ç§ï¼Œä¸è¯¥ç”¨å“ªä¸€äº›ã€‚</p><blockquote><p>ä½ å¯ä»¥è‡ªå·±ä¸‹è½½ã€æ„å»ºå’Œè¿è¡Œ <a href="https://github.com/NSHipster/Image-Resizing-Example" target="_blank" rel="noopener">ç¤ºä¾‹é¡¹ç›®ä»£ç </a> æ¥è¯•éªŒè¿™äº›å›¾åƒæ¸²æŸ“ä¼˜åŒ–æŠ€å·§ã€‚</p></blockquote><hr><h2 id="å›¾åƒæ¸²æŸ“ä¼˜åŒ–çš„æ—¶æœºå’Œç†ç”±"><a href="#å›¾åƒæ¸²æŸ“ä¼˜åŒ–çš„æ—¶æœºå’Œç†ç”±" class="headerlink" title="å›¾åƒæ¸²æŸ“ä¼˜åŒ–çš„æ—¶æœºå’Œç†ç”±"></a>å›¾åƒæ¸²æŸ“ä¼˜åŒ–çš„æ—¶æœºå’Œç†ç”±</h2><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆè®¨è®ºä¸€ä¸‹<em>ä¸ºä»€ä¹ˆ</em>éœ€è¦å¯¹å›¾åƒè¿›è¡Œæ¸²æŸ“ä¼˜åŒ–ã€‚æ¯•ç«Ÿï¼Œ<code>UIImageView</code> ä¼šè‡ªåŠ¨æ ¹æ® <a href="https://developer.apple.com/documentation/uikit/uiview/1622619-contentmode" target="_blank" rel="noopener"><code>contentmode</code> å±æ€§</a> è§„å®šçš„è¡Œä¸ºç¼©æ”¾å’Œè£å‰ªå›¾åƒã€‚åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ<code>.scaleAspectFit</code>ã€<code>.scaleAspectFill</code> æˆ– <code>.scaleToFill</code> å·²ç»å®Œå…¨æ»¡è¶³ä½ çš„æ‰€éœ€ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">imageView.contentMode = .scaleAspectFit</span><br><span class="line">imageView.image = image</span><br></pre></td></tr></table></figure><hr><p>é‚£ä¹ˆï¼Œä»€ä¹ˆæ—¶å€™å¯¹å›¾åƒè¿›è¡Œæ¸²æŸ“ä¼˜åŒ–æ‰æœ‰æ„ä¹‰å‘¢ï¼Ÿ<br><br><strong>å½“å®ƒæ˜æ˜¾å¤§äº</strong> <strong><code>UIImageView</code></strong> <strong>æ˜¾ç¤ºå°ºå¯¸çš„æ—¶å€™</strong></p><hr><p>çœ‹çœ‹æ¥è‡ª <a href="https://visibleearth.nasa.gov" target="_blank" rel="noopener">NASA è§†è§‰åœ°çƒç›¸å†Œé›†é”¦</a> çš„è¿™å¼  <a href="https://visibleearth.nasa.gov/view.php?id=78314" target="_blank" rel="noopener">ä»¤äººèµå¹çš„å›¾ç‰‡</a>ï¼š</p><p><img src="https://nshipster.com/assets/image-resizing-earth-5eaad58ee8c9b4f79595ef7271d19afa50f2240f128465746b3c930c1d420524.jpg" alt="image-resizing-earth"></p><p>æƒ³è¦å®Œæ•´æ¸²æŸ“è¿™å¼ å®½é«˜ä¸º 12,000 px çš„å›¾ç‰‡ï¼Œéœ€è¦é«˜è¾¾ 20 MB çš„ç©ºé—´ã€‚å¯¹äºå½“ä»Šçš„ç¡¬ä»¶æ¥è¯´ï¼Œä½ å¯èƒ½ä¸ä¼šåœ¨æ„è¿™ä¹ˆå°‘å…†å­—èŠ‚çš„å ç”¨ã€‚ä½†é‚£åªæ˜¯å®ƒå‹ç¼©åçš„å°ºå¯¸ã€‚è¦å±•ç¤ºå®ƒï¼Œ<code>UIImageView</code> é¦–å…ˆéœ€è¦æŠŠ JPEG æ•°æ®è§£ç æˆä½å›¾ï¼ˆbitmapï¼‰ï¼Œå¦‚æœè¦åœ¨ä¸€ä¸ª <code>UIImageView</code> ä¸ŠæŒ‰åŸæ ·è®¾ç½®è¿™å¼ å…¨å°ºå¯¸å›¾ç‰‡ï¼Œä½ çš„åº”ç”¨å†…å­˜å ç”¨å°†ä¼šæ¿€å¢åˆ°<strong>å‡ ç™¾å…†</strong>ï¼Œå¯¹ç”¨æˆ·æ˜æ˜¾æ²¡æœ‰ä»€ä¹ˆå¥½å¤„ï¼ˆæ¯•ç«Ÿï¼Œå±å¹•èƒ½æ˜¾ç¤ºçš„åƒç´ æœ‰é™ï¼‰ã€‚ä½†åªè¦åœ¨è®¾ç½® <code>UIImageView</code> çš„ <code>image</code> å±æ€§ä¹‹å‰ï¼Œå°†å›¾åƒæ¸²æŸ“çš„å°ºå¯¸è°ƒæ•´æˆ <code>UIImageView</code> çš„å¤§å°ï¼Œä½ ç”¨åˆ°çš„å†…å­˜å°±ä¼šå°‘ä¸€ä¸ªæ•°é‡çº§ï¼š</p><table><thead><tr><th></th><th>å†…å­˜æ¶ˆè€— <em>(MB)</em></th></tr></thead><tbody><tr><td>æ— ä¸‹é‡‡æ ·</td><td>220.2</td></tr><tr><td>ä¸‹é‡‡æ ·</td><td>23.7</td></tr></tbody></table><p>è¿™ä¸ªæŠ€å·§å°±æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„<em>ä¸‹é‡‡æ ·ï¼ˆdownsamplingï¼‰</em>ï¼Œåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå®ƒå¯ä»¥æœ‰æ•ˆåœ°ä¼˜åŒ–ä½ åº”ç”¨çš„æ€§èƒ½è¡¨ç°ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºä¸‹é‡‡æ ·çš„çŸ¥è¯†æˆ–è€…å…¶å®ƒå›¾å½¢å›¾åƒçš„æœ€ä½³å®è·µï¼Œè¯·å‚ç…§ <a href="https://developer.apple.com/videos/play/wwdc2018/219/" target="_blank" rel="noopener">æ¥è‡ª WWDC 2018 çš„ç²¾å½©è¯¾ç¨‹</a>ã€‚</p><p>è€Œç°åœ¨ï¼Œå¾ˆå°‘æœ‰åº”ç”¨ç¨‹åºä¼šå°è¯•ä¸€æ¬¡æ€§åŠ è½½è¿™ä¹ˆå¤§çš„å›¾åƒäº†ï¼Œä½†æ˜¯ä¹Ÿè·Ÿæˆ‘ä»è®¾è®¡å¸ˆé‚£é‡Œæ‹¿åˆ°çš„å›¾ç‰‡èµ„æºä¸ä¼šå·®<em>å¤ª</em>å¤šã€‚<em>ï¼ˆè®¤çœŸçš„å—ï¼Ÿä¸€å¼ é¢œè‰²æ¸å˜çš„</em> <em>PNG</em> <em>å›¾ç‰‡è¦</em> <em>3</em> <em>MB?ï¼‰</em> è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æœ‰ä»€ä¹ˆä¸åŒçš„æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ ç”¨æ¥å¯¹å›¾åƒè¿›è¡Œä¼˜åŒ–æˆ–è€…ä¸‹é‡‡æ ·ã€‚</p><blockquote><p>ä¸ç”¨è¯´ï¼Œè¿™é‡Œæ‰€æœ‰ä» URL åŠ è½½çš„ç¤ºä¾‹å›¾åƒéƒ½æ˜¯é’ˆå¯¹<strong>æœ¬åœ°</strong>æ–‡ä»¶ã€‚è®°ä½ï¼Œåœ¨åº”ç”¨çš„ä¸»çº¿ç¨‹åŒæ­¥ä½¿ç”¨ç½‘ç»œè¯·æ±‚å›¾åƒ<strong>ç»ä¸</strong>æ˜¯ä»€ä¹ˆå¥½ä¸»æ„ã€‚</p></blockquote><hr><h2 id="å›¾åƒæ¸²æŸ“ä¼˜åŒ–æŠ€å·§"><a href="#å›¾åƒæ¸²æŸ“ä¼˜åŒ–æŠ€å·§" class="headerlink" title="å›¾åƒæ¸²æŸ“ä¼˜åŒ–æŠ€å·§"></a>å›¾åƒæ¸²æŸ“ä¼˜åŒ–æŠ€å·§</h2><p>ä¼˜åŒ–å›¾åƒæ¸²æŸ“çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œæ¯ç§éƒ½æœ‰ä¸åŒçš„åŠŸèƒ½å’Œæ€§èƒ½ç‰¹æ€§ã€‚æˆ‘ä»¬åœ¨æœ¬æ–‡çœ‹åˆ°çš„è¿™äº›ä¾‹å­ï¼Œæ¶æ„å±‚æ¬¡è·¨åº¦ä¸Šä»åº•å±‚çš„ Core Graphicsã€vImageã€Image I/O åˆ°ä¸Šå±‚çš„ Core Image å’Œ UIKit éƒ½æœ‰ã€‚</p><ol><li><a href="#technique-1-drawing-to-a-uigraphicsimagerenderer">ç»˜åˆ¶åˆ° UIGraphicsImageRenderer ä¸Š</a></li><li><a href="#technique-2-drawing-to-a-core-graphics-context">ç»˜åˆ¶åˆ° Core Graphics Context ä¸Š</a></li><li><a href="#technique-3-creating-a-thumbnail-with-image-io">ä½¿ç”¨ Image I/O åˆ›å»ºç¼©ç•¥å›¾åƒ</a></li><li><a href="#technique-4-lanczos-resampling-with-core-image">ä½¿ç”¨ Core Image è¿›è¡Œ Lanczos é‡é‡‡æ ·</a></li><li><a href="#technique-5-image-scaling-with-vimage">ä½¿ç”¨ vImage ä¼˜åŒ–å›¾ç‰‡æ¸²æŸ“</a></li></ol><p>ä¸ºäº†ç»Ÿä¸€è°ƒç”¨æ–¹å¼ï¼Œä»¥ä¸‹çš„æ¯ç§æŠ€æœ¯å…±ç”¨ä¸€ä¸ªå…¬å…±æ¥å£æ–¹æ³•ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">resizedImage</span><span class="params">(at url: URL, <span class="keyword">for</span> size: CGSize)</span></span> -&gt; <span class="type">UIImage?</span> &#123; &lt;#...#&gt; &#125;</span><br><span class="line"></span><br><span class="line">imageView.image = resizedImage(at: url, <span class="keyword">for</span>: size)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œ<code>size</code> çš„è®¡é‡å•ä½ä¸æ˜¯ç”¨ <code>pixel</code>ï¼Œè€Œæ˜¯ç”¨ <code>point</code>ã€‚æƒ³è¦è®¡ç®—å‡ºä½ è°ƒæ•´å¤§å°åå›¾åƒçš„ç­‰æ•ˆå°ºå¯¸ï¼Œç”¨ä¸» <code>UIScreen</code> çš„ <code>scale</code>ï¼Œç­‰æ¯”ä¾‹æ”¾å¤§ä½  <code>UIImageView</code> çš„ <code>size</code> å¤§å°ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> scaleFactor = <span class="type">UIScreen</span>.main.scale</span><br><span class="line"><span class="keyword">let</span> scale = <span class="type">CGAffineTransform</span>(scaleX: scaleFactor, y: scaleFactor)</span><br><span class="line"><span class="keyword">let</span> size = imageView.bounds.size.applying(scale)</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœä½ æ˜¯åœ¨å¼‚æ­¥åŠ è½½ä¸€å¼ å¤§å›¾ï¼Œä½¿ç”¨ä¸€ä¸ªè¿‡æ¸¡åŠ¨ç”»è®©å›¾åƒé€æ¸æ˜¾ç¤ºåˆ° <code>UIImageView</code> ä¸Šã€‚ä¾‹å¦‚:</p></blockquote><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">var</span> imageView: <span class="type">UIImageView!</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewWillAppear</span><span class="params">(<span class="number">_</span> animated: Bool)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewWillAppear(animated)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> url = <span class="type">Bundle</span>.main.url(forResource: <span class="string">"Blue Marble West"</span>,</span><br><span class="line">                                withExtension: <span class="string">"tiff"</span>)!</span><br><span class="line"></span><br><span class="line">        <span class="type">DispatchQueue</span>.global(qos: .userInitiated).async &#123;</span><br><span class="line">            <span class="keyword">let</span> image = resizedImage(at: url, <span class="keyword">for</span>: <span class="keyword">self</span>.imageView.bounds.size)</span><br><span class="line"></span><br><span class="line">            <span class="type">DispatchQueue</span>.main.sync &#123;</span><br><span class="line">                <span class="type">UIView</span>.transition(with: <span class="keyword">self</span>.imageView,</span><br><span class="line">                                duration: <span class="number">1.0</span>,</span><br><span class="line">                                options: [.curveEaseOut, .transitionCrossDissolve],</span><br><span class="line">                                animations: &#123;</span><br><span class="line">                                    <span class="keyword">self</span>.imageView.image = image</span><br><span class="line">                                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><a name="technique-1-drawing-to-a-uigraphicsimagerenderer"></a></p><h3 id="æŠ€å·§-1-ç»˜åˆ¶åˆ°-UIGraphicsImageRenderer-ä¸Š"><a href="#æŠ€å·§-1-ç»˜åˆ¶åˆ°-UIGraphicsImageRenderer-ä¸Š" class="headerlink" title="æŠ€å·§ #1: ç»˜åˆ¶åˆ° UIGraphicsImageRenderer ä¸Š"></a>æŠ€å·§ #1: ç»˜åˆ¶åˆ° UIGraphicsImageRenderer ä¸Š</h3><p>å›¾åƒæ¸²æŸ“ä¼˜åŒ–çš„æœ€ä¸Šå±‚ API ä½äº UIKit æ¡†æ¶ä¸­ã€‚ç»™å®šä¸€ä¸ª <code>UIImage</code>ï¼Œä½ å¯ä»¥ç»˜åˆ¶åˆ° <code>UIGraphicsImageRenderer</code> çš„ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ä¸­ä»¥æ¸²æŸ“ç¼©å°ç‰ˆæœ¬çš„å›¾åƒï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ€å·§ #1</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">resizedImage</span><span class="params">(at url: URL, <span class="keyword">for</span> size: CGSize)</span></span> -&gt; <span class="type">UIImage?</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> image = <span class="type">UIImage</span>(contentsOfFile: url.path) <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> renderer = <span class="type">UIGraphicsImageRenderer</span>(size: size)</span><br><span class="line">    <span class="keyword">return</span> renderer.image &#123; (context) <span class="keyword">in</span></span><br><span class="line">        image.draw(<span class="keyword">in</span>: <span class="type">CGRect</span>(origin: .zero, size: size))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer" target="_blank" rel="noopener"><code>UIGraphicsImageRenderer</code></a> æ˜¯ä¸€é¡¹ç›¸å¯¹è¾ƒæ–°çš„æŠ€æœ¯ï¼Œåœ¨ iOS 10 ä¸­è¢«å¼•å…¥ï¼Œç”¨ä»¥å–ä»£æ—§ç‰ˆæœ¬çš„ <code>UIGraphicsBeginImageContextWithOptions</code> / <code>UIGraphicsEndImageContext</code> APIã€‚ä½ é€šè¿‡æŒ‡å®šä»¥ <code>point</code> è®¡é‡çš„ <code>size</code> åˆ›å»ºäº†ä¸€ä¸ª <code>UIGraphicsImageRenderer</code>ã€‚<code>image</code> æ–¹æ³•å¸¦æœ‰ä¸€ä¸ªé—­åŒ…å‚æ•°ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªç»è¿‡é—­åŒ…å¤„ç†åçš„ä½å›¾ã€‚æœ€ç»ˆï¼ŒåŸå§‹å›¾åƒä¾¿ä¼šåœ¨ç¼©å°åˆ°æŒ‡å®šçš„èŒƒå›´å†…ç»˜åˆ¶ã€‚</p><blockquote><p>åœ¨ä¸æ”¹å˜å›¾åƒåŸå§‹çºµæ¨ªæ¯”ï¼ˆaspect ratioï¼‰çš„æƒ…å†µä¸‹ï¼Œç¼©å°å›¾åƒåŸå§‹çš„å°ºå¯¸æ¥æ˜¾ç¤ºé€šå¸¸å¾ˆæœ‰ç”¨ã€‚<a href="https://developer.apple.com/documentation/avfoundation/1390116-avmakerect" target="_blank" rel="noopener"><code>AVMakeRect(aspectRatio:insideRect:)</code></a> æ˜¯åœ¨ AVFoundation æ¡†æ¶ä¸­å¾ˆæ–¹ä¾¿çš„ä¸€ä¸ªå‡½æ•°ï¼Œè´Ÿè´£å¸®ä½ åšå¦‚ä¸‹çš„è®¡ç®—ï¼š</p></blockquote><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> func AVFoundation.AVMakeRect</span><br><span class="line"><span class="keyword">let</span> rect = <span class="type">AVMakeRect</span>(aspectRatio: image.size, insideRect: imageView.bounds)</span><br></pre></td></tr></table></figure><p><a name="technique-2-drawing-to-a-core-graphics-context"></a></p><h3 id="æŠ€å·§-2ï¼šç»˜åˆ¶åˆ°-Core-Graphics-Context-ä¸­"><a href="#æŠ€å·§-2ï¼šç»˜åˆ¶åˆ°-Core-Graphics-Context-ä¸­" class="headerlink" title="æŠ€å·§ #2ï¼šç»˜åˆ¶åˆ° Core Graphics Context ä¸­"></a>æŠ€å·§ #2ï¼šç»˜åˆ¶åˆ° Core Graphics Context ä¸­</h3><p>Core Graphics / Quartz 2D æä¾›äº†ä¸€ç³»åˆ—åº•å±‚ API è®©æˆ‘ä»¬å¯ä»¥è¿›è¡Œæ›´å¤šé«˜çº§çš„é…ç½®ã€‚</p><p>ç»™å®šä¸€ä¸ª <code>CGImage</code> ä½œä¸ºæš‚æ—¶çš„ä½å›¾ä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨ <code>draw(_:in:)</code> æ–¹æ³•æ¥ç»˜åˆ¶ç¼©æ”¾åçš„å›¾åƒï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> CoreGraphics</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ€å·§ #2</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">resizedImage</span><span class="params">(at url: URL, <span class="keyword">for</span> size: CGSize)</span></span> -&gt; <span class="type">UIImage?</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> imageSource = <span class="type">CGImageSourceCreateWithURL</span>(url <span class="keyword">as</span> <span class="type">NSURL</span>, <span class="literal">nil</span>),</span><br><span class="line">        <span class="keyword">let</span> image = <span class="type">CGImageSourceCreateImageAtIndex</span>(imageSource, <span class="number">0</span>, <span class="literal">nil</span>)</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> context = <span class="type">CGContext</span>(data: <span class="literal">nil</span>,</span><br><span class="line">                            width: <span class="type">Int</span>(size.width),</span><br><span class="line">                            height: <span class="type">Int</span>(size.height),</span><br><span class="line">                            bitsPerComponent: image.bitsPerComponent,</span><br><span class="line">                            bytesPerRow: image.bytesPerRow,</span><br><span class="line">                            space: image.colorSpace ?? <span class="type">CGColorSpace</span>(name: <span class="type">CGColorSpace</span>.sRGB)!,</span><br><span class="line">                            bitmapInfo: image.bitmapInfo.rawValue)</span><br><span class="line">    context?.interpolationQuality = .high</span><br><span class="line">    context?.draw(image, <span class="keyword">in</span>: <span class="type">CGRect</span>(origin: .zero, size: size))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> scaledImage = context?.makeImage() <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">UIImage</span>(cgImage: scaledImage)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª <code>CGContext</code> åˆå§‹åŒ–æ–¹æ³•æ¥æ”¶äº†å‡ ä¸ªå‚æ•°æ¥æ„é€ ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬äº†å¿…è¦çš„å®½é«˜å‚æ•°ï¼Œè¿˜æœ‰åœ¨ç»™å‡ºçš„è‰²åŸŸèŒƒå›´å†…æ¯ä¸ªé¢œè‰²é€šé“æ‰€éœ€è¦çš„å†…å­˜å¤§å°ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™äº›å‚æ•°éƒ½æ˜¯é€šè¿‡ <code>CGImage</code> è¿™ä¸ªå¯¹è±¡è·å–çš„ã€‚ä¸‹ä¸€æ­¥ï¼Œè®¾ç½® <code>interpolationQuality</code> å±æ€§ä¸º <code>.high</code> æŒ‡ç¤ºä¸Šä¸‹æ–‡åœ¨ä¿è¯ä¸€å®šçš„ç²¾åº¦ä¸Šå¡«å……åƒç´ ã€‚<code>draw(_:in:)</code> æ–¹æ³•åˆ™æ˜¯åœ¨ç»™å®šçš„å®½é«˜å’Œä½ç½®ç»˜åˆ¶å›¾åƒï¼Œå¯ä»¥è®©å›¾ç‰‡åœ¨ç‰¹å®šçš„è¾¹è·ä¸‹è£å‰ªï¼Œä¹Ÿå¯ä»¥é€‚ç”¨äºä¸€äº›åƒæ˜¯äººè„¸è¯†åˆ«ä¹‹ç±»çš„å›¾åƒç‰¹æ€§ã€‚æœ€å <code>makeImage()</code> ä»ä¸Šä¸‹æ–‡è·å–ä¿¡æ¯å¹¶ä¸”æ¸²æŸ“åˆ°ä¸€ä¸ª <code>CGImage</code> å€¼ä¸Šï¼ˆä¹‹åä¼šç”¨æ¥æ„é€  <code>UIImage</code> å¯¹è±¡ï¼‰ã€‚</p><p><a name="technique-3-creating-a-thumbnail-with-image-io"></a></p><h3 id="æŠ€å·§-3ï¼šä½¿ç”¨-Image-I-O-åˆ›å»ºç¼©ç•¥å›¾åƒ"><a href="#æŠ€å·§-3ï¼šä½¿ç”¨-Image-I-O-åˆ›å»ºç¼©ç•¥å›¾åƒ" class="headerlink" title="æŠ€å·§ #3ï¼šä½¿ç”¨ Image I/O åˆ›å»ºç¼©ç•¥å›¾åƒ"></a>æŠ€å·§ #3ï¼šä½¿ç”¨ Image I/O åˆ›å»ºç¼©ç•¥å›¾åƒ</h3><p>Image I/O æ˜¯ä¸€ä¸ªå¼ºå¤§ï¼ˆå´é²œæœ‰äººçŸ¥ï¼‰çš„å›¾åƒå¤„ç†æ¡†æ¶ã€‚æŠ›å¼€ Core Graphics ä¸è¯´ï¼Œå®ƒå¯ä»¥è¯»å†™è®¸å¤šä¸åŒå›¾åƒæ ¼å¼ï¼Œè®¿é—®å›¾åƒçš„å…ƒæ•°æ®ï¼Œè¿˜æœ‰æ‰§è¡Œå¸¸è§„çš„å›¾åƒå¤„ç†æ“ä½œã€‚è¿™ä¸ªæ¡†æ¶é€šè¿‡å…ˆè¿›çš„ç¼“å­˜æœºåˆ¶ï¼Œæä¾›äº†å¹³å°ä¸Šæœ€å¿«çš„å›¾ç‰‡ç¼–ç å™¨å’Œè§£ç å™¨ï¼Œç”šè‡³å¯ä»¥å¢é‡åŠ è½½å›¾ç‰‡ã€‚</p><p>è¿™ä¸ªé‡è¦çš„ <code>CGImageSourceCreateThumbnailAtIndex</code> æä¾›äº†ä¸€ä¸ªå¸¦æœ‰è®¸å¤šä¸åŒé…ç½®é€‰é¡¹çš„ APIï¼Œæ¯”èµ·åœ¨ Core Graphics ä¸­ç­‰ä»·çš„å¤„ç†æ“ä½œè¦ç®€æ´å¾—å¤šï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ImageIO</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ€å·§ #3</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">resizedImage</span><span class="params">(at url: URL, <span class="keyword">for</span> size: CGSize)</span></span> -&gt; <span class="type">UIImage?</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> options: [<span class="type">CFString</span>: <span class="type">Any</span>] = [</span><br><span class="line">        kCGImageSourceCreateThumbnailFromImageIfAbsent: <span class="literal">true</span>,</span><br><span class="line">        kCGImageSourceCreateThumbnailWithTransform: <span class="literal">true</span>,</span><br><span class="line">        kCGImageSourceShouldCacheImmediately: <span class="literal">true</span>,</span><br><span class="line">        kCGImageSourceThumbnailMaxPixelSize: <span class="built_in">max</span>(size.width, size.height)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> imageSource = <span class="type">CGImageSourceCreateWithURL</span>(url <span class="keyword">as</span> <span class="type">NSURL</span>, <span class="literal">nil</span>),</span><br><span class="line">        <span class="keyword">let</span> image = <span class="type">CGImageSourceCreateThumbnailAtIndex</span>(imageSource, <span class="number">0</span>, options <span class="keyword">as</span> <span class="type">CFDictionary</span>)</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">UIImage</span>(cgImage: image)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»™å®šä¸€ä¸ª <code>CGImageSource</code> å’Œä¸€ç³»åˆ—é…ç½®é€‰é¡¹ï¼Œ<code>CGImageSourceCreateThumbnailAtIndex(_:_:_:)</code> å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªå›¾åƒçš„ç¼©ç•¥å›¾ã€‚ä¼˜åŒ–å°ºå¯¸å¤§å°çš„æ“ä½œæ˜¯é€šè¿‡ <code>kCGImageSourceThumbnailMaxPixelSize</code> å®Œæˆçš„ï¼Œå®ƒæ ¹æ®å›¾åƒåŸå§‹å®½é«˜æ¯”æŒ‡å®šçš„æœ€å¤§å°ºå¯¸æ¥ç¼©æ”¾å›¾åƒã€‚é€šè¿‡è®¾å®š <code>kCGImageSourceCreateThumbnailFromImageIfAbsent</code> æˆ– <code>kCGImageSourceCreateThumbnailFromImageAlways</code> é€‰é¡¹ï¼ŒImage I/O å¯ä»¥è‡ªåŠ¨ç¼“å­˜ä¼˜åŒ–åçš„ç»“æœä»¥ä¾¿åç»­è°ƒç”¨ã€‚</p><p><a name="technique-4-lanczos-resampling-with-core-image"></a></p><h3 id="æŠ€å·§-4ï¼šä½¿ç”¨-Core-Image-è¿›è¡Œ-Lanczos-é‡é‡‡æ ·"><a href="#æŠ€å·§-4ï¼šä½¿ç”¨-Core-Image-è¿›è¡Œ-Lanczos-é‡é‡‡æ ·" class="headerlink" title="æŠ€å·§ #4ï¼šä½¿ç”¨ Core Image è¿›è¡Œ Lanczos é‡é‡‡æ ·"></a>æŠ€å·§ #4ï¼šä½¿ç”¨ Core Image è¿›è¡Œ Lanczos é‡é‡‡æ ·</h3><p>Core Image å†…ç½®äº† <a href="https://en.wikipedia.org/wiki/Lanczos_resampling" target="_blank" rel="noopener">Lanczos é‡é‡‡æ ·ï¼ˆresamplingï¼‰</a> åŠŸèƒ½ï¼Œå®ƒæ˜¯ä»¥ <code>CILanczosScaleTransform</code> çš„åŒåæ»¤é•œå‘½åçš„ã€‚è™½ç„¶å¯ä»¥è¯´å®ƒæ˜¯åœ¨ UIKit å±‚çº§ä¹‹ä¸Šçš„ APIï¼Œä½†æ— å¤„ä¸åœ¨çš„ key-value ç¼–å†™æ–¹å¼å¯¼è‡´å®ƒä½¿ç”¨èµ·æ¥å¾ˆä¸æ–¹ä¾¿ã€‚</p><p>å³ä¾¿å¦‚æ­¤ï¼Œå®ƒçš„å¤„ç†æ¨¡å¼è¿˜æ˜¯ä¸€è‡´çš„ã€‚</p><p>åˆ›å»ºè½¬æ¢æ»¤é•œï¼Œå¯¹æ»¤é•œè¿›è¡Œé…ç½®ï¼Œæœ€åæ¸²æŸ“è¾“å‡ºå›¾åƒï¼Œè¿™æ ·çš„æ­¥éª¤å’Œå…¶ä»–ä»»ä½• Core Image çš„å·¥ä½œæµæ²¡ä»€ä¹ˆä¸åŒã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> CoreImage</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sharedContext = <span class="type">CIContext</span>(options: [.useSoftwareRenderer : <span class="literal">false</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ€å·§ #4</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">resizedImage</span><span class="params">(at url: URL, scale: CGFloat, aspectRatio: CGFloat)</span></span> -&gt; <span class="type">UIImage?</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> image = <span class="type">CIImage</span>(contentsOf: url) <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="built_in">filter</span> = <span class="type">CIFilter</span>(name: <span class="string">"CILanczosScaleTransform"</span>)</span><br><span class="line">    <span class="built_in">filter</span>?.setValue(image, forKey: kCIInputImageKey)</span><br><span class="line">    <span class="built_in">filter</span>?.setValue(scale, forKey: kCIInputScaleKey)</span><br><span class="line">    <span class="built_in">filter</span>?.setValue(aspectRatio, forKey: kCIInputAspectRatioKey)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> outputCIImage = <span class="built_in">filter</span>?.outputImage,</span><br><span class="line">        <span class="keyword">let</span> outputCGImage = sharedContext.createCGImage(outputCIImage,</span><br><span class="line">                                                        from: outputCIImage.extent)</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">UIImage</span>(cgImage: outputCGImage)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåå« <code>CILanczosScaleTransform</code> çš„ Core Image æ»¤é•œåˆ†åˆ«æ¥æ”¶äº† <code>inputImage</code>ã€<code>inputScale</code> å’Œ <code>inputAspectRatio</code> ä¸‰ä¸ªå‚æ•°ï¼Œæ¯ä¸€ä¸ªå‚æ•°çš„æ„æ€ä¹Ÿéƒ½ä¸è¨€è‡ªæ˜ã€‚</p><p>æ›´æœ‰è¶£çš„æ˜¯ï¼Œ<code>CIContext</code> åœ¨è¿™é‡Œè¢«ç”¨æ¥åˆ›å»ºä¸€ä¸ª <code>UIImage</code>ï¼ˆé—´æ¥é€šè¿‡ <code>CGImageRef</code> è¡¨ç¤ºï¼‰ï¼Œå› ä¸º <code>UIImage(CIImage:)</code> ç»å¸¸ä¸èƒ½æŒ‰æˆ‘ä»¬æœ¬æ„ä½¿ç”¨ã€‚åˆ›å»º <code>CIContext</code> æ˜¯ä¸€ä¸ªä»£ä»·å¾ˆæ˜‚è´µçš„æ“ä½œï¼Œæ‰€ä»¥ä½¿ç”¨ä¸Šä¸‹æ–‡ç¼“å­˜ä»¥ä¾¿é‡å¤çš„æ¸²æŸ“å·¥ä½œã€‚</p><blockquote><p>ä¸€ä¸ª <code>CIContext</code> å¯ä»¥ä½¿ç”¨ GPU æˆ–è€… CPUï¼ˆæ…¢å¾ˆå¤šï¼‰æ¸²æŸ“åˆ›å»ºå‡ºæ¥ã€‚é€šè¿‡æŒ‡å®šæ„é€ æ–¹æ³•ä¸­çš„ <code>.useSoftwareRenderer</code> é€‰é¡¹æ¥é€‰æ‹©ä½¿ç”¨å“ªä¸ªç¡¬ä»¶ã€‚<em>ï¼ˆæç¤ºï¼šç”¨æ›´å¿«çš„é‚£ä¸ªï¼Œä½ è§‰å¾—å‘¢ï¼Ÿï¼‰</em></p></blockquote><p><a name="technique-5-image-scaling-with-vimage"></a></p><h3 id="æŠ€å·§-5-ä½¿ç”¨-vImage-ä¼˜åŒ–å›¾ç‰‡æ¸²æŸ“"><a href="#æŠ€å·§-5-ä½¿ç”¨-vImage-ä¼˜åŒ–å›¾ç‰‡æ¸²æŸ“" class="headerlink" title="æŠ€å·§ #5: ä½¿ç”¨ vImage ä¼˜åŒ–å›¾ç‰‡æ¸²æŸ“"></a>æŠ€å·§ #5: ä½¿ç”¨ vImage ä¼˜åŒ–å›¾ç‰‡æ¸²æŸ“</h3><p>æœ€åä¸€ä¸ªäº†ï¼Œå®ƒæ˜¯å¤è€çš„ <a href="https://developer.apple.com/documentation/accelerate" target="_blank" rel="noopener">Accelerate æ¡†æ¶</a> â€”â€” æ›´å…·ä½“ç‚¹æ¥è¯´ï¼Œå®ƒæ˜¯ <code>vImage</code> çš„å›¾åƒå¤„ç†å­æ¡†æ¶ã€‚</p><p>vImage é™„å¸¦æœ‰ <a href="https://developer.apple.com/documentation/accelerate/vimage/vimage_operations/image_scaling" target="_blank" rel="noopener">ä¸€äº›ä¸åŒçš„åŠŸèƒ½</a>ï¼Œå¯ä»¥ç”¨æ¥è£å‰ªå›¾åƒç¼“å†²åŒºå¤§å°ã€‚è¿™äº›åº•å±‚ API ä¿è¯äº†é«˜æ€§èƒ½åŒæ—¶ä½èƒ½è€—ï¼Œä½†ä¼šå¯¼è‡´ä½ å¯¹ç¼“å†²åŒºçš„ç®¡ç†æ“ä½œå¢åŠ ï¼ˆæ›´ä¸ç”¨è¯´è¦ç¼–å†™æ›´å¤šçš„ä»£ç äº†ï¼‰ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> Accelerate.vImage</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ€å·§ #5</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">resizedImage</span><span class="params">(at url: URL, <span class="keyword">for</span> size: CGSize)</span></span> -&gt; <span class="type">UIImage?</span> &#123;</span><br><span class="line">    <span class="comment">// è§£ç æºå›¾åƒ</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> imageSource = <span class="type">CGImageSourceCreateWithURL</span>(url <span class="keyword">as</span> <span class="type">NSURL</span>, <span class="literal">nil</span>),</span><br><span class="line">        <span class="keyword">let</span> image = <span class="type">CGImageSourceCreateImageAtIndex</span>(imageSource, <span class="number">0</span>, <span class="literal">nil</span>),</span><br><span class="line">        <span class="keyword">let</span> properties = <span class="type">CGImageSourceCopyPropertiesAtIndex</span>(imageSource, <span class="number">0</span>, <span class="literal">nil</span>) <span class="keyword">as</span>? [<span class="type">CFString</span>: <span class="type">Any</span>],</span><br><span class="line">        <span class="keyword">let</span> imageWidth = properties[kCGImagePropertyPixelWidth] <span class="keyword">as</span>? vImagePixelCount,</span><br><span class="line">        <span class="keyword">let</span> imageHeight = properties[kCGImagePropertyPixelHeight] <span class="keyword">as</span>? vImagePixelCount</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰å›¾åƒæ ¼å¼</span></span><br><span class="line">    <span class="keyword">var</span> format = vImage_CGImageFormat(bitsPerComponent: <span class="number">8</span>,</span><br><span class="line">                                      bitsPerPixel: <span class="number">32</span>,</span><br><span class="line">                                      colorSpace: <span class="literal">nil</span>,</span><br><span class="line">                                      bitmapInfo: <span class="type">CGBitmapInfo</span>(rawValue: <span class="type">CGImageAlphaInfo</span>.first.rawValue),</span><br><span class="line">                                      version: <span class="number">0</span>,</span><br><span class="line">                                      decode: <span class="literal">nil</span>,</span><br><span class="line">                                      renderingIntent: .defaultIntent)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> error: vImage_Error</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºå¹¶åˆå§‹åŒ–æºç¼“å†²åŒº</span></span><br><span class="line">    <span class="keyword">var</span> sourceBuffer = vImage_Buffer()</span><br><span class="line">    <span class="keyword">defer</span> &#123; sourceBuffer.data.deallocate() &#125;</span><br><span class="line">    error = vImageBuffer_InitWithCGImage(&amp;sourceBuffer,</span><br><span class="line">                                         &amp;format,</span><br><span class="line">                                         <span class="literal">nil</span>,</span><br><span class="line">                                         image,</span><br><span class="line">                                         vImage_Flags(kvImageNoFlags))</span><br><span class="line">    <span class="keyword">guard</span> error == kvImageNoError <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºå¹¶åˆå§‹åŒ–ç›®æ ‡ç¼“å†²åŒº</span></span><br><span class="line">    <span class="keyword">var</span> destinationBuffer = vImage_Buffer()</span><br><span class="line">    error = vImageBuffer_Init(&amp;destinationBuffer,</span><br><span class="line">                              vImagePixelCount(size.height),</span><br><span class="line">                              vImagePixelCount(size.width),</span><br><span class="line">                              format.bitsPerPixel,</span><br><span class="line">                              vImage_Flags(kvImageNoFlags))</span><br><span class="line">    <span class="keyword">guard</span> error == kvImageNoError <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¼˜åŒ–ç¼©æ”¾å›¾åƒ</span></span><br><span class="line">    error = vImageScale_ARGB8888(&amp;sourceBuffer,</span><br><span class="line">                                 &amp;destinationBuffer,</span><br><span class="line">                                 <span class="literal">nil</span>,</span><br><span class="line">                                 vImage_Flags(kvImageHighQualityResampling))</span><br><span class="line">    <span class="keyword">guard</span> error == kvImageNoError <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»ç›®æ ‡ç¼“å†²åŒºåˆ›å»ºä¸€ä¸ª CGImage å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> resizedImage =</span><br><span class="line">        vImageCreateCGImageFromBuffer(&amp;destinationBuffer,</span><br><span class="line">                                      &amp;format,</span><br><span class="line">                                      <span class="literal">nil</span>,</span><br><span class="line">                                      <span class="literal">nil</span>,</span><br><span class="line">                                      vImage_Flags(kvImageNoAllocate),</span><br><span class="line">                                      &amp;error)?.takeRetainedValue(),</span><br><span class="line">        error == kvImageNoError</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">UIImage</span>(cgImage: resizedImage)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨ Accelerate API è¿›è¡Œçš„æ˜ç¡®æ“ä½œï¼Œæ¯”èµ·ç›®å‰ä¸ºæ­¢è®¨è®ºåˆ°çš„å…¶ä»–ä¼˜åŒ–æ–¹æ³•æ›´åŠ åº•å±‚ã€‚ä½†æš‚æ—¶ä¸ç®¡è¿™äº›ä¸å‹å¥½çš„ç±»å‹ç”³æ˜å’Œå‡½æ•°åç§°çš„è¯ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªæ–¹æ³•ç›¸å½“ç›´æ¥äº†å½“ã€‚</p><ul><li>é¦–å…ˆï¼Œæ ¹æ®ä½ ä¼ å…¥çš„å›¾åƒåˆ›å»ºä¸€ä¸ªè¾“å…¥çš„æºç¼“å†²åŒºï¼Œ</li><li>æ¥ç€ï¼Œåˆ›å»ºä¸€ä¸ªè¾“å‡ºçš„ç›®æ ‡ç¼“å†²åŒºæ¥æ¥å—ä¼˜åŒ–åçš„å›¾åƒï¼Œ</li><li>ç„¶åï¼Œåœ¨æºç¼“å†²åŒºè£å‰ªå›¾åƒæ•°æ®ï¼Œç„¶åä¼ ç»™ç›®æ ‡ç¼“å†²åŒºï¼Œ</li><li>æœ€åï¼Œä»ç›®æ ‡ç¼“å†²åŒºä¸­æ ¹æ®å¤„ç†å®Œåçš„å›¾åƒåˆ›å»º <code>UIImage</code> å¯¹è±¡ã€‚</li></ul><hr><h2 id="æ€§èƒ½å¯¹æ¯”"><a href="#æ€§èƒ½å¯¹æ¯”" class="headerlink" title="æ€§èƒ½å¯¹æ¯”"></a>æ€§èƒ½å¯¹æ¯”</h2><p>é‚£ä¹ˆè¿™äº›ä¸åŒçš„æ–¹æ³•æ˜¯å¦‚ä½•ç›¸äº’å¯¹æ¯”çš„å‘¢ï¼Ÿ</p><p><a href="https://github.com/NSHipster/Image-Resizing-Example" target="_blank" rel="noopener">è¿™ä¸ªé¡¹ç›®</a> æ˜¯ä¸€äº› <a href="https://nshipster.com/benchmarking/" target="_blank" rel="noopener">æ€§èƒ½å¯¹æ¯”</a> ç»“æœï¼Œè¿è¡Œç¯å¢ƒæ˜¯ iPhone 7 iOS 12.2ã€‚</p><p><img src="https://nshipster.com/assets/image-resizing-app-screenshot-02998a420a75691f6b5c8de44ba24d6119853776bd78bb9e1bfa3a36cdd7d48d.png" alt="image-resizing-app-screenshot"></p><p>ä¸‹é¢çš„è¿™äº›æ•°å­—æ˜¯å¤šæ¬¡è¿­ä»£åŠ è½½ã€ä¼˜åŒ–ã€æ¸²æŸ“ä¹‹å‰é‚£å¼  <a href="https://visibleearth.nasa.gov/view.php?id=78314" target="_blank" rel="noopener">è¶…å¤§åœ°çƒå›¾ç‰‡</a> çš„å¹³å‡æ—¶é—´ï¼š</p><table><thead><tr><th></th><th>è€—æ—¶ <em>(seconds)</em></th></tr></thead><tbody><tr><td>æŠ€å·§ #1: <code>UIKit</code></td><td>0.1420</td></tr><tr><td>æŠ€å·§ #2: <code>Core Graphics</code> <sup>1</sup></td><td>0.1722</td></tr><tr><td>æŠ€å·§ #3: <code>Image I/O</code></td><td>0.1616</td></tr><tr><td>æŠ€å·§ #4: <code>Core Image</code> <sup>2</sup></td><td>2.4983</td></tr><tr><td>æŠ€å·§ #5: <code>vImage</code></td><td>2.3126</td></tr></tbody></table><p><sup>1</sup> &nbsp;<br>è®¾ç½®ä¸åŒçš„ <code>CGInterpolationQuality</code> å€¼å‡ºæ¥çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œåœ¨æ€§èƒ½ä¸Šçš„å·®å¼‚å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p><p><sup>2</sup> &nbsp;<br>è‹¥åœ¨ <code>CIContext</code> åˆ›å»ºæ—¶è®¾ç½® <code>kCIContextUseSoftwareRenderer</code> çš„å€¼ä¸º <code>true</code>ï¼Œä¼šå¯¼è‡´è€—æ—¶ç›¸æ¯”åŸºç¡€ç»“æœæ…¢ä¸€ä¸ªæ•°é‡çº§ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li><strong>UIKit</strong>, <strong>Core</strong> <strong>Graphics</strong>, å’Œ <strong>Image</strong> <strong>I/O</strong> éƒ½èƒ½å¾ˆå¥½åœ°ç”¨äºå¤§éƒ¨åˆ†å›¾ç‰‡çš„ä¼˜åŒ–æ“ä½œã€‚å¦‚æœï¼ˆåœ¨ iOS å¹³å°ï¼Œè‡³å°‘ï¼‰è¦é€‰æ‹©ä¸€ä¸ªçš„è¯ï¼Œ<code>UIGraphicsImageRenderer</code> æ˜¯ä½ æœ€ä½³çš„é€‰æ‹©ã€‚</li><li><strong>Core</strong> <strong>Image</strong> åœ¨å›¾åƒä¼˜åŒ–æ¸²æŸ“æ“ä½œæ–¹é¢æ€§èƒ½è¡¨ç°ä¼˜è¶Šã€‚å®é™…ä¸Šï¼Œæ ¹æ® Apple å®˜æ–¹ <a href="https://developer.apple.com/library/mac/documentation/graphicsimaging/Conceptual/CoreImaging/ci_performance/ci_performance.html#//apple_ref/doc/uid/TP30001185-CH10-SW1" target="_blank" rel="noopener"><em>Core</em> <em>Image</em> <em>ç¼–ç¨‹è§„èŒƒä¸­çš„æ€§èƒ½æœ€ä½³å®è·µå•å…ƒ</em></a>ï¼Œä½ åº”è¯¥ä½¿ç”¨ Core Graphics æˆ– Image I/O å¯¹å›¾åƒè¿›è¡Œè£å‰ªå’Œä¸‹é‡‡æ ·ï¼Œè€Œä¸æ˜¯ç”¨ Core Imageã€‚</li><li>é™¤éä½ å·²ç»åœ¨ä½¿ç”¨ <strong><code>vImage</code></strong>ï¼Œå¦åˆ™åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ç”¨åˆ°åº•å±‚çš„ Accelerate API æ‰€éœ€çš„é¢å¤–å·¥ä½œå¯èƒ½æ˜¯ä¸åˆç†çš„ã€‚</li></ul><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      é•¿æœŸä»¥æ¥ï¼ŒiOS å¼€å‘äººå‘˜å°±ä¸ºä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜æ‰€å›°æ‰°ï¼šâ€˜å¦‚ä½•å¯¹ä¸€å¼ å›¾åƒè¿›è¡Œæ¸²æŸ“ä¼˜åŒ–ï¼Ÿâ€™æœ¬æ–‡è¯•å›¾ä¸ºè¿™ä¸ªç”±æ¥å·²ä¹…çš„é—®é¢˜æä¾›ä¸€ä¸ªæ˜ç¡®çš„ç­”æ¡ˆã€‚
    
    </summary>
    
      <category term="Miscellaneous" scheme="https://swift.gg/categories/Miscellaneous/"/>
    
    
      <category term="å›¾åƒ" scheme="https://swift.gg/tags/%E5%9B%BE%E5%83%8F/"/>
    
  </entry>
  
  <entry>
    <title>æ¯ä¸€ç‚¹è¿›æ­¥éƒ½æ˜¯å¿«ä¹ï¼šæ— å¤„ä¸åœ¨çš„æ‰©å±•</title>
    <link href="https://swift.gg/2019/10/29/extensions-everywhere/"/>
    <id>https://swift.gg/2019/10/29/extensions-everywhere/</id>
    <published>2019-10-29T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šRuss Bishopï¼Œ<a href="http://www.russbishop.net/take-delight-in-small-joys" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-11-08<br>è¯‘è€…ï¼šä¿Šä¸œï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>è¿™ç¯‡æ–‡ç« è®°å½•äº†æˆ‘æ‰€æ”¶è·çš„å°æƒŠå–œã€‚åœ¨ Swift ä¸­å†™æ‰©å±•è®©äººæ„Ÿè§‰éå¸¸è‡ªç„¶ã€‚</p><p>æˆ‘è®¤ä¸º <code>UnsafeMutableRawBufferPointer.baseAddress</code> æ˜¯å¯é€‰é¡¹è¿™å›äº‹éå¸¸ä¸åˆç†ã€‚åœ¨å®è·µä¸­å®ƒä¼šä½¿ä»£ç å˜å¾—ä¸‘é™‹ã€‚æˆ‘ä¹Ÿä¸å–œæ¬¢åœ¨åˆ†é…æ—¶æŒ‡å®šå¯¹é½æ–¹å¼ï¼›åœ¨å¤§å¤šæ•°å¹³å°ä¸Šï¼Œåˆç†çš„é»˜è®¤å€¼éƒ½æ˜¯ <code>Int.bitWidth / 8</code>ã€‚</p><p>é€šè¿‡æ‰©å±•ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°è§£å†³è¿™äº›é—®é¢˜ã€‚è¿™æ ·çš„è§£å†³æ–¹æ¡ˆèƒ½åƒæ ‡å‡†åº“ä¸€æ ·è‡ªç„¶åœ°ä½¿ç”¨ã€‚<br><a id="more"></a></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨è°ƒè¯•ç‰ˆæœ¬ä¸­è¿›è¡Œç®€å•çš„å¥å…¨æ€§æ£€æŸ¥ï¼Œä»¥ç¡®ä¿ä¸ä¼šäº§ç”Ÿæ— æ„ä¹‰çš„å¯¹é½è®¡ç®—ã€‚è¿™é‡Œæä¸€ä¸ªæœ‰å…³æ­£æ•´æ•°çš„å°æŠ€å·§ï¼šä¸€ä¸ª 2 çš„ n æ¬¡å¹‚æ•°åªæœ‰ä¸€ä¸ªæ¯”ç‰¹ä½æ˜¯æœ‰å€¼çš„ã€‚å‡å» 1 æ—¶å°±æ˜¯æŠŠåé¢çš„æ‰€æœ‰æ¯”ç‰¹ä½è®¾ç½®ä¸º 1ï¼Œå¦‚ 8ï¼ˆ<code>0b1000</code>ï¼‰- 1 å¾—åˆ° 7ï¼ˆ<code>0b0111</code>ï¼‰ã€‚è¿™ä¸¤ä¸ªæ•°å­—æ²¡æœ‰å…±åŒçš„ä½ï¼Œå› æ­¤æŒ‰ä½å–ä¸åº”è¯¥äº§ç”Ÿé›¶ã€‚ç”±äºè¿™è§„å¾‹åœ¨é›¶ä¸Šæ— æ•ˆï¼Œæ‰€ä»¥éœ€è¦å•ç‹¬æ£€æŸ¥ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">BinaryInteger</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> isPositivePowerOf2: <span class="type">Bool</span> &#123;</span><br><span class="line">        @inline(__always)</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">self</span> &amp; (<span class="keyword">self</span> - <span class="number">1</span>)) == <span class="number">0</span> &amp;&amp; <span class="keyword">self</span> != <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®© allocate æ–¹æ³•é»˜è®¤ä½¿ç”¨è‡ªç„¶æ•´æ•°å®½åº¦å¯¹é½ã€‚è®¾ç½®å¯¹é½å‚æ•°å¯èƒ½æœ‰ç‚¹å¤šä½™ï¼Œä¸è¿‡å®ƒå‡ ä¹èƒ½å¤„ç†æˆ‘ä»¬æƒ³è¦å­˜å‚¨åœ¨ç¼“å†²åŒºä¸­çš„ä»»ä½•æ•°æ®ã€‚è™½ç„¶æ–­è¨€ä»…åœ¨è°ƒè¯•ç¯å¢ƒä¸­æœ‰æ•ˆï¼Œä½†è¿™å·²ç»å¤Ÿåº”ä»˜æˆ‘ä»¬çš„ä½¿ç”¨ï¼›å·²çŸ¥ Swift æ”¯æŒçš„å¹³å°ä¸Šè¿™ä¸ªæ–­è¨€éƒ½ä¼šæ˜¯ trueã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UnsafeMutableRawBufferPointer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">allocate</span><span class="params">(byteCount: Int)</span></span> -&gt; <span class="type">UnsafeMutableRawBufferPointer</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> alignment = <span class="type">Int</span>.bitWidth / <span class="number">8</span></span><br><span class="line">        <span class="built_in">assert</span>(alignment.isPositivePowerOf2, <span class="string">"expected power of two"</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.allocate(byteCount: byteCount, alignment: alignment)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åå†æä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªéšå¼å¼ºåˆ¶è§£åŒ…çš„ <code>base</code> å±æ€§ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UnsafeMutableRawBufferPointer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> base: <span class="type">UnsafeMutableRawPointer</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> baseAddress!</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UnsafeRawBufferPointer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> base: <span class="type">UnsafeRawPointer</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> baseAddress!</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€åˆ‡å¦‚æ­¤ç®€å•ã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      Swift æ‰©å±•çš„åº”ç”¨
    
    </summary>
    
      <category term="Russ Bishop" scheme="https://swift.gg/categories/Russ-Bishop/"/>
    
    
      <category term="iOS" scheme="https://swift.gg/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>Xcode Build é…ç½®æ–‡ä»¶</title>
    <link href="https://swift.gg/2019/10/25/nshipster-xcconfig/"/>
    <id>https://swift.gg/2019/10/25/nshipster-xcconfig/</id>
    <published>2019-10-25T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šMatttï¼Œ<a href="https://nshipster.com/xcconfig/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2019-05-13<br>è¯‘è€…ï¼š<a href="https://github.com/mobilefellow" target="_blank" rel="noopener">é›¨è°¨</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>è½¯ä»¶å¼€å‘æœ€ä½³å®è·µ <a href="https://12factor.net/config" target="_blank" rel="noopener">è§„å®šäº†</a> é…ç½®ä¸ä»£ç çš„ä¸¥æ ¼åˆ†ç¦»ã€‚ç„¶è€Œï¼Œè‹¹æœå¹³å°ä¸Šçš„å¼€å‘äººå‘˜å¸¸å¸¸éš¾ä»¥å°†è¿™äº›æŒ‡å¯¼åŸåˆ™ä¸ Xcode ç¹é‡çš„é¡¹ç›®å·¥ä½œæµç¨‹ç»“åˆèµ·æ¥ã€‚</p><p>äº†è§£æ¯ä¸ªé¡¹ç›®è®¾ç½®çš„åŠŸèƒ½ä»¥åŠå®ƒä»¬ä¹‹é—´å¦‚ä½•äº¤äº’ï¼Œæ˜¯ä¸€é¡¹éœ€è¦å¤šå¹´ç£¨ç»ƒçš„æŠ€èƒ½ã€‚ä½† Xcode å°†å¤§éƒ¨åˆ†çš„è¿™ç±»ä¿¡æ¯éƒ½éƒ½æ·±åŸ‹åœ¨å…¶å›¾å½¢åŒ–ç•Œé¢ä¸­ï¼Œè¿™å¯¹æˆ‘ä»¬æ²¡æœ‰ä»»ä½•å¥½å¤„ã€‚<br><a id="more"></a><br>å¯¼èˆªåˆ°é¡¹ç›®ç¼–è¾‘å™¨çš„ â€œBuild Settingsâ€ tabï¼Œä½ ä¼šçœ‹åˆ°åˆ†å¸ƒåœ¨ projectã€target å’Œ configuration ä¸Šçš„ <em>æ•°ç™¾æ¡</em> Build Settingï¼ˆæ„å»ºé…ç½®ï¼‰ â€”â€” <em>æ›´åˆ«è¯´å…¶ä»–å…­ä¸ª tab äº†!</em></p><p><img src="https://nshipster.com/assets/xcconfig-project-build-settings--light-f7043782f0b56d637bec89eefa0d37939b38ef33f55c293e326d3fecbc06df49.png" alt></p><p>å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªæ›´å¥½çš„åŠæ³•ï¼Œä¸å¿…ç‚¹å‡»è¿·å®«èˆ¬çš„ tab å’Œç®­å¤´ï¼Œå°±å¯ä»¥ç®¡ç†æ‰€æœ‰çš„é…ç½®ã€‚</p><p>è¿™ä¸€å‘¨ï¼Œæˆ‘ä»¬å°†å‘ä½ å±•ç¤ºå¦‚ä½•åœ¨ Xcode ä¹‹å¤–ï¼Œé€šè¿‡ä¿®æ”¹åŸºäºæ–‡æœ¬çš„ <code>xcconfig</code> æ–‡ä»¶ï¼Œè®©ä½ çš„é¡¹ç›®æ›´åŠ ç´§å‡‘ã€æ˜“æ‡‚ã€å¼ºå¤§ã€‚</p><hr><p><a href="https://help.apple.com/xcode/mac/8.3/#/dev745c5c974" target="_blank" rel="noopener">Xcode Build é…ç½®æ–‡ä»¶</a>ï¼Œå³å¤§å®¶æ‰€ç†ŸçŸ¥çš„ <code>xcconfig</code> æ–‡ä»¶ï¼Œå…è®¸æˆ‘ä»¬åœ¨ä¸ä½¿ç”¨ Xcode çš„æƒ…å†µä¸‹å£°æ˜å’Œç®¡ç† APP çš„ Build Settingã€‚å®ƒä»¬æ˜¯çº¯æ–‡æœ¬ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯¹ä»£ç ç®¡ç†ç³»ç»Ÿæ›´åŠ å‹å¥½ï¼Œè€Œä¸”å¯ä»¥è¢«ä»»æ„ç¼–è¾‘å™¨ä¿®æ”¹ã€‚</p><p>ä»æ ¹æœ¬ä¸Šè¯´ï¼Œæ¯ä¸ªé…ç½®æ–‡ä»¶éƒ½ç”±ä¸€ç³»åˆ—é”®å€¼å¯¹ç»„æˆï¼Œå…¶è¯­æ³•å¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;#BUILD_SETTING_NAME#&gt; = &lt;#value#&gt;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ ·çš„ <code>SWIFT_VERSION</code> Build Settingï¼ŒæŒ‡å®šé¡¹ç›®çš„ Swift è¯­è¨€ç‰ˆæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SWIFT_VERSION = 5.0</span><br></pre></td></tr></table></figure><blockquote><p>æ ¹æ® <a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html#tag_08" target="_blank" rel="noopener"><abbr title="Portable Operating System Interface">POSIX</abbr> æ ‡å‡†</a>ï¼Œç¯å¢ƒå˜é‡çš„åå­—ç”±å…¨å¤§å†™å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼ˆ<code>_</code>ï¼‰ç»„æˆ â€”â€” ç»å…¸ä¾‹å­å°±æ˜¯ <code>SCREAMING_SNAKE_CASE</code> ğŸğŸ—¯ã€‚</p></blockquote><hr><p>ä¹ä¸€çœ‹ï¼Œ<code>xcconfig</code> æ–‡ä»¶ä¸ <code>.env</code> æ–‡ä»¶æœ‰æƒŠäººçš„ç›¸ä¼¼ä¹‹å¤„ï¼Œå®ƒä»¬çš„è¯­æ³•éƒ½å¾ˆç®€å•ï¼Œéƒ½ä»¥æ¢è¡Œåˆ†éš”ã€‚ä½†æ˜¯ï¼ŒXcode Build é…ç½®æ–‡ä»¶çš„å†…å®¹æ¯”è¡¨é¢ä¸Šçœ‹åˆ°çš„è¦å¤šã€‚<em>çœ‹å“ª!</em></p><h3 id="ä¿ç•™ç°æœ‰å€¼"><a href="#ä¿ç•™ç°æœ‰å€¼" class="headerlink" title="ä¿ç•™ç°æœ‰å€¼"></a>ä¿ç•™ç°æœ‰å€¼</h3><p>è¦è¿½åŠ æ–°å†…å®¹ï¼Œè€Œä¸æ˜¯æ›¿æ¢ç°æœ‰å®šä¹‰æ—¶ï¼Œå¯ä»¥åƒè¿™æ ·ä½¿ç”¨ <code>$(inherited)</code> å˜é‡:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;#BUILD_SETTING_NAME#&gt; = $(inherited)&lt;#additional value#&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¹ˆåšé€šå¸¸æ˜¯ä¸ºäº†æ­å»ºä¸€äº›å€¼çš„åˆ—è¡¨ï¼Œæ¯”å¦‚ç¼–è¯‘å™¨çš„ framework å¤´æ–‡ä»¶çš„æœç´¢è·¯å¾„(<code>FRAMEWORK_SEARCH_PATHS</code>):</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FRAMEWORK_SEARCH_PATHS = $(inherited) $(PROJECT_DIR)</span><br></pre></td></tr></table></figure><p>Xcode æŒ‰ä¸‹é¢çš„é¡ºåºå¯¹ <code>inherited</code> è¿›è¡Œèµ‹å€¼ï¼ˆä¼˜å…ˆçº§ä»ä½åˆ°é«˜ï¼‰ï¼š</p><ul><li>å¹³å°é»˜è®¤å€¼ï¼ˆPlatform Defaultsï¼‰</li><li>Xcode é¡¹ç›®æ–‡ä»¶çš„ Build Settingï¼ˆXcode Project File Build Settingsï¼‰</li><li>Xcode é¡¹ç›®çš„ xcconfig æ–‡ä»¶ï¼ˆxcconfig File for the Xcode Projectï¼‰</li><li>Active Target çš„ Build Settingï¼ˆActive Target Build Settingsï¼‰</li><li>Active Target çš„ xcconfig æ–‡ä»¶ï¼ˆxcconfig File for the Active Targetï¼‰</li></ul><blockquote><p>ç©ºæ ¼ç”¨äºåˆ†éš”å­—ç¬¦ä¸²å’Œè·¯å¾„åˆ—è¡¨ä¸­çš„é¡¹ã€‚æŒ‡å®šåŒ…å«ç©ºæ ¼çš„é¡¹æ—¶ï¼Œå¿…é¡»ç”¨å¼•å·(<code>&quot;</code>)æ‹¬èµ·æ¥ã€‚</p></blockquote><h3 id="å¼•ç”¨å…¶ä»–å€¼"><a href="#å¼•ç”¨å…¶ä»–å€¼" class="headerlink" title="å¼•ç”¨å…¶ä»–å€¼"></a>å¼•ç”¨å…¶ä»–å€¼</h3><p>ä½ å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„è¯­æ³•ï¼Œé€šè¿‡å…¶ä»–è®¾ç½®çš„åå­—å¼•ç”¨å®ƒä»¬çš„å€¼ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;#BUILD_SETTING_NAME#&gt; = $(&lt;#ANOTHER_BUILD_SETTING_NAME#&gt;)</span><br></pre></td></tr></table></figure><p>è¿™ç§å¼•ç”¨æ—¢å¯ä»¥ç”¨äºæ ¹æ®ç°æœ‰å€¼å®šä¹‰æ–°å˜é‡ï¼Œä¹Ÿå¯ä»¥ç”¨äºä»¥å†…è”æ–¹å¼åŠ¨æ€æ„å»ºæ–°å€¼ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">OBJROOT = $(SYMROOT)</span><br><span class="line">CONFIGURATION_BUILD_DIR = $(BUILD_DIR)/$(CONFIGURATION)-$(PLATFORM_NAME)</span><br></pre></td></tr></table></figure><h3 id="æ¡ä»¶çº¦æŸ"><a href="#æ¡ä»¶çº¦æŸ" class="headerlink" title="æ¡ä»¶çº¦æŸ"></a>æ¡ä»¶çº¦æŸ</h3><p>ä½¿ç”¨ä»¥ä¸‹è¯­æ³•ï¼Œä½ å¯ä»¥æŒ‰ SDKï¼ˆ<code>sdk</code>ï¼‰ã€æ¶æ„ï¼ˆ<code>arch</code>ï¼‰å’Œ / æˆ–é…ç½®ï¼ˆ<code>config</code>ï¼‰å¯¹ Build Setting è¿›è¡Œæ¡ä»¶çº¦æŸï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;#BUILD_SETTING_NAME#&gt;[sdk=&lt;#sdk#&gt;] = &lt;#value for specified sdk#&gt;</span><br><span class="line">&lt;#BUILD_SETTING_NAME#&gt;[arch=&lt;#architecture#&gt;] = &lt;#value for specified architecture#&gt;</span><br><span class="line">&lt;#BUILD_SETTING_NAME#&gt;[config=&lt;#configuration#&gt;] = &lt;#value for specified configuration#&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦åœ¨åŒä¸€ Build Setting çš„å¤šä¸ªå®šä¹‰ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼Œç¼–è¯‘å™¨å°†æ ¹æ®æ¡ä»¶çº¦æŸè¿›è¡Œè§£æã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;#BUILD_SETTING_NAME#&gt;[sdk=&lt;#sdk#&gt;][arch=&lt;#architecture#&gt;] = &lt;#value for specified sdk and architectures#&gt;</span><br><span class="line">&lt;#BUILD_SETTING_NAME#&gt;[sdk=*][arch=&lt;#architecture#&gt;] = &lt;#value for all other sdks with specified architecture#&gt;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ¡ Build Setting æŒ‡å®šä»…ç¼–è¯‘ active architectureï¼Œä»è€Œæå‡æœ¬åœ° Build çš„é€Ÿåº¦ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ONLY_ACTIVE_ARCH[config=Debug][sdk=*][arch=*] = YES</span><br></pre></td></tr></table></figure><h3 id="å¼•ç”¨å…¶ä»–é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®"><a href="#å¼•ç”¨å…¶ä»–é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®" class="headerlink" title="å¼•ç”¨å…¶ä»–é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®"></a>å¼•ç”¨å…¶ä»–é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®</h3><p>è·Ÿ <code>C</code> è¯­è¨€çš„ <code>#include</code> æŒ‡ä»¤ä¸€æ ·ï¼ŒBuild é…ç½®æ–‡ä»¶ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ç§è¯­æ³•æ¥å¼•ç”¨å…¶ä»–é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include &quot;&lt;#path/to/File.xcconfig#&gt;&quot;</span><br></pre></td></tr></table></figure><p>æ­£å¦‚æˆ‘ä»¬å°†åœ¨æœ¬æ–‡åé¢çœ‹åˆ°çš„ï¼Œä½ å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œä»¥éå¸¸å¼ºå¤§çš„æ–¹å¼æ­å»ºèµ· Build Setting çš„çº§è”åˆ—è¡¨ã€‚</p><blockquote><p>æ­£å¸¸æ¥è¯´ï¼Œå½“é‡åˆ°ä¸€ä¸ªæ— æ³•è§£æçš„ <code>#include</code> æŒ‡ä»¤æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚ä½†æ˜¯ <code>xcconfig</code> æ–‡ä»¶åŒæ—¶ä¹Ÿæ”¯æŒ <code>#include?</code> æŒ‡ä»¤ï¼Œåœ¨è¯¥æŒ‡ä»¤ä¸‹ï¼Œè‹¥æ–‡ä»¶æ— æ³•æ‰¾åˆ°ï¼Œç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™ã€‚</p></blockquote><blockquote><p>æ ¹æ®æ–‡ä»¶æ˜¯å¦å­˜åœ¨è€Œæ”¹å˜ç¼–è¯‘æ—¶è¡Œä¸ºçš„æƒ…å†µå¹¶ä¸å¤šï¼›æ¯•ç«Ÿï¼ŒBuild æœ€å¥½æ˜¯å¯é¢„è§çš„ã€‚ä½†æ˜¯ä½ å¯ä»¥æŠŠå®ƒç”¨åœ¨å¯é€‰çš„å¼€å‘å·¥å…·ä¸Šï¼Œæ¯”å¦‚ <a href="https://revealapp.com/" target="_blank" rel="noopener">Reveal</a> éœ€è¦ä»¥ä¸‹çš„é…ç½®ï¼š</p></blockquote><blockquote><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; # Reveal.xcconfig</span><br><span class="line">&gt; OTHER_LDFLAGS = $(inherited) -weak_framework RevealServer</span><br><span class="line">&gt; FRAMEWORK_SEARCH_PATHS = $(inherited) /Applications/Reveal.app/Contents/SharedSupport/iOS-Libraries</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h2 id="åˆ›å»º-Build-é…ç½®æ–‡ä»¶"><a href="#åˆ›å»º-Build-é…ç½®æ–‡ä»¶" class="headerlink" title="åˆ›å»º Build é…ç½®æ–‡ä»¶"></a>åˆ›å»º Build é…ç½®æ–‡ä»¶</h2><p>è¦åˆ›å»º Build é…ç½®æ–‡ä»¶ï¼Œè¯·é€‰æ‹© â€œFile &gt; New Fileâ€¦â€ èœå•é¡¹ï¼ˆ<kbd>âŒ˜</kbd><kbd>N</kbd>ï¼‰ï¼Œä¸‹æ‹‰åˆ° â€œOtherâ€ éƒ¨åˆ†ï¼Œé€‰ä¸­ Configuration Settings File æ¨¡æ¿ã€‚å°†å®ƒä¿å­˜åˆ°ä½ çš„é¡¹ç›®ç›®å½•ï¼Œå¹¶ç¡®ä¿å®ƒåœ¨ä½ æœŸæœ›çš„ target ä¸Šã€‚</p><p><img src="https://nshipster.com/assets/xcconfig-new-file--light-1569134f8ecaeaee6640f28e544443da0136ff72b00f9343126147934ac134d4.png" alt></p><p>åˆ›å»ºå¥½ <code>xcconfig</code> æ–‡ä»¶åï¼Œä½ å°±å¯ä»¥å°†å®ƒåˆ†é…ç»™å¯¹åº” target çš„ä¸€ä¸ªæˆ–å¤šä¸ª Build é…ç½®ã€‚</p><p><img src="https://nshipster.com/assets/xcconfig-project-configurations--light-a82440e27f27e3b139ab51c7317780c6b4a017dfcc56532972da5d521f1f0988.png" alt></p><hr><p>ç°åœ¨æˆ‘ä»¬å·²ç»ä»‹ç»äº† Xcode Build é…ç½®æ–‡ä»¶ä½¿ç”¨çš„åŸºç¡€çŸ¥è¯†ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªç¤ºä¾‹ï¼Œçœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒä»¬æ¥ç®¡ç† developmentã€stage å’Œ production ç¯å¢ƒã€‚</p><hr><h2 id="ä¸ºå†…éƒ¨ç‰ˆæœ¬æä¾›è‡ªå®šä¹‰çš„-APP-åç§°å’Œå›¾æ ‡"><a href="#ä¸ºå†…éƒ¨ç‰ˆæœ¬æä¾›è‡ªå®šä¹‰çš„-APP-åç§°å’Œå›¾æ ‡" class="headerlink" title="ä¸ºå†…éƒ¨ç‰ˆæœ¬æä¾›è‡ªå®šä¹‰çš„ APP åç§°å’Œå›¾æ ‡"></a>ä¸ºå†…éƒ¨ç‰ˆæœ¬æä¾›è‡ªå®šä¹‰çš„ APP åç§°å’Œå›¾æ ‡</h2><p>å¼€å‘ iOS åº”ç”¨ç¨‹åºæ—¶ï¼Œé€šå¸¸éœ€è¦åœ¨æ¨¡æ‹Ÿå™¨å’Œæµ‹è¯•è®¾å¤‡ä¸Šå®‰è£…å„ç§å†…éƒ¨ç‰ˆæœ¬ï¼ˆåŒæ—¶ä¹Ÿä¼šå®‰è£…åº”ç”¨ç¨‹åºå•†åº—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä»¥ä¾›å‚è€ƒï¼‰ã€‚</p><p>ä½¿ç”¨ <code>xcconfig</code> æ–‡ä»¶ï¼Œä½ å¯ä»¥è½»æ¾åœ°ä¸ºæ¯ä¸ªé…ç½®åˆ†é…ä¸€ä¸ªä¸åŒçš„åç§°å’Œ APP å›¾æ ‡ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// Development.xcconfig</span><br><span class="line">PRODUCT_NAME = $(inherited) Î±</span><br><span class="line">ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon-Alpha</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">// Staging.xcconfig</span><br><span class="line">PRODUCT_NAME = $(inherited) Î²</span><br><span class="line">ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon-Beta</span><br></pre></td></tr></table></figure><h2 id="ç®¡ç†ä¸åŒç¯å¢ƒä¸‹çš„å¸¸é‡"><a href="#ç®¡ç†ä¸åŒç¯å¢ƒä¸‹çš„å¸¸é‡" class="headerlink" title="ç®¡ç†ä¸åŒç¯å¢ƒä¸‹çš„å¸¸é‡"></a>ç®¡ç†ä¸åŒç¯å¢ƒä¸‹çš„å¸¸é‡</h2><p>å¦‚æœä½ çš„åç«¯å¼€å‘äººå‘˜ä¹Ÿéµå¾ªå‰é¢æåˆ°çš„ <a href="https://12factor.net/config" target="_blank" rel="noopener">12 Factor App</a> ç†è®ºï¼Œé‚£ä¹ˆä»–ä»¬å°†ä¸º developmentã€stage å’Œ production ç¯å¢ƒæä¾›å•ç‹¬çš„æ¥å£ã€‚</p><p>iOS ä¸Šæœ€å¸¸è§çš„ç¯å¢ƒç®¡ç†æ–¹å¼å¯èƒ½å°±æ˜¯ä½¿ç”¨æ¡ä»¶ç¼–è¯‘è¯­å¥ + <code>DEBUG</code> è¿™æ ·çš„ Build Setting äº†ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">let</span> apiBaseURL = <span class="type">URL</span>(string: <span class="string">"https://api.example.dev"</span>)!</span><br><span class="line"><span class="keyword">let</span> apiKey = <span class="string">"9e053b0285394378cf3259ed86cd7504"</span></span><br><span class="line">#<span class="keyword">else</span></span><br><span class="line"><span class="keyword">let</span> apiBaseURL = <span class="type">URL</span>(string: <span class="string">"https://api.example.com"</span>)!</span><br><span class="line"><span class="keyword">let</span> apiKey = <span class="string">"4571047960318d233d64028363dfa771"</span></span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p>è¿™åªæ˜¯å®Œæˆäº†ä»»åŠ¡ï¼Œä½†æ˜¯ä¸ä»£ç  / é…ç½®åˆ†ç¦»çš„æ ‡å‡†ç›¸å†²çªã€‚</p><p>å¦ä¸€ä¸ªæ–¹æ¡ˆæ˜¯å°†è¿™äº›ä¸ç¯å¢ƒç›¸å…³çš„å€¼æ”¾åˆ°å®ƒä»¬è¯¥å¾…çš„åœ°æ–¹ â€”â€” <code>xcconfig</code> æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// Development.xcconfig</span><br><span class="line">API_BASE_URL = api.example.dev</span><br><span class="line">API_KEY = 9e053b0285394378cf3259ed86cd7504</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">// Production.xcconfig</span><br><span class="line">API_BASE_URL = api.example.com</span><br><span class="line">API_KEY = 4571047960318d233d64028363dfa771</span><br></pre></td></tr></table></figure><blockquote><p>ä¸å¹¸çš„æ˜¯ï¼Œ<code>xcconfig</code> å°†æ‰€æœ‰ <code>//</code> éƒ½å½“æˆæ³¨é‡Šåˆ†éš”ç¬¦ï¼Œä¸ç®¡å®ƒä»¬æ˜¯å¦åŒ…æ‹¬åœ¨å¼•å·ä¸­ã€‚å¦‚æœä½ ç”¨åæ–œçº¿ <code>\/\/</code> è¿›è¡Œè½¬ä¹‰ï¼Œé‚£ä¹ˆè¿™äº›åæ–œçº¿ä¹Ÿå°†è¢«ç›´æ¥å±•ç¤ºå‡ºç°ï¼Œä½¿ç”¨æ—¶å¿…é¡»ä»ç»“æœä¸­ç§»é™¤ã€‚åœ¨æŒ‡å®šæ¯ä¸ªç¯å¢ƒçš„ URL å¸¸é‡æ—¶ï¼Œè¿™å°¤å…¶ä¸æ–¹ä¾¿ã€‚</p></blockquote><blockquote><p>å¦‚æœä¸æƒ³å¤„ç†è¿™ç§éº»çƒ¦çš„äº‹æƒ…ï¼Œä½ å¯ä»¥åœ¨ <code>xcconfig</code> ä¸­å¿½ç•¥ schemeï¼Œç„¶ååœ¨ä»£ç ä¸­æ·»åŠ  <code>https://</code>ã€‚<em>ï¼ˆä½ æ˜¯åœ¨ä½¿ç”¨ httpsâ€¦â€¦å¯¹å§ï¼Ÿï¼‰</em></p></blockquote><p>ç„¶è€Œï¼Œè¦ä»¥ç¼–ç¨‹æ–¹å¼è·å–è¿™äº›å€¼ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªé¢å¤–çš„æ­¥éª¤:</p><h3 id="åœ¨-Swift-ä¸­è®¿é—®-Build-Setting"><a href="#åœ¨-Swift-ä¸­è®¿é—®-Build-Setting" class="headerlink" title="åœ¨ Swift ä¸­è®¿é—® Build Setting"></a>åœ¨ Swift ä¸­è®¿é—® Build Setting</h3><p>ç”± Xcode é¡¹ç›®æ–‡ä»¶ã€<code>xcconfig</code> æ–‡ä»¶å’Œç¯å¢ƒå˜é‡å®šä¹‰çš„ Build Setting åªåœ¨ Build æ—¶å¯ç”¨ã€‚å½“ä½ è¿è¡Œä¸€ä¸ªå·²ç»ç¼–è¯‘çš„ APP æ—¶ï¼Œæ‰€æœ‰ç›¸å…³çš„ä¸Šä¸‹æ–‡éƒ½æ˜¯ä¸å¯è§çš„ã€‚<em>ï¼ˆè°¢å¤©è°¢åœ°ï¼ï¼‰</em></p><p>ä½†æ˜¯ç­‰ä¸€ä¸‹â€”â€”ä½ ä¸è®°å¾—ä¹‹å‰åœ¨å…¶ä»– tab ä¸­çœ‹åˆ°è¿‡ä¸€äº› Build Setting å—ï¼ŸInfoï¼Œæ˜¯å—ï¼Ÿ</p><p>å®é™…ä¸Šï¼ŒInfo tab åªæ˜¯ target çš„ <code>Info.plist</code> æ–‡ä»¶çš„ä¸€ä¸ªé©¬ç”²ã€‚Build æ—¶ï¼Œè¿™ä¸ª <code>Info.plist</code> æ–‡ä»¶ä¼šæ ¹æ® Build Setting çš„é…ç½®è¿›è¡Œç¼–è¯‘ï¼Œç„¶åå¤åˆ¶åˆ°æœ€ç»ˆ APP çš„ <a href="https://nshipster.com/bundles-and-packages/" target="_blank" rel="noopener">bundle</a> ä¸­ã€‚å› æ­¤ï¼Œæ·»åŠ  <code>$(API_BASE_URL)</code> å’Œ <code>$(API_KEY)</code> çš„å¼•ç”¨åï¼Œä½ å¯ä»¥é€šè¿‡ Foundation <code>Bundle</code> API çš„ <code>infoDictionary</code> å±æ€§è®¿é—®è¿™äº›å€¼ã€‚å®Œç¾ï¼</p><p><img src="https://nshipster.com/assets/xcconfig-project-info-plist--light-5561d8abf4dca9722875ff1f62b5975c3361f5ea3dfd584b655f3da7d3ceb94b.png" alt></p><p>æŒ‰ç…§è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åšå¦‚ä¸‹å·¥ä½œï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Configuration</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">value</span>&lt;T&gt;<span class="params">(<span class="keyword">for</span> key: String)</span></span> -&gt; <span class="type">T</span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> value = <span class="type">Bundle</span>.main.infoDictionary?[key] <span class="keyword">as</span>? <span class="type">T</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">fatalError</span>(<span class="string">"Invalid or missing Info.plist key: \(key)"</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">API</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> baseURL: <span class="type">URL</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">URL</span>(string: <span class="string">"https://"</span> + <span class="type">Configuration</span>.value(<span class="keyword">for</span>: <span class="string">"API_BASE_URL"</span>))!</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> key: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Configuration</span>.value(<span class="keyword">for</span>: <span class="string">"API_KEY"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»è°ƒç”¨çš„è§’åº¦è€ƒè™‘ï¼Œæˆ‘ä»¬å‘ç°è¿™ç§æ–¹æ³•ä¸æˆ‘ä»¬çš„æœ€ä½³å®è·µå®Œç¾åœ°åœ¨ç»“åˆä¸€èµ· â€”â€” æ²¡æœ‰å‡ºç°ä¸€ä¸ªç¡¬ç¼–ç çš„å¸¸é‡!</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> url = <span class="type">URL</span>(string: path, relativeTo: <span class="type">API</span>.baseURL)!</span><br><span class="line"><span class="keyword">var</span> request = <span class="type">URLRequest</span>(url: url)</span><br><span class="line">request.httpMethod = method</span><br><span class="line">request.addValue(<span class="type">API</span>.key, forHTTPHeaderField: <span class="string">"X-API-KEY"</span>)</span><br></pre></td></tr></table></figure><blockquote><p>ä¸è¦æŠŠç§å¯†çš„ä¸œè¥¿å†™åœ¨ä»£ç ä¸­ã€‚ç›¸åï¼Œåº”è¯¥å°†å®ƒä»¬å®‰å…¨åœ°å­˜å‚¨åœ¨å¯†ç ç®¡ç†å™¨æˆ–ç±»ä¼¼çš„ä¸œè¥¿ä¸­ã€‚</p></blockquote><blockquote><p>ä¸ºäº†é˜²æ­¢ä½ çš„ç§å¯†è¢«æ³„æ¼åˆ° GitHub ä¸Šï¼Œè¯·å°†ä¸‹åˆ—é…ç½®æ·»åŠ åˆ°ä½ çš„ <code>.gitignore</code> æ–‡ä»¶ä¸­ï¼ˆæ ¹æ®éœ€è¦ï¼‰ï¼š</p></blockquote><blockquote><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; # .gitignore</span><br><span class="line">&gt; Development.xcconfig</span><br><span class="line">&gt; Staging.xcconfig</span><br><span class="line">&gt; Production.xcconfig</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>ä¸€äº›å¼€å‘äººå‘˜å–œæ¬¢ä½¿ç”¨åŒ…å«äº†æ‰€éœ€ key çš„å ä½ç¬¦æ–‡ä»¶ï¼ˆä¾‹å¦‚ Development.sample.xcconfigï¼‰ä»£æ›¿è¿™äº›æ–‡ä»¶ã€‚æ‹‰å–ä»£ç æ—¶ï¼Œå¼€å‘äººå‘˜å†å°†è¯¥æ–‡ä»¶å¤åˆ¶åˆ°éå ä½ç¬¦ä½ç½®ï¼Œå¹¶ç›¸åº”åœ°å¡«å……å®ƒã€‚</p></blockquote><hr><hr><p>Xcode é¡¹ç›®æ˜¯åºå¤§ã€è„†å¼±çš„å’Œä¸é€æ˜çš„ã€‚å®ƒä»¬æ˜¯å›¢é˜Ÿæˆå‘˜åˆä½œæ—¶æ‘©æ“¦çš„æ¥æºï¼Œä¹Ÿå¸¸å¸¸æ˜¯å·¥ä½œçš„ç´¯èµ˜ã€‚</p><p>å¹¸è¿çš„æ˜¯ï¼Œ<code>xcconfig</code> æ–‡ä»¶å¾ˆå¥½åœ°è§£å†³äº†è¿™äº›ç—›ç‚¹ã€‚å°†é…ç½®ä» Xcode ç§»åˆ° <code>xcconfig</code> æ–‡ä»¶å¸¦æ¥äº†å¾ˆå¤šå¥½å¤„ï¼Œå¯ä»¥è®©ä½ çš„é¡¹ç›®ä¸ Xcode çš„ç»†èŠ‚ä¿æŒä¸€å®šè·ç¦»ï¼Œä¸å—è‹¹æœå…¬å¸çš„æ£è‚˜ã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šMatttï¼Œ&lt;a href=&quot;https://nshipster.com/xcconfig/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2019-05-13&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://github.com/mobilefellow&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;é›¨è°¨&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://numbbbbb.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;numbbbbb&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://github.com/WAMaker&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;WAMaker&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/Pancf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Pancf&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;è½¯ä»¶å¼€å‘æœ€ä½³å®è·µ &lt;a href=&quot;https://12factor.net/config&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è§„å®šäº†&lt;/a&gt; é…ç½®ä¸ä»£ç çš„ä¸¥æ ¼åˆ†ç¦»ã€‚ç„¶è€Œï¼Œè‹¹æœå¹³å°ä¸Šçš„å¼€å‘äººå‘˜å¸¸å¸¸éš¾ä»¥å°†è¿™äº›æŒ‡å¯¼åŸåˆ™ä¸ Xcode ç¹é‡çš„é¡¹ç›®å·¥ä½œæµç¨‹ç»“åˆèµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;äº†è§£æ¯ä¸ªé¡¹ç›®è®¾ç½®çš„åŠŸèƒ½ä»¥åŠå®ƒä»¬ä¹‹é—´å¦‚ä½•äº¤äº’ï¼Œæ˜¯ä¸€é¡¹éœ€è¦å¤šå¹´ç£¨ç»ƒçš„æŠ€èƒ½ã€‚ä½† Xcode å°†å¤§éƒ¨åˆ†çš„è¿™ç±»ä¿¡æ¯éƒ½éƒ½æ·±åŸ‹åœ¨å…¶å›¾å½¢åŒ–ç•Œé¢ä¸­ï¼Œè¿™å¯¹æˆ‘ä»¬æ²¡æœ‰ä»»ä½•å¥½å¤„ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Swift" scheme="https://swift.gg/categories/Swift/"/>
    
      <category term="NSHipster" scheme="https://swift.gg/categories/Swift/NSHipster/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
      <category term="NSHipster" scheme="https://swift.gg/tags/NSHipster/"/>
    
  </entry>
  
  <entry>
    <title>Swift 5 å­—ç¬¦ä¸²æ’å€¼-AttributedStrings</title>
    <link href="https://swift.gg/2019/10/18/swift5-stringinterpolation-part2/"/>
    <id>https://swift.gg/2019/10/18/swift5-stringinterpolation-part2/</id>
    <published>2019-10-18T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šOlivier Halligonï¼Œ<a href="http://alisoftware.github.io/swift/2018/12/16/swift5-stringinterpolation-part2" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-12-16<br>è¯‘è€…ï¼š<a href="https://nemocdz.github.io/" target="_blank" rel="noopener">Nemocdz</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><hr> <!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>æˆ‘ä»¬å·²ç»åœ¨ <a href="https://swift.gg/2019/04/22/swift5-stringinterpolation-part1/">å‰æ–‡</a> é‡Œä»‹ç»äº† Swift 5 å…¨æ–°çš„ StringInterpolation è®¾è®¡ã€‚åœ¨è¿™ç¬¬äºŒéƒ¨åˆ†ä¸­ï¼Œæˆ‘ä¼šç€çœ¼äº <code>ExpressibleByStringInterpolation</code> å…¶ä¸­ä¸€ç§åº”ç”¨ï¼Œè®© <code>NSAttributedString</code> å˜å¾—æ›´ä¼˜é›…ã€‚</p> <a id="more"></a><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨çœ‹åˆ° <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0228-fix-expressiblebystringinterpolation.md" target="_blank" rel="noopener">Swift 5 è¿™ä¸ªå…¨æ–°çš„ StringInterpolation è®¾è®¡</a> æ—¶ï¼Œæˆ‘é©¬ä¸Šæƒ³åˆ°çš„åº”ç”¨ä¹‹ä¸€å°±æ˜¯ç®€åŒ– <code>NSAttributedString</code> çš„ç”Ÿæˆã€‚</p><p>æˆ‘çš„ç›®æ ‡æ˜¯åšåˆ°ç”¨ç±»ä¼¼ä¸‹é¢çš„è¯­æ³•åˆ›å»ºä¸€ä¸ª attributed å­—ç¬¦ä¸²ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> username = <span class="string">"AliGator"</span></span><br><span class="line"><span class="keyword">let</span> str: <span class="type">AttrString</span> = <span class="string">"""</span></span><br><span class="line"><span class="string">  Hello \(username, .color(.red)), isn't this \("cool", .color(.blue), .oblique, .underline(.purple, .single))?</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  \(wrap: """</span></span><br><span class="line">    \(<span class="string">" Merry Xmas! "</span>, .font(.systemFont(ofSize: <span class="number">36</span>)), .color(.red), .bgColor(.yellow))</span><br><span class="line">    \(image: #imageLiteral(resourceName: <span class="string">"santa.jpg"</span>), scale: <span class="number">0.2</span>)</span><br><span class="line">    <span class="string">""", .alignment(.center))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Go there to \("learn more about String Interpolation", .link("https://github.com/apple/swift-evolution/blob/master/proposals/0228-fix-expressiblebystringinterpolation.md"), .underline(.blue, .single))!</span></span><br><span class="line"><span class="string">  """</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸€å¤§ä¸²å­—ç¬¦ä¸²ä¸ä»…ä½¿ç”¨äº†å¤šè¡Œå­—ç¬¦ä¸²çš„å­—é¢é‡è¯­æ³•ï¼ˆ<a href="https://github.com/apple/swift-evolution/blob/master/proposals/0168-multi-line-string-literals.md" target="_blank" rel="noopener">é¡ºå¸¦ä¸€æï¼Œè¿™ä¸ªç‰¹æ€§æ˜¯åœ¨ Swift4 ä¸­æ–°å¢çš„ï¼Œä»¥å…ä½ é”™è¿‡äº†</a>ï¼‰ â€”â€”è€Œä¸”åœ¨å…¶ä¸­ä¸€ä¸ªå¤šè¡Œå­—ç¬¦ä¸²å­—é¢é‡ä¸­åŒ…å«äº†å¦ä¸€ä¸ª(è§ <code>\(wrap: ...)</code> æ®µè½ï¼‰ï¼- ç”šè‡³è¿˜åŒ…å«äº†ç»™ä¸€éƒ¨åˆ†å­—ç¬¦æ·»åŠ ä¸€äº›æ ·å¼çš„æ’å€¼â€¦â€¦æ‰€ä»¥ç”±å¤§é‡ Swift æ–°ç‰¹æ€§ç»„åˆè€Œæˆï¼</p><p>è¿™ä¸ª <code>NSAttributedString</code> å¦‚æœåœ¨ä¸€ä¸ª <code>UILabel</code> æˆ–è€… <code>NSTextView</code> ä¸­æ¸²æŸ“ï¼Œç»“æœæ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p><p><img src="http://alisoftware.github.io/assets/StringInterpolation-AttrString.png" alt="image"></p><p>â˜ï¸ æ˜¯çš„ï¼Œä¸Šé¢çš„æ–‡å­—å’Œå›¾ç‰‡â€¦â€¦çœŸçš„<strong>åª</strong>æ˜¯ä¸€ä¸ª <code>NSAttributedString</code>(è€Œä¸æ˜¯ä¸€ä¸ªå¤æ‚çš„è§†å›¾å¸ƒå±€æˆ–è€…å…¶ä»–)ï¼ ğŸ¤¯</p><h2 id="åˆæ­¥å®ç°"><a href="#åˆæ­¥å®ç°" class="headerlink" title="åˆæ­¥å®ç°"></a>åˆæ­¥å®ç°</h2><p>æ‰€ä»¥ï¼Œä»å“ªé‡Œå¼€å§‹å®ç°ï¼Ÿå½“ç„¶å’Œç¬¬ä¸€éƒ¨åˆ†ä¸­å¦‚ä½•å®ç° <code>GitHubComment</code> å·®ä¸å¤šï¼</p><p>å¥½çš„ï¼Œåœ¨å®é™…è§£å†³å­—ç¬¦ä¸²æ’å€¼ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»å£°æ˜ç‰¹æœ‰ç±»å‹å¼€å§‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AttrString</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> attributedString: <span class="type">NSAttributedString</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AttrString</span>: <span class="title">ExpressibleByStringLiteral</span> </span>&#123;</span><br><span class="line">  <span class="keyword">init</span>(stringLiteral: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.attributedString = <span class="type">NSAttributedString</span>(string: stringLiteral)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AttrString</span>: <span class="title">CustomStringConvertible</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(describing: <span class="keyword">self</span>.attributedString)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒºç®€å•çš„å§ï¼Ÿä»…ä»…ç»™ <code>NSAttributedString</code> å°è£…äº†ä¸€ä¸‹ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·»åŠ  <code>ExpressibleByStringInterpolation</code> çš„æ”¯æŒï¼Œæ¥åŒæ—¶æ”¯æŒå­—é¢é‡å’Œå¸¦ <code>NSAttributedString</code> å±æ€§æ³¨é‡Šçš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AttrString</span>: <span class="title">ExpressibleByStringInterpolation</span> </span>&#123;</span><br><span class="line">  <span class="keyword">init</span>(stringInterpolation: <span class="type">StringInterpolation</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.attributedString = <span class="type">NSAttributedString</span>(attributedString: stringInterpolation.attributedString)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">StringInterpolation</span>: <span class="title">StringInterpolationProtocol</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> attributedString: <span class="type">NSMutableAttributedString</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(literalCapacity: <span class="type">Int</span>, interpolationCount: <span class="type">Int</span>) &#123;</span><br><span class="line">      <span class="keyword">self</span>.attributedString = <span class="type">NSMutableAttributedString</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">appendLiteral</span><span class="params">(<span class="number">_</span> literal: String)</span></span> &#123;</span><br><span class="line">      <span class="keyword">let</span> astr = <span class="type">NSAttributedString</span>(string: literal)</span><br><span class="line">      <span class="keyword">self</span>.attributedString.append(astr)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">appendInterpolation</span><span class="params">(<span class="number">_</span> string: String, attributes: [NSAttributedString.Key: <span class="keyword">Any</span>])</span></span> &#123;</span><br><span class="line">      <span class="keyword">let</span> astr = <span class="type">NSAttributedString</span>(string: string, attributes: attributes)</span><br><span class="line">      <span class="keyword">self</span>.attributedString.append(astr)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶ï¼Œå·²ç»å¯ä»¥ç”¨ä¸‹é¢è¿™ç§æ–¹å¼ç®€å•åœ°æ„å»ºä¸€ä¸ª <code>NSAttributedString</code> äº†ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> user = <span class="string">"AliSoftware"</span></span><br><span class="line"><span class="keyword">let</span> str: <span class="type">AttrString</span> = <span class="string">"""</span></span><br><span class="line"><span class="string">  Hello \(user, attributes: [.foregroundColor: NSColor.blue])!</span></span><br><span class="line"><span class="string">  """</span></span><br></pre></td></tr></table></figure><p>è¿™çœ‹èµ·æ¥å·²ç»ä¼˜é›…å¤šäº†å§ï¼Ÿ</p><h2 id="æ–¹ä¾¿çš„æ ·å¼æ·»åŠ "><a href="#æ–¹ä¾¿çš„æ ·å¼æ·»åŠ " class="headerlink" title="æ–¹ä¾¿çš„æ ·å¼æ·»åŠ "></a>æ–¹ä¾¿çš„æ ·å¼æ·»åŠ </h2><p>ä½†ç”¨å­—å…¸ <code>[NAttributedString.Key: Any]</code> çš„æ–¹å¼å¤„ç†å±æ€§ä¸å¤Ÿä¼˜é›…ã€‚ç‰¹åˆ«æ˜¯ç”±äº <code>Any</code> æ²¡æœ‰æ˜ç¡®ç±»å‹ï¼Œè¦æ±‚äº†è§£æ¯ä¸€ä¸ªé”®å€¼çš„æ˜ç¡®ç±»å‹â€¦â€¦</p><p>æ‰€ä»¥å¯ä»¥é€šè¿‡åˆ›å»ºç‰¹æœ‰çš„ <code>Style</code> ç±»å‹è®©å®ƒå˜å¾—æ›´ä¼˜é›…ï¼Œå¹¶å¸®åŠ©æˆ‘ä»¬æ„å»ºå±æ€§çš„å­—å…¸ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AttrString</span> </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">Style</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> attributes: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>: <span class="type">Any</span>]</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">font</span><span class="params">(<span class="number">_</span> font: NSFont)</span></span> -&gt; <span class="type">Style</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">Style</span>(attributes: [.font: font])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">color</span><span class="params">(<span class="number">_</span> color: NSColor)</span></span> -&gt; <span class="type">Style</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">Style</span>(attributes: [.foregroundColor: color])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">bgColor</span><span class="params">(<span class="number">_</span> color: NSColor)</span></span> -&gt; <span class="type">Style</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">Style</span>(attributes: [.backgroundColor: color])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">link</span><span class="params">(<span class="number">_</span> link: String)</span></span> -&gt; <span class="type">Style</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> .link(<span class="type">URL</span>(string: link)!)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">link</span><span class="params">(<span class="number">_</span> link: URL)</span></span> -&gt; <span class="type">Style</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">Style</span>(attributes: [.link: link])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> oblique = <span class="type">Style</span>(attributes: [.obliqueness: <span class="number">0.1</span>])</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">underline</span><span class="params">(<span class="number">_</span> color: NSColor, <span class="number">_</span> style: NSUnderlineStyle)</span></span> -&gt; <span class="type">Style</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="type">Style</span>(attributes: [</span><br><span class="line">        .underlineColor: color,</span><br><span class="line">        .underlineStyle: style.rawValue</span><br><span class="line">      ])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">alignment</span><span class="params">(<span class="number">_</span> alignment: NSTextAlignment)</span></span> -&gt; <span class="type">Style</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> ps = <span class="type">NSMutableParagraphStyle</span>()</span><br><span class="line">      ps.alignment = alignment</span><br><span class="line">      <span class="keyword">return</span> <span class="type">Style</span>(attributes: [.paragraphStyle: ps])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å…è®¸ä½¿ç”¨ <code>Style.color(.blue)</code> æ¥ç®€å•åœ°åˆ›å»ºä¸€ä¸ªå°è£…äº† <code>[.foregroundColor: NSColor.blue]</code> çš„ <code>Style</code>ã€‚</p><p>å¯åˆ«æ­¢æ­¥äºæ­¤ï¼Œç°åœ¨è®©æˆ‘ä»¬çš„ <code>StringInterpolation</code> å¯ä»¥å¤„ç†ä¸‹é¢è¿™æ ·çš„ <code>Style</code> å±æ€§ï¼</p><p>è¿™ä¸ªæƒ³æ³•æ˜¯å¯ä»¥åšåˆ°åƒè¿™æ ·å†™ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str: <span class="type">AttrString</span> = <span class="string">"""</span></span><br><span class="line"><span class="string">  Hello \(user, .color(.blue)), how do you like this?</span></span><br><span class="line"><span class="string">  """</span></span><br></pre></td></tr></table></figure><p>æ˜¯ä¸æ˜¯æ›´ä¼˜é›…ï¼Ÿè€Œæˆ‘ä»¬ä»…ä»…éœ€è¦ä¸ºå®ƒæ­£ç¡®å®ç° <code>appendInterpolation</code> è€Œå·²ï¼</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AttrString</span>.<span class="title">StringInterpolation</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">appendInterpolation</span><span class="params">(<span class="number">_</span> string: String, <span class="number">_</span> style: AttrString.Style)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> astr = <span class="type">NSAttributedString</span>(string: string, attributes: style.attributes)</span><br><span class="line">    <span class="keyword">self</span>.attributedString.append(astr)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å®Œæˆäº†ï¼ä½†â€¦â€¦è¿™æ ·ä¸€æ¬¡åªæ”¯æŒä¸€ä¸ª <code>Style</code>ã€‚ä¸ºä»€ä¹ˆä¸å…è®¸å®ƒä¼ å…¥å¤šä¸ª <code>Style</code> ä½œä¸ºå½¢å‚å‘¢ï¼Ÿè¿™å¯ä»¥ç”¨ä¸€ä¸ª <code>[Style]</code> å½¢å‚æ¥å®ç°ï¼Œä½†è¿™è¦æ±‚è°ƒç”¨ä¾§å°†æ ·å¼åˆ—è¡¨ç”¨æ‹¬å·æ‹¬èµ·æ¥â€¦â€¦ä¸å¦‚è®©å®ƒä½¿ç”¨å¯å˜å½¢å‚ï¼Ÿ</p><p>è®©æˆ‘ä»¬ç”¨è¿™ç§æ–¹å¼æ¥ä»£æ›¿ä¹‹å‰çš„å®ç°ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AttrString</span>.<span class="title">StringInterpolation</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">appendInterpolation</span><span class="params">(<span class="number">_</span> string: String, <span class="number">_</span> style: AttrString.Style...)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> attrs: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>: <span class="type">Any</span>] = [:]</span><br><span class="line">    style.forEach &#123; attrs.merge($<span class="number">0</span>.attributes, uniquingKeysWith: &#123;$<span class="number">1</span>&#125;) &#125;</span><br><span class="line">    <span class="keyword">let</span> astr = <span class="type">NSAttributedString</span>(string: string, attributes: attrs)</span><br><span class="line">    <span class="keyword">self</span>.attributedString.append(astr)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨å¯ä»¥å°†å¤šç§æ ·å¼æ··åˆèµ·æ¥äº†ï¼</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str: <span class="type">AttrString</span> = <span class="string">"""</span></span><br><span class="line"><span class="string">  Hello \(user, .color(.blue), .underline(.red, .single)), how do you like this?</span></span><br><span class="line"><span class="string">  """</span></span><br></pre></td></tr></table></figure><h2 id="æ”¯æŒå›¾åƒ"><a href="#æ”¯æŒå›¾åƒ" class="headerlink" title="æ”¯æŒå›¾åƒ"></a>æ”¯æŒå›¾åƒ</h2><p><code>NSAttributedString</code> çš„å¦ä¸€ç§èƒ½åŠ›æ˜¯ä½¿ç”¨ <code>NSAttributedString(attachment: NSTextAttachment)</code> æ·»åŠ å›¾åƒï¼Œè®©å®ƒæˆä¸ºå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚è¦å®ç°å®ƒï¼Œä»…éœ€è¦å®ç° <code>appendInterpolation(image: NSImage)</code> å¹¶è°ƒç”¨å®ƒã€‚</p><p>æˆ‘å¸Œæœ›ä¸ºè¿™ä¸ªç‰¹æ€§é¡ºä¾¿åŠ ä¸Šç¼©æ”¾å›¾åƒçš„èƒ½åŠ›ã€‚ç”±äºæˆ‘æ˜¯åœ¨ macOS çš„ playground ä¸Šå°è¯•çš„ï¼Œå®ƒçš„å›¾å½¢ä¸Šä¸‹æ–‡æ˜¯ç¿»è½¬çš„ï¼Œæ‰€ä»¥ä¹Ÿå¾—å°†å›¾åƒç¿»è½¬å›æ¥ï¼ˆæ³¨æ„è¿™ä¸ªç»†èŠ‚å¯èƒ½ä¼šå’Œ iOS ä¸Šå®ç°å¯¹ UIImage çš„æ”¯æŒæ—¶ä¸ä¸€æ ·ï¼‰ã€‚è¿™é‡Œæ˜¯æˆ‘çš„åšæ³•ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AttrString</span>.<span class="title">StringInterpolation</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">appendInterpolation</span><span class="params">(image: NSImage, scale: CGFloat = <span class="number">1.0</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> attachment = <span class="type">NSTextAttachment</span>()</span><br><span class="line">    <span class="keyword">let</span> size = <span class="type">NSSize</span>(</span><br><span class="line">      width: image.size.width * scale,</span><br><span class="line">      height: image.size.height * scale</span><br><span class="line">    )</span><br><span class="line">    attachment.image = <span class="type">NSImage</span>(size: size, flipped: <span class="literal">false</span>, drawingHandler: &#123; (rect: <span class="type">NSRect</span>) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></span><br><span class="line">      <span class="type">NSGraphicsContext</span>.current?.cgContext.translateBy(x: <span class="number">0</span>, y: size.height)</span><br><span class="line">      <span class="type">NSGraphicsContext</span>.current?.cgContext.scaleBy(x: <span class="number">1</span>, y: -<span class="number">1</span>)</span><br><span class="line">      image.draw(<span class="keyword">in</span>: rect)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">self</span>.attributedString.append(<span class="type">NSAttributedString</span>(attachment: attachment))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ ·å¼åµŒå¥—"><a href="#æ ·å¼åµŒå¥—" class="headerlink" title="æ ·å¼åµŒå¥—"></a>æ ·å¼åµŒå¥—</h2><p>æœ€åï¼Œæœ‰æ—¶å€™ä½ ä¼šå¸Œæœ›åº”ç”¨ä¸€ä¸ªæ ·å¼åœ¨ä¸€å¤§æ®µæ–‡å­—ä¸Šï¼Œä½†é‡Œé¢å¯èƒ½ä¹ŸåŒ…å«äº†å­æ®µè½çš„æ ·å¼ã€‚å°±åƒ HTML é‡Œçš„ <code>&quot;&lt;b&gt;Hello &lt;i&gt;world&lt;/i&gt;&lt;/b&gt;&quot;</code>ï¼Œæ•´æ®µæ˜¯ç²—ä½“ä½†åŒ…å«äº†ä¸€éƒ¨åˆ†æ–œä½“çš„ã€‚</p><p>ç°åœ¨æˆ‘ä»¬çš„ API è¿˜ä¸æ”¯æŒè¿™æ ·ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ¥åŠ ä¸Šå®ƒã€‚æ€è·¯æ˜¯å…è®¸å°†ä¸€ä¸² <code>Styleâ€¦</code> ä¸æ­¢åº”ç”¨åœ¨ <code>String</code> ä¸Šï¼Œè¿˜èƒ½åº”ç”¨åœ¨å·²ç»å­˜åœ¨å±æ€§çš„ <code>AttrString</code> ä¸Šã€‚</p><p>è¿™ä¸ªå®ç°å’Œ <code>appendInterpolation(_ string: String, _ style: Styleâ€¦)</code> ç›¸ä¼¼ï¼Œä½†ä¼šä¿®æ”¹ <code>AttrString.attributedString</code> æ¥<em>æ·»åŠ </em>å±æ€§åˆ°ä¸Šé¢ï¼Œè€Œä¸æ˜¯å•çº¯ç”¨ <code>String</code> åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ <code>NSAttributedString</code>ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AttrString</span>.<span class="title">StringInterpolation</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">func</span> <span class="title">appendInterpolation</span><span class="params">(wrap string: AttrString, <span class="number">_</span> style: AttrString.Style...)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> attrs: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>: <span class="type">Any</span>] = [:]</span><br><span class="line">    style.forEach &#123; attrs.merge($<span class="number">0</span>.attributes, uniquingKeysWith: &#123;$<span class="number">1</span>&#125;) &#125;</span><br><span class="line">    <span class="keyword">let</span> mas = <span class="type">NSMutableAttributedString</span>(attributedString: string.attributedString)</span><br><span class="line">    <span class="keyword">let</span> fullRange = <span class="type">NSRange</span>(mas.string.startIndex..&lt;mas.string.endIndex, <span class="keyword">in</span>: mas.string)</span><br><span class="line">    mas.addAttributes(attrs, range: fullRange)</span><br><span class="line">    <span class="keyword">self</span>.attributedString.append(mas)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™äº›å…¨éƒ¨å®Œæˆä¹‹åï¼Œç›®æ ‡å°±è¾¾æˆäº†ï¼Œç»ˆäºå¯ä»¥ç”¨å•çº¯çš„å­—ç¬¦ä¸²åŠ ä¸Šæ’å€¼åˆ›å»ºä¸€ä¸ª AttributedStringï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> username = <span class="string">"AliGator"</span></span><br><span class="line"><span class="keyword">let</span> str: <span class="type">AttrString</span> = <span class="string">"""</span></span><br><span class="line"><span class="string">  Hello \(username, .color(.red)), isn't this \("cool", .color(.blue), .oblique, .underline(.purple, .single))?</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  \(wrap: """</span></span><br><span class="line">    \(<span class="string">" Merry Xmas! "</span>, .font(.systemFont(ofSize: <span class="number">36</span>)), .color(.red), .bgColor(.yellow))</span><br><span class="line">    \(image: #imageLiteral(resourceName: <span class="string">"santa.jpg"</span>), scale: <span class="number">0.2</span>)</span><br><span class="line">    <span class="string">""", .alignment(.center))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Go there to \("learn more about String Interpolation", .link("https://github.com/apple/swift-evolution/blob/master/proposals/0228-fix-expressiblebystringinterpolation.md"), .underline(.blue, .single))!</span></span><br><span class="line"><span class="string">  """</span></span><br></pre></td></tr></table></figure><p><img src="http://alisoftware.github.io/assets/StringInterpolation-AttrString.png" alt="imgage"></p><h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>æœŸå¾…ä½ äº«å—è¿™ä¸€ç³»åˆ— <code>StringInterpolation</code> æ–‡ç« ï¼Œå¹¶ä¸”èƒ½ä»ä¸­ç¥åˆ°è¿™ä¸ªæ–°è®¾è®¡å¨åŠ›çš„å†°å±±ä¸€è§’ã€‚</p><p>ä½ å¯ä»¥ <a href="http://alisoftware.github.io/assets/StringInterpolation.playground.zip" target="_blank" rel="noopener">åœ¨è¿™ä¸‹è½½æˆ‘çš„ Playground æ–‡ä»¶</a>ï¼Œé‡Œé¢æœ‰ <code>GitHubComment</code>(è§ <a href="http://alisoftware.github.io/swift/2018/12/15/swift5-stringinterpolation-part1/" target="_blank" rel="noopener">ç¬¬ä¸€éƒ¨åˆ†</a>)ï¼Œ<code>AttrString</code> çš„å…¨éƒ¨å®ç°ï¼Œè¯´ä¸å®šè¿˜èƒ½ä»æˆ‘ç®€å•å®ç° <code>RegEX</code> çš„å°è¯•ä¸­å¾—åˆ°ä¸€äº›çµæ„Ÿã€‚</p><p>è¿™é‡Œè¿˜æœ‰æ›´å¤šæ›´å¥½çš„æ€è·¯å»ä½¿ç”¨ Swift 5 ä¸­æ–°çš„ <code>ExpressibleByStringInterpolation</code> API - åŒ…æ‹¬ <a href="https://ericasadun.com/2018/12/12/the-beauty-of-swift-5-string-interpolation/" target="_blank" rel="noopener">Erica Sadun åšå®¢é‡Œè¿™ç¯‡</a>ã€<a href="https://ericasadun.com/2018/12/14/more-fun-with-swift-5-string-interpolation-radix-formatting/" target="_blank" rel="noopener">è¿™ç¯‡</a> å’Œ <a href="https://ericasadun.com/2018/12/16/swift-5-interpolation-part-3-dates-and-number-formatters/" target="_blank" rel="noopener">è¿™ç¯‡</a> - è¿˜åœ¨çŠ¹è±«ä»€ä¹ˆï¼Œé˜…è¯»æ›´å¤šâ€¦â€¦ä»ä¸­æ„Ÿå—ä¹è¶£å§ï¼</p><hr><ol><li>è¿™ç¯‡æ–‡ç« å’Œ Playground é‡Œçš„ä»£ç ï¼Œéœ€è¦ä½¿ç”¨ Swift 5ã€‚åœ¨å†™ä½œæ—¶ï¼Œæœ€æ–°çš„ Xcode ç‰ˆæœ¬æ˜¯ 10.1ï¼ŒSwift 4.2ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³å°è¯•è¿™äº›ä»£ç ï¼Œéœ€è¦éµå¾ªå®˜æ–¹æŒ‡å—å»ä¸‹è½½å¼€å‘ä¸­çš„ Swift 5 å¿«ç…§ã€‚å®‰è£… Swift 5 å·¥å…·é“¾å¹¶åœ¨ Xcode åå¥½è®¾ç½®é‡Œå¯ç”¨å¹¶ä¸å›°éš¾(è§å®˜æ–¹æŒ‡å—)ã€‚</li><li>å½“ç„¶ï¼Œè¿™é‡Œä»…ä½œä¸º Demoï¼Œåªå®ç°äº†ä¸€éƒ¨åˆ†æ ·å¼ã€‚æœªæ¥å¯ä»¥å»¶ä¼¸æ€è·¯è®© <code>Style</code> ç±»å‹æ”¯æŒæ›´å¤šçš„æ ·å¼ï¼Œåœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œå¯ä»¥è¦†ç›–æ‰€æœ‰å­˜åœ¨ <code>NSAttributedString.Key</code>ã€‚</li></ol><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šOlivier Halligonï¼Œ&lt;a href=&quot;http://alisoftware.github.io/swift/2018/12/16/swift5-stringinterpolation-part2&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-12-16&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://nemocdz.github.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Nemocdz&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://numbbbbb.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;numbbbbb&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://github.com/WAMaker&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;WAMaker&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/Pancf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Pancf&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
 &lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»åœ¨ &lt;a href=&quot;https://swift.gg/2019/04/22/swift5-stringinterpolation-part1/&quot;&gt;å‰æ–‡&lt;/a&gt; é‡Œä»‹ç»äº† Swift 5 å…¨æ–°çš„ StringInterpolation è®¾è®¡ã€‚åœ¨è¿™ç¬¬äºŒéƒ¨åˆ†ä¸­ï¼Œæˆ‘ä¼šç€çœ¼äº &lt;code&gt;ExpressibleByStringInterpolation&lt;/code&gt; å…¶ä¸­ä¸€ç§åº”ç”¨ï¼Œè®© &lt;code&gt;NSAttributedString&lt;/code&gt; å˜å¾—æ›´ä¼˜é›…ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Crunchy Development" scheme="https://swift.gg/categories/Crunchy-Development/"/>
    
    
      <category term="Swift è¿›é˜¶ï¼ŒSwift" scheme="https://swift.gg/tags/Swift-%E8%BF%9B%E9%98%B6%EF%BC%8CSwift/"/>
    
  </entry>
  
  <entry>
    <title>Chris Lattner è®²è¿° Swift èµ·æºæ•…äº‹</title>
    <link href="https://swift.gg/2019/10/16/chris-lattner-swift-origins/"/>
    <id>https://swift.gg/2019/10/16/chris-lattner-swift-origins/</id>
    <published>2019-10-16T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šOle Begemannï¼Œ<a href="https://oleb.net/2019/chris-lattner-swift-origins/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2019-02-18<br>è¯‘è€…ï¼š<a href="https://dingtz.com/" target="_blank" rel="noopener">jojotov</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>åœ¨ <a href="https://www.swiftcommunitypodcast.org/episodes/1" target="_blank" rel="noopener">æ–°æ¨å‡ºçš„ Swift ç¤¾åŒºæ’­å®¢ç¬¬ä¸€é›†</a> ä¸­ï¼Œ<a href="http://nondot.org/sabre/" target="_blank" rel="noopener">Chris Lattner</a>, <a href="https://garricn.com/" target="_blank" rel="noopener">Garric Nahapetian</a>, å’Œ <a href="https://www.swiftbysundell.com/" target="_blank" rel="noopener">John Sundell</a> è®²è¿°äº†å…³äº Swift èµ·æºçš„æ•…äº‹å’Œ Swift ç¤¾åŒºçš„ç°çŠ¶ã€‚</p><p>æœ¬æ–‡æ˜¯æˆ‘æ•´ç†å‡ºçš„ä¸€äº›æ¯”è¾ƒæœ‰è¶£çš„ä¸œè¥¿ï¼ˆä¸ºäº†èƒ½æ›´å¥½åœ°é˜…è¯»è€Œåšäº†éƒ¨åˆ†ä¿®æ”¹ï¼‰ã€‚ä½ å¯ä»¥çœ‹åˆ°æˆ‘ä¸»è¦å¼•ç”¨äº† Chris Lattner çš„è®²è¯ï¼Œå› ä¸ºæˆ‘è®¤ä¸ºä»–å¯¹äº Swift æ˜¯å¦‚ä½•è¢«åˆ›é€ å‡ºæ¥çš„æè¿°æ˜¯æœ€å€¼å¾—ä¿ç•™ä¸‹å»çš„ã€‚ä½†è¿™å¹¶ä¸ä»£è¡¨ John å’Œ Garric æ‰€è¯´çš„ä¸œè¥¿æ²¡é‚£ä¹ˆæœ‰è¶£ã€‚ä½ çœŸçš„åº”è¯¥å»å®Œæ•´åœ°æ”¶å¬æ•´é›†æ’­å®¢â€”â€”åæ­£æ‰€èŠ±çš„æ—¶é—´å’Œé˜…è¯»æœ¬æ–‡ç›¸å·®æ— å‡ ã€‚</p><a id="more"></a><p><a href="https://www.swiftcommunitypodcast.org/" target="_blank" rel="noopener">Swift ç¤¾åŒºæ’­å®¢</a> æœ¬èº«ä¹Ÿéå¸¸å€¼å¾—å…³æ³¨ã€‚ä½œä¸ºä¸€ä¸ªè®©ä½ å¯ä»¥é€šè¿‡å„ç§æ–¹å¼è¿›è¡Œè´¡çŒ®çš„é¡¹ç›®ï¼Œå®ƒéå¸¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼ˆä¸Šé¢æåˆ°çš„ä¸‰ä½å˜‰å®¾åœ¨ç¬¬ä¸€é›†ä¸­è°ˆåˆ°äº†æ›´å¤šç»†èŠ‚ï¼‰ã€‚åœ¨æœ¬æ–‡çš„å®Œæˆè¿‡ç¨‹ä¸­ï¼Œæˆ‘çš„å·¥ä½œä¸»è¦åœ¨ <a href="https://github.com/SwiftCommunityPodcast/podcast/issues/15" target="_blank" rel="noopener">creating the transcript</a> è¿™ä¸ª Issue ä¸Šè¿›è¡Œï¼Œç”šè‡³åœ¨ä»£ç æ ¼å¼éƒ¨åˆ†å’Œç¼–è¾‘æœºå™¨ç”Ÿæˆçš„æ–‡æœ¬éƒ¨åˆ†æ”¶åˆ°äº†è®¸å¤šæ¥è‡ªäºç¤¾åŒºçš„å¸®åŠ©ã€‚åœ¨æ­¤å¯¹æ‰€æœ‰æä¾›è¿‡å¸®åŠ©çš„äººè¡¨ç¤ºæ„Ÿè°¢ï¼</p><p>ä½ å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ° <a href="https://github.com/SwiftCommunityPodcast/podcast/blob/master/Shownotes/Episode1-Transcript.vtt" target="_blank" rel="noopener">å®Œæ•´çš„è®°å½•å‰¯æœ¬</a>ï¼ˆ<a href="https://en.wikipedia.org/wiki/WebVTT" target="_blank" rel="noopener">WebVTT æ ¼å¼</a>ï¼‰ã€‚æ‰€æœ‰çš„æ’­å®¢éƒ½æ˜¯ç”± <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener">CC-BY 4.0</a> æˆæƒã€‚</p><hr><h2 id="Swift-çš„èµ·æº"><a href="#Swift-çš„èµ·æº" class="headerlink" title="Swift çš„èµ·æº"></a>Swift çš„èµ·æº</h2><p><em>ï¼ˆå¼€å§‹äº 16:59ï¼‰</em></p><blockquote><p><strong>Crhis Lattner:</strong> å…³äºè¿™ä»¶äº‹ï¼Œæˆ‘å¿…é¡»ä» <a href="https://en.wikipedia.org/wiki/Apple_Worldwide_Developers_Conference" target="_blank" rel="noopener">WWDC</a> 2010 å¼€å§‹è®²èµ·ã€‚å½“æ—¶æˆ‘ä»¬åˆšåˆšä¸Šçº¿äº† <a href="https://en.wikipedia.org/wiki/Clang" target="_blank" rel="noopener">Clang</a> å¯¹ <a href="https://en.wikipedia.org/wiki/C%2B%2B" target="_blank" rel="noopener">C++</a> çš„æ”¯æŒï¼Œéå¸¸å¤šçš„äººåœ¨è¿™ä»¶äº‹ä¸Šé¢èŠ±è´¹äº†æå…¶å·¨å¤§çš„ç²¾åŠ›ã€‚æˆ‘å¯¹è¿™ä»¶äº‹æ„Ÿåˆ°éå¸¸å¼€å¿ƒçš„åŒæ—¶ï¼Œä¹Ÿæœ‰ä¸€äº›çƒ¦èºï¼Œå› ä¸ºæˆ‘ä»¬åšäº†å¤ªå¤šçš„ç»†èŠ‚å·¥ä½œã€‚è€Œä¸”ä½ å¾ˆéš¾ä¸ç»è¿‡æ€è€ƒç›´æ¥ç¼–å†™ C++ ä»£ç ï¼Œâ€œå¤©å‘ï¼Œåº”è¯¥æœ‰æ¯”ç°åœ¨æ›´å¥½çš„å®ç°æ–¹æ³•å§ï¼â€</p><p>å› æ­¤ï¼Œæˆ‘ä¸ä¸€ä¸ªå« <a href="https://en.wikipedia.org/wiki/Bertrand_Serlet" target="_blank" rel="noopener">Bertrand Serlet</a> çš„å“¥ä»¬å„¿è¿›è¡Œäº†è®¸å¤šæ¬¡è®¨è®ºã€‚Bertrand å½“æ—¶æ˜¯è½¯ä»¶å›¢é˜Ÿçš„è€å¤§ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä½å‡ºç±»æ‹”èƒçš„å·¥ç¨‹å¸ˆã€‚ä»–æ˜¯ä¸€ä¸ªä»¤äººæƒŠå¹çš„äººï¼Œå¹¶ä¸”åœ¨è¯­è¨€æ–¹é¢æœ‰ç‚¹æå®¢èŒƒã€‚å½“æ—¶ä»–æ­£åœ¨æ¨è¿›å¯¹ <a href="https://en.wikipedia.org/wiki/Objective-C" target="_blank" rel="noopener">Objective-C</a> çš„ä¼˜åŒ–å·¥ä½œã€‚æˆ‘å’Œä»–è¿›è¡Œäº†è®¸å¤šæ¬¡ä¸€å¯¹ä¸€çš„ç™½æ¿ä¼šè®®ã€‚</p><blockquote><p>At the time, Swift was called â€˜Shinyâ€™.<br>åœ¨é‚£æ—¶ï¼ŒSwift è¿˜å« â€˜Shinyâ€™</p></blockquote><p>Bertrand è´Ÿè´£è‹¹æœå…¬å¸æ‰€æœ‰çš„è½¯ä»¶é¡¹ç›®ï¼Œå› æ­¤ä»–åŸºæœ¬æ²¡ä»€ä¹ˆæ—¶é—´ã€‚ä½†ä»–æ€»æ˜¯ä¼šè®©æˆ‘åœ¨å·¥ä½œç»“æŸæ—¶é¡ºä¾¿æ‹œè®¿ä¸€ä¸‹ä»–ï¼Œçœ‹ä»–æ˜¯ä¸æ˜¯æœ‰ç©ºã€‚ä»–ç»å¸¸ä¼šå‘†åˆ°å¾ˆæ™šï¼Œç„¶åæˆ‘ä»¬ä¼šåœ¨ç™½æ¿ä¸Šè¿›è¡Œéå¸¸è®¤çœŸçš„è®¨è®ºã€‚æˆ‘ä»¬ä¼šè°ˆè®ºéå¸¸éå¸¸å¤šçš„ä¸œè¥¿ï¼šæ–°è¯­è¨€è¦è¾¾æˆçš„ç›®æ ‡ã€ä¸€äº›å¥‡æ€ªçš„ç»†èŠ‚å¦‚ç±»å‹ç³»ç»Ÿï¼Œå¹¶ä¸”æˆ‘ä»¬æœ€ç»ˆéƒ½ä¼šæŠŠè¿™äº›è®¨è®ºå˜æˆä¸€ä»½è®¡åˆ’ä¹¦ã€‚å› æ­¤æˆ‘ä¸ºä»–åšäº†è¿™ä»½è®¡åˆ’ä¹¦å¹¶æ¼”å˜æˆæ„å»ºä¸€ä¸ªæ–°è¯­è¨€çš„æƒ³æ³•ã€‚é‚£æ—¶è¿™ä¸ªæ–°è¯­è¨€è¿˜å«åš â€œShinyâ€ï¼Œå¯“æ„ç€ä½ æ­£åœ¨å»ºé€ ä¸€ä¸ª <a href="https://www.youtube.com/watch?v=8q_lsRLJhcA" target="_blank" rel="noopener">å¾ˆé…·çš„</a> æ–°ä¸œè¥¿ã€‚[^1] å½“ç„¶æˆ‘ä¹Ÿæ˜¯ Firefly ç”µè§†èŠ‚ç›®çš„ç²‰ä¸ä¹‹ä¸€ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šâ€Shinyâ€ çš„æ¢—æºè‡ª 2002 å¹´ç¾å›½ç”µè§†èŠ‚ç›® <a href="https://en.wikipedia.org/wiki/Firefly_(TV_series" target="_blank" rel="noopener">Firefly</a>)ï¼Œæ„æ€ç›¸å½“äºçœŸå®ä¸–ç•Œä¸­çš„ â€œcoolâ€ã€‚ï¼‰</p><p><strong>John Sundell:</strong> å½“æ—¶çš„æ–‡ä»¶åç¼€æ˜¯ <code>.shiny</code> å—ï¼Ÿ</p><p><strong>Chris Lattner:</strong> ç¡®å®å¦‚æ­¤ã€‚ä½ çŸ¥é“åœ¨é‚£ä¸ªæ—¶å€™ï¼Œè¿™è¿˜æ˜¯ä¸ªå¾ˆå°å‹çš„é¡¹ç›®ã€‚çœŸçš„å°±åªæœ‰æˆ‘å’Œ Bertrand åœ¨è®¨è®ºè¿™ä»¶äº‹ã€‚å¦å¤–å°±åªæœ‰ä¸€ä¸ªåŒæ ·éå¸¸å‡ºè‰²çš„å·¥ç¨‹å¸ˆ <a href="https://github.com/davezarzycki" target="_blank" rel="noopener">Dave Zarzycki</a> å‚ä¸äº†æ—©æœŸçš„ä¸€äº›æ¦‚å¿µä¸Šçš„è®¨è®ºã€‚</p><p>ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬å°±è‡ªç„¶è€Œç„¶åœ°å±•å¼€äº†å…³äºå†…å­˜ç®¡ç†çš„è®¨è®ºã€‚å½“æ—¶ï¼Œæˆ‘ä»¬éƒ½ç¡®ä¿¡ä¸€ç‚¹å°±æ˜¯ï¼šå¿…é¡»è¦æœ‰ä¸€ä¸ªå¥½çš„æ–¹æ³•æ¥è§£å†³æˆ–æ”¹å–„å†…å­˜ç®¡ç†ï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦ç¡®ä¿ <a href="https://docs.swift.org/swift-book/LanguageGuide/MemorySafety.html" target="_blank" rel="noopener">å†…å­˜å®‰å…¨</a>ã€‚å› è€Œï¼Œä½ å¿…é¡»æœ‰ä¸€ä¸ªè‡ªåŠ¨å†…å­˜ç®¡ç†åŠŸèƒ½ã€‚</p><blockquote><p>ä¸ºäº†è¾¾åˆ°è‡ªåŠ¨å†…å­˜ç®¡ç†çš„ç›®æ ‡ï¼Œæˆ‘ä»¬æœ‰å²ä»¥æ¥ç¬¬ä¸€æ¬¡ä»¥ Swift çš„å†…éƒ¨è®¾è®¡è®¨è®ºä¸ºèµ·ç‚¹ï¼Œå¹¶æœ€ç»ˆåœ¨ Objective-C ä¸­å®ç°äº†æ­¤ç‰¹æ€§ã€‚</p></blockquote><p>é¦–å…ˆæƒ³åˆ°çš„ä¸€ä¸ªå…³é”®åŠŸèƒ½å°±æ˜¯ <a href="https://clang.llvm.org/docs/AutomaticReferenceCounting.html" target="_blank" rel="noopener">ARC</a>ï¼ŒåŒæ—¶æˆ‘ä»¬éœ€è¦è®©ç¼–è¯‘å™¨è‡ªèº«æ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œè€Œä¸æ˜¯é€šè¿‡è¿è¡Œæ—¶æ¥å®ç°ã€‚Objective-C å½“æ—¶ä½¿ç”¨ <a href="https://opensource.apple.com/source/libauto/libauto-77.1/README.html" target="_blank" rel="noopener">libauto</a> åƒåœ¾å›æ”¶ç³»ç»Ÿï¼Œä½†å®ƒæœ‰ç€ä¸€å¤§å †é—®é¢˜ã€‚å› æ­¤ä¸ºäº†è¾¾åˆ°è‡ªåŠ¨å†…å­˜ç®¡ç†çš„ç›®æ ‡ï¼Œæˆ‘ä»¬æœ‰å²ä»¥æ¥ç¬¬ä¸€æ¬¡ä»¥ Swift çš„å†…éƒ¨è®¾è®¡è®¨è®ºä¸ºèµ·ç‚¹ï¼Œå¹¶æœ€ç»ˆåœ¨ Objective-C ä¸­å®ç°äº†æ­¤ç‰¹æ€§ã€‚éšåæœ‰è®¸å¤šçš„ä¸œè¥¿éƒ½æ˜¯è¿™æ ·äº§ç”Ÿçš„ï¼ŒåŒ…æ‹¬ ARC å’Œ <a href="https://clang.llvm.org/docs/Modules.html" target="_blank" rel="noopener">modules</a> ç”šè‡³ <a href="https://clang.llvm.org/docs/ObjectiveCLiterals.html" target="_blank" rel="noopener">literals</a> åŠæ›´å¤šç±»ä¼¼çš„åŠŸèƒ½ï¼Œå®ƒä»¬çš„ç¡®éƒ½æ˜¯ç”± Swift çš„å¹•åå¼€å‘ä¸»å¯¼çš„ã€‚[^2]</p><p><strong>John Sundell:</strong> æ‰€ä»¥åœ¨å½“æ—¶ï¼Œä½ è„‘æµ·é‡Œå·²ç»æœ‰è®¸å¤šå…³äº Shiny çš„ç‰¹æ€§ï¼Œæœ€åå®ƒä»¬éƒ½åœ¨ Swift ä¸­å®ç°äº†ã€‚ä½†ä½ æ›¾ç»è¯´è¿‡ï¼Œâ€œæˆ‘ä»¬å¹¶ä¸æƒ³ä¸€ç›´ç­‰å¾…æ–°è¯­è¨€å¼€å‘å®Œæˆã€‚æˆ‘ä»¬åº”è¯¥æŠŠè¿™äº›éå¸¸å¸å¼•äººçš„ç‰¹æ€§åŠ å…¥åˆ° Objective-C ä¸­ã€‚â€</p><blockquote><p>åœ¨æ„å»ºä¸€ä¸ªæ–°çš„è¯­è¨€æ—¶ï¼Œä½ å¿…é¡»ä¸€ç›´é—®è‡ªå·±ï¼Œâ€˜ä¸ºä»€ä¹ˆä¸ç›´æ¥ä¼˜åŒ–ç°æœ‰çš„è¯­è¨€â€™ï¼Œè¿™æ˜¯å¹•åæ„æ€è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚</p></blockquote><p><strong>Chris Lattner:</strong> æˆ–è®¸ç°åœ¨çœ‹æ¥ï¼ŒSwift çš„å‡ºç°æ˜¯å¿…ç„¶çš„ï¼Œä½†å¦‚æœä½ ä»å¦ä¸€ä¸ªè§’åº¦æ€è€ƒè¿™ä¸ªé—®é¢˜ï¼Œåœ¨å½“æ—¶å¹¶ä¸æ˜¯æ‰€æœ‰äººéƒ½èƒ½è®¤è¯†åˆ°è¿™ä¸€ç‚¹ï¼Œç”šè‡³è¿æˆ‘ä¹Ÿä¸èƒ½ç¡®å®šã€‚Bertrand ä»è¿‡å»åˆ°ç°åœ¨éƒ½ä¸€ç›´éå¸¸çš„æ£’ï¼Œä»–ä¸€ç›´ç»™äºˆæˆ‘ä»¬æå¤§çš„é¼“åŠ±ã€‚è€Œä¸”ä»–æ€»æ˜¯èƒ½åœ¨è´¨ç–‘ä¸­å‰è¿›ã€‚Bertrand æœ‰ç‚¹ç±»ä¼¼ç§‘å­¦å®¶ï¼Œä»–ä»…ä»…åªæ˜¯æƒ³é€šè¿‡å„ç§é€”å¾„å¯»æ‰¾çœŸç›¸ã€‚çš„ç¡®ï¼Œå½“æ—¶æˆ‘ä»¬æœ‰è®¸å¤šç–‘è™‘ï¼Œä½†åŒæ—¶ä¹Ÿæœ‰è®¸å¤šå¥½çš„æƒ³æ³•ã€‚åŒ…æ‹¬ Bertrand åœ¨å†…çš„å¾ˆå¤šäººä¸€ç›´åœ¨æ¨è¿›è¿™é¡¹å·¥ä½œã€‚åœ¨æ„å»ºä¸€ä¸ªæ–°çš„è¯­è¨€æ—¶ï¼Œä½ å¿…é¡»ä¸€ç›´é—®è‡ªå·±ï¼Œâ€˜ä¸ºä»€ä¹ˆä¸ç›´æ¥ä¼˜åŒ–ç°æœ‰çš„è¯­è¨€â€™ï¼Œè¿™æ˜¯å¹•åæ„æ€è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚è€Œè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ˜¯ï¼Œâ€œå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠç°æœ‰çš„ä¼˜åŒ–å¥½â€ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¯¸å¦‚ ARC çš„åŠŸèƒ½ä¼šå‡ºç°ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨ Swift ä¸­ï¼Œæœ€éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯å†…å­˜å®‰å…¨ã€‚åœ¨ Objective-C ä¸­ï¼Œé™¤éå»é™¤ C ç›¸å…³çš„ä¸œè¥¿ï¼Œä¸ç„¶æ˜¯ä¸å¯èƒ½è¾¾åˆ°ç»å¯¹çš„å†…å­˜å®‰å…¨ã€‚ä½†å»é™¤äº† C çš„ Objective-C ä¼šå¤±å»å¤ªå¤šçš„ä¸œè¥¿ï¼Œ è€Œå®ƒä¹Ÿä¸å†æ˜¯ Objective-C äº†ã€‚</p><p><strong>Garric Nahapetian:</strong> æ²¡é”™ã€‚å› æ­¤ï¼ŒæŠŠä¸€äº› Swift çš„ç‰¹æ€§æ·»åŠ åˆ° Objective-C ä¸­å°±åƒæ˜¯ <a href="https://zh.wikipedia.org/zh/ç‰¹æ´›ä¼Šæœ¨é¦¬" target="_blank" rel="noopener">ç‰¹æ´›ä¼Šæœ¨é©¬</a> ä¸€æ ·ï¼Œå¯ä»¥è®©å¤§å®¶æ›´å®¹æ˜“åœ°ä¿¡ä»» Swift ï¼Œå› ä¸ºä½ å·²ç»å®Œæˆäº† Objective-C æ–¹é¢çš„å·¥ä½œï¼Œæ˜¯è¿™æ ·å—ï¼Ÿ</p><p><strong>Chris Lattner:</strong> ï¼ˆè¿™é‡Œé¢ï¼‰å…¶å®æœ‰è®¸å¤šæœ‰è¶£çš„å†…éƒ¨åŠ¨åŠ›ã€‚æˆ‘è§‰å¾—æˆ‘ä»¬éå¸¸ä¸“æ³¨åœ°ä¼˜åŒ– Objective-C åŠå…¶ç›¸å…³çš„å¹³å°ã€‚å¯¹äºå¼€å‘ Swift è€Œè¨€ï¼Œè¿™æ˜¯ä¸€ç§é™ä½é£é™©çš„åŠæ³•ã€‚å¦‚æœè¯´ï¼Œâ€œæˆ‘ä»¬è¦æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½ä¸€æ¬¡æ€§æ¨åˆ°é‡åšâ€ï¼Œè€Œä¸”ä¸ç»è¿‡ä»»ä½•æµ‹è¯•çš„è¯ï¼Œè‚¯å®šä¼šæœ‰å·¨å¤§çš„é£é™©ã€‚ä½†å¦‚æœä½ åªæŠŠâ€œå°‘éƒ¨åˆ†â€çš„ä¸œè¥¿å•ç‹¬æ¨å€’é‡åšï¼Œæ¯”å¦‚ä¸€ä¸ªå…¨æ–°çš„å†…å­˜ç®¡ç†ç³»ç»Ÿï¼Œç„¶åå¯¹å®ƒè¿›è¡Œè¿­ä»£ã€è°ƒè¯•å¹¶ç»“åˆç¤¾åŒºçš„åŠ›é‡è¿›è¡Œå¼€å‘çš„è¯ï¼Œå°±åªä¼šäº§ç”Ÿæœ‰é™çš„é£é™©ã€‚ä¸è¿‡æœ‰ä¸€ç‚¹æˆ‘è¦è¯´çš„æ˜¯ï¼Œä¸ç®¡æ˜¯å¤–éƒ¨çš„ç¤¾åŒºè¿˜æ˜¯è‹¹æœå†…éƒ¨çš„ç¤¾åŒºï¼Œè²Œä¼¼éƒ½åœ¨å¯¹æˆ‘ä»¬è¯´ï¼Œâ€œä¸ºä»€ä¹ˆä½ è¦ä¼˜å…ˆè€ƒè™‘è¿™ä¸ªï¼Ÿæˆ‘ä»¬å°±å¥½åƒæ˜¯æ¦‚ç‡è®ºä¸­çš„ <a href="https://zh.wikipedia.org/wiki/éš¨æ©Ÿæ¼«æ­¥" target="_blank" rel="noopener">éšæœºæ¼«æ­¥</a> ä¸€æ ·ã€‚ä¸ºä»€ä¹ˆä½ è¦åšè¿™ä¸ªè€Œä¸æ˜¯å…¶ä»–çš„ï¼Ÿâ€å› æ­¤ï¼Œè¿™ä¹Ÿæˆä¸ºäº†ä¸€ä¸ªæœ‰è¶£çš„åŠ¨åŠ›ã€‚</p></blockquote><hr><h2 id="åˆå§‹å›¢é˜Ÿçš„æˆé•¿"><a href="#åˆå§‹å›¢é˜Ÿçš„æˆé•¿" class="headerlink" title="åˆå§‹å›¢é˜Ÿçš„æˆé•¿"></a>åˆå§‹å›¢é˜Ÿçš„æˆé•¿</h2><p><em>ï¼ˆå¼€å§‹äº 22:49ï¼‰</em></p><blockquote><p><strong>Chris Lattner:</strong> è‹¹æœæ‹¥æœ‰ç€ä¸€æ”¯éå¸¸å¼ºå¤§çš„å·¥ç¨‹å¸ˆé˜Ÿä¼ã€‚é‚£æ—¶æœ‰éå¸¸å¤šçš„äººä¸€èµ·ç»´æŠ¤ Objective-Cï¼Œè¿™å…¶å®æ˜¯æœ‰ç‚¹å›ºæ‰§çš„ä¸€ä»¶äº‹ï¼Œä½†åŒæ—¶è¿™ä¹Ÿè®©æˆ‘ä»¬åœ¨åŠ¨æ€åº“ã€åº”ç”¨å’Œå…¶ä»–ç±»ä¼¼çš„ä¸œè¥¿ä¸Šæ‹¥æœ‰äº†åè¶³çš„æ·±åº¦å’ŒèƒŒæ™¯ã€‚æ­£å› å¦‚æ­¤ï¼Œé‚£æ—¶æœ‰è®¸å¤šå…³äºä¼˜åŒ– Objective-C çš„æƒ³æ³•æ¶Œç°ã€‚è‡ªä»ä¹”å¸ƒæ–¯ç¦»å¼€å¹¶åˆ›ç«‹ <a href="https://en.wikipedia.org/wiki/NeXT" target="_blank" rel="noopener">NeXT</a> ä¹‹åï¼Œè®¸å¤šæ°å‡ºçš„äººç‰©éƒ½ä¸€ç›´å‚ä¸è¿™é¡¹å·¥ä½œå¹¶å†™ä¸‹äº†å¤§é‡ç›¸å…³çš„ç™½çš®ä¹¦ã€‚å› æ­¤ï¼ŒObjective-C èƒŒåæœ‰ä¸€ä¸ªæå…¶åºå¤§çš„ç¤¾åŒºåœ¨æ¨åŠ¨ç€ã€‚</p><p>å½“æ—¶ï¼Œæˆ‘å’Œ Bertrand ä»¥åŠ Dave è®¨è®ºè¿‡ä¸€äº›æƒ³æ³•ï¼Œæˆ‘ä¹Ÿå¼€å§‹ç€æ‰‹ç¼–å†™ä¸€ä¸ªç¼–è¯‘å™¨çš„åŸå‹ã€‚ä¸è¿‡ç»“æœå¾ˆæ˜¾ç„¶ï¼Œæˆ‘å¾ˆéš¾é è‡ªå·±å»æ„å»ºå‡ºæ‰€æœ‰çš„ä¸œè¥¿ã€‚æ‰€ä»¥æœ€åçš„äº‹æƒ…ä¹Ÿç†æ‰€å½“ç„¶åœ°å‘ç”Ÿäº†â€”â€”å¤§çº¦åœ¨ 2011 å¹´å››æœˆçš„æ—¶å€™æˆ‘ä»¬ä¸ç®¡ç†å±‚è®¨è®ºäº†å…³äº Swift çš„äº‹æƒ…ï¼Œç„¶åä¹Ÿè·å¾—æ‰¹å‡†å»è°ƒåŠ¨ä¸€å°éƒ¨åˆ†äººå‘˜ã€‚<a href="https://twitter.com/tkremenek" target="_blank" rel="noopener">Ted Kremenek</a>ã€<a href="https://twitter.com/dgregor79" target="_blank" rel="noopener">Doug Gregor</a>ã€<a href="https://twitter.com/pathofshrines" target="_blank" rel="noopener">John McCall</a> ä»¥åŠä¸€äº›å…¶ä»–çš„æ°å‡ºå·¥ç¨‹å¸ˆéƒ½æ˜¯åœ¨é‚£æ—¶è°ƒå…¥ Swift é¡¹ç›®çš„ã€‚ç°åœ¨å›å¤´çœ‹çœ‹ï¼Œå…¶å®æŒºæœ‰æ„æ€çš„ï¼Œå› ä¸ºå½“æ—¶æ˜¯ç¬¬ä¸€æ¬¡æœ‰ä¸€äº›è¯­è¨€å’Œè®¾è®¡ä¸“å®¶å¯¹ Swift åšäº†æ‰¹åˆ¤æ€§çš„è¯„ä»·ã€‚ä»–ä»¬åé¦ˆäº†å¾ˆå¤šä¸¥å‰çš„æ‰¹åˆ¤ã€‚è™½ç„¶ä»–ä»¬çš„æœ¬æ„å¹¶ä¸æ˜¯æ‰“å‡»æˆ‘ä»¬ï¼Œä½†ä»–ä»¬çš„ç¡®è¯´çš„å¾ˆå¯¹â€”â€”è¿™ä¸ªè¯­è¨€å½“æ—¶å®åœ¨æ˜¯ç³Ÿé€äº†ã€‚</p><p>èƒ½è®©è¿™ä¸€åˆ‡é¡ºåˆ©è¿›è¡Œæœ‰ä¸€ä¸ªå…³é”®åŸå› ï¼Œå°±æ˜¯æˆ‘ä»¬æœ‰æœºä¼šæ‹‰æ‹¢ä¸€ä½æ³›å‹é¢†åŸŸçš„ä¸–ç•Œçº§ä¸“å®¶ï¼Œä»¥åŠä¸€æ”¯æ„å»ºè¿‡ Clang ç¼–è¯‘å™¨çš„å›¢é˜Ÿã€‚åŒæ—¶è¿™æ”¯å›¢é˜Ÿä¹Ÿå‚ä¸è¿‡è®¸å¤šä¸åŒçš„æœ‰æ„æ€çš„é¡¹ç›®ï¼Œå¹¶èƒ½å¤Ÿå°½å¯èƒ½åœ°å‘æŒ¥ä»–ä»¬çš„å·¥ç¨‹å¤©èµ‹ã€‚è™½ç„¶ä»–ä»¬åªæ˜¯å¸®åŠ©æ¨è¿›å’Œå¼€å‘æ„å»ºçš„ä¸€éƒ¨åˆ†äººå‘˜ï¼Œä½†å´è‡³å…³é‡è¦ã€‚</p><p><strong>John Sundell:</strong> åœ¨é‚£æ—¶ Swift è¯­è¨€çš„çŠ¶å†µæ˜¯æ€æ ·çš„ï¼Ÿæ¯”å¦‚ï¼Œè¯­è¨€çš„è¯­æ³•æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿç¼–è¯‘å™¨çš„å“ªéƒ¨åˆ†åŸºç¡€è®¾æ–½å·²ç»æ­å»ºå®Œæˆäº†ï¼Ÿå®ƒæ˜¯ä¸æ˜¯å·²ç»æ¥è¿‘äºåŸå‹çš„é˜¶æ®µç”šè‡³æ›´è¿›ä¸€æ­¥å‘¢ï¼Ÿ</p><p><strong>Chris Lattner:</strong> é‚£æ—¶ Swift å·²ç»éå¸¸æ¥è¿‘åŸå‹é˜¶æ®µäº†ã€‚è¿™äº›èµ„æ–™éƒ½æ˜¯å®Œå…¨å…¬å¼€çš„ï¼Œå› ä¸ºåœ¨ GitHub ä¸Šï¼Œ<a href="https://github.com/apple/swift/commits/master" target="_blank" rel="noopener">å˜æ›´å†å²æ˜¯å®Œå…¨å…¬å¼€</a> çš„ã€‚<a href="https://github.com/apple/swift/blob/master/CHANGELOG.md" target="_blank" rel="noopener">å˜æ›´æ—¥å¿—</a> è™½ç„¶ä¸èƒ½å®Œå…¨è¿½æº¯æ‰€æœ‰çš„å†å²å˜æ›´ï¼Œä½†å·²ç»è¶³å¤Ÿäº†ã€‚</p><p>åœ¨ Doug åŠ å…¥ä¹‹å‰ï¼ŒSwift å¹¶æ²¡æœ‰æ³›å‹ç³»ç»Ÿã€‚å½“æ—¶æˆ‘ä»¬å¾ˆæƒ³åšä¸€ä¸ªæ³›å‹ç³»ç»Ÿï¼Œä½†æˆ‘ä¸æ˜¯å¾ˆæœ‰è‡ªä¿¡èƒ½ç‹¬è‡ªè®¾è®¡å‡ºæ¥ï¼ŒDoug å´åšåˆ°äº†ã€‚æˆ‘è®°å¾—åœ¨å¾ˆæ—©çš„æ—¶å€™ï¼ŒJohn æ›¾ç»æ¥æ‰‹è¿‡ä¸€ä¸ªé¡¹ç›®ï¼Œè®©ä¸€ä¸ªç±»ä¼¼è¯­æ³•åˆ†æå™¨çš„ä¸œè¥¿å˜å¾—å¯ä»¥çœŸæ­£ç”Ÿæˆä»£ç ã€‚Doug æ‰€åšçš„äº‹æƒ…å¤§æ¦‚å°±æ˜¯è¿™æ ·ã€‚</p><p>æœ‰å¾ˆå¤šé›¶ç¢çš„äº‹æƒ…æˆ‘ä¸å¤ªè®°å¾—äº†ï¼Œä½†æœ‰äº›ä¸œè¥¿æˆ‘å´ä¸€ç›´è®°å¿†çŠ¹æ–°ã€‚æˆ‘è®°å¾— <code>var</code> å’Œ <code>func</code> å°±æ˜¯ä»æœ€åˆå°±åˆ¶å®šå¥½çš„ã€‚æ—©æœŸçš„ Swift ä¸­å¾ˆå¤šåŸºæœ¬è¯­æ³•éƒ½å’Œç°åœ¨çš„ Swift è¯­æ³•éå¸¸æ¥è¿‘ã€‚</p><blockquote><p>å½“ä½ æ„å»ºä¸€æ ·æ–°ä¸œè¥¿çš„æ—¶å€™ï¼Œé€šå¸¸æƒ³æ³•æ˜¯é¢†å…ˆäºæ–‡æ¡£çš„ï¼Œè€Œæ–‡æ¡£åˆå…ˆäºä»£ç ã€‚æˆ‘ä»¬å½“æ—¶æƒ…å†µä¹Ÿéå¸¸ç±»ä¼¼ã€‚åˆ°ç°åœ¨ï¼Œæƒ³æ³•å·²ç»é¢†å…ˆäºä»£ç éå¸¸ä¹‹å¤šäº†ï¼Œè¿™éƒ½æ˜¯æ— å¯é¿å…çš„ã€‚</p></blockquote><p>å½“æ—¶çš„ Swift å·²ç»ååˆ†æ¥è¿‘äºä¸€ä¸ªåŸå‹äº†ã€‚ä½†ä»æœ‰è®¸è®¸å¤šå¤šçš„æƒ³æ³•æœªå®ç°ã€‚å½“ä½ æ„å»ºä¸€æ ·æ–°ä¸œè¥¿çš„æ—¶å€™ï¼Œé€šå¸¸æƒ³æ³•æ˜¯å…ˆäºæ–‡æ¡£çš„ï¼Œè€Œæ–‡æ¡£åˆæ˜¯å…ˆäºä»£ç ã€‚æˆ‘ä»¬å½“æ—¶æƒ…å†µä¹Ÿéå¸¸ç±»ä¼¼ã€‚åˆ°ç°åœ¨ï¼Œæƒ³æ³•å·²ç»é¢†å…ˆäºä»£ç éå¸¸ä¹‹å¤šäº†ï¼Œè¿™éƒ½æ˜¯æ— å¯é¿å…çš„ã€‚</p></blockquote><hr><h2 id="å…³äº-Craig-Federighi"><a href="#å…³äº-Craig-Federighi" class="headerlink" title="å…³äº Craig Federighi"></a>å…³äº Craig Federighi</h2><p><em>ï¼ˆå¼€å§‹äº 26:10ï¼‰</em></p><blockquote><p><strong>Chris Lattner:</strong> å¯¹äºç¤¾åŒºéå¸¸é‡è¦çš„å¦ä¸€ä½ä¼™ä¼´åå« <a href="https://en.wikipedia.org/wiki/Craig_Federighi" target="_blank" rel="noopener">Craig Federighi</a>ã€‚Craig åœ¨è‹¹æœç¤¾åŒºä¸­éå¸¸å‡ºåã€‚åœ¨ 2011 å¹´æ—©äº›æ—¶å€™ï¼Œä»–åŠ å…¥äº†è¿™ä¸ªé¡¹ç›®ã€‚é‚£æ—¶æ­£å¥½ Bertrand ä»è‹¹æœé€€ä¼‘ï¼ŒCraig ä¾¿æ¥æ‰‹äº†ä»–çš„å·¥ä½œã€‚</p><p>è¯´åˆ° Craigï¼Œä»–æ˜¯ä¸€ä¸ªéå¸¸ã€éå¸¸æœ‰è¶£çš„äººã€‚æ— è®ºåœ¨å°ä¸Šè¿˜æ˜¯å°ä¸‹ï¼Œä»–éƒ½ç€éå‡¡çš„ä¸ªäººé­…åŠ›ã€‚å¤§å¤šæ•°äººä»¬éƒ½ä¸äº†è§£ä»–åˆ°åº•æœ‰å¤šä¹ˆçš„èªæ˜ã€‚ä»–è¿˜åœ¨è®¸å¤šæ–¹é¢éƒ½æœ‰ç€æå…¶æ·±å…¥çš„ç ”ç©¶ã€‚æˆ‘å®Œå…¨æ²¡æƒ³åˆ°ï¼Œä»–åœ¨è¯­è¨€æ–¹é¢æ‡‚å¾—å¾ˆå¤šã€‚ä»–æ›¾ä¸º <a href="http://groovy-lang.org/" target="_blank" rel="noopener">Groovy</a> å’Œè®¸å¤šå…¶ä»–ç±»å‹çš„è¯­è¨€ä½œä¸ºæ­£å¼å‚ä¸è€…å·¥ä½œè¿‡ï¼Œæœ‰äº›è¯­è¨€æˆ‘ç”šè‡³è¿˜æ²¡æ¥è§¦è¿‡ã€‚è€Œä¸”ï¼Œä»–å¹¶ä¸åƒæ˜¯ä¸€ä½åªä¼šè°ˆè®ºç­–ç•¥çš„é«˜å±‚äººå‘˜ã€‚ä»–åŒæ ·å…³å¿ƒè®¸å¤šç»†èŠ‚çš„äº‹æƒ…ï¼Œä¾‹å¦‚é—­åŒ…è¯­æ³•ã€å…³é”®å­—å’Œå…¶ä»–ä¸œè¥¿ã€‚</p><p>Craig çœŸçš„æ˜¯ä¸€ä½éå¸¸ä¸¥æ ¼çš„ä»»åŠ¡æ¨åŠ¨è€…ï¼ŒåŒæ—¶ä»–ä¹Ÿæ¨åŠ¨ç€ Swift çš„å®ç°ä»¥åŠ Swift ä¸ Objective-C çš„è”åŠ¨ã€‚ä¸ä»…å¦‚æ­¤ï¼Œä»–è¿˜å…³å¿ƒç€ Objective-C æœ¬èº«çš„ç»´æŠ¤ï¼›å…³å¿ƒç€ APIï¼›å…³å¿ƒç€ Objective-C çš„ API <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0005-objective-c-name-translation.md" target="_blank" rel="noopener">å¯¼å…¥åˆ° Swift</a> åçš„å½¢æ€ï¼Œè¿˜æœ‰ç›¸å…³çš„ä¸€åˆ‡ã€‚Craig åœ¨ç§¯æç»™äºˆåé¦ˆçš„åŒæ—¶ï¼Œä¸€ç›´ä¿æŒç€åœ¨å›¢é˜Ÿå’Œé¡¹ç›®ä¸Šå‡ºä¹æ„æ–™çš„å“è¶Šæ€åº¦ã€‚ä»–çš„å¸®åŠ©å¯¹ Swift çš„ç°çŠ¶å½±å“å¾ˆå¤§ã€‚</p><p><strong>Garric Nahapetian:</strong> è¿™çœŸçš„å¾ˆé…·ï¼Œå› ä¸ºä»–åˆšå¥½æ˜¯åœ¨ WWDC 2014 çš„è®²å°ä¸Šç¬¬ä¸€ä½å‘è¡¨æ¼”è®²çš„äººã€‚</p><p><strong>Chris Lattner:</strong> æ²¡é”™ã€‚</p><p><strong>John Sundell:</strong> ç„¶åä»–å°±ä»‹ç»ä½ å‡ºåœºäº†ï¼Œå¯¹å§ï¼Ÿæˆ‘è¿˜è®°å¾—é‚£å¥ç»å…¸çš„æ ‡è¯­ï¼šâ€œæ²¡æœ‰ C çš„ Objective-Câ€ã€‚</p><blockquote><p>æˆ‘å¯¹é‚£å¥â€œæ²¡æœ‰ C çš„ Objective-Câ€æ ‡è¯­æœ‰ç€å¤æ‚çš„æ„Ÿè§‰ï¼Œå› ä¸ºå…¶å®æˆ‘æƒ³è¡¨è¾¾çš„å¹¶ä¸æ˜¯è¿™æ ·ã€‚</p></blockquote><p><strong>Chris Lattner:</strong> è¯´å®è¯ï¼Œæˆ‘å¯¹é‚£å¥æ ‡è¯­æœ‰ç€å¤æ‚çš„æ„Ÿè§‰ï¼Œå› ä¸ºå…¶å®æˆ‘æƒ³è¡¨è¾¾çš„å¹¶ä¸æ˜¯è¿™æ ·ã€‚</p><p><strong>John Sundell:</strong> é‚£æ˜¯å¥å¾ˆæ£’çš„æ ‡è¯­ã€‚</p><p><strong>Chris Lattner:</strong> åœ¨é‚£ä¸ªæ—¶å€™ï¼Œä»¥è¿™ç§æ–¹å¼å‘ç¤¾åŒºå®£ä¼ æ˜¯å¾ˆæ­£ç¡®çš„é€‰æ‹©ã€‚</p><p>ï¼ˆâ€¦â€¦ï¼‰</p><blockquote><p>åœ¨é¡¹ç›®çš„ä¸€å¼€å§‹ï¼Œæˆ‘çš„ç›®æ ‡å…¶å®æ˜¯æ„å»ºä¸€ä¸ªå…¨æ ˆç³»ç»Ÿã€‚</p></blockquote><p><strong>Chris Lattner:</strong> è‡³äºè¯´ä¸ºä»€ä¹ˆæˆ‘å½“æ—¶å¾ˆçŸ›ç›¾ï¼Œå› ä¸ºåœ¨é¡¹ç›®çš„ä¸€å¼€å§‹ï¼Œæˆ‘çš„ç›®æ ‡å…¶å®æ˜¯æ„å»ºä¸€ä¸ªå…¨æ ˆç³»ç»Ÿâ€”â€”åˆ†æå¸‚é¢ä¸Šç°æœ‰çš„ç³»ç»Ÿï¼Œå–å…¶ç²¾åï¼Œå¼ƒå…¶ç³Ÿç²•ã€‚è€Œä¸”å½“æ—¶çš„ç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥ç¼–å†™å›ºä»¶ã€ç¼–å†™è„šæœ¬ã€ç¼–å†™ç§»åŠ¨åº”ç”¨å’ŒæœåŠ¡ç«¯åº”ç”¨ç”šè‡³æ˜¯æ›´åº•å±‚ç³»ç»Ÿä»£ç çš„è¯­è¨€ï¼ŒåŒæ—¶åœ¨è¯­è¨€å±‚é¢ä¸Šå¹¶éåªæ˜¯é€šè¿‡éšæ„å †ç Œæ¥å®ç°ï¼Œæˆ‘è¦è®©å®ƒåœ¨ä¸Šé¢è¯´çš„æ‰€æœ‰æ–¹é¢éƒ½èƒ½è¡¨ç°å‡ºè‰²ã€‚</p><p>æ‰€ä»¥åœ¨å½“æ—¶è€Œè¨€ï¼Œè¿™ä¸ªæ–¹å‘ç»å¯¹æ˜¯æ­£ç¡®çš„ã€‚è™½ç„¶ç›®å‰ Swift è¿˜æ²¡èƒ½è¾¾åˆ°é¢„æœŸï¼Œä½†æ¬£æ…°çš„æ˜¯å®ƒçš„å‘å±•å°†ä¼šä½¿å®ƒèƒ½å¤Ÿåœ¨æœªæ¥æ‹¥æœ‰è¿™äº›çš„èƒ½åŠ›ã€‚</p></blockquote><hr><h2 id="æ–‡æ¡£çš„é‡è¦æ€§"><a href="#æ–‡æ¡£çš„é‡è¦æ€§" class="headerlink" title="æ–‡æ¡£çš„é‡è¦æ€§"></a>æ–‡æ¡£çš„é‡è¦æ€§</h2><p><em>ï¼ˆå¼€å§‹äº 30:32ï¼‰</em></p><blockquote><p><strong>Chris Lattner:</strong> ï¼ˆåœ¨è¿™é‡Œï¼‰æˆ‘è¿˜è¦æœ€åæåˆ°ä¸€æ”¯å›¢é˜Ÿã€‚ä½ ç›®å‰æ‰€çœ‹åˆ°çš„ Swiftï¼Œå®ƒæ˜¯ä¸€ä¸ª<a href="https://en.wikipedia.org/wiki/Compiler" target="_blank" rel="noopener">ç¼–è¯‘å™¨</a>ï¼Œæ˜¯ä¸€é—¨è¯­è¨€ï¼Œæ˜¯<a href="https://developer.apple.com/documentation/swift/swift_standard_library" target="_blank" rel="noopener">ä¸€ç³»åˆ— API çš„é›†åˆ</a>ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª IDEã€‚ä½†è®©è¿™äº›äº‹æƒ…èƒ½å¤ŸæˆçœŸï¼Œå¹¶è®© Swift èµ°å‘å¤§ä¼—ï¼Œç¦»ä¸å¼€å¼€å‘è€…å‘å¸ƒå›¢é˜Ÿçš„å·¥ä½œã€‚ä»–ä»¬æ˜¯ Apple çš„ç§‘æŠ€ç¼–è¾‘ï¼Œè´Ÿè´£ç¼–å†™å¦‚ <a href="https://developer.apple.com/documentation/swift/swift_standard_library" target="_blank" rel="noopener">Swift ç¼–ç¨‹è¯­è¨€ä¹¦ç±</a> ä¹‹ç±»çš„ä¸œè¥¿ã€‚Swift çš„æˆåŠŸå’Œå¿«é€Ÿé€‚åº”å¸‚åœºç¦»ä¸å¼€å½“æ—¶ç¬¬ä¸€æ—¶é—´å‘å¸ƒçš„é«˜è´¨é‡æ–‡æ¡£å’Œä¹¦ç±ã€‚ç›´åˆ°ä»Šå¤©ï¼Œä»–ä»¬ä»åœ¨ç»´æŠ¤è¿™äº›æ–‡æ¡£ï¼ŒçœŸçš„éå¸¸ä¸å¯æ€è®®ã€‚</p><blockquote><p>æˆ‘ä»¬ç›´æ¥æŠŠè¿™äº›ç§‘æŠ€ç¼–è¾‘æ‹‰å…¥äº†è®¾è®¡è®¨è®ºä¼š</p></blockquote><p>æˆ‘è®°å¾—å½“æ—¶æˆ‘ä»¬ç›´æ¥æŠŠè¿™äº›ç§‘æŠ€ç¼–è¾‘æ‹‰å…¥äº†è®¾è®¡è®¨è®ºä¼šã€‚åƒ <a href="https://twitter.com/timisted" target="_blank" rel="noopener">Tim Isted</a>ã€Brian Lanier å’Œ Alex Martini è¿™äº›äººï¼Œä»–ä»¬åœ¨å‘¨ä¼šä¸ŠèŠ±äº†å¤§é‡çš„æ—¶é—´äº‰è®ºç€ä¸€äº›ç»†èŠ‚é—®é¢˜â€”â€”â€œæˆ‘ä»¬æ˜¯å¦åº”è¯¥ä½¿ç”¨ç‚¹è¯­æ³•ï¼Ÿâ€â€œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨è¿™ä¸ªå…³é”®å­—è¿˜æ˜¯é‚£ä¸ªå…³é”®å­—ï¼Ÿâ€æˆ–è€…æ˜¯â€œæˆ‘ä»¬æ˜¯åº”è¯¥æŠŠ <code>func</code> æ”¹ä¸º <code>def</code> å—ï¼Ÿâ€åŒæ—¶è¿˜è®¨è®ºç€â€”â€”ç±»å‹ç³»ç»Ÿçš„æ·±åº¦ä»¥åŠ <a href="https://en.wikipedia.org/wiki/Code_generation_(compiler" target="_blank" rel="noopener">ä»£ç ç”Ÿæˆ</a>) ç®—æ³•åº”å¦‚ä½•å·¥ä½œï¼›æˆ‘ä»¬å¦‚ä½•è¾¾åˆ°è¾ƒå¥½çš„æ€§èƒ½ï¼Ÿ<a href="https://developer.apple.com/documentation/swift/string" target="_blank" rel="noopener">å­—ç¬¦ä¸²</a> åº”å¦‚ä½•è¿ä½œï¼Ÿè¿˜æœ‰å„ç§å„æ ·çš„é—®é¢˜ã€‚</p><blockquote><p>å¦‚æœä½ èƒ½åœ¨è®¾è®¡é˜¶æ®µå°±è€ƒè™‘åˆ°å¦‚ä½•åƒå¤§å®¶è§£é‡Šè¿™é—¨è¯­è¨€çš„è¯ï¼Œå·¥ä½œä¼šè¿›è¡Œå¾—æ›´é¡ºåˆ©ã€‚</p></blockquote><p>æˆ‘è§è¿‡å¾ˆå¤šæ¬¡è¿™ç§äº‹æƒ…ï¼Œå½“ä½ æ„å»ºå®Œä¸€ä¸ªç³»ç»Ÿåä½ è¿˜è¦å°è¯•ç€è§£é‡Šå®ƒã€‚ç„¶åå½“ä½ å¼€å§‹è§£é‡Šè¿™ä¸ªç³»ç»Ÿæ—¶ï¼ŒçœŸçš„ä¼šé™·å…¥ä¸€ä¸ªå°´å°¬çš„å¤„å¢ƒï¼Œæ¯”å¦‚ï¼šâ€œå¤©å•Šï¼Œæˆ‘ç«Ÿç„¶è¿˜è¦å»è§£é‡Šè¿™ä¸ªä¸œè¥¿æ˜¯å¦‚ä½•å·¥ä½œçš„â€ã€‚å¦‚æœä½ å¯ä»¥åœ¨è®¾è®¡é˜¶æ®µå°±å¤„ç†å¥½åé¦ˆä¿¡æ¯ï¼Œå¹¶å¼•å…¥æ–‡æ¡£ï¼Œå¼•å…¥è¿™äº›å…³äºå¦‚ä½•å‘å¤§å®¶è§£é‡Šçš„å·¥ä½œï¼Œä½ ä¼šè¿›è¡Œå¾—æ›´é¡ºåˆ©ã€‚</p></blockquote><hr><h2 id="Swift-çš„å¼€å‘å·¥ä½œæ˜¯ä¸€ä¸ªå›¢é˜Ÿæ•ˆåº”"><a href="#Swift-çš„å¼€å‘å·¥ä½œæ˜¯ä¸€ä¸ªå›¢é˜Ÿæ•ˆåº”" class="headerlink" title="Swift çš„å¼€å‘å·¥ä½œæ˜¯ä¸€ä¸ªå›¢é˜Ÿæ•ˆåº”"></a>Swift çš„å¼€å‘å·¥ä½œæ˜¯ä¸€ä¸ªå›¢é˜Ÿæ•ˆåº”</h2><p><em>ï¼ˆå¼€å§‹äº 34:58ï¼‰</em></p><blockquote><p><strong>Chris Lattner:</strong> æˆ‘æƒ³è¯´çš„æ˜¯ï¼Œå¾ˆå¤šäººä¼šè¯´â€œChris å‘æ˜äº† Swiftâ€ã€‚è™½ç„¶æˆ‘çš„ç¡®åœ¨å¾ˆå¤šå¹´çš„æ—¶é—´é‡Œä¸€ç›´ç”¨ä¸åŒçš„æ–¹æ³•æ¨åŠ¨ç€ Swift çš„å¼€å‘ï¼Œä¹Ÿç®—æ˜¯å¸¦é¢†ç€æ•´ä¸ªé¡¹ç›®ï¼Œä½†äº‹å®ä¸Šå…¶å®ä»–ä»¬éƒ½å¿½ç•¥äº†ä¸€ç‚¹ï¼Œæœ‰æ•°ä»¥ç™¾è®¡çš„äººä¸º Swift çš„è®¸å¤šå…³é”®é—®é¢˜ä½œå‡ºäº†è´¡çŒ®ã€‚ä¾‹å¦‚æ„å»ºè°ƒè¯•å™¨ã€æ„å»º <a href="https://developer.apple.com/xcode/" target="_blank" rel="noopener">IDE</a>ã€æ„å»º <a href="https://help.apple.com/xcode/mac/current/#/dev188e45167" target="_blank" rel="noopener">Playgrounds</a>ã€æ„å»ºæ•™è‚²ç›¸å…³çš„å†…å®¹ã€æ„å»ºå„ç§ä¸œè¥¿ä»¥åŠç›¸å…³çš„ç¤¾åŒºã€‚</p><p>æˆ‘åœ¨è®¸å¤šåœ°æ–¹éƒ½ä¸å¦‚ä»–ä»¬ä¼˜ç§€ã€‚ä»–ä»¬å‡ ä¹ç»„æˆäº†ä¸€ä¸ªä¸ä»…æ˜¯åœ¨ Apple å†…éƒ¨ï¼ŒåŒæ—¶æ´»è·ƒäº Apple ä¹‹å¤–çš„ç¤¾åŒºï¼Œå¹¶ä¸€èµ·æ¨åŠ¨ç€ Swift ç›¸å…³åŠŸèƒ½çš„æ„å»ºï¼Œå¹¶ä»¥ä»–ä»¬è‡ªå·±çš„æ–¹å¼åšç€è´¡çŒ®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Swift èƒ½å‘å±•çš„å¦‚ä»Šçš„è§„æ¨¡ï¼Œæˆ‘è®¤ä¸ºè¿™ä¹Ÿæ˜¯ Swift èƒ½ä¸€ç›´æˆé•¿ä¸‹å»çš„åŸå› ã€‚</p><p><strong>Garric Nahapetian:</strong> è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å½•åˆ¶è¿™é›†æ’­å®¢çš„åŸå› ä¹‹ä¸€â€”â€”è®©è¿™äº›åœ¨å¹•ååšè¿‡è´¡çŒ®çš„äººå¯ä»¥ç«™åœ¨èšå…‰ç¯ä¸‹ã€‚</p></blockquote><hr><h2 id="ä¸è¦åƒç¼–è¯‘å™¨å¼€å‘è€…ä¸€æ ·å†™-Swift"><a href="#ä¸è¦åƒç¼–è¯‘å™¨å¼€å‘è€…ä¸€æ ·å†™-Swift" class="headerlink" title="ä¸è¦åƒç¼–è¯‘å™¨å¼€å‘è€…ä¸€æ ·å†™ Swift"></a>ä¸è¦åƒç¼–è¯‘å™¨å¼€å‘è€…ä¸€æ ·å†™ Swift</h2><p><em>ï¼ˆå¼€å§‹äº 42:15ï¼‰</em></p><blockquote><p><strong>Chris Lattner:</strong> æœ‰ä»¶äº‹æˆ‘è§‰å¾—å¾ˆç¥å¥‡ï¼Œä½ ä»¬ä¸¤ä¸ªå†™çš„ Swift ä»£ç æ¯”æˆ‘å†™çš„è¿˜å¤šã€‚æˆ‘å¯èƒ½å¯¹ Swift çš„å†…éƒ¨å®ç°ã€å®ƒä¸ºä»€ä¹ˆä¼šæ˜¯è¿™æ ·çš„ã€å®ƒæ˜¯å¦‚ä½•åšåˆ°æŸäº›äº‹çš„ï¼Œä»¥åŠå®ƒæ˜¯å¦‚ä½•è¿ä½œçš„æ¯”è¾ƒäº†è§£ï¼Œä½†ä½ ä»¬å´æ‹¥æœ‰ç€çœŸæ­£ä»¥ Swift æ¥æ„å»ºäº§å“çš„ç»éªŒ</p><p><strong>John Sundell:</strong> æ˜¯çš„ï¼Œè¿™å¾ˆæœ‰è¶£ã€‚æœ‰è®¸å¤šè®¸å¤šäººåœ¨ä¸º Swift é¡¹ç›®å·¥ä½œï¼Œä¸ºå®ƒçš„ç¼–è¯‘å™¨å·¥ä½œï¼Œè€Œä¸”ä»–ä»¬å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨å†™ C++ã€‚æˆ‘æƒ³é¡ºä¾¿é—®ä¸€ä¸‹ï¼Œè¿™ç§æ„Ÿè§‰æ˜¯æ€æ ·çš„ï¼Ÿä½ è®¾è®¡äº†è¿™é—¨éå¸¸é…·çš„è¯­è¨€ï¼Œå¤§å®¶ä¹Ÿé€æ¸å¼€å§‹ä½¿ç”¨å®ƒäº†ï¼Œä½†ä½ å´è¿˜åœ¨ä½¿ç”¨ C++ã€‚</p><p><strong>Chris Lattner:</strong> ï¼ˆå¤§ç¬‘ï¼‰ è¿™è®©æˆ‘ç—›ä¸æ¬²ç”Ÿã€‚è¿™çœŸçš„å¤ªå¯æ€•äº†ã€‚å°±åƒè€å¤©å¼€çš„ç©ç¬‘ä¸€æ ·ï¼Œå¼ºåˆ¶æˆ‘ä¸€ç›´åœ¨å†™ C++ã€‚</p></blockquote><hr><h2 id="å…³äºç¤¾åŒºåé¦ˆ"><a href="#å…³äºç¤¾åŒºåé¦ˆ" class="headerlink" title="å…³äºç¤¾åŒºåé¦ˆ"></a>å…³äºç¤¾åŒºåé¦ˆ</h2><p><em>ï¼ˆå¼€å§‹äº 43:11ï¼‰</em></p><blockquote><p><strong>Chris Lattner:</strong> ä¸ºä»€ä¹ˆ Swift ç°åœ¨èƒ½å‘å±•å¾—è¿™ä¹ˆå¥½ï¼Œæ‹¥æœ‰ä¸€ä¸ªåºå¤§çš„çš„ç¤¾åŒºï¼Œè€Œä¸”å¤§å®¶éƒ½ä¹ æƒ¯äºåœ¨ä¸Šé¢å†™åšå®¢ï¼Œè¿™è‚¯å®šæ˜¯éƒ½ä¸»è¦åŸå› ä¹‹ä¸€å¯¹å§ï¼Ÿç¤¾åŒºçš„åé¦ˆçš„ç¡®å½±å“äº† Swift 1 å’Œ 2 ã€‚é‚£äº›æŠ±æ€¨å°±åƒæ˜¯æé†’æˆ‘ä»¬çš„ä¿¡å·ä¸€æ ·ï¼Œâ€œè¿™æ ¹æœ¬ä¸åˆç†â€ï¼Œâ€œæˆ‘åœ¨è¿™ä¸Šé¢é‡åˆ°äº†é—®é¢˜ï¼Œè¿˜æœ‰é‚£ä¸ªå’Œå¦å¤–çš„éƒ½é‡åˆ°äº†é—®é¢˜â€ã€‚è¿™äº›çš„ç¡®å¸®äº†æˆ‘ä»¬å¾ˆå¤šï¼Œç‰¹åˆ«æ˜¯åœ¨ä¼˜åŒ–ã€æ’æœŸå’Œæ¨åŠ¨æœ€ç»ˆçš„ Swift ç‰ˆæœ¬æ–¹é¢ã€‚</p><blockquote><p>æ—©æœŸçš„ç¤¾åŒºåé¦ˆçš„ç¡®å½±å“äº† Swift 1 å’Œ 2ã€‚</p></blockquote><p>æ¯”è¾ƒæ„å¤–ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯æˆ‘ä»¬æœ‰æ„ä¸ºä¹‹çš„æ˜¯ï¼Œåœ¨ Swift 1 ä¸­æ²¡æœ‰åŠ å…¥é”™è¯¯å¤„ç†æœºåˆ¶ã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿæ²¡æœ‰åŠ å…¥åè®®æ‰©å±•ï¼Œè¿™äº›èƒ½åŠ›æˆ‘ä»¬ç»å¯¹æ˜¯å¸Œæœ› Swift èƒ½å¤Ÿæ‹¥æœ‰çš„ï¼Œä½†åªæ˜¯é”™è¿‡äº†å‘å¸ƒæ—¥ç¨‹ã€‚å› æ­¤æˆ‘ä»¬å¾ˆæ¸…æ¥šå¿…é¡»è¦å»æ„å»ºè¿™äº›åŠŸèƒ½ï¼Œä½†åœ¨ç¬¬ä¸€ä¸¤å¹´é—´è¿™äº›ä¸œè¥¿å´æ˜¯ç›´æ¥ç”±ç¤¾åŒºæœ€ç»ˆæ¨åŠ¨å®Œæˆçš„ã€‚ç„¶å<a href="https://developer.apple.com/swift/blog/?id=34" target="_blank" rel="noopener">å½“ Swift å¼€æº</a>ï¼Œ<a href="https://github.com/apple/swift-evolution" target="_blank" rel="noopener">Swift Evolution</a> å˜æˆäº†ä¸€ä¸ªä¼Ÿå¤§çš„é¡¹ç›®ã€‚è¿™ä¸ªé¡¹ç›®å¯èƒ½åœ¨äººä»¬çš„æ—¶é—´æ•ˆç‡ä¼˜åŒ–æ–¹é¢è¡¨ç°å¹¶ä¸ç†æƒ³ï¼Œä½†å®ƒå´æ˜¯è®© Swift éæ¯”å¯»å¸¸çš„é‡è¦å› ç´ ã€‚æˆ‘æƒ³è¿™é¡¹è£èª‰å±äºæ‰€æœ‰åœ¨ç¤¾åŒºä¸­èŠ±æ—¶é—´ä¸º Swift çš„åŠŸèƒ½ä¼˜åŒ–å’Œå·¥ä½œæ¨è¿›æä¾›å¸®åŠ©çš„äººã€‚</p><p><strong>John Sundell:</strong> æˆ‘æ‰€æƒ³åˆ°çš„å°±æ˜¯ï¼Œä¸ä»…æ˜¯é‚£äº›æ–‡ç« å’Œå†…å®¹ï¼ŒåŒæ—¶åŒ…æ‹¬å¼€æºåœ¨å†…çš„æ‰€æœ‰ä¸œè¥¿ï¼Œéƒ½æ˜¯å¦‚ä½•å¤§é‡åå“ºäº† Swift è‡ªèº«ã€‚ä¾‹å¦‚ï¼Œç±»ä¼¼ <a href="https://developer.apple.com/documentation/swift/swift_standard_library/encoding_decoding_and_serialization" target="_blank" rel="noopener"><code>Codable</code></a> åŠŸèƒ½ï¼Œåœ¨å®ƒæœªå®Œæˆä¹‹å‰äººä»¬ä¼šå¼€å‘æ•°ä»¥åƒè®¡çš„ JSON æ˜ å°„åº“ã€‚æˆ‘ä¹Ÿæ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚æˆ‘æ›¾ç»æ„å»ºäº† <a href="https://github.com/JohnSundell/Unbox" target="_blank" rel="noopener">Unbox</a> ï¼Œå› ä¸ºåœ¨ Objective-C ä¸­ä½ ä¸éœ€è¦åœ¨è¿™æ–¹é¢èŠ±è´¹è®¸å¤šæ—¶é—´å’Œç²¾åŠ›ã€‚ä½ åªéœ€è¦è¯´ï¼Œè¿™æ˜¯ä¸ªå­—å…¸ï¼Œé‚£æˆ‘ä»¬å°±è®¿é—®å®ƒçš„æŸä¸ª Key ç„¶åå‡è®¾è¿”å›ç»“æœæ°¸è¿œæ˜¯å­—ç¬¦ä¸²ã€‚ä½†ä¸€æ—¦ä½ åä¸‹æ¥æŠŠåŒæ ·çš„ä»£ç ä»¥ Swift å®ç°çš„è¯ï¼Œä½ å°±ä¼šå‘ç°éœ€è¦ç”¨åˆ°å¤§é‡çš„ <code>if let</code>ã€‚å› æ­¤æˆ‘èƒ½æƒ³è±¡åˆ°è¿™äº›å¤§å®¶éƒ½å°è¯•è§£å†³çš„ä¸œè¥¿ï¼Œç»å¯¹ä¼šä»¥ä¸åŒçš„æ–¹å¼åå“º Swift è‡ªèº«çš„è®¾è®¡è¿›ç¨‹ã€‚</p><p><strong>Chris Lattner:</strong> æ˜¯çš„ï¼Œè¿™æ— å¯åšéã€‚è€Œä¸” <code>Codable</code> çš„è®¾è®¡æ¥è‡ªäº Apple çš„ä¸€æ”¯é Swift æ ¸å¿ƒå¼€å‘å›¢é˜Ÿçš„åŠ¨æ€åº“å›¢é˜Ÿã€‚ä»–ä»¬å¯¹è¿™ä¸ªå·¥ä½œçœŸçš„å¾ˆæœ‰è€å¿ƒï¼Œä»–ä»¬å®ç°å¹¶æ¨åŠ¨ç€å®ƒï¼Œå¹¶ä¸”ä¸€ç›´æ”¯æŒç€å®ƒä¸Šçº¿ã€‚</p><blockquote><p>å¾ˆéš¾æƒ³è±¡åˆ°åº•ç¤¾åŒºå½±å“äº† Swift å¤šå°‘ã€‚</p></blockquote><p>ç¤¾åŒºå‘ˆç°äº†å„ç§å„æ ·çš„ä¸œè¥¿å¯¹å§ï¼Ÿæ¯”å¦‚ <a href="https://developer.apple.com/documentation/swift/result" target="_blank" rel="noopener"><code>Result</code></a>ã€‚ä¸ºä»€ä¹ˆ <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0235-add-result.md" target="_blank" rel="noopener"><code>Result</code> è¦åŠ å…¥åˆ° Swift 5 ä¸­</a>ï¼Ÿå› ä¸ºæˆ‘ä»¬ä¸€æ¬¡åˆä¸€æ¬¡åœ°æ„é€ äº†å®ƒã€‚å³ä½¿ <a href="https://swift.org/community/#core-team" target="_blank" rel="noopener">æ ¸å¿ƒå›¢é˜Ÿ</a> ä¸å¸Œæœ›æœ‰ä¸€ä¸ª <code>Result</code> ç±»å‹ï¼Œå› ä¸ºè¿™ä»¿ä½›æ˜¯è¯­è¨€çš„å¤±è´¥ä½“ç°ï¼›å³ä½¿æˆ‘ä»¬ä¸€è‡´è®¤ä¸º <code>Result</code> ç±»å‹ä¸æ˜¯å¿…è¦çš„ã€‚ä½†ç¤¾åŒºä¸­å´ä¸€ç›´æœ‰æ¸…æ™°ä¸”å¼ºçƒˆçš„å£°éŸ³ï¼Œâ€œä½ ä»¬çœ‹ï¼Œæˆ‘ä»¬éœ€è¦å®ƒã€‚ä¸ç®¡åœ¨é•¿æœŸçœ‹æ¥å®ƒæ˜¯å¦ç†æƒ³ï¼Œä½†æˆ‘ä»¬ç°åœ¨çš„ç¡®éœ€è¦ã€‚â€å› æ­¤ç¤¾åŒºçœŸçš„å½±å“äº†å¾ˆå¤šä¸œè¥¿ã€‚è€Œä¸”ä½ å¯èƒ½éš¾ä»¥æƒ³è±¡åˆ°åº•ç¤¾åŒºå½±å“äº† Swift å¤šå°‘ã€‚</p></blockquote><hr><h2 id="å…³äºåˆå§‹é¢„æœŸ"><a href="#å…³äºåˆå§‹é¢„æœŸ" class="headerlink" title="å…³äºåˆå§‹é¢„æœŸ"></a>å…³äºåˆå§‹é¢„æœŸ</h2><p><em>ï¼ˆå¼€å§‹äº 46:07ï¼‰</em></p><blockquote><p><strong>John Sundell:</strong> å¯¹äº Swift çš„ç°çŠ¶ï¼Œä»¥åŠä½ å‘å¸ƒ Swift åå®ƒçš„æ”¹å˜ï¼Œè¿™äº›æ˜¯å¦éƒ½ç¬¦åˆä½ çš„é¢„æœŸå‘¢ï¼Ÿç»è¿‡äº†è¿™äº›å¹´ï¼Œå¯¹äºä½ åœ¨æœ€åˆé˜¶æ®µçš„æƒ³æ³•ï¼ŒSwift ç°åœ¨æœ‰å¤šå°‘æ˜¯ç¬¦åˆçš„ï¼Ÿ</p><blockquote><p>å½“ Swift 1 å‘å¸ƒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ä¸€äº›ç–‘é—®ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨ Objective-C çš„ç¤¾åŒºä¸­è·å¾—ä¸€å¸­ä¹‹åœ°ï¼Ÿæˆ‘ä»¬æ˜¯å¦èƒ½åœ¨ iOS çš„ç”Ÿæ€ç³»ç»Ÿä¸­è·å¾—ä¸€å¸­ä¹‹åœ°ï¼Œæˆ–è€…æ˜¯å°†ä¼šåˆ†æˆå‡ æ´¾ï¼Ÿ</p></blockquote><p><strong>Chris Lattner:</strong> è¿™ä¹ˆè¯´å§ï¼Œæˆ‘è§‰å¾—é¢„æœŸä¹Ÿä¼šéšæ—¶é—´æ”¹å˜ã€‚å¦‚æœå›åˆ° 2010-2011 å¹´ï¼Œæˆ‘å¹¶æ²¡æœ‰é¢„æƒ³ç€å®ƒä¼šæœ‰å¤šæˆåŠŸã€‚æˆ‘æ‰¿è®¤å½“æ—¶æˆ‘åªæ˜¯è§‰å¾—è¿™æ˜¯ä¸ªæœ‰è¶£çš„ä¸šä½™é¡¹ç›®ã€‚è¿™åŸæœ¬å°±æ˜¯ä¸ªå¡«è¡¥å¤œæ™šå’Œå‘¨æœ«æ—¶é—´çš„ä¸œè¥¿ã€‚ä½ çŸ¥é“ï¼Œåœ¨æ•´æ—¥çš„å·¥ä½œåå†å»åšä¸€ä¸ªä¸šä½™é¡¹ç›®æ˜¯å¾ˆæœ‰è¶£ä¹Ÿå¾ˆå…·æŒ‘æˆ˜æ€§çš„ã€‚å½“å®ƒè¶Šæ¥è¶Šæ¥è¿‘å®Œæˆï¼Œå¹¶ç›´åˆ° Swift 1 å‘å¸ƒæ—¶ï¼Œæˆ‘ä»¬éƒ½ä¸€äº›ç–‘é—®â€”â€”æˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨ Objective-C çš„ç¤¾åŒºä¸­è·å¾—ä¸€å¸­ä¹‹åœ°ï¼Ÿæˆ‘ä»¬æ˜¯å¦èƒ½åœ¨ iOS çš„ç”Ÿæ€ç³»ç»Ÿä¸­è·å¾—ä¸€å¸­ä¹‹åœ°ï¼Œæˆ–è€…æ˜¯å°†ä¼šåˆ†æˆå‡ æ´¾ï¼Ÿæˆ‘ä»¬å½“æ—¶çš„ç¡®æœ‰è¿™æ ·çš„ç–‘è™‘ã€‚ç°åœ¨æˆ‘å¯ä»¥è¯´æˆ‘ä¼šæ„Ÿåˆ°å¾ˆæ¬£æ…°ï¼Œå› ä¸ºæˆ‘è§‰å¾—ç¤¾åŒºä¸­ç»å¤§å¤šæ•°äººéƒ½å¯¹ Swift æŒä¹è§‚æ€åº¦ã€‚</p><p><strong>Chris Lattner:</strong> ä¸è¿‡ç°åœ¨ä¾ç„¶æœ‰æ–°çš„é¢†åŸŸç­‰å¾…æ¢ç´¢ã€‚Swift åœ¨æœåŠ¡ç«¯çš„è¡¨ç°ä¸€ç›´è¶Šæ¥è¶Šå¥½ï¼Œä½†ä»æœ‰å¤§é‡çš„å·¥ä½œéœ€è¦å®Œæˆã€‚åœ¨å¤–éƒ¨ï¼Œä¹Ÿæœ‰è®¸å¤šä¸åŒçš„ç¤¾åŒºæ´»è·ƒç€ã€‚æˆ‘å¯¹æ•°å­—å’Œ <a href="https://github.com/tensorflow/swift" target="_blank" rel="noopener">æœºå™¨å­¦ä¹ çš„ç¤¾åŒº</a> ç‰¹åˆ«æ„Ÿå…´è¶£ï¼Œè¿™äº›å¯¹å…¨ä¸–ç•Œéƒ½æœ‰é‡è¦çš„æ„ä¹‰ã€‚åœ¨è¿™äº›ç¤¾åŒºä¸­ï¼Œæœ‰ç€è®¸å¤šæœ‰è¶£çš„äººï¼Œæˆ‘è§‰å¾— Swift åœ¨è¿™é‡Œå¯ä»¥å‘å±•å¾—å¾ˆå¥½ã€‚</p><blockquote><p>Swift çš„å…¨çƒåˆ¶éœ¸åªæ˜¯ä¸€ä¸ªå¼€ç©ç¬‘çš„ç›®æ ‡ï¼Œä½†å®ƒæ¥æºäºä½¿ç”¨å’Œçƒ­çˆ± Swift çš„äººä»¬çš„ä¿¡å¿µã€‚</p></blockquote><p>æˆ‘æœ‰æ—¶ä¼šå¼€ç©ç¬‘åœ°è¯´ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ <a href="https://oleb.net/blog/2017/06/chris-lattner-wwdc-swift-panel/#in-which-fields-would-you-like-to-see-swift-in-the-future" target="_blank" rel="noopener">Swift å…¨çƒåˆ¶éœ¸</a>ã€‚è¿™åªæ˜¯ä¸€ä¸ªç©ç¬‘ç›®æ ‡ï¼Œä½†å®ƒæ¥æºäºä½¿ç”¨å’Œçƒ­çˆ± Swift çš„äººä»¬çš„ä¿¡å¿µã€‚å¦‚æœçœŸæ˜¯è¿™æ ·çš„è¯ï¼Œæˆ‘ä¼šéå¸¸æ„¿æ„æŠŠè¿™ä»½æ„‰æ‚¦å¸¦ç»™äººä»¬ï¼Œå¹¶å¸®åŠ©æ”¹å–„æ•´ä¸ªä¸–ç•Œã€‚ç°å®ä¸­ä»æœ‰è®¸å¤šè®©äººå¤´ç—›çš„ç³»ç»Ÿå¯¹å§ï¼Ÿä»æœ‰è®¸å¤šäººè¿˜åœ¨å†™ç€ C è¯­è¨€ä»£ç ã€‚å°±é‚£äº› <a href="https://oleb.net/blog/2017/06/chris-lattner-wwdc-swift-panel/#in-which-fields-would-you-like-to-see-swift-in-the-future" target="_blank" rel="noopener">bug å’Œå®‰å…¨è„†å¼±æ€§</a> æ¥è¯´ï¼ŒçœŸæ˜¯è®©äººæ„Ÿè§‰ååˆ†ä¸å¹¸ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜è¦é¢å¯¹ç”Ÿæ€ç³»ç»Ÿçš„é—®é¢˜ï¼Œä»¥åŠè®¸å¤šå…¶ä»–çš„æŒ‘æˆ˜è¦å¾æœï¼Œè¿™éƒ½æ˜¯æˆ‘ä»¬ä½œä¸ºä¸€ä¸ªç¤¾åŒºå¯ä»¥å®Œæˆçš„ã€‚åœ¨è¿™æ–¹é¢ï¼Œæˆ‘è®¤ä¸ºæœ‰ç€æ— é™çš„å¯èƒ½ã€‚</p></blockquote><hr><h2 id="åœ¨-Apple-ç¤¾åŒºä»¥å¤–æ¨å¹¿-Swift"><a href="#åœ¨-Apple-ç¤¾åŒºä»¥å¤–æ¨å¹¿-Swift" class="headerlink" title="åœ¨ Apple ç¤¾åŒºä»¥å¤–æ¨å¹¿ Swift"></a>åœ¨ Apple ç¤¾åŒºä»¥å¤–æ¨å¹¿ Swift</h2><p><em>ï¼ˆå¼€å§‹äº 50:18ï¼‰</em></p><blockquote><p><strong>Chris Lattner:</strong> å°½ç®¡äººä»¬ç°åœ¨éƒ½æ˜¯ä»¥ç§¯æã€ä¹è§‚çš„æ€åº¦æ¥è®¨è®º Swiftï¼Œå¯ Swift ä»æœ‰è®¸å¤šé—®é¢˜ã€‚æˆ‘è§‰å¾—æˆ‘ä»¬å¿…é¡»ä¿æŒå¼€æ”¾çš„æ€åº¦æ¥è®¨è®ºè¿™ä¸ªï¼Œå¹¶æŠŠå®ƒçœ‹ä½œä¸€ä¸ªè§£å†³é—®é¢˜çš„ç»ƒä¹ ã€‚ä¸»è¦çš„é—®é¢˜é›†ä¸­åœ¨ Linux ç”Ÿæ€ç³»ç»Ÿä¸Šé¢ï¼Œä¸ä¹‹ç›¸æ¯”ï¼Œ<a href="https://dev.azure.com/compnerd/windows-swift" target="_blank" rel="noopener">Windows ç”Ÿæ€ç³»ç»Ÿ</a> çš„é—®é¢˜ç®€ç›´ä¸å€¼ä¸€æã€‚ä¸ºäº†è®© Swift çš„å—ä¼—æ›´å¹¿æ³›ï¼Œæˆ‘ä»¬çœŸçš„è¿˜æœ‰è®¸å¤šå·¥ä½œè¦åšã€‚</p><blockquote><p>Swift ä»æœ‰è®¸å¤šé—®é¢˜ã€‚ä¸»è¦çš„é—®é¢˜é›†ä¸­åœ¨  Linux ç”Ÿæ€ç³»ç»Ÿä¸Šé¢ã€‚Swift åœ¨ <a href="https://dev.azure.com/compnerd/windows-swift" target="_blank" rel="noopener">Windows ç”Ÿæ€ç³»ç»Ÿ</a> çš„é—®é¢˜ç®€ç›´ä¸å€¼ä¸€æã€‚</p></blockquote><p><strong>Chris Lattner:</strong> æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰“é€ ä¸€ä¸ªä¸æ’å¤–çš„ç¤¾åŒºã€‚å¯äº‹ä¸æ„¿è¿çš„æ˜¯ï¼Œå¦‚æœä½ ä¸æ˜¯ä¸€å Apple å¼€å‘è€…ï¼Œä½ å¯èƒ½ä¼šåœ¨æœç´¢ Swift ç›¸å…³çš„ä¸œè¥¿æ—¶æ„Ÿåˆ°èå…¥ä¸äº†ç¤¾åŒºï¼Œå› ä¸ºæœç´¢ç»“æœéƒ½æ˜¯ä¸€äº› iOS ç›¸å…³çš„è®¨è®ºã€‚</p><blockquote><p>å¦‚æœä½ ä¸æ˜¯ä¸€å Apple å¼€å‘è€…ï¼Œä½ å¯èƒ½ä¼šåœ¨æœç´¢ Swift ç›¸å…³çš„ä¸œè¥¿æ—¶æ„Ÿåˆ°èå…¥ä¸äº†ç¤¾åŒºï¼Œå› ä¸ºæœç´¢ç»“æœéƒ½æ˜¯ä¸€äº› iOS ç›¸å…³çš„è®¨è®ºã€‚</p></blockquote><p><strong>John Sundell:</strong> å®Œå…¨æ­£ç¡®ã€‚æ¯”å¦‚â€œè¿™æ˜¯å¦‚ä½•åœ¨ <code>UIViewController</code> ä¸­å®Œæˆå®ƒçš„æ–¹æ³•ã€‚â€</p><p><strong>Chris Lattner:</strong> æ²¡é”™ã€‚è¿™ä¼šè®©ä½ è§‰å¾—è‡ªå·±æ˜¯ä¸ªå¤–æ¥è€…ï¼Œä½†è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬çš„åˆè¡·ã€‚æˆ‘è®¤ä¸ºè¿™ä¸æ˜¯æœ‰æ„ä¸ºä¹‹çš„ï¼Œä½†å®ƒå´æ˜¯çœŸå®å­˜åœ¨çš„ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬ç¤¾åŒºæ‰€é¢å¯¹çš„ä¸€å¤§æŒ‘æˆ˜ã€‚æˆ‘ç›®å‰è¿˜ä¸çŸ¥é“æœ‰æ²¡æœ‰æ¯”è¾ƒå®Œç¾è§£å†³æ–¹æ¡ˆï¼Œä¸è¿‡æˆ‘æƒ³æˆ‘ä»¬æ€»ä¼šæ‰¾åˆ°çš„ã€‚</p></blockquote><hr><h2 id="å…³äº-Swift-çš„æ¼”è¿›"><a href="#å…³äº-Swift-çš„æ¼”è¿›" class="headerlink" title="å…³äº Swift çš„æ¼”è¿›"></a>å…³äº Swift çš„æ¼”è¿›</h2><p><em>ï¼ˆå¼€å§‹äº 55:12ï¼‰</em></p><blockquote><p><strong>Chris Lattner:</strong> ï¼ˆå…³äº Swift çš„æ¼”è¿›ï¼‰è¿™æ˜¯ä¸ªéå¸¸å¤æ‚çš„äº‹æƒ…ï¼Œæˆ‘å¤§æ¦‚è¦å¥½å‡ ä¸ªå°æ—¶æ‰èƒ½å…¨éƒ¨è®²å®Œã€‚å¦‚æœç®€çŸ­åœ°è¯´ä¸€ä¸‹æˆ‘çš„æƒ³æ³•â€”â€”å¼€æ”¾è¦å¥½äºå°é—­ã€‚å¦‚æœä½ èƒ½è®©æ›´å¤šäººå‚ä¸ï¼Œé‚£ä¹ˆä½ è‚¯å®šèƒ½å¾—åˆ°ä¸€ä¸ªæ›´å¥½çš„ç»“æœã€‚æˆ‘æƒ³ <a href="(https://github.com/apple/swift-evolution">Swift Evolution</a>) çš„é¡¹ç›®è¿›å±•æœ‰å¾ˆå¤šé—®é¢˜ï¼ŒGarric ä¹Ÿåˆ—ä¸¾äº†ä¸€äº›ã€‚ä½†è¿™ä¸å¦¨ç¢å®ƒæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¸œè¥¿ã€‚åŒæ—¶æœ‰ä¸€ç‚¹æˆ‘è®¤ä¸ºæ˜¯æœ‰ç›Šçš„ï¼Œå°±æ˜¯å®ƒå¾ˆå¥½åœ°å‡ç¼“äº†è¯­è¨€çš„æ¼”è¿›ã€‚å› ä¸ºå°å¿ƒè°¨æ…åœ°å‘å±•ä¸€ä¸ªè¯­è¨€æ€»æ¯”è¿‡å¿«åœ°å‘å±•å¥½ã€‚</p><p>æˆ‘è§‰å¾—å¼ºåˆ¶åœ°æ¨åŠ¨ä¸€ç³»åˆ—æ–‡æ¡£è¿›å±•ä¹Ÿæ˜¯ä¸€ä»¶å¾ˆå¥½çš„äº‹æƒ…ï¼Œå› ä¸ºæ–‡æ¡£æ˜¯ååˆ†é‡è¦çš„ã€‚Swift Evolution é¡¹ç›®å¼•é¢†äº†è‹¹æœä¸ç¤¾åŒºåœ¨æŸç§è§„èŒƒä¸‹ï¼Œä»¥ä¸åŒçš„æ–¹å¼è¿›è¡Œåˆä½œï¼Œè¿™ä¸ä»…æœ‰è¶£ï¼Œä¹Ÿæ˜¯éå¸¸æ£’çš„ä¸€ä»¶äº‹ã€‚</p><p>æˆ‘ä¸è®¤ä¸º Swift Evolution é¡¹ç›®æ˜¯ä¸€æˆä¸å˜çš„ã€‚åœ¨è¿™å‡ å¹´çš„æ—¶é—´é‡Œï¼Œå®ƒåœ¨ä¸åŒæ–¹é¢éƒ½å‘ç”Ÿäº†æ”¹å˜ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨è‰°éš¾åœ°æƒè¡¡ç€å®ƒçš„ç›®çš„â€”â€”åˆ°åº•æ˜¯ä¸ºç¤¾åŒºè¾“å‡ºè®¾è®¡è§„èŒƒè¿˜æ˜¯å¸®åŠ©ç¤¾åŒºç¡®å®šä¼˜å…ˆçº§ï¼Ÿå¯¹æˆ‘ä»¬æ¥è¯´ï¼Œè¿™æ˜¯ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ï¼Œå› ä¸ºå½“ä½ æŠŠå®ƒå®Œå…¨äº¤ç»™ç¤¾åŒºå»æ‰§è¡Œæ—¶ï¼Œä½ å¯èƒ½ä¼šå¤±å»ä¸€äº›ç»†èŠ‚çš„ä¸œè¥¿ã€‚ä½†åœ¨ä¸€äº›å¤§æ–¹å‘ä¸Šï¼Œæ•´ä¸ª Swift çš„ä¸–ç•Œéƒ½æ˜¯è®¤åŒçš„â€”â€”æ¯”å¦‚ <a href="https://forums.swift.org/t/concurrency-async-await-actors/6499" target="_blank" rel="noopener">å¹¶å‘æ€§</a>ã€‚</p><p>è¿™æ˜¯æˆ‘ä»¬çš„ä¸€æ¬¡éå¸¸å¤§çš„å°è¯•ï¼Œè€Œä¸”é€šè¿‡ä¸€ä¸ªè‡ªåº•å‘ä¸Šçš„ç¤¾åŒºæµç¨‹æ¥å®ç°å®ƒä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ã€‚å› æ­¤å¾ˆå¤šäº‹å¯¹æˆ‘æ¥è¯´éƒ½æ˜¯æœªçŸ¥çš„ã€‚æˆ‘è§‰å¾— Swift Evolution æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„é¡¹ç›®ã€‚æˆ‘ä¹Ÿå¾ˆå¼€å¿ƒæˆ‘ä»¬ç°åœ¨æ‹¥æœ‰è¿™ä¸ªé¡¹ç›®ã€‚å°½ç®¡æˆ‘åŒæ„å®ƒä¸æ˜¯æˆ‘ä»¬æ‰€å”¯ä¸€æ‹¥æœ‰çš„ï¼Œä¹Ÿä¸åº”è¯¥æ˜¯å”¯ä¸€çš„ï¼Œä½†æˆ‘ä»è§‰å¾—å®ƒç»å¯¹æ˜¯ä¸šç•Œæ ‡æ†ä¹‹ä¸€ã€‚</p><p>ï¼ˆâ€¦â€¦ï¼‰</p><blockquote><p>æˆ‘ä¸€ç›´åœ¨å¯»æ‰¾ Swift åŒ…ç®¡ç†ç”Ÿæ€ç³»ç»Ÿçš„å‚¬åŒ–å‰‚ï¼Œåˆ°åº•åº”è¯¥ä»¥æœåŠ¡ç«¯ Swift çš„ç¤¾åŒºä¸ºèµ·ç‚¹ï¼Œè¿˜æ˜¯ä»¥æœºå™¨å­¦ä¹ ç¤¾åŒºä¸ºèµ·ç‚¹ã€‚</p></blockquote><p>ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼ŒSwift çš„æ¯ä¸€ä¸ªå˜åŠ¨ï¼Œéƒ½éœ€è¦ä¸€æ®µæ—¶é—´æ¥æ¶ˆåŒ–ã€‚å½“ä¸€ä¸ªå¤§çš„æ–°èƒ½åŠ›å‡ºç°æ—¶ï¼Œç¤¾åŒºéƒ½éœ€è¦ä¸€æ®µæ—¶é—´æ¥å¼„æ˜ç™½å®ƒã€åº”ç”¨å®ƒã€æ‰¾å‡ºå®ƒçš„ä½¿ç”¨åœºæ™¯å’Œå®ƒå¦‚ä½•ä¸å…¶ä»–åŠŸèƒ½å…¼å®¹ã€‚å› æ­¤ï¼ŒèŠ±è´¹çš„è¿™äº›æ—¶é—´éƒ½æ˜¯å€¼å¾—çš„ã€‚æˆ‘ä» Swift Evolution æ‰€è®¤è¯†åˆ°çš„æœ€é‡è¦çš„äº‹ï¼Œå°±æ˜¯ç¤¾åŒºçš„åˆç†æ¨åŠ¨æ‰€å¸¦æ¥çš„åŠ›é‡ã€‚Swift Evolution çœŸçš„ä¸ºæˆ‘ä»¬èšé›†äº†è®¸å¤šæ¥è‡ªç¤¾åŒºçš„è¯­è¨€æå®¢ï¼Œè®©ä»–ä»¬åŒæ—¶å…³æ³¨ Swift é¡¹ç›®ä¸€ä¸ªç‰¹å®šæ–¹é¢ã€‚æˆ‘ä¸€ç›´åœ¨å¯»æ‰¾ Swift åŒ…ç®¡ç†ç”Ÿæ€ç³»ç»Ÿå‘å±•çš„å‚¬åŒ–å‰‚ï¼Œåˆ°åº•åº”è¯¥ä»¥æœåŠ¡ç«¯ Swift çš„ç¤¾åŒºä¸ºèµ·ç‚¹ï¼Œè¿˜æ˜¯æŠŠæœºå™¨å­¦ä¹ ç¤¾åŒºèšé›†èµ·æ¥å¹²ç‚¹å¤§äº‹ã€‚</p><p>æˆ‘ä»¬å¦‚ä½•å»å¯»æ‰¾è¿™ç§å‚¬åŒ–å‰‚â€”â€”è®©å¤§å®¶åœ¨åˆé€‚çš„åœ°æ–¹èšåœ¨ä¸€èµ·ï¼Œé€šè¿‡ä»–ä»¬è‡ªå·±çš„åŠ›é‡æ„å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå‘æŒ¥ä»–ä»¬çš„èƒ½åŠ›å’Œå¤©èµ‹ï¼Œè®©å¤§å®¶åä½œå·¥ä½œï¼Ÿ</p></blockquote><p>[^1]:  <a href="https://twitter.com/uint_min/status/1098628355539124224" target="_blank" rel="noopener">Jordan Rose åˆ†äº«äº†ä¸€åˆ™ä¸ Shiny è¿™ä¸ªåå­—ç›¸å…³çš„ä½šäº‹</a> ï¼š.swiftmodule æ–‡ä»¶ä¸­çš„â€œé­”æ³•æ•°å­—â€æ˜¯ E2 9C A8 0Eã€‚å®ƒçš„å‰ä¸‰ä¸ªå­—èŠ‚æ˜¯ âœ¨ çš„ UTF-8 å­—ç¬¦ï¼ˆU+2728 SPARKLESï¼‰ã€‚</p><p>[^2]:  <a href="https://twitter.com/gparker/status/1099251522422992896" target="_blank" rel="noopener">Greg Parker å£°ç§°</a> ARC åªæ˜¯é—´æ¥åœ°ä» Swift çš„å¼€å‘è¿‡ç¨‹ä¸­äº§ç”Ÿï¼šARC çš„å®ç°æ—©äº Swift çš„å®ç°ã€‚ä½†åœ¨å¹•åçš„å·¥ä½œä¸­ï¼ŒSwift æ—©æœŸçš„è®¾æƒ³çš„ç¡®æ¨è¿›äº†ç®¡ç†å±‚æä¾›å¿…è¦çš„èµ„æºå»æ„å»ºå’Œéƒ¨ç½² ObjC çš„ ARCã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šOle Begemannï¼Œ&lt;a href=&quot;https://oleb.net/2019/chris-lattner-swift-origins/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2019-02-18&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://dingtz.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;jojotov&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://numbbbbb.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;numbbbbb&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://github.com/WAMaker&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;WAMaker&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/Pancf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Pancf&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;åœ¨ &lt;a href=&quot;https://www.swiftcommunitypodcast.org/episodes/1&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ–°æ¨å‡ºçš„ Swift ç¤¾åŒºæ’­å®¢ç¬¬ä¸€é›†&lt;/a&gt; ä¸­ï¼Œ&lt;a href=&quot;http://nondot.org/sabre/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Chris Lattner&lt;/a&gt;, &lt;a href=&quot;https://garricn.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Garric Nahapetian&lt;/a&gt;, å’Œ &lt;a href=&quot;https://www.swiftbysundell.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;John Sundell&lt;/a&gt; è®²è¿°äº†å…³äº Swift èµ·æºçš„æ•…äº‹å’Œ Swift ç¤¾åŒºçš„ç°çŠ¶ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æ˜¯æˆ‘æ•´ç†å‡ºçš„ä¸€äº›æ¯”è¾ƒæœ‰è¶£çš„ä¸œè¥¿ï¼ˆä¸ºäº†èƒ½æ›´å¥½åœ°é˜…è¯»è€Œåšäº†éƒ¨åˆ†ä¿®æ”¹ï¼‰ã€‚ä½ å¯ä»¥çœ‹åˆ°æˆ‘ä¸»è¦å¼•ç”¨äº† Chris Lattner çš„è®²è¯ï¼Œå› ä¸ºæˆ‘è®¤ä¸ºä»–å¯¹äº Swift æ˜¯å¦‚ä½•è¢«åˆ›é€ å‡ºæ¥çš„æè¿°æ˜¯æœ€å€¼å¾—ä¿ç•™ä¸‹å»çš„ã€‚ä½†è¿™å¹¶ä¸ä»£è¡¨ John å’Œ Garric æ‰€è¯´çš„ä¸œè¥¿æ²¡é‚£ä¹ˆæœ‰è¶£ã€‚ä½ çœŸçš„åº”è¯¥å»å®Œæ•´åœ°æ”¶å¬æ•´é›†æ’­å®¢â€”â€”åæ­£æ‰€èŠ±çš„æ—¶é—´å’Œé˜…è¯»æœ¬æ–‡ç›¸å·®æ— å‡ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Ole Begemann" scheme="https://swift.gg/categories/Ole-Begemann/"/>
    
      <category term="Swift" scheme="https://swift.gg/categories/Ole-Begemann/Swift/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
      <category term="Ole Begemann" scheme="https://swift.gg/tags/Ole-Begemann/"/>
    
  </entry>
  
  <entry>
    <title>å›¾åƒä¼˜åŒ–</title>
    <link href="https://swift.gg/2019/10/09/optimizing-images/"/>
    <id>https://swift.gg/2019/10/09/optimizing-images/</id>
    <published>2019-10-09T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šJordan Morganï¼Œ<a href="https://www.swiftjectivec.com/optimizing-images/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-12-11<br>è¯‘è€…ï¼š<a href="https://nemocdz.github.io/" target="_blank" rel="noopener">Nemocdz</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><hr><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>ä¿—è¯è¯´å¾—å¥½ï¼Œæœ€å¥½çš„ç›¸æœºæ˜¯ä½ èº«è¾¹çš„é‚£ä¸ªã€‚é‚£ä¹ˆæ¯«æ— ç–‘é—® - iPhone å¯ä»¥è¯´æ˜¯è¿™ä¸ªæ˜Ÿçƒæœ€é‡è¦çš„çš„ç›¸æœºã€‚è€Œè¿™åœ¨ä¸šç•Œä¹Ÿå·²ç»è¾¾æˆå…±è¯†ã€‚</p><p>åœ¨åº¦å‡ï¼Ÿä¸å·å·æ‹å‡ å¼ è®°å½•åœ¨ä½ çš„ Instagram æ•…äº‹é‡Œï¼Ÿä¸å­˜åœ¨çš„ã€‚</p><p>å‡ºç°çˆ†ç‚¸æ–°é—»ï¼ŸæŸ¥çœ‹ Twitterï¼Œå°±å¯ä»¥çŸ¥é“æ˜¯å“ªäº›åª’ä½“æ­£åœ¨æŠ¥é“ï¼Œé€šè¿‡ä»–ä»¬æ­éœ²äº‹ä»¶çš„å®æ—¶ç…§ç‰‡ã€‚</p><p>ç­‰ç­‰â€¦â€¦</p><p>æ­£å› ä¸ºå›¾åƒåœ¨å¹³å°ä¸Šæ— å¤„ä¸åœ¨ï¼Œå¦‚æœç®¡ç†ä¸å½“ï¼Œå¾ˆå®¹æ˜“å‡ºç°æ€§èƒ½å’Œå†…å­˜é—®é¢˜ã€‚ç¨å¾®äº†è§£ä¸‹ UIKitï¼Œææ¸…æ¥šå®ƒå¤„ç†å›¾åƒçš„æœºåˆ¶ï¼Œå¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ï¼Œé¿å…åšæ— ç”¨åŠŸã€‚</p><a id="more"></a><h3 id="ç†è®ºçŸ¥è¯†"><a href="#ç†è®ºçŸ¥è¯†" class="headerlink" title="ç†è®ºçŸ¥è¯†"></a>ç†è®ºçŸ¥è¯†</h3><p>å¿«é—®å¿«ç­” - è¿™æ˜¯ä¸€å¼ æˆ‘æ¼‚äº®ï¼ˆä¸”æ—¶é«¦ï¼‰å¥³å„¿çš„ç…§ç‰‡ï¼Œå¤§å°ä¸º 266KBï¼Œåœ¨ä¸€ä¸ª iOS åº”ç”¨ä¸­å±•ç¤ºå®ƒéœ€è¦å¤šå°‘å†…å­˜ï¼Ÿ</p><p><img src="https://www.swiftjectivec.com/assets/images/baylor.jpg" alt></p><p>å‰§é€è­¦å‘Š - ç­”æ¡ˆä¸æ˜¯ 266KBï¼Œä¹Ÿä¸æ˜¯ 2.66MBï¼Œè€Œæ˜¯æ¥è¿‘ 14MBã€‚</p><p>ä¸ºå•¥å‘¢ï¼Ÿ</p><p>iOS å®é™…ä¸Šæ˜¯ä»ä¸€å¹…å›¾åƒçš„<em>å°ºå¯¸</em>è®¡ç®—å®ƒå ç”¨çš„å†…å­˜ - å®é™…çš„æ–‡ä»¶å¤§å°ä¼šæ¯”è¿™å°å¾ˆå¤šã€‚è¿™å¼ ç…§ç‰‡çš„å°ºå¯¸æ˜¯ 1718 åƒç´ å®½å’Œ 2048 åƒç´ é«˜ã€‚å‡è®¾æ¯ä¸ªåƒç´ ä¼šæ¶ˆè€—æˆ‘ä»¬ 4 ä¸ªæ¯”ç‰¹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1718 * 2048 * 4 / 1000000 = 14.07 MB å ç”¨</span><br></pre></td></tr></table></figure><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ table viewï¼Œå¹¶ä¸”åœ¨æ¯ä¸€è¡Œå·¦è¾¹ä½¿ç”¨å¸¸è§çš„åœ†è§’å¤´åƒæ¥å±•ç¤ºä»–ä»¬çš„ç…§ç‰‡ã€‚å¦‚æœä½ è®¤ä¸ºè¿™äº›å›¾åƒä¼šåƒæ´é£Ÿï¼ˆçŠ¹å¤ªäººçš„é£Ÿå“ï¼Œæ¯”å–»äº‹æƒ…å®Œç¾æ— ç‘•ï¼‰ä¸€æ ·ï¼Œæ¯ä¸ªéƒ½è¢«ç±»ä¼¼ ImageOptim çš„å·¥å…·å‹ç¼©è¿‡ï¼Œé‚£å¯å°±å¤§é”™ç‰¹é”™äº†ã€‚å³ä½¿æ¯ä¸ªå¤´åƒçš„å¤§å°åªæœ‰ 256x256ï¼Œä¹Ÿä¼šå ç”¨ç›¸å½“ä¸€éƒ¨åˆ†å†…å­˜ã€‚</p><h3 id="æ¸²æŸ“æµç¨‹"><a href="#æ¸²æŸ“æµç¨‹" class="headerlink" title="æ¸²æŸ“æµç¨‹"></a>æ¸²æŸ“æµç¨‹</h3><p>ç»¼ä¸Šæ‰€è¿° - äº†è§£å¹•ååŸç†æ˜¯å€¼å¾—çš„ã€‚å½“ä½ åŠ è½½ä¸€å¼ å›¾ç‰‡æ—¶ï¼Œä¼šæ‰§è¡Œä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š</p><p>1ï¼‰<strong>åŠ è½½</strong> - iOS è·å–å‹ç¼©çš„å›¾åƒå¹¶åŠ è½½åˆ° 266KB çš„å†…å­˜ï¼ˆåœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­ï¼‰ã€‚è¿™ä¸€æ­¥æ²¡å•¥é—®é¢˜ã€‚</p><p>2ï¼‰<strong>è§£ç </strong> - è¿™æ—¶ï¼ŒiOS è·å–å›¾åƒå¹¶è½¬æ¢æˆ GPU èƒ½è¯»å–å’Œç†è§£çš„æ–¹å¼ã€‚è¿™é‡Œä¼šè§£å‹å›¾ç‰‡ï¼Œåƒä¸Šé¢æåˆ°é‚£æ ·å ç”¨ 14MBã€‚</p><p>3ï¼‰<strong>æ¸²æŸ“</strong> - é¡¾åæ€ä¹‰ï¼Œå›¾åƒæ•°æ®å·²ç»å‡†å¤‡å¥½ä»¥ä»»æ„æ–¹å¼æ¸²æŸ“ã€‚å³ä½¿åªæ˜¯åœ¨ä¸€ä¸ª 60x60pt çš„ image view ä¸­ã€‚</p><p>è§£ç é˜¶æ®µæ˜¯æ¶ˆè€—æœ€å¤§çš„ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼ŒiOS ä¼šåˆ›å»ºä¸€å—ç¼“å†²åŒº - å…·ä½“æ¥è¯´æ˜¯ä¸€å—å›¾åƒç¼“å†²åŒºï¼Œä¹Ÿå°±æ˜¯å›¾åƒåœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºã€‚è¿™è§£é‡Šäº†ä¸ºå•¥å†…å­˜å ç”¨å¤§å°å’Œå›¾åƒå°ºå¯¸æœ‰å…³ï¼Œè€Œä¸æ˜¯æ–‡ä»¶å¤§å°ã€‚å› æ­¤ä¹Ÿå¯ä»¥ç†è§£ï¼Œä¸ºä»€ä¹ˆåœ¨å¤„ç†å›¾ç‰‡æ—¶ï¼Œå°ºå¯¸å¦‚æ­¤é‡è¦ã€‚</p><p>å…·ä½“åˆ° <code>UIImage</code>ï¼Œå½“æˆ‘ä»¬ä¼ å…¥ä»ç½‘ç»œæˆ–è€…å…¶å®ƒæ¥æºè¯»å–çš„å›¾åƒæ•°æ®æ—¶ï¼Œå®ƒä¼šå°†æ•°æ®è§£ç åˆ°ç¼“å†²åŒºï¼Œä½†ä¸ä¼šè€ƒè™‘æ•°æ®çš„ç¼–ç æ–¹å¼ï¼ˆæ¯”å¦‚ PNG æˆ–è€… JPGï¼‰ã€‚ç„¶è€Œï¼Œç¼“å†²åŒºå®é™…ä¸Šä¼šä¿å­˜åˆ° <code>UIImage</code> ä¸­ã€‚ç”±äºæ¸²æŸ“ä¸æ˜¯ä¸€ç¬é—´çš„æ“ä½œï¼Œ<code>UIImage</code> ä¼šæ‰§è¡Œä¸€æ¬¡è§£ç æ“ä½œï¼Œç„¶åä¸€ç›´ä¿ç•™å›¾åƒç¼“å†²åŒºã€‚</p><p>æ¥ç€å¾€ä¸‹è¯´ - ä»»ä½• iOS åº”ç”¨ä¸­éƒ½æœ‰ä¸€æ•´å—çš„å¸§ç¼“å†²åŒºã€‚å®ƒä¼šä¿å­˜å†…å®¹çš„æ¸²æŸ“ç»“æœï¼Œä¹Ÿå°±æ˜¯ä½ åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„ä¸œè¥¿ã€‚æ¯ä¸ª iOS è®¾å¤‡è´Ÿè´£æ˜¾ç¤ºçš„ç¡¬ä»¶éƒ½ç”¨è¿™é‡Œé¢å•ä¸ªåƒç´ ä¿¡æ¯é€ä¸ªç‚¹äº®ç‰©ç†å±å¹•ä¸Šåˆé€‚çš„åƒç´ ç‚¹ã€‚</p><p>å¤„ç†é€Ÿåº¦éå¸¸é‡è¦ã€‚ä¸ºäº†è¾¾åˆ°é»„æ²¹èˆ¬é¡ºæ»‘çš„æ¯ç§’ 60 å¸§æ»‘åŠ¨ï¼Œåœ¨ä¿¡æ¯å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆæ¯”å¦‚ç»™ä¸€ä¸ª image view èµ‹å€¼ä¸€å¹…å›¾åƒï¼‰ï¼Œå¸§ç¼“å†²åŒºéœ€è¦è®© UIKit æ¸²æŸ“ app çš„ window ä»¥åŠå®ƒé‡Œé¢æ‰€æœ‰å±‚çº§çš„å­è§†å›¾ã€‚ä¸€æ—¦å»¶è¿Ÿï¼Œå°±ä¼šä¸¢å¸§ã€‚</p><blockquote><p><em>è§‰å¾— 1/60 ç§’å¤ªçŸ­ä¸å¤Ÿç”¨ï¼ŸPro Motion è®¾å¤‡å·²ç»å°†ä¸Šé™æ‹‰åˆ°äº† 1/120 ç§’ã€‚</em></p></blockquote><h3 id="å°ºå¯¸æ­£æ˜¯é—®é¢˜æ‰€åœ¨"><a href="#å°ºå¯¸æ­£æ˜¯é—®é¢˜æ‰€åœ¨" class="headerlink" title="å°ºå¯¸æ­£æ˜¯é—®é¢˜æ‰€åœ¨"></a>å°ºå¯¸æ­£æ˜¯é—®é¢˜æ‰€åœ¨</h3><p>æˆ‘ä»¬å¯ä»¥å¾ˆç®€å•åœ°å°†è¿™ä¸ªè¿‡ç¨‹å’Œå†…å­˜çš„æ¶ˆè€—å¯è§†åŒ–ã€‚æˆ‘åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼Œå¯ä»¥åœ¨ä¸€ä¸ª image view ä¸Šå±•ç¤ºéœ€è¦çš„å›¾åƒï¼Œè¿™é‡Œç”¨çš„æ˜¯æˆ‘å¥³å„¿çš„ç…§ç‰‡ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> filePath = <span class="type">Bundle</span>.main.path(forResource:<span class="string">"baylor"</span>, ofType: <span class="string">"jpg"</span>)!</span><br><span class="line"><span class="keyword">let</span> url = <span class="type">NSURL</span>(fileURLWithPath: filePath)</span><br><span class="line"><span class="keyword">let</span> fileImage = <span class="type">UIImage</span>(contentsOfFile: filePath)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Image view</span></span><br><span class="line"><span class="keyword">let</span> imageView = <span class="type">UIImageView</span>(image: fileImage)</span><br><span class="line">imageView.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">imageView.contentMode = .scaleAspectFit</span><br><span class="line">imageView.widthAnchor.constraint(equalToConstant: <span class="number">300</span>).isActive = <span class="literal">true</span></span><br><span class="line">imageView.heightAnchor.constraint(equalToConstant: <span class="number">400</span>).isActive = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">view.addSubview(imageView)</span><br><span class="line">imageView.centerXAnchor.constraint(equalTo: view.centerXAnchor).isActive = <span class="literal">true</span></span><br><span class="line">imageView.centerYAnchor.constraint(equalTo: view.centerYAnchor).isActive = <span class="literal">true</span></span><br></pre></td></tr></table></figure><blockquote><p><em>å®è·µä¸­è¯·æ³¨æ„å¼ºåˆ¶è§£åŒ…ã€‚è¿™é‡Œåªæ˜¯ä¸€ä¸ªç®€å•çš„åœºæ™¯ã€‚</em></p></blockquote><p>å®Œæˆä¹‹åå°±ä¼šæ˜¯è¿™ä¸ªæ ·å­ï¼š</p><p><img src="https://www.swiftjectivec.com/assets/images/baylorPhone.jpg" alt></p><p>è™½ç„¶å±•ç¤ºå›¾ç‰‡çš„ image view å°ºå¯¸å¾ˆå°ï¼Œä½†æ˜¯ç”¨ LLDB å°±å¯ä»¥çœ‹åˆ°å›¾åƒçš„çœŸæ­£å°ºå¯¸ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;UIImage: 0x600003d41a40&gt;, &#123;1718, 2048&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ - è¿™é‡Œçš„å•ä½æ˜¯<em>ç‚¹</em>ã€‚æ‰€ä»¥å½“æˆ‘åœ¨ 3x æˆ– 2x è®¾å¤‡æ—¶ï¼Œå¯èƒ½è¿˜éœ€è¦é¢å¤–ä¹˜ä¸Šè¿™ä¸ªæ•°å­—ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ vmmap æ¥ç¡®è®¤è¿™å¼ å›¾åƒæ˜¯å¦å ç”¨äº† 14 MBï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vmmap --summary baylor.memgraph</span><br></pre></td></tr></table></figure><p>ä¸€éƒ¨åˆ†è¾“å‡ºï¼ˆçœç•¥ä¸€äº›å†…å®¹ä»¥ä¾¿å±•ç¤ºï¼‰ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Physical footprint:         69.5M</span><br><span class="line">Physical footprint (peak):  69.7M</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªæ•°å­—æ¥è¿‘ 70MBï¼Œè¿™å¯ä»¥ä½œä¸ºåŸºå‡†æ¥ç¡®è®¤é’ˆå¯¹æ€§ä¼˜åŒ–çš„æˆæœã€‚å¦‚æœæˆ‘ä»¬ç”¨ grep å‘½ä»¤æŸ¥æ‰¾ Image IOï¼Œæˆ–è®¸ä¼šçœ‹åˆ°ä¸€éƒ¨åˆ†å›¾åƒæ¶ˆè€—:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vmmap --summary baylor.memgraph | grep "Image IO"</span><br><span class="line"></span><br><span class="line">Image IO  13.4M   13.4M   13.4M    0K  0K  0K   0K  2</span><br></pre></td></tr></table></figure><p>å•Šå“ˆ - è¿™é‡Œæœ‰å¤§çº¦ 14MB çš„è„å†…å­˜ï¼Œå’Œæˆ‘ä»¬å‰é¢çš„ä¼°ç®—ä¸€è‡´ã€‚å¦‚æœä½ ä¸æ¸…æ¥šæ¯ä¸€åˆ—è¡¨ç¤ºä»€ä¹ˆï¼Œå¯ä»¥çœ‹ä¸‹é¢è¿™ä¸ªæˆªå›¾ï¼š</p><p><img src="https://www.swiftjectivec.com/assets/images/vmmap.jpg" alt></p><p>é€šè¿‡è¿™ä¸ªä¾‹å­å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œå“ªæ€•å±•ç¤ºåœ¨ 300x400 image view ä¸­ï¼Œå›¾åƒä¹Ÿéœ€è¦å®Œæ•´çš„å†…å­˜æ¶ˆè€—ã€‚å›¾åƒå°ºå¯¸å¾ˆé‡è¦ï¼Œä½†æ˜¯å°ºå¯¸å¹¶ä¸æ˜¯å”¯ä¸€çš„é—®é¢˜ã€‚</p><h3 id="è‰²å½©ç©ºé—´"><a href="#è‰²å½©ç©ºé—´" class="headerlink" title="è‰²å½©ç©ºé—´"></a>è‰²å½©ç©ºé—´</h3><p>èƒ½ç¡®å®šçš„æ˜¯ï¼Œæœ‰ä¸€éƒ¨åˆ†å†…å­˜æ¶ˆè€—æ¥æºäºå¦ä¸€ä¸ªé‡è¦å› ç´  - è‰²å½©ç©ºé—´ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„è®¡ç®—åŸºäºä»¥ä¸‹å‡è®¾ - å›¾åƒä½¿ç”¨ sRGB æ ¼å¼ï¼Œä½†å¤§éƒ¨åˆ† iPhone ä¸ç¬¦åˆè¿™ç§æƒ…å†µã€‚sRGB æ¯ä¸ªåƒç´ æœ‰ 4 ä¸ªå­—èŠ‚ï¼Œåˆ†åˆ«è¡¨ç¤ºçº¢ã€è“ã€ç»¿ã€é€æ˜åº¦ã€‚</p><p>å¦‚æœä½ ç”¨æ”¯æŒå®½è‰²åŸŸçš„è®¾å¤‡è¿›è¡Œæ‹æ‘„ï¼ˆæ¯”å¦‚ iPhone 8+ æˆ– iPhone Xï¼‰ï¼Œé‚£ä¹ˆå†…å­˜æ¶ˆè€—å°†å˜æˆä¸¤å€ï¼Œåä¹‹äº¦ç„¶ã€‚Metal ä¼šç”¨ä»…æœ‰ä¸€ä¸ª 8 ä½é€æ˜é€šé“çš„ Alpha 8 æ ¼å¼ã€‚</p><p>è¿™é‡Œæœ‰å¾ˆå¤šå¯ä»¥æŠŠæ§å’Œå€¼å¾—æ€è€ƒçš„åœ°æ–¹ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½ åº”è¯¥ç”¨ <a href="https://www.swiftjectivec.com/uigraphicsimagerenderer/" target="_blank" rel="noopener">UIGraphicsImageRenderer</a> ä»£æ›¿ <code>UIGraphicsBeginImageContextWithOptions</code> çš„åŸå› ä¹‹ä¸€ã€‚åè€…<em>æ€»æ˜¯</em>ä¼šä½¿ç”¨ sRGBï¼Œå› æ­¤æ— æ³•ä½¿ç”¨å®½è‰²åŸŸï¼Œä¹Ÿæ— æ³•åœ¨ä¸éœ€è¦çš„æ—¶å€™èŠ‚çœç©ºé—´ã€‚åœ¨ iOS 12 ä¸­ï¼Œ<code>UIGraphicsImageRenderer</code> ä¼šä¸ºä½ åšæ­£ç¡®çš„é€‰æ‹©ã€‚</p><p>ä¸è¦å¿˜äº†ï¼Œå¾ˆå¤šå›¾åƒå¹¶ä¸æ˜¯çœŸæ­£çš„æ‘„å½±ä½œå“ï¼Œåªæ˜¯ä¸€äº›ç»˜å›¾æ“ä½œã€‚å¦‚æœä½ é”™è¿‡äº†æˆ‘æœ€è¿‘çš„æ–‡ç« ï¼Œå¯ä»¥å†é˜…è¯»ä¸€éä¸‹é¢çš„å†…å®¹ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> circleSize = <span class="type">CGSize</span>(width: <span class="number">60</span>, height: <span class="number">60</span>)</span><br><span class="line"></span><br><span class="line"><span class="type">UIGraphicsBeginImageContextWithOptions</span>(circleSize, <span class="literal">true</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Draw a circle</span></span><br><span class="line"><span class="keyword">let</span> ctx = <span class="type">UIGraphicsGetCurrentContext</span>()!</span><br><span class="line"><span class="type">UIColor</span>.red.setFill()</span><br><span class="line">ctx.setFillColor(<span class="type">UIColor</span>.red.cgColor)</span><br><span class="line">ctx.addEllipse(<span class="keyword">in</span>: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: circleSize.width, height: circleSize.height))</span><br><span class="line">ctx.drawPath(using: .fill)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> circleImage = <span class="type">UIGraphicsGetImageFromCurrentImageContext</span>()</span><br><span class="line"><span class="type">UIGraphicsEndImageContext</span>()</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„åœ†å½¢å›¾åƒç”¨çš„æ˜¯æ¯ä¸ªåƒç´  4 ä¸ªå­—èŠ‚çš„æ ¼å¼ã€‚å¦‚æœæ¢ç”¨ <code>UIGraphicsImageRenderer</code>ï¼Œé€šè¿‡æ¸²æŸ“å™¨è‡ªåŠ¨é€‰æ‹©æ­£ç¡®çš„æ ¼å¼ï¼Œè®©æ¯ä¸ªåƒç´ ä½¿ç”¨ 1 ä¸ªå­—èŠ‚ï¼Œå¯ä»¥èŠ‚çœé«˜è¾¾ 75ï¼… çš„å†…å­˜ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> circleSize = <span class="type">CGSize</span>(width: <span class="number">60</span>, height: <span class="number">60</span>)</span><br><span class="line"><span class="keyword">let</span> renderer = <span class="type">UIGraphicsImageRenderer</span>(bounds: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: circleSize.width, height: circleSize.height))</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> circleImage = renderer.image&#123; ctx <span class="keyword">in</span></span><br><span class="line">    <span class="type">UIColor</span>.red.setFill()</span><br><span class="line">    ctx.cgContext.setFillColor(<span class="type">UIColor</span>.red.cgColor)</span><br><span class="line">    ctx.cgContext.addEllipse(<span class="keyword">in</span>: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: circleSize.width, height: circleSize.height))</span><br><span class="line">    ctx.cgContext.drawPath(using: .fill)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¼©å°å›¾ç‰‡-vs-å‘ä¸‹é‡‡æ ·"><a href="#ç¼©å°å›¾ç‰‡-vs-å‘ä¸‹é‡‡æ ·" class="headerlink" title="ç¼©å°å›¾ç‰‡ vs å‘ä¸‹é‡‡æ ·"></a>ç¼©å°å›¾ç‰‡ vs å‘ä¸‹é‡‡æ ·</h3><p>ç°åœ¨æˆ‘ä»¬ä»ç®€å•çš„ç»˜å›¾åœºæ™¯å›åˆ°ç°å®ä¸–ç•Œ - è®¸å¤šå›¾ç‰‡å…¶å®å¹¶ä¸æ˜¯è‰ºæœ¯ä½œå“ï¼Œåªæ˜¯è‡ªæ‹æˆ–è€…é£æ™¯ç…§ã€‚</p><p>å› æ­¤æœ‰äº›äººå¯èƒ½ä¼šå‡è®¾ï¼ˆå¹¶ä¸”ç¡®å®ç›¸ä¿¡ï¼‰é€šè¿‡ <code>UIImage</code> ç®€å•åœ°ç¼©å°å›¾ç‰‡å°±å¤Ÿäº†ã€‚ä½†æˆ‘ä»¬å‰é¢å·²ç»è§£é‡Šè¿‡ï¼Œç¼©å°å°ºå¯¸å¹¶ä¸ç®¡ç”¨ã€‚è€Œä¸”æ ¹æ® Apple å·¥ç¨‹å¸ˆ kyle Howarth çš„è¯´æ³•ï¼Œç”±äºå†…éƒ¨åæ ‡è½¬æ¢çš„åŸå› ï¼Œç¼©å°å›¾ç‰‡çš„ä¼˜åŒ–æ•ˆæœå¹¶ä¸å¤ªå¥½ã€‚</p><p><code>UIImage</code> å¯¼è‡´æ€§èƒ½é—®é¢˜çš„æ ¹æœ¬åŸå› ï¼Œæˆ‘ä»¬åœ¨æ¸²æŸ“æµç¨‹é‡Œå·²ç»è®²è¿‡ï¼Œå®ƒä¼šè§£å‹<em>åŸå§‹å›¾åƒ</em>åˆ°å†…å­˜ä¸­ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–¹æ³•æ¥å‡å°‘å›¾åƒç¼“å†²åŒºçš„å°ºå¯¸ã€‚</p><p>åº†å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹å›¾åƒå°ºå¯¸ï¼Œæ¥å‡å°‘å†…å­˜å ç”¨ã€‚å¾ˆå¤šäººä»¥ä¸ºå›¾åƒä¼šè‡ªåŠ¨æ‰§è¡Œè¿™ç±»ä¼˜åŒ–ï¼Œä½†å®é™…ä¸Šå¹¶æ²¡æœ‰ã€‚</p><p>è®©æˆ‘ä»¬å°è¯•ç”¨åº•å±‚çš„ API æ¥å¯¹å®ƒè¿›è¡Œå‘ä¸‹é‡‡æ ·ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> imageSource = <span class="type">CGImageSourceCreateWithURL</span>(url, <span class="literal">nil</span>)!</span><br><span class="line"><span class="keyword">let</span> options: [<span class="type">NSString</span>:<span class="type">Any</span>] = [kCGImageSourceThumbnailMaxPixelSize:<span class="number">400</span>,</span><br><span class="line">                               kCGImageSourceCreateThumbnailFromImageAlways:<span class="literal">true</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> scaledImage = <span class="type">CGImageSourceCreateThumbnailAtIndex</span>(imageSource, <span class="number">0</span>, options <span class="keyword">as</span> <span class="type">CFDictionary</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> imageView = <span class="type">UIImageView</span>(image: <span class="type">UIImage</span>(cgImage: scaledImage))</span><br><span class="line">    </span><br><span class="line">    imageView.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">    imageView.contentMode = .scaleAspectFit</span><br><span class="line">    imageView.widthAnchor.constraint(equalToConstant: <span class="number">300</span>).isActive = <span class="literal">true</span></span><br><span class="line">    imageView.heightAnchor.constraint(equalToConstant: <span class="number">400</span>).isActive = <span class="literal">true</span></span><br><span class="line">    </span><br><span class="line">    view.addSubview(imageView)</span><br><span class="line">    imageView.centerXAnchor.constraint(equalTo: view.centerXAnchor).isActive = <span class="literal">true</span></span><br><span class="line">    imageView.centerYAnchor.constraint(equalTo: view.centerYAnchor).isActive = <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ç§å–å·§çš„å±•ç¤ºæ–¹æ³•ï¼Œä¼šè·å¾—å’Œä»¥å‰å®Œå…¨ç›¸åŒçš„ç»“æœã€‚ä¸è¿‡åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>CGImageSourceCreateThumbnailAtIndex()</code>ï¼Œè€Œä¸æ˜¯ç›´æ¥å°†åŸå§‹å›¾ç‰‡æ”¾è¿› image viewã€‚å†æ¬¡ä½¿ç”¨ vmmap æ¥ç¡®è®¤ä¼˜åŒ–æ˜¯å¦æœ‰å›æŠ¥ï¼ˆåŒæ ·ï¼Œçœç•¥éƒ¨åˆ†å†…å®¹ä»¥ä¾¿å±•ç¤ºï¼‰ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vmmap -summary baylorOptimized.memgraph</span><br><span class="line"></span><br><span class="line">Physical footprint:         56.3M</span><br><span class="line">Physical footprint (peak):  56.7M</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¾ˆæ˜æ˜¾ã€‚ä¹‹å‰æ˜¯ 69.5Mï¼Œç°åœ¨æ˜¯ 56.3Mï¼ŒèŠ‚çœäº† 13.2Mã€‚è¿™ä¸ªèŠ‚çœ<em>ç›¸å½“å¤§</em>ï¼Œå‡ ä¹å’Œå›¾ç‰‡æœ¬èº«ä¸€æ ·å¤§ã€‚</p><p>æ›´è¿›ä¸€æ­¥ï¼Œä½ å¯ä»¥åœ¨è‡ªå·±çš„æ¡ˆä¾‹ä¸­å°è¯•æ›´å¤šå¯èƒ½çš„é€‰é¡¹æ¥è¿›è¡Œä¼˜åŒ–ã€‚åœ¨ WWDC 18 çš„ Session 219ï¼Œâ€œImages and Graphics Best Practicesâ€œä¸­ï¼Œè‹¹æœå·¥ç¨‹å¸ˆ Kyle Sluder å±•ç¤ºäº†ä¸€ç§æœ‰è¶£çš„æ–¹å¼ï¼Œé€šè¿‡ <code>kCGImageSourceShouldCacheImmediately</code> æ ‡å¿—ä½æ¥æ§åˆ¶è§£ç æ—¶æœºï¼Œï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">downsampleImage</span><span class="params">(at URL:NSURL, maxSize:Float)</span></span> -&gt; <span class="type">UIImage</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> sourceOptions = [kCGImageSourceShouldCache:<span class="literal">false</span>] <span class="keyword">as</span> <span class="type">CFDictionary</span></span><br><span class="line">    <span class="keyword">let</span> source = <span class="type">CGImageSourceCreateWithURL</span>(<span class="type">URL</span> <span class="keyword">as</span> <span class="type">CFURL</span>, sourceOptions)!</span><br><span class="line">    <span class="keyword">let</span> downsampleOptions = [kCGImageSourceCreateThumbnailFromImageAlways:<span class="literal">true</span>,</span><br><span class="line">                             kCGImageSourceThumbnailMaxPixelSize:maxSize</span><br><span class="line">                             kCGImageSourceShouldCacheImmediately:<span class="literal">true</span>,</span><br><span class="line">                             kCGImageSourceCreateThumbnailWithTransform:<span class="literal">true</span>,</span><br><span class="line">                             ] <span class="keyword">as</span> <span class="type">CFDictionary</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> downsampledImage = <span class="type">CGImageSourceCreateThumbnailAtIndex</span>(source, <span class="number">0</span>, downsampleOptions)!</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="type">UIImage</span>(cgImage: downsampledImage)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ Core Graphics ä¸ä¼šå¼€å§‹å›¾ç‰‡è§£ç ï¼Œç›´åˆ°ä½ è¯·æ±‚ç¼©ç•¥å›¾ã€‚å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œä¸¤ä¸ªä¾‹å­éƒ½ä¼ å…¥äº† <code>kCGImageSourceCreateThumbnailMaxPixelSize</code>ï¼Œå¦‚æœä¸è¿™æ ·åšï¼Œå°±ä¼šè·å¾—å’ŒåŸå›¾åŒæ ·å°ºå¯¸çš„ç¼©ç•¥å›¾ã€‚æ ¹æ®æ–‡æ¡£æ‰€ç¤ºï¼š</p><blockquote><p>â€œâ€¦å¦‚æœæ²¡æŒ‡å®šæœ€å¤§å°ºå¯¸ï¼Œè¿”å›çš„ç¼©ç•¥å›¾å°†ä¼šæ˜¯å®Œæ•´å›¾åƒçš„å°ºå¯¸ï¼Œè¿™å¯èƒ½å¹¶ä¸æ˜¯ä½ æƒ³è¦çš„ã€‚â€</p></blockquote><p>æ‰€ä»¥ä¸Šé¢å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬å°†ç¼©æ”¾çš„ç»“æœæ”¾å…¥ç¼©ç•¥å›¾ä¸­ï¼Œä»è€Œåˆ›å»ºçš„æ˜¯æ¯”ä¹‹å‰å°å¾ˆå¤šçš„å›¾åƒè§£ç ç¼“å†²åŒºã€‚å›é¡¾ä¹‹å‰æåˆ°çš„æ¸²æŸ“æµç¨‹ï¼Œåœ¨ç¬¬ä¸€ä¸ªç¯èŠ‚ï¼ˆåŠ è½½ï¼‰ä¸­ï¼Œæˆ‘ä»¬ç»™ UIImage ä¼ å…¥çš„ç¼“å†²åŒºæ˜¯éœ€è¦ç»˜åˆ¶çš„å›¾ç‰‡å°ºå¯¸ï¼Œä¸æ˜¯å›¾ç‰‡çš„çœŸå®å°ºå¯¸ã€‚</p><p>å¦‚ä½•ç”¨ä¸€å¥è¯æ€»ç»“æœ¬æ–‡ï¼Ÿæƒ³åŠæ³•å¯¹å›¾åƒè¿›è¡Œå‘ä¸‹é‡‡æ ·ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ UIImage å»ç¼©å°å°ºå¯¸ã€‚</p><h3 id="é™„èµ å†…å®¹"><a href="#é™„èµ å†…å®¹" class="headerlink" title="é™„èµ å†…å®¹"></a>é™„èµ å†…å®¹</h3><p>é™¤äº†å‘ä¸‹é‡‡æ ·ï¼Œæˆ‘è‡ªå·±è¿˜ç»å¸¸ä½¿ç”¨ iOS 11 å¼•å…¥çš„ <a href="https://developer.apple.com/documentation/uikit/uitableviewdatasourceprefetching?language=swift" target="_blank" rel="noopener">é¢„åŠ è½½ API</a>ã€‚è¯·è®°ä½ï¼Œæˆ‘ä»¬æ˜¯åœ¨è§£ç å›¾åƒï¼Œå“ªæ€•æ˜¯æ”¾åœ¨ Cell å±•ç¤ºä¹‹å‰æ‰§è¡Œï¼Œä¹Ÿä¼šæ¶ˆè€—å¤§é‡ CPU èµ„æºã€‚</p><p>å¦‚æœåº”ç”¨æŒç»­è€—ç”µï¼ŒiOS å¯ä»¥ä¼˜åŒ–ç”µé‡æ¶ˆè€—ã€‚ä½†æ˜¯æˆ‘ä»¬åšçš„å‘ä¸‹é‡‡æ ·ä¸€èˆ¬ä¸ä¼šæŒç»­æ‰§è¡Œï¼Œæ‰€ä»¥æœ€å¥½åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­æ‰§è¡Œé‡‡æ ·æ“ä½œã€‚ä¸æ­¤åŒæ—¶ï¼Œä½ çš„è§£ç è¿‡ç¨‹ä¹Ÿå®ç°äº†åå°æ‰§è¡Œï¼Œä¸€çŸ³å¤šé¸Ÿã€‚</p><p>åšå¥½å‡†å¤‡ï¼Œä¸‹é¢å³å°†ä¸ºæ‚¨å‘ˆç°çš„æ˜¯â€”â€”æˆ‘è‡ªå·±ä¸šä½™é¡¹ç›®é‡Œçš„ Objective-C ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// ä¸è¦ç”¨å…¨å±€å¼‚æ­¥é˜Ÿåˆ—ï¼Œä½¿ç”¨ä½ è‡ªå·±çš„é˜Ÿåˆ—ï¼Œä»è€Œé¿å…æ½œåœ¨çš„çº¿ç¨‹çˆ†ç‚¸é—®é¢˜</span><br><span class="line">- (void)tableView:(UITableView *)tableView prefetchRowsAtIndexPaths:(NSArray&lt;NSIndexPath *&gt; *)indexPaths</span><br><span class="line">&#123;</span><br><span class="line">    if (self.downsampledImage != nil || </span><br><span class="line">        self.listItem.mediaAssetData == nil) return;</span><br><span class="line">    </span><br><span class="line">    NSIndexPath *mediaIndexPath = [NSIndexPath indexPathForRow:0</span><br><span class="line">                                                     inSection:SECTION_MEDIA];</span><br><span class="line">    if ([indexPaths containsObject:mediaIndexPath])</span><br><span class="line">    &#123;</span><br><span class="line">        CGFloat scale = tableView.traitCollection.displayScale;</span><br><span class="line">        CGFloat maxPixelSize = (tableView.width - SSSpacingJumboMargin) * scale;</span><br><span class="line">        </span><br><span class="line">        dispatch_async(self.downsampleQueue, ^&#123;</span><br><span class="line">            // Downsample</span><br><span class="line">            self.downsampledImage = [UIImage downsampledImageFromData:self.listItem.mediaAssetData</span><br><span class="line">                               scale:scale</span><br><span class="line">                        maxPixelSize:maxPixelSize];</span><br><span class="line">            </span><br><span class="line">            dispatch_async(dispatch_get_main_queue(), ^ &#123;</span><br><span class="line">                self.listItem.downsampledMediaImage = self.downsampledImage;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å»ºè®®ä½¿ç”¨ asset catalog æ¥ç®¡ç†åŸå§‹å›¾åƒèµ„æºï¼Œå®ƒå·²ç»å®ç°äº†ç¼“å†²åŒºä¼˜åŒ–ï¼ˆä»¥åŠæ›´å¤šåŠŸèƒ½ï¼‰ã€‚</p></blockquote><p>æƒ³æˆä¸ºå†…å­˜å’Œå›¾åƒå¤„ç†ä¸“å®¶ï¼Ÿä¸è¦é”™è¿‡ WWDC 18 è¿™äº›ä¿¡æ¯é‡å·¨å¤§çš„ sessionï¼š</p><ul><li><a href="https://developer.apple.com/videos/play/wwdc2018/416/?time=1074" target="_blank" rel="noopener">iOS Memory Deep Dive</a></li><li><a href="https://developer.apple.com/videos/play/wwdc2018/219/" target="_blank" rel="noopener">Images and Graphics Best Practices</a></li></ul><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å­¦æ— æ­¢å¢ƒã€‚å¦‚æœé€‰æ‹©äº†ç¼–ç¨‹ï¼Œä½ å°±å¿…é¡»æ¯å°æ—¶è·‘ä¸€ä¸‡è‹±é‡Œæ‰èƒ½è·Ÿå¾—ä¸Šè¿™ä¸ªé¢†åŸŸåˆ›æ–°å’Œå˜åŒ–çš„æ­¥ä¼â€¦â€¦æ¢å¥è¯è¯´ï¼Œä¸€å®šä¼šæœ‰å¾ˆå¤šä½ æ ¹æœ¬ä¸çŸ¥é“çš„ APIã€æ¡†æ¶ã€æ¨¡å¼æˆ–è€…ä¼˜åŒ–æŠ€å·§ã€‚</p><p>åœ¨å›¾åƒé¢†åŸŸä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¤§å¤šæ•°æ—¶å€™ï¼Œä½ åˆå§‹åŒ–ä¸€ä¸ªäº†å¤§å°åˆé€‚çš„ UIImageView å°±ä¸ç®¡äº†ã€‚æˆ‘å½“ç„¶çŸ¥é“æ‘©å°”å®šå¾‹ã€‚ç°åœ¨æ‰‹æœºç¡®å®å¾ˆå¿«ï¼Œå†…å­˜ä¹Ÿå¾ˆå¤§ï¼Œä½†æ˜¯ä½ è¦çŸ¥é“ - å°†äººç±»é€ä¸Šæœˆçƒçš„è®¡ç®—æœºåªæœ‰ä¸åˆ° 100KB å†…å­˜ã€‚</p><p>é•¿æœŸå’Œé­”é¬¼å…±èˆï¼ˆè¯‘è€…æ³¨ï¼šæ¯”å–»ä¸ç®¡å†…å­˜é—®é¢˜ï¼‰ï¼Œå®ƒæ€»æœ‰éœ²å‡ºç ç‰™çš„é‚£å¤©ã€‚ç­‰åˆ°ä¸€å¼ è‡ªæ‹å°±å æ‰ 1G å†…å­˜çš„æ—¶å€™ï¼Œåæ‚”ä¹Ÿæ¥ä¸åŠäº†ã€‚å¸Œæœ›ä¸Šè¿°çš„çŸ¥è¯†å’ŒæŠ€æœ¯èƒ½å¸®ä½ èŠ‚çœä¸€äº› debug æ—¶é—´ã€‚</p><p>ä¸‹æ¬¡å†è§ âœŒï¸ã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šJordan Morganï¼Œ&lt;a href=&quot;https://www.swiftjectivec.com/optimizing-images/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-12-11&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://nemocdz.github.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Nemocdz&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://numbbbbb.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;numbbbbb&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://github.com/WAMaker&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;WAMaker&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/Pancf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Pancf&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;ä¿—è¯è¯´å¾—å¥½ï¼Œæœ€å¥½çš„ç›¸æœºæ˜¯ä½ èº«è¾¹çš„é‚£ä¸ªã€‚é‚£ä¹ˆæ¯«æ— ç–‘é—® - iPhone å¯ä»¥è¯´æ˜¯è¿™ä¸ªæ˜Ÿçƒæœ€é‡è¦çš„çš„ç›¸æœºã€‚è€Œè¿™åœ¨ä¸šç•Œä¹Ÿå·²ç»è¾¾æˆå…±è¯†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åº¦å‡ï¼Ÿä¸å·å·æ‹å‡ å¼ è®°å½•åœ¨ä½ çš„ Instagram æ•…äº‹é‡Œï¼Ÿä¸å­˜åœ¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;å‡ºç°çˆ†ç‚¸æ–°é—»ï¼ŸæŸ¥çœ‹ Twitterï¼Œå°±å¯ä»¥çŸ¥é“æ˜¯å“ªäº›åª’ä½“æ­£åœ¨æŠ¥é“ï¼Œé€šè¿‡ä»–ä»¬æ­éœ²äº‹ä»¶çš„å®æ—¶ç…§ç‰‡ã€‚&lt;/p&gt;
&lt;p&gt;ç­‰ç­‰â€¦â€¦&lt;/p&gt;
&lt;p&gt;æ­£å› ä¸ºå›¾åƒåœ¨å¹³å°ä¸Šæ— å¤„ä¸åœ¨ï¼Œå¦‚æœç®¡ç†ä¸å½“ï¼Œå¾ˆå®¹æ˜“å‡ºç°æ€§èƒ½å’Œå†…å­˜é—®é¢˜ã€‚ç¨å¾®äº†è§£ä¸‹ UIKitï¼Œææ¸…æ¥šå®ƒå¤„ç†å›¾åƒçš„æœºåˆ¶ï¼Œå¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ï¼Œé¿å…åšæ— ç”¨åŠŸã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Swift" scheme="https://swift.gg/categories/Swift/"/>
    
    
      <category term="Swiftï¼ŒiOS å¼€å‘" scheme="https://swift.gg/tags/Swift%EF%BC%8CiOS-%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>å®å®šä¹‰ä¸å¯é€‰æ‹¬å·</title>
    <link href="https://swift.gg/2019/09/27/preprocessor-abuse-and-optional-parentheses/"/>
    <id>https://swift.gg/2019/09/27/preprocessor-abuse-and-optional-parentheses/</id>
    <published>2019-09-27T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šMike Ashï¼Œ<a href="https://www.mikeash.com/pyblog/friday-qa-2015-03-20-preprocessor-abuse-and-optional-parentheses.html" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2015-03-20<br>è¯‘è€…ï¼šä¿Šä¸œï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://nemocdz.github.io/" target="_blank" rel="noopener">Nemocdz</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>å‰å‡ å¤©æˆ‘é‡åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼šå¦‚ä½•ç¼–å†™ä¸€ä¸ª C è¯­è¨€é¢„å¤„ç†å™¨çš„å®ï¼Œåˆ é™¤åŒ…å›´å®å‚çš„æ‹¬å·ï¼Ÿ</p><p>ä»Šå¤©çš„æ–‡ç« ï¼Œå°†ä¸ºå¤§å®¶åˆ†äº«æˆ‘çš„è§£å†³æ–¹æ¡ˆã€‚<br><a id="more"></a></p><h2 id="èµ·æº"><a href="#èµ·æº" class="headerlink" title="èµ·æº"></a>èµ·æº</h2><p>C è¯­è¨€é¢„å¤„ç†å™¨æ˜¯ä¸€ä¸ªç›¸å½“ç›²ç›®çš„æ–‡æœ¬æ›¿æ¢å¼•æ“ï¼Œå®ƒå¹¶ä¸ç†è§£ C ä»£ç ï¼Œæ›´ä¸ç”¨è¯´ Objective-C äº†ã€‚å®ƒçš„å·¥ä½œåŸç†è¿˜ç®—ä¸é”™ï¼Œå¯ä»¥åº”ä»˜å¤§éƒ¨åˆ†æƒ…å†µï¼Œä½†å¶å°”ä¹Ÿä¼šå‡ºç°åˆ¤æ–­å¤±è¯¯ã€‚</p><p>è¿™é‡Œä¸¾ä¸ªå…¸å‹çš„ä¾‹å­ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">XCTAssertEqualObjects</span>(someArray, @[ <span class="string">@"one"</span>, <span class="string">@"two"</span> ], <span class="string">@"Array is not as expected"</span>);</span><br></pre></td></tr></table></figure><p>è¿™ä¼šæ— æ³•ç¼–è¯‘ï¼Œå¹¶ä¸”ä¼šå‡ºç°éå¸¸å¤æ€ªçš„é”™è¯¯æç¤ºã€‚é¢„å¤„ç†å™¨æŸ¥æ‰¾åˆ†éš”å®å‚æ•°çš„é€—å·æ—¶ï¼Œæ²¡èƒ½å°†æ•°ç»„ç»“æ„ <code>@ [...]</code> ä¸­çš„ä¸œè¥¿ç†è§£ä¸ºä¸€ä¸ªå•ä¸€çš„å…ƒç´ ã€‚ç»“æœä»£ç å°è¯•æ¯”è¾ƒ <code>someArray</code> å’Œ <code>@[@&quot;one&quot;</code>ã€‚æ–­è¨€å¤±è´¥æ¶ˆæ¯ <code>@&quot;two&quot;]</code> å’Œ <code>@&quot;Array is not as expected&quot;</code> æ˜¯å¦å¤–çš„å®å‚ã€‚è¿™äº›åŠæˆå“éƒ¨åˆ†ç”¨äº <code>XCTAssertEqualObjects</code> çš„å®æ‰©å±•ä¸­ï¼Œç”Ÿæˆçš„ä»£ç å½“ç„¶é”™å¾—ç¦»è°±ã€‚</p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿå¾ˆå®¹æ˜“ï¼šæ·»åŠ æ‹¬å·å°±è¡Œã€‚é¢„ç¼–è¯‘å™¨ä¸èƒ½è¯†åˆ« <code>[]</code>ï¼Œä½†å®ƒ<em>ç¡®å®</em>çŸ¥é“ <code>()</code> å¹¶ä¸”èƒ½å¤Ÿç†è§£åº”è¯¥å¿½ç•¥é‡Œé¢çš„é€—å·ã€‚ä¸‹é¢çš„ä»£ç å°±èƒ½æ­£å¸¸è¿è¡Œï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">XCTAssertEqualObjects</span>(someArray, (@[ <span class="string">@"one"</span>, <span class="string">@"two"</span> ]), <span class="string">@"Array is not as expected"</span>);</span><br></pre></td></tr></table></figure><p>åœ¨ C è¯­è¨€çš„è®¸å¤šåœºæ™¯ä¸‹ï¼Œä½ æ·»åŠ å¤šä½™çš„æ‹¬å·ä¹Ÿä¸ä¼šæœ‰ä»»ä½•åŒºåˆ«ã€‚å®æ‰©å±•å¼€ä¹‹åï¼Œç”Ÿæˆçš„ä»£ç è™½ç„¶åœ¨æ•°ç»„æ–‡å­—å‘¨å›´æœ‰æ‹¬å·ï¼Œä½†æ²¡æœ‰å¼‚å¸¸ã€‚ä½ å¯ä»¥å†™æç¬‘çš„å¤šå±‚æ‹¬å·è¡¨è¾¾å¼ï¼Œç¼–è¯‘å™¨ä¼šæ„‰å¿«åœ°å¸®ä½ è§£æåˆ°æœ€é‡Œé¢ä¸€å±‚ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%d"</span>,((((((((((<span class="number">42</span>)))))))))));</span><br></pre></td></tr></table></figure><p>ç”šè‡³å°† <code>NSLog</code> è¿™æ ·å¤„ç†ä¹Ÿè¡Œï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">((((((((((<span class="built_in">NSLog</span>))))))))))(<span class="string">@"%d"</span>,<span class="number">42</span>);</span><br></pre></td></tr></table></figure><p>åœ¨ C ä¸­æœ‰ä¸€ä¸ªåœ°æ–¹ä½ ä¸èƒ½éšæ„æ·»åŠ æ‹¬å·ï¼šç±»å‹ï¼ˆtypesï¼‰ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> f(<span class="keyword">void</span>); <span class="comment">// åˆæ³•</span></span><br><span class="line">(<span class="keyword">int</span>) f(<span class="keyword">void</span>); <span class="comment">// ä¸åˆæ³•</span></span><br></pre></td></tr></table></figure><p>ä»€ä¹ˆæ—¶å€™ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µå‘¢ï¼Ÿè¿™ç§æƒ…å†µå¹¶ä¸å¸¸è§ï¼Œä½†å¦‚æœä½ æœ‰ä¸€ä¸ªä½¿ç”¨ç±»å‹çš„å®ï¼Œå¹¶ä¸”ç±»å‹åŒ…å«çš„é€—å·ä¸åœ¨æ‹¬å·å†…ï¼Œåˆ™ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚å®å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œå½“ä¸€ä¸ªç±»å‹éµå¾ªå¤šä¸ªåè®®æ—¶ï¼Œåœ¨ Objective-C ä¸­å¯èƒ½å‡ºç°ä¸€äº›ç±»å‹å¸¦æœ‰æœªåŠ æ‹¬å·çš„é€—å·;å½“ä½¿ç”¨å¸¦æœ‰å¤šä¸ªæ¨¡æ¿å‚æ•°çš„æ¨¡æ¿åŒ–ç±»å‹æ—¶ï¼Œåœ¨ C++ ä¸­ä¹Ÿå¯èƒ½å‡ºç°ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè¿™æœ‰ä¸€ä¸ªç®€å•çš„å®ï¼Œåˆ›å»ºä»å­—å…¸ä¸­æä¾›é™æ€ç±»å‹å€¼çš„ <code>getter</code>ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define GETTER(type,name) \</span></span><br><span class="line">- (type)name &#123; \</span><br><span class="line"><span class="keyword">return</span> [_dictionary objectForKey: @<span class="meta">#name]; \</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ èƒ½è¿™æ ·ä½¿ç”¨å®ƒï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">SomeClass</span> </span>&#123;</span><br><span class="line"><span class="built_in">NSDictionary</span> *_dictionary;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GETTER(<span class="built_in">NSView</span> *,view)</span><br><span class="line">GETTER(<span class="built_in">NSString</span> *,name)</span><br><span class="line">GETTER(<span class="keyword">id</span>&lt;<span class="built_in">NSCopying</span>&gt;,someCopyableThing)</span><br></pre></td></tr></table></figure><p>åˆ°ç›®å‰ä¸ºæ­¢æ²¡é—®é¢˜ã€‚ç°åœ¨å‡è®¾æˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªéµå¾ª<em>ä¸¤ä¸ª</em>åè®®çš„ç±»å‹ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">GETTER(<span class="keyword">id</span>&lt;<span class="built_in">NSCopying</span>,<span class="built_in">NSCoding</span>&gt;,someCopyableAndCodeableThing)</span><br></pre></td></tr></table></figure><p>å“å‘€ï¼å®ä¸èµ·ä½œç”¨äº†ã€‚è€Œä¸”æ·»åŠ æ‹¬å·ä¹Ÿæ— æµäºäº‹ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">GETTER((<span class="keyword">id</span>&lt;<span class="built_in">NSCopying</span>,<span class="built_in">NSCoding</span>&gt;),someCopyableAndCodeableThing)</span><br></pre></td></tr></table></figure><p>è¿™ä¼šäº§ç”Ÿéæ³•ä»£ç ã€‚è¿™æ—¶æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåˆ é™¤å¯é€‰æ‹¬å·çš„ UNPAREN å®ã€‚å°† <code>GETTER</code> å®é‡å†™ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define GETTER(type,name) \</span><br><span class="line">- (UNPAREN(type))name &#123; \</span><br><span class="line">return [_dictionary objectForKey: @#name]; \</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><h2 id="å¿…é¡»çš„æ‹¬å·"><a href="#å¿…é¡»çš„æ‹¬å·" class="headerlink" title="å¿…é¡»çš„æ‹¬å·"></a>å¿…é¡»çš„æ‹¬å·</h2><p>åˆ é™¤æ‹¬å·å¾ˆå®¹æ˜“ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define UNPAREN(...) __VA_ARGS__</span></span><br><span class="line"><span class="meta">#define GETTER(type,name) \</span></span><br><span class="line">- (UNPAREN type)name &#123; \</span><br><span class="line"><span class="keyword">return</span> [_dictionary objectForKey: @<span class="meta">#name]; \</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶çœ‹ä¸Šå»å¾ˆæ‰¯ï¼Œä½†è¿™çš„ç¡®èƒ½è¿è¡Œã€‚é¢„ç¼–è¯‘å™¨å°† <code>type</code> æ‰©å±•ä¸º <code>(id &lt;NSCopyingï¼ŒNSCoding&gt;)</code>ï¼Œç”Ÿæˆ <code>UNPAREN (id&lt;NSCopying, NSCoding&gt;)</code>ã€‚ç„¶åå®ƒä¼šå°† <code>UNPAREN</code> å®æ‰©å±•ä¸º <code>id &lt;NSCopyingï¼ŒNSCoding&gt;</code>ã€‚æ‹¬å·ï¼Œæ¶ˆå¤±ï¼</p><p>ä½†æ˜¯ï¼Œä¹‹å‰ä½¿ç”¨çš„ <code>GETTER</code> å¤±è´¥äº†ã€‚ä¾‹å¦‚ï¼Œ<code>GETTER(NSView *ï¼Œview)</code> åœ¨å®æ‰©å±•ä¸­ç”Ÿæˆ <code>UNPAREN NSView *</code>ã€‚ä¸ä¼šè¿›ä¸€æ­¥æ‰©å±•å°±ç›´æ¥æä¾›ç»™ç¼–è¯‘å™¨ã€‚ç»“æœè‡ªç„¶ä¼šæŠ¥ç¼–è¯‘å™¨é”™è¯¯ï¼Œå› ä¸º <code>UNPAREN NSView *</code> æ˜¯æ— æ³•ç¼–è¯‘çš„ã€‚è¿™è™½ç„¶å¯ä»¥é€šè¿‡ç¼–å†™ <code>GETTER((NSView *)ï¼Œview)</code> æ¥è§£å†³ï¼Œä½†æ˜¯è¢«è¿«æ·»åŠ è¿™äº›æ‹¬å·å¾ˆçƒ¦äººã€‚è¿™æ ·çš„ç»“æœå¯ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p><h2 id="å®ä¸èƒ½è¢«é‡è½½"><a href="#å®ä¸èƒ½è¢«é‡è½½" class="headerlink" title="å®ä¸èƒ½è¢«é‡è½½"></a>å®ä¸èƒ½è¢«é‡è½½</h2><p>æˆ‘ç«‹åˆ»æƒ³åˆ°äº†å¦‚ä½•æ‘†è„±å‰©ä½™çš„ <code>UNPAREN</code>ã€‚å½“ä½ æƒ³è¦ä¸€ä¸ªæ ‡è¯†ç¬¦æ¶ˆå¤±æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç©ºçš„ <code>#define</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define UNPAREN</span></span><br></pre></td></tr></table></figure><p>æœ‰äº†è¿™ä¸ªï¼Œ<code>a UNPAREN b</code> çš„åºåˆ—å˜ä¸º <code>a b</code>ã€‚å®Œç¾è§£å†³é—®é¢˜ï¼ä½†æ˜¯ï¼Œå¦‚æœå·²ç»å­˜åœ¨å¸¦å‚æ•°çš„å¦ä¸€ä¸ªå®šä¹‰ï¼Œåˆ™é¢„å¤„ç†å™¨ä¼šæ‹’ç»æ­¤æ“ä½œã€‚å³ä½¿é¢„å¤„ç†å™¨å¯èƒ½é€‰æ‹©å…¶ä¸­ä¸€ä¸ªï¼Œå®ƒä¹Ÿä¸ä¼šåŒæ—¶å­˜åœ¨ä¸¤ç§å½¢å¼ã€‚å¦‚æœå¯è¡Œçš„è¯ï¼Œè¿™èƒ½æœ‰æ•ˆè§£å†³æˆ‘ä»¬çš„é—®é¢˜ï¼Œä½†å¯æƒœçš„æ˜¯å¹¶ä¸å…è®¸ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define UNPAREN(...) __VA_ARGS__</span></span><br><span class="line"><span class="meta">#define UNPAREN</span></span><br><span class="line"><span class="meta">#define GETTER(type,name) \</span></span><br><span class="line">- (UNPAREN type)name &#123; \</span><br><span class="line"><span class="keyword">return</span> [_dictionary objectForKey: @<span class="meta">#name]; \</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ— æ³•é€šè¿‡é¢„å¤„ç†å™¨ï¼Œå®ƒä¼šç”±äº <code>UNPAREN</code> çš„é‡å¤ <code>#define</code> è€ŒæŠ¥é”™ã€‚ä¸è¿‡ï¼Œå®ƒå¼•å¯¼æˆ‘ä»¬èµ°ä¸Šäº†æˆåŠŸçš„é“è·¯ã€‚ç°åœ¨çš„ç“¶é¢ˆæ˜¯æ€ä¹ˆæ‰¾å‡ºä¸€ç§æ–¹æ³•æ¥å®ç°ç›¸åŒçš„æ•ˆæœï¼Œè€Œä¸ä¼šä½¿ä¸¤ä¸ªå®å…·æœ‰ç›¸åŒçš„åç§°ã€‚</p><h2 id="å…³é”®"><a href="#å…³é”®" class="headerlink" title="å…³é”®"></a>å…³é”®</h2><p>æœ€ç»ˆç›®æ ‡æ˜¯è®© <code>UNPAREN(x)</code> å’Œ <code>UNPAREN((x))</code> ç»“æœéƒ½æ˜¯ <code>x</code>ã€‚æœç€è¿™ä¸ªç›®æ ‡è¿ˆå‡ºçš„ç¬¬ä¸€æ­¥æ˜¯åˆ¶ä½œä¸€äº›å®ï¼Œå…¶ä¸­ä¼ é€’ <code>x</code> å’Œ <code>(x)</code> äº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼Œå³ä½¿å®ƒå¹¶ä¸ç¡®å®š <code>x</code> æ˜¯ä»€ä¹ˆã€‚è¿™å¯ä»¥é€šè¿‡å°†å®åç§°æ”¾åœ¨å®æ‰©å±•ä¸­æ¥å®ç°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define EXTRACT(...) EXTRACT __VA_ARGS__</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨å¦‚æœä½ å†™ <code>EXTRACT(x)</code>ï¼Œç»“æœæ˜¯ <code>EXTRACT x</code>ã€‚å½“ç„¶ï¼Œå¦‚æœä½ å†™ <code>EXTRACT x</code>ï¼Œç»“æœä¹Ÿæ˜¯ <code>EXTRACT x</code>ï¼Œå°±åƒæ²¡æœ‰å®æ‰©å±•çš„æƒ…å†µã€‚è¿™ä»ç„¶ç»™æˆ‘ä»¬ç•™ä¸‹ä¸€ä¸ª <code>EXTRACT</code>ã€‚è™½ç„¶ä¸èƒ½ç”¨ <code>#define</code> ç›´æ¥è§£å†³ï¼Œä½†è¿™å·²ç»è¿›æ­¥äº†ã€‚</p><h2 id="æ ‡è¯†ç¬¦ç²˜åˆ"><a href="#æ ‡è¯†ç¬¦ç²˜åˆ" class="headerlink" title="æ ‡è¯†ç¬¦ç²˜åˆ"></a>æ ‡è¯†ç¬¦ç²˜åˆ</h2><p>é¢„å¤„ç†å™¨æœ‰ä¸€ä¸ªæ“ä½œç¬¦ <code>##</code>ï¼Œå®ƒå°†ä¸¤ä¸ªæ ‡è¯†ç¬¦ç²˜åˆåœ¨ä¸€èµ·ã€‚ä¾‹å¦‚ï¼Œ<code>a ## b</code> å˜ä¸º <code>ab</code>ã€‚è¿™å¯ä»¥ç”¨äºä»ç‰‡æ®µæ„é€ æ ‡è¯†ç¬¦ï¼Œä½†ä¹Ÿå¯ä»¥ç”¨äºè°ƒç”¨å®ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define AA 1</span></span><br><span class="line"><span class="meta">#define AB 2</span></span><br><span class="line"><span class="meta">#define A(x) A ## x</span></span><br></pre></td></tr></table></figure><p>ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œ<code>A(A)</code> äº§ç”Ÿ <code>1</code>ï¼Œ<code>A(B)</code> äº§ç”Ÿ <code>2</code>ã€‚</p><p>è®©æˆ‘ä»¬å°†è¿™ä¸ªè¿ç®—ç¬¦ä¸ä¸Šé¢çš„ <code>EXTRACT</code> å®ç»“åˆèµ·æ¥ï¼Œå°è¯•ç”Ÿæˆä¸€ä¸ª <code>UNPAREN</code> å®ã€‚ç”±äº <code>EXTRACT(...)</code> ä½¿ç”¨å‰ç¼€ <code>EXTRACT</code> ç”Ÿæˆå®å‚ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‡è¯†ç¬¦ç²˜åˆæ¥ç”Ÿæˆä»¥ <code>EXTRACT</code> ç»“å°¾çš„å…¶ä»–æ ‡è®°ã€‚å¦‚æœæˆ‘ä»¬ <code>#define</code> é‚£ä¸ªæ–°æ ‡è®°ä¸ºç©ºï¼Œé‚£å°±æå®šäº†ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªä»¥ <code>EXTRACT</code> ç»“å°¾çš„å®ï¼Œå®ƒä¸ä¼šäº§ç”Ÿä»»ä½•ç»“æœï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define NOTHING_EXTRACT</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å¯¹ <code>UNPAREN</code> å®çš„å°è¯•ï¼Œå®ƒå°†æ‰€æœ‰å†…å®¹æ”¾åœ¨ä¸€èµ·ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define UNPAREN(x) NOTHING_ ## EXTRACT x</span></span><br></pre></td></tr></table></figure><p>ä¸å¹¸çš„æ˜¯ï¼Œè¿™å¹¶ä¸èƒ½å®ç°æˆ‘ä»¬çš„ç›®æ ‡ã€‚é—®é¢˜åœ¨æ“ä½œé¡ºåºä¸Šã€‚å¦‚æœæˆ‘ä»¬å†™ <code>UNPAREN((int))</code>ï¼Œæˆ‘ä»¬å°†ä¼šå¾—åˆ°ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">UNPAREN((<span class="keyword">int</span>))</span><br><span class="line">NOTHING_ <span class="meta">## EXTRACT (int)</span></span><br><span class="line">NOTHING_EXTRACT (<span class="keyword">int</span>)</span><br><span class="line">(<span class="keyword">int</span>)</span><br></pre></td></tr></table></figure><p>æ ‡ç¤ºç¬¦ç²˜åˆå¤ªæ—©èµ·ä½œç”¨ï¼Œ<code>EXTRACT</code> å®æ°¸è¿œä¸ä¼šæœ‰æœºä¼šæ‰©å±•å¼€ã€‚</p><p>å¯ä»¥ä½¿ç”¨é—´æ¥çš„æ–¹å¼å¼ºåˆ¶é¢„å¤„ç†å™¨ç”¨ä¸åŒçš„é¡ºåºåˆ¤æ–­äº‹ä»¶ã€‚æˆ‘ä»¬å¯ä»¥åˆ¶ä½œä¸€ä¸ª <code>PASTE</code> å®ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ <code>##</code>ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define PASTE(x,...) x ## __VA_ARGS__</span></span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°†æ ¹æ®å®ƒç¼–å†™ <code>UNPAREN</code>ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define UNPAREN(x)  PASTE(NOTHING_,EXTRACT x)</span></span><br></pre></td></tr></table></figure><p>è¿™<em>ä»ç„¶</em>ä¸èµ·ä½œç”¨ã€‚æƒ…å†µå¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">UNPAREN((<span class="keyword">int</span>))</span><br><span class="line">PASTE(NOTHING_,EXTRACT (<span class="keyword">int</span>))</span><br><span class="line">NOTHING_ <span class="meta">## EXTRACT (int)</span></span><br><span class="line">NOTHING_EXTRACT (<span class="keyword">int</span>)</span><br><span class="line">(<span class="keyword">int</span>)</span><br></pre></td></tr></table></figure><p>ä½†æ›´æ¥è¿‘æˆ‘ä»¬çš„ç›®æ ‡äº†ã€‚åºåˆ— <code>EXTRACT(int)</code> æ˜¾ç„¶æ²¡æœ‰è§¦å‘æ ‡ç¤ºç¬¦ç²˜åˆæ“ä½œç¬¦ã€‚æˆ‘ä»¬å¿…é¡»è®©é¢„å¤„ç†å™¨åœ¨å®ƒçœ‹åˆ° <code>##</code> ä¹‹å‰è§£æå®ƒã€‚å¯ä»¥é€šè¿‡å¦ä¸€ç§æ–¹å¼é—´æ¥å¼ºåˆ¶è§£æå®ƒã€‚è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåªåŒ…è£… <code>PASTE</code> çš„ <code>EVALUATING_PASTE</code> å®ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define EVALUATING_PASTE(x,...) PASTE(x,__VA_ARGS__)</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨è®©æˆ‘ä»¬ç”¨<em>å®ƒ</em>å†™ <code>UNPAREN</code>ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define UNPAREN(x) EVALUATING_PASTE(NOTHING_,EXTRACT x)</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å±•å¼€ä¹‹åï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">UNPAREN((<span class="keyword">int</span>))</span><br><span class="line">EVALUATING_PASTE(NOTHING_,EXTRACT (<span class="keyword">int</span>))</span><br><span class="line">PASTE(NOTHING_,EXTRACT <span class="keyword">int</span>)</span><br><span class="line">NOTHING_ <span class="meta">## EXTRACT int</span></span><br><span class="line">NOTHING_EXTRACT <span class="keyword">int</span></span><br><span class="line"><span class="keyword">int</span></span><br></pre></td></tr></table></figure><p>å³ä½¿æ²¡æœ‰é¢å¤–åŠ æ‹¬å·ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œï¼Œå› ä¸ºé¢å¤–çš„èµ‹å€¼å¹¶æ²¡æœ‰å½±å“ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">UNPAREN(<span class="keyword">int</span>)</span><br><span class="line">EVALUATING_PASTE(NOTHING_,EXTRACT <span class="keyword">int</span>)</span><br><span class="line">PASTE(NOTHING_,EXTRACT <span class="keyword">int</span>)</span><br><span class="line">NOTHING_ <span class="meta">## EXTRACT int</span></span><br><span class="line">NOTHING_EXTRACT <span class="keyword">int</span></span><br><span class="line"><span class="keyword">int</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸäº†ï¼æˆ‘ä»¬ç°åœ¨ç¼–å†™ <code>GETTER</code> æ—¶å¯ä»¥ä¸éœ€è¦å›´ç»•ç±»å‹çš„æ‹¬å·äº†ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define GETTER(type,name) \</span></span><br><span class="line">- (UNPAREN(type))name &#123; \</span><br><span class="line"><span class="keyword">return</span> [_dictionary objectForKey: @<span class="meta">#name]; \</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¥–åŠ±å®"><a href="#å¥–åŠ±å®" class="headerlink" title="å¥–åŠ±å®"></a>å¥–åŠ±å®</h2><p>åœ¨é€‰æ‹©ä¸€äº›å®æ¥è¯æ˜è¿™ä¸ªç»“æ„æ—¶ï¼Œæˆ‘æ„å»ºäº†ä¸€ä¸ªå¾ˆå¥½çš„ <code>dispatch_once</code> å®æ¥åˆ¶ä½œå»¶è¿Ÿåˆå§‹åŒ–çš„å¸¸é‡ã€‚å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#define ONCE(type,name,...) \</span></span><br><span class="line">UNPAREN(type) name() &#123; \</span><br><span class="line"><span class="keyword">static</span> UNPAREN(type) static_ <span class="meta">## name; \</span></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> predicate; \</span><br><span class="line"><span class="built_in">dispatch_once</span>(&amp;predicate,^&#123; \</span><br><span class="line">static_ <span class="meta">## name = (&#123; __VA_ARGS__; &#125;); \</span></span><br><span class="line">&#125;); \</span><br><span class="line"><span class="keyword">return</span> static_ <span class="meta">## name; \</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ¡ˆä¾‹ï¼š</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">ONCE(<span class="built_in">NSSet</span> *,AllowedFileTypes,[<span class="built_in">NSSet</span> setWithArray:@[ <span class="string">@"mp3"</span>,<span class="string">@"m4a"</span>,<span class="string">@"aiff"</span> ]])</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œä½ å¯ä»¥è°ƒç”¨ <code>AllowedFileTypes()</code> æ¥è·å–é›†åˆï¼Œå¹¶æ ¹æ®éœ€è¦é«˜æ•ˆåˆ›å»ºé›†åˆã€‚å¦‚æœç±»å‹ä¸å·§åŒ…æ‹¬æ‹¬å·ï¼Œæ·»åŠ æ‹¬å·å°±èƒ½è¿è¡Œã€‚</p><h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>ä»…ä»…å†™è¿™ä¸ªå®ï¼Œæˆ‘å°±å‘ç°äº†å¾ˆå¤šè‰°æ¶©çš„çŸ¥è¯†ã€‚æˆ‘å¸Œæœ›æ¥è§¦è¿™äº›çŸ¥è¯†ä¹Ÿä¸ä¼šå½±å“ä½ çš„æ€ç»´ã€‚è¯·è°¨æ…ä½¿ç”¨è¿™äº›çŸ¥è¯†ã€‚</p><p>ä»Šå¤©å°±è¿™æ ·ã€‚ä»¥åè¿˜ä¼šæœ‰æ›´å¤šä»¤äººå…´å¥‹çš„æ¢ç´¢ï¼Œå¯èƒ½æ¯”è¿™è¿˜è¦å†ä¸å¯æ€è®®ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå¦‚æœä½ å¯¹æ­¤ä¸»é¢˜æœ‰ä»»ä½•å»ºè®®ï¼Œè¯·å‘é€ç»™ <a href="mike@mikeash.com">æˆ‘ä»¬</a>ï¼</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      Objective-C ä¸­ C è¯­è¨€å®å®šä¹‰æ‰©å±•
    
    </summary>
    
      <category term="Mike Ash" scheme="https://swift.gg/categories/Mike-Ash/"/>
    
    
      <category term="iOS" scheme="https://swift.gg/tags/iOS/"/>
    
      <category term="macro" scheme="https://swift.gg/tags/macro/"/>
    
  </entry>
  
  <entry>
    <title>Swift Import å£°æ˜</title>
    <link href="https://swift.gg/2019/09/23/swift-import/"/>
    <id>https://swift.gg/2019/09/23/swift-import/</id>
    <published>2019-09-23T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šMatttï¼Œ<a href="https://nshipster.com/import/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2019-01-07<br>è¯‘è€…ï¼š<a href="https://github.com/mobilefellow" target="_blank" rel="noopener">é›¨è°¨</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="http://blog.yousanflics.com.cn" target="_blank" rel="noopener">Yousanflics</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>ä½œä¸ºè½¯ä»¶å¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬å­¦åˆ°çš„ç¬¬ä¸€è¯¾æ˜¯å¦‚ä½•å°†æ¦‚å¿µå’ŒåŠŸèƒ½ç»„ç»‡æˆç‹¬ç«‹çš„å•å…ƒã€‚åœ¨æœ€å°çš„å±‚çº§ä¸Šï¼Œè¿™æ„å‘³ç€æ€è€ƒç±»å‹ã€æ–¹æ³•å’Œå±æ€§ã€‚è¿™äº›ä¸œè¥¿æ„æˆäº†æ¨¡å—ï¼ˆmoduleï¼‰çš„åŸºç¡€ï¼Œè€Œæ¨¡å—åˆå¯ä»¥è¢«æ‰“åŒ…æˆä¸º library æˆ–è€… frameworkã€‚</p><p>åœ¨è¿™ç§æ–¹å¼ä¸­ï¼Œimport å£°æ˜æ˜¯å°†æ‰€æœ‰å†…å®¹ç»„åˆåœ¨ä¸€èµ·çš„ç²˜åˆå‰‚ã€‚</p><a id="more"></a><p>å°½ç®¡ import å£°æ˜éå¸¸é‡è¦ï¼Œä½†å¤§éƒ¨åˆ† Swift å¼€å‘è€…éƒ½åªç†Ÿæ‚‰å®ƒçš„æœ€åŸºæœ¬ç”¨æ³•ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &lt;#module#&gt;</span><br></pre></td></tr></table></figure><p>æœ¬å‘¨çš„ NSHipster ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢ Swift è¿™ä¸ªæœ€é‡è¦çš„åŠŸèƒ½çš„å…¶ä»–ç”¨æ³•ã€‚</p><hr><p>import å£°æ˜å…è®¸ä½ çš„ä»£ç è®¿é—®å…¶ä»–æ–‡ä»¶ä¸­å£°æ˜çš„ç¬¦å·ã€‚ä½†æ˜¯ï¼Œå¦‚æœå¤šä¸ªæ¨¡å—éƒ½å£°æ˜äº†ä¸€ä¸ªåŒåçš„å‡½æ•°æˆ–ç±»å‹ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°†æ— æ³•åˆ¤æ–­ä½ çš„ä»£ç åˆ°åº•æƒ³è°ƒç”¨å“ªä¸ªã€‚</p><p>ä¸ºäº†æ¼”ç¤ºè¿™ä¸ªé—®é¢˜ï¼Œè€ƒè™‘ <a href="https://zh.wikipedia.org/wiki/ä¸‰é¡¹å…¨èƒ½" target="_blank" rel="noopener">é“äººä¸‰é¡¹ï¼ˆTriathlonï¼‰</a> å’Œ <a href="https://zh.wikipedia.org/wiki/ç°ä»£äº”é¡¹" target="_blank" rel="noopener">é“äººäº”é¡¹ï¼ˆPentathlonï¼‰</a> è¿™ä¸¤ä¸ªä»£è¡¨å¤šè¿åŠ¨æ¯”èµ›çš„æ¨¡å—:</p><p><dfn>é“äººä¸‰é¡¹</dfn> åŒ…æ‹¬ä¸‰ä¸ªé¡¹ç›®ï¼šæ¸¸æ³³ã€è‡ªè¡Œè½¦å’Œè·‘æ­¥ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é“äººä¸‰é¡¹æ¨¡å—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swim</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸŠâ€ Swim 1.5 km"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bike</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸš´ Cycle 40 km"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸƒâ€ Run 10 km"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><dfn>é“äººäº”é¡¹</dfn> æ¨¡å—ç”±äº”ä¸ªé¡¹ç›®ç»„æˆï¼šå‡»å‰‘ã€æ¸¸æ³³ã€é©¬æœ¯ã€å°„å‡»å’Œè·‘æ­¥ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é“äººäº”é¡¹æ¨¡å—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fence</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸ¤º Bout with Ã©pÃ©es"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swim</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸŠâ€ Swim 200 m"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ride</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸ‡ Complete a show jumping course"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">shoot</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸ¯ Shoot 5 targets"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸƒâ€ Run 3 km cross-country"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬å•ç‹¬ import å…¶ä¸­ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒä»¬çš„ <dfn>éé™å®šï¼ˆunqualifiedï¼‰</dfn>åç§°å¼•ç”¨å®ƒä»¬çš„æ¯ä¸ªå‡½æ•°ï¼Œè€Œä¸ä¼šå‡ºç°é—®é¢˜ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Triathlon</span><br><span class="line"></span><br><span class="line">swim() <span class="comment">// æ­£ç¡®ï¼Œè°ƒç”¨ Triathlon.swim</span></span><br><span class="line">bike() <span class="comment">// æ­£ç¡®ï¼Œè°ƒç”¨ Triathlon.bike</span></span><br><span class="line">run() <span class="comment">// æ­£ç¡®ï¼Œè°ƒç”¨ Triathlon.run</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœåŒæ—¶ import ä¸¤ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬ä¸èƒ½å…¨éƒ¨ä½¿ç”¨éé™å®šå‡½æ•°åã€‚é“äººä¸‰é¡¹å’Œäº”é¡¹éƒ½åŒ…æ‹¬æ¸¸æ³³å’Œè·‘æ­¥ï¼Œæ‰€ä»¥å¯¹ <code>swim()</code> çš„å¼•ç”¨æ˜¯æ¨¡ç³Šçš„ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Triathlon</span><br><span class="line"><span class="keyword">import</span> Pentathlon</span><br><span class="line"></span><br><span class="line">bike() <span class="comment">// æ­£ç¡®ï¼Œè°ƒç”¨ Triathlon.bike</span></span><br><span class="line">fence() <span class="comment">// æ­£ç¡®ï¼Œè°ƒç”¨ Pentathlon.fence</span></span><br><span class="line">swim() <span class="comment">// é”™è¯¯ï¼Œæ¨¡ç³Šä¸æ¸…</span></span><br></pre></td></tr></table></figure><p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿä¸€ç§ç­–ç•¥æ˜¯ä½¿ç”¨ <dfn>å…¨é™å®šåç§°ï¼ˆfully-qualified nameï¼‰</dfn> æ¥å¤„ç†ä»»ä½•ä¸æ˜ç¡®çš„å¼•ç”¨ã€‚é€šè¿‡åŒ…å«æ¨¡å—åç§°ï¼Œç¨‹åºæ˜¯è¦åœ¨æ¸¸æ³³æ± ä¸­æ¸¸å‡ åœˆï¼Œè¿˜æ˜¯åœ¨å¼€æ”¾æ°´åŸŸä¸­æ¸¸ä¸€è‹±é‡Œï¼Œå°±ä¸å­˜åœ¨æ··æ·†äº†ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Triathlon</span><br><span class="line"><span class="keyword">import</span> Pentathlon</span><br><span class="line"></span><br><span class="line"><span class="type">Triathlon</span>.swim() <span class="comment">// æ­£ç¡®ï¼ŒæŒ‡å‘ Triathlon.swim çš„å…¨é™å®šå¼•ç”¨</span></span><br><span class="line"><span class="type">Pentathlon</span>.swim() <span class="comment">// æ­£ç¡®ï¼ŒæŒ‡å‘ Pentathlon.swim çš„å…¨é™å®šå¼•ç”¨</span></span><br></pre></td></tr></table></figure><p>è§£å†³ API åç§°å†²çªçš„å¦ä¸€ç§æ–¹æ³•æ˜¯æ›´æ”¹ import å£°æ˜ï¼Œä½¿å…¶æ›´åŠ ä¸¥æ ¼åœ°æŒ‘é€‰éœ€è¦åŒ…å«æ¯ä¸ªæ¨¡å—å“ªäº›çš„å†…å®¹ã€‚</p><h2 id="import-å•ä¸ªå£°æ˜"><a href="#import-å•ä¸ªå£°æ˜" class="headerlink" title="import å•ä¸ªå£°æ˜"></a>import å•ä¸ªå£°æ˜</h2><p>import å£°æ˜æä¾›äº†ä¸€ç§æ ·å¼ï¼Œå¯ä»¥æŒ‡å®šå¼•å…¥å®šä¹‰åœ¨é¡¶å±‚ï¼ˆtop-levelï¼‰çš„å•ä¸ªç»“æ„ä½“ã€ç±»ã€æšä¸¾ã€åè®®å’Œç±»å‹åˆ«åï¼Œä»¥åŠå‡½æ•°ã€å¸¸é‡å’Œå˜é‡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &lt;#kind#&gt; &lt;#module.symbol#&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œ<code>&lt;#kind#&gt;</code> å¯ä»¥ä¸ºå¦‚ä¸‹çš„ä»»ä½•å…³é”®å­—ï¼š</p><table><thead><tr><th>Kind</th><th>Description</th></tr></thead><tbody><tr><td><code>struct</code></td><td>ç»“æ„ä½“</td></tr><tr><td><code>class</code></td><td>ç±»</td></tr><tr><td><code>enum</code></td><td>æšä¸¾</td></tr><tr><td><code>protocol</code></td><td>åè®®</td></tr><tr><td><code>typealias</code></td><td>ç±»å‹åˆ«å</td></tr><tr><td><code>func</code></td><td>å‡½æ•°</td></tr><tr><td><code>let</code></td><td>å¸¸é‡</td></tr><tr><td><code>var</code></td><td>å˜é‡</td></tr></tbody></table><p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„ import å£°æ˜åªæ·»åŠ äº† <code>Pentathlon</code> æ¨¡å—çš„ <code>swim()</code> å‡½æ•°:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> func Pentathlon.swim</span><br><span class="line"></span><br><span class="line">swim() <span class="comment">// æ­£ç¡®ï¼Œè°ƒç”¨ Pentathlon.swim</span></span><br><span class="line">fence() <span class="comment">// é”™è¯¯ï¼Œæ— æ³•è§£æçš„æ ‡è¯†</span></span><br></pre></td></tr></table></figure><h3 id="è§£å†³ç¬¦å·åç§°å†²çª"><a href="#è§£å†³ç¬¦å·åç§°å†²çª" class="headerlink" title="è§£å†³ç¬¦å·åç§°å†²çª"></a>è§£å†³ç¬¦å·åç§°å†²çª</h3><p>å½“ä»£ç ä¸­å¤šä¸ªç¬¦å·è¢«åŒä¸€ä¸ªåå­—è¢«å¼•ç”¨æ—¶ï¼ŒSwift ç¼–è¯‘å™¨å‚è€ƒä»¥ä¸‹ä¿¡æ¯ï¼ŒæŒ‰ä¼˜å…ˆçº§é¡ºåºè§£æè¯¥å¼•ç”¨:</p><ol><li>æœ¬åœ°çš„å£°æ˜</li><li>å•ä¸ªå¯¼å…¥ï¼ˆimportï¼‰çš„å£°æ˜</li><li>æ•´ä½“å¯¼å…¥çš„æ¨¡å—</li></ol><p>å¦‚æœä»»ä½•ä¸€ä¸ªä¼˜å…ˆçº§æœ‰å¤šä¸ªå€™é€‰é¡¹ï¼ŒSwift å°†æ— æ³•è§£å†³æ­§ä¹‰ï¼Œè¿›è€Œå¼•å‘ç¼–è¯‘é”™è¯¯ã€‚</p><p>ä¾‹å¦‚ï¼Œæ•´ä½“å¯¼å…¥çš„ <code>Triathlon</code> æ¨¡å—ä¼šæä¾› <code>swim()</code>ã€<code>bike()</code> å’Œ <code>run()</code> æ–¹æ³•ï¼Œä½†ä» <code>Pentathlon</code> ä¸­å•ä¸ªå¯¼å…¥çš„ <code>swim()</code> å‡½æ•°å£°æ˜ä¼šè¦†ç›– <code>Triathlon</code> æ¨¡å—ä¸­çš„å¯¹åº”å‡½æ•°ã€‚åŒæ ·ï¼Œæœ¬åœ°å£°æ˜çš„ <code>run()</code> å‡½æ•°ä¼šè¦†ç›– <code>Triathlon</code> ä¸­çš„åŒåç¬¦å·ï¼Œä¹Ÿä¼šè¦†ç›–ä»»ä½•å•ä¸ªå¯¼å…¥çš„å‡½æ•°å£°æ˜ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Triathlon</span><br><span class="line"><span class="keyword">import</span> func Pentathlon.swim</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ¬åœ°çš„å‡½æ•°ä¼šé®ä½æ•´ä½“å¯¼å…¥çš„ Triathlon æ¨¡å—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ğŸƒâ€ Run 42.195 km"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">swim() <span class="comment">// æ­£ç¡®ï¼Œè°ƒç”¨ Pentathlon.swim</span></span><br><span class="line">bike() <span class="comment">// æ­£ç¡®ï¼Œè°ƒç”¨ Triathlon.bike</span></span><br><span class="line">run() <span class="comment">//  æ­£ç¡®ï¼Œè°ƒç”¨æœ¬åœ°çš„ run</span></span><br></pre></td></tr></table></figure><p>é‚£è¿™ä¸ªä»£ç çš„è¿è¡Œç»“æœæ˜¯ï¼Ÿä¸€ä¸ªå¤æ€ªçš„å¤šè¿åŠ¨æ¯”èµ›ï¼ŒåŒ…æ‹¬åœ¨ä¸€ä¸ªæ³³æ± é‡Œæ¸¸å‡ åœˆçš„æ¸¸æ³³ï¼Œä¸€ä¸ªé€‚åº¦çš„è‡ªè¡Œè½¦éª‘è¡Œï¼Œå’Œä¸€ä¸ªé©¬æ‹‰æ¾è·‘ã€‚<em>(@ æˆ‘ä»¬, é’¢é“ä¾ )</em></p><blockquote><p>å¦‚æœæœ¬åœ°æˆ–è€…å¯¼å…¥çš„å£°æ˜ï¼Œä¸æ¨¡å—çš„åå­—å‘ç”Ÿå†²çªï¼Œç¼–è¯‘å™¨é¦–å…ˆæŸ¥æ‰¾å£°æ˜ï¼Œç„¶ååœ¨æ¨¡å—ä¸­è¿›è¡Œé™å®šæŸ¥æ‰¾ã€‚</p></blockquote><blockquote><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">&gt; <span class="keyword">import</span> Triathlon</span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="class"><span class="keyword">enum</span> <span class="title">Triathlon</span> </span>&#123;</span><br><span class="line">&gt;     <span class="keyword">case</span> sprint, olympic, ironman</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="type">Triathlon</span>.olympic <span class="comment">// å¼•ç”¨æœ¬åœ°çš„æšä¸¾ case</span></span><br><span class="line">&gt; <span class="type">Triathlon</span>.swim() <span class="comment">// å¼•ç”¨æ¨¡å—çš„å‡½æ•°</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>Swiftç¼–è¯‘å™¨ä¸ä¼šé€šçŸ¥å¼€å‘è€…ï¼Œä¹Ÿæ— æ³•åè°ƒæ¨¡å—å’Œæœ¬åœ°å£°æ˜ä¹‹é—´çš„å‘½åå†²çªï¼Œå› æ­¤ä½¿ç”¨ä¾èµ–é¡¹æ—¶ï¼Œä½ åº”è¯¥äº†è§£è¿™ç§å¯èƒ½æ€§ã€‚</p></blockquote><h3 id="æ¾„æ¸…å’Œç¼©å°èŒƒå›´"><a href="#æ¾„æ¸…å’Œç¼©å°èŒƒå›´" class="headerlink" title="æ¾„æ¸…å’Œç¼©å°èŒƒå›´"></a>æ¾„æ¸…å’Œç¼©å°èŒƒå›´</h3><p>é™¤äº†è§£å†³å‘½åå†²çªä¹‹å¤–ï¼Œimport å£°æ˜è¿˜å¯ä»¥ä½œä¸ºæ¾„æ¸…ç¨‹åºå‘˜æ„å›¾çš„ä¸€ç§æ–¹æ³•ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœåªä½¿ç”¨ AppKit è¿™æ ·å¤§å‹æ¡†æ¶ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨ import å£°æ˜ä¸­å•ç‹¬æŒ‡å®šè¿™ä¸ªå‡½æ•°ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> func AppKit.NSUserName</span><br><span class="line"></span><br><span class="line"><span class="type">NSUserName</span>() <span class="comment">// "jappleseed"</span></span><br></pre></td></tr></table></figure><p>é¡¶å±‚å¸¸é‡å’Œå˜é‡çš„æ¥æºé€šå¸¸æ¯”å…¶ä»–çš„å¯¼å…¥ç¬¦å·æ›´éš¾è¯†åˆ«ï¼Œåœ¨å¯¼å…¥å®ƒä»¬æ—¶ï¼Œè¿™ä¸ªæŠ€æœ¯å°¤å…¶æœ‰ç”¨ã€‚</p><p>ä¾‹å¦‚ï¼ŒDarwin framework æä¾›çš„ä¼—å¤šåŠŸèƒ½ä¸­ï¼ŒåŒ…å«ä¸€ä¸ªé¡¶å±‚çš„ <code>stderr</code> å˜é‡ã€‚è¿™é‡Œçš„ä¸€ä¸ªæ˜¾å¼ import å£°æ˜å¯ä»¥åœ¨ä»£ç è¯„å®¡æ—¶ï¼Œæå‰é¿å…è¯¥å˜é‡æ¥æºçš„ä»»ä½•ç–‘é—®ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> func Darwin.fputs</span><br><span class="line"><span class="keyword">import</span> var Darwin.stderr</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">StderrOutputStream</span>: <span class="title">TextOutputStream</span> </span>&#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">write</span><span class="params">(<span class="number">_</span> string: String)</span></span> &#123;</span><br><span class="line">        fputs(string, stderr)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> standardError = <span class="type">StderrOutputStream</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Error!"</span>, to: &amp;standardError)</span><br></pre></td></tr></table></figure><h2 id="import-å­æ¨¡å—"><a href="#import-å­æ¨¡å—" class="headerlink" title="import å­æ¨¡å—"></a>import å­æ¨¡å—</h2><p>æœ€åä¸€ç§ import å£°æ˜æ ·å¼ï¼Œæä¾›äº†å¦ä¸€ç§é™åˆ¶ API æš´éœ²çš„æ–¹å¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &lt;#module.submodule#&gt;</span><br></pre></td></tr></table></figure><p>ä½ å¾ˆå¯èƒ½åœ¨ AppKit å’Œ Accelerate ç­‰å¤§å‹çš„ç³»ç»Ÿ framework ä¸­é‡åˆ°å­æ¨¡å—ã€‚è™½ç„¶è¿™ç§ <dfn><a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPFrameworks/Concepts/FrameworkAnatomy.html#//apple_ref/doc/uid/20002253-97623-BAJJHAJC" target="_blank" rel="noopener">ä¼æ¶æ„ï¼ˆumbrella frameworkï¼‰</a></dfn> ä¸å†æ˜¯ä¸€ç§æœ€ä½³å®è·µï¼Œä½†å®ƒä»¬åœ¨ 20 ä¸–çºªåˆè‹¹æœå‘ Cocoa è¿‡æ¸¡çš„è¿‡ç¨‹ä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚</p><p>ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä»… import <a href="developer.apple.com/documentation/coreservices">Core Services framework</a> çš„ <a href="/dictionary-services/">DictionaryServices</a> å­æ¨¡å—ï¼Œä»è€Œå°†ä½ çš„ä»£ç ä¸æ— æ•°å·²åºŸå¼ƒçš„ APIï¼ˆå¦‚ Carbon Coreï¼‰éš”ç¦»å¼€æ¥ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> CoreServices.DictionaryServices</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">define</span><span class="params">(<span class="number">_</span> word: String)</span></span> -&gt; <span class="type">String?</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> nsstring = word <span class="keyword">as</span> <span class="type">NSString</span></span><br><span class="line">    <span class="keyword">let</span> cfrange = <span class="type">CFRange</span>(location: <span class="number">0</span>, length: nsstring.length)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> definition = <span class="type">DCSCopyTextDefinition</span>(<span class="literal">nil</span>, nsstring, cfrange) <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(definition.takeUnretainedValue())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">define(<span class="string">"apple"</span>) <span class="comment">// "apple | ËˆapÉ™l | noun 1 the round fruit of a tree..."</span></span><br></pre></td></tr></table></figure><p>äº‹å®ä¸Šï¼Œå•ç‹¬å¯¼å…¥çš„å£°æ˜å’Œå­æ¨¡å—ï¼Œé™¤äº†æ¾„æ¸…ç¨‹åºå‘˜çš„æ„å›¾ï¼Œå¹¶ä¸èƒ½å¸¦æ¥ä»»ä½•çœŸæ­£çš„å¥½å¤„ã€‚è¿™ç§æ–¹å¼å¹¶ä¸ä¼šè®©ä½ çš„ä»£ç ç¼–è¯‘åœ°æ›´å¿«ã€‚ç”±äºå¤§éƒ¨åˆ†çš„å­æ¨¡å—ä¼¼ä¹éƒ½ä¼šé‡æ–°å¯¼å…¥å®ƒä»¬çš„ä¼å¤´æ–‡ä»¶ï¼ˆumbrella headerï¼‰ï¼Œå› æ­¤è¿™ç§æ–¹å¼ä¹Ÿæ²¡æ³•å‡å°‘è‡ªåŠ¨è¡¥å…¨åˆ—è¡¨ä¸Šçš„å™ªéŸ³ã€‚</p><hr><p>ä¸è®¸å¤šæ™¦æ¶©éš¾æ‡‚çš„é«˜çº§ä¸»é¢˜ä¸€æ ·ï¼Œä½ ä¹‹æ‰€ä»¥æ²¡æœ‰å¬è¯´è¿‡è¿™äº› import å£°æ˜æ ·å¼ï¼Œå¾ˆå¯èƒ½çš„æ˜¯å› ä¸ºä½ ä¸éœ€è¦äº†è§£å®ƒä»¬ã€‚å¦‚æœä½ å·²ç»åœ¨æ²¡æœ‰å®ƒä»¬çš„æƒ…å†µä¸‹å¼€å‘äº†å¾ˆå¤š APPï¼Œé‚£ä¹ˆä½ å®Œå…¨æœ‰ç†ç”±å¯ä»¥ç›¸ä¿¡ï¼Œä½ ä¸éœ€è¦å¼€å§‹ä½¿ç”¨å®ƒä»¬ã€‚</p><p>ç›¸åï¼Œè¿™é‡Œæ¯”è¾ƒæœ‰ä»·å€¼çš„æ”¶è·æ˜¯ç†è§£ Swift ç¼–è¯‘å™¨å¦‚ä½•è§£å†³å‘½åå†²çªã€‚ä¸ºæ­¤ï¼Œç†è§£ import å£°æ˜æ˜¯éå¸¸é‡è¦çš„ã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      ä½œä¸ºè½¯ä»¶å¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬å­¦åˆ°çš„ç¬¬ä¸€è¯¾æ˜¯å¦‚ä½•å°†æ¦‚å¿µå’ŒåŠŸèƒ½ç»„ç»‡æˆç‹¬ç«‹çš„å•å…ƒã€‚ä½†æ˜¯ï¼Œå½“å‘½åç©ºé—´å†²çªå’Œå£°æ˜éšè—åœ¨é˜´å½±æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ
    
    </summary>
    
      <category term="Swift" scheme="https://swift.gg/categories/Swift/"/>
    
      <category term="NSHipster" scheme="https://swift.gg/categories/Swift/NSHipster/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
      <category term="NSHipster" scheme="https://swift.gg/tags/NSHipster/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨ç»“æ„ä½“å’Œå…ƒç»„æ„å»ºæ›´æ•´æ´çš„ç±»</title>
    <link href="https://swift.gg/2019/09/20/2019-02-24-anonymous-tuple-structs/"/>
    <id>https://swift.gg/2019/09/20/2019-02-24-anonymous-tuple-structs/</id>
    <published>2019-09-20T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šBenedikt Terhechteï¼Œ<a href="https://appventure.me/posts/2019-02-24-anonymous-tuple-structs.html" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2019-02-24<br>è¯‘è€…ï¼š<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://bignerdcoding.com/" target="_blank" rel="noopener">BigNerdCoding</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>å‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€æ¬¾ç¤¾äº¤ç½‘ç»œåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ä¸ªå¸¦æœ‰å…³æ³¨æŒ‰é’®å’Œç‚¹èµæŒ‰é’®çš„ç”¨æˆ·å›¾ç‰‡å±•ç¤ºç»„ä»¶ã€‚åŒæ—¶ï¼Œä¸ºäº†æ»¡è¶³å•ä¸€åŠŸèƒ½åŸåˆ™ï¼ˆsingle responsibility principleï¼‰å’Œè§†å›¾æ§åˆ¶å™¨çš„æ„æˆï¼Œ<strong>ç‚¹èµ</strong>å’Œ<strong>å…³æ³¨</strong>çš„å®ç°åº”è¯¥å¦æœ‰å®ƒå¤„ã€‚ç¤¾äº¤ç½‘ç»œä¸ä»…æœ‰é«˜çº§è´¦æˆ·ï¼Œä¹Ÿæœ‰ä¼ä¸šè´¦æˆ·ï¼Œå› æ­¤ <code>InteractiveUserImageController</code>ï¼ˆå‘½åä»æ¥ä¸æ˜¯æˆ‘çš„å¼ºé¡¹ï¼‰ è¦èƒ½æ»¡è¶³ä¸€ç³»åˆ—çš„é…ç½®é€‰é¡¹ã€‚ä»¥ä¸‹æ˜¯è¿™ä¸ªç±»ä¸€ä¸ªå¯èƒ½çš„å®ç°ï¼ˆä¸ºä½œå±•ç¤ºï¼Œç¤ºä¾‹ä»£ç ä¿ç•™äº†ä¸å°‘å¯æ”¹è¿›çš„åœ°æ–¹ï¼‰ï¼š<br><a id="more"></a><br><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">InteractiveUserImageController</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="comment">/// æ˜¯å¦éœ€è¦å±•ç¤ºé«˜çº§å¸ƒå±€</span></span><br><span class="line">    <span class="keyword">var</span> isPremium: <span class="type">Bool</span></span><br><span class="line">    <span class="comment">/// è´¦æˆ·ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> accountType: <span class="type">AccountType</span></span><br><span class="line">    <span class="comment">/// ç‚¹å‡»è§†å›¾æ˜¯å¦é«˜äº®</span></span><br><span class="line">    <span class="keyword">var</span> isHighlighted: <span class="type">Bool</span></span><br><span class="line">    <span class="comment">/// ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">var</span> username: <span class="type">String</span></span><br><span class="line">    <span class="comment">/// ç”¨æˆ·å¤´åƒ</span></span><br><span class="line">    <span class="keyword">var</span> profileImage: <span class="type">UIImage</span></span><br><span class="line">    <span class="comment">/// å½“å‰ç”¨æˆ·æ˜¯å¦èƒ½ç‚¹èµè¯¥ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">var</span> canLike: <span class="type">Bool</span></span><br><span class="line">    <span class="comment">/// å½“å‰ç”¨æˆ·æ˜¯å¦èƒ½å…³æ³¨è¯¥ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">var</span> canFollow: <span class="type">Bool</span></span><br><span class="line">    <span class="comment">/// å¤§èµæŒ‰é’®æ˜¯å¦èƒ½ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">var</span> bigLikeButton: <span class="type">Bool</span></span><br><span class="line">    <span class="comment">/// é’ˆå¯¹ä¸€äº›å†…å®¹ä½¿ç”¨ç‰¹æ®Šçš„èƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="keyword">var</span> alternativeBackgroundColor: <span class="type">Bool</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(...) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸å°‘å‚æ•°ã€‚éšç€åº”ç”¨ä½“é‡çš„å¢é•¿ï¼Œä¼šæœ‰æ›´å¤šçš„å‚æ•°è¢«åŠ è¿›ç±»é‡Œã€‚å°†è¿™äº›å‚æ•°é€šè¿‡èŒèƒ½è¿›è¡Œåˆ’åˆ†å’Œé‡æ„å›ºç„¶å¯è¡Œï¼Œä½†æœ‰æ—¶ä¿æŒäº†å•ä¸€åŠŸèƒ½åä»ä¼šæœ‰å¤§é‡çš„å‚æ•°å­˜åœ¨ã€‚è¦å¦‚ä½•æ‰èƒ½æ›´å¥½çš„ç»„ç»‡ä»£ç å‘¢ï¼Ÿ</p><h2 id="Swift-ç»“æ„ä½“ç»“æ„"><a href="#Swift-ç»“æ„ä½“ç»“æ„" class="headerlink" title="Swift ç»“æ„ä½“ç»“æ„"></a>Swift ç»“æ„ä½“ç»“æ„</h2><p>Swift çš„ <code>struct</code> ç±»å‹åœ¨è¿™ç§æƒ…å†µèƒ½å‘æŒ¥å·¨å¤§çš„ä½œç”¨ã€‚ä¾æ®å‚æ•°çš„ç±»å‹å°†å®ƒä»¬è£…è¿›<strong>ä¸€æ¬¡æ€§</strong>ç»“æ„ä½“ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">InteractiveUserImageController</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">DisplayOptions</span> </span>&#123;</span><br><span class="line">        <span class="comment">/// å¤§èµæŒ‰é’®æ˜¯å¦èƒ½ä½¿ç”¨</span></span><br><span class="line">        <span class="keyword">var</span> bigLikeButton: <span class="type">Bool</span></span><br><span class="line">        <span class="comment">/// é’ˆå¯¹ä¸€äº›å†…å®¹ä½¿ç”¨ç‰¹æ®Šçš„èƒŒæ™¯è‰²</span></span><br><span class="line">        <span class="keyword">var</span> alternativeBackgroundColor: <span class="type">Bool</span></span><br><span class="line">        <span class="comment">/// æ˜¯å¦éœ€è¦å±•ç¤ºé«˜çº§å¸ƒå±€</span></span><br><span class="line">        <span class="keyword">var</span> isPremium: <span class="type">Bool</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">UserOptions</span> </span>&#123;</span><br><span class="line">        <span class="comment">/// è´¦æˆ·ç±»å‹</span></span><br><span class="line">        <span class="keyword">var</span> accountType: <span class="type">AccountType</span></span><br><span class="line">        <span class="comment">/// ç”¨æˆ·å</span></span><br><span class="line">        <span class="keyword">var</span> username: <span class="type">String</span></span><br><span class="line">        <span class="comment">/// ç”¨æˆ·å¤´åƒ</span></span><br><span class="line">        <span class="keyword">var</span> profileImage: <span class="type">UIImage</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">State</span> </span>&#123;</span><br><span class="line">        <span class="comment">/// ç‚¹å‡»è§†å›¾æ˜¯å¦é«˜äº®</span></span><br><span class="line">        <span class="keyword">var</span> isHighlighted: <span class="type">Bool</span></span><br><span class="line">        <span class="comment">/// å½“å‰ç”¨æˆ·æ˜¯å¦èƒ½ç‚¹èµè¯¥ç”¨æˆ·</span></span><br><span class="line">        <span class="keyword">var</span> canLike: <span class="type">Bool</span></span><br><span class="line">        <span class="comment">/// å½“å‰ç”¨æˆ·æ˜¯å¦èƒ½å…³æ³¨è¯¥ç”¨æˆ·</span></span><br><span class="line">        <span class="keyword">var</span> canFollow: <span class="type">Bool</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> displayOptions = <span class="type">DisplayOptions</span>(...)</span><br><span class="line">    <span class="keyword">var</span> userOptions = <span class="type">UserOptions</span>(...)</span><br><span class="line">    <span class="keyword">var</span> state = <span class="type">State</span>(...)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(...) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­£å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬æŠŠè¿™äº›çŠ¶æ€æ”¾å…¥äº†ç‹¬ç«‹çš„ <code>struct</code> ç±»å‹ä¸­ã€‚ä¸ä»…è®©ç±»æ›´æ•´æ´ï¼Œä¹Ÿä¾¿äºæ–°ä¸Šæ‰‹çš„å¼€å‘è€…æ‰¾åˆ°ç›¸å…³è”çš„é€‰é¡¹ã€‚</p><p>å·²ç»æ˜¯ä¸€ä¸ªä¸é”™çš„æ”¹è¿›äº†ï¼Œä½†æˆ‘ä»¬èƒ½åšå¾—æ›´å¥½ï¼</p><p>æˆ‘ä»¬é¢ä¸´çš„é—®é¢˜æ˜¯æŸ¥æ‰¾ä¸€ä¸ªå‚æ•°éœ€è¦é¢å¤–çš„æ“ä½œã€‚</p><p>ç”±äºä½¿ç”¨äº†ä¸€æ¬¡æ€§ç»“æ„ä½“ç±»å‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æŸå¤„å®šä¹‰å®ƒä»¬ï¼ˆä¾‹å¦‚ï¼š<code>struct DisplayOptions</code>ï¼‰ï¼Œä¹Ÿéœ€è¦å°†å®ƒä»¬å®ä¾‹åŒ–ï¼ˆä¾‹å¦‚ï¼š<code>let displayOptions = DisplayOptions(...)</code>ï¼‰ã€‚å¤§ä½“ä¸Šæ¥è¯´<strong>æ²¡ä»€ä¹ˆé—®é¢˜</strong>ï¼Œä½†åœ¨æ›´å¤§çš„ç±»ä¸­ï¼Œä¸ºç¡®å®š <code>displayOptions</code> çš„ç±»å‹ä»æ—§éœ€è¦ä¸€æ¬¡é¢å¤–çš„æŸ¥è¯¢ã€‚ç„¶è€Œï¼Œä¸ C è¯­è¨€ä¸åŒï¼Œåƒä¸‹é¢è¿™æ ·çš„åŒ¿å <code>struct</code> åœ¨ Swift é‡Œå¹¶ä¸å­˜åœ¨ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> displayOptions = <span class="class"><span class="keyword">struct</span> </span>&#123;</span><br><span class="line">    <span class="comment">/// å¤§èµæŒ‰é’®æ˜¯å¦èƒ½ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">var</span> bigLikeButton: <span class="type">Bool</span></span><br><span class="line">    <span class="comment">/// é’ˆå¯¹ä¸€äº›å†…å®¹ä½¿ç”¨ç‰¹æ®Šçš„èƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="keyword">var</span> alternativeBackgroundColor: <span class="type">Bool</span></span><br><span class="line">    <span class="comment">/// æ˜¯å¦éœ€è¦å±•ç¤ºé«˜çº§å¸ƒå±€</span></span><br><span class="line">    <span class="keyword">var</span> isPremium: <span class="type">Bool</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å…ƒç»„-â€“-åŒ¿åç»“æ„ä½“åœ¨-Swift-ä¸­çš„å®ç°"><a href="#å…ƒç»„-â€“-åŒ¿åç»“æ„ä½“åœ¨-Swift-ä¸­çš„å®ç°" class="headerlink" title="å…ƒç»„ â€“ åŒ¿åç»“æ„ä½“åœ¨ Swift ä¸­çš„å®ç°"></a>å…ƒç»„ â€“ åŒ¿åç»“æ„ä½“åœ¨ Swift ä¸­çš„å®ç°</h2><p>å®é™…ä¸Šï¼ŒSwift ä¸­è¿˜çœŸæœ‰è¿™ä¹ˆä¸€ä¸ªç±»å‹ã€‚å®ƒå°±æ˜¯æˆ‘ä»¬çš„è€æœ‹å‹ï¼Œ<code>tuple</code>ã€‚è‡ªå·±çœ‹å§ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> displayOptions: (</span><br><span class="line">  bigLikeButton: <span class="type">Bool</span>,</span><br><span class="line">  alternativeBackgroundColor: <span class="type">Bool</span>,</span><br><span class="line">  isPremium: <span class="type">Bool</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªæ–°çš„ç±»å‹ <code>displayOptions</code>ï¼Œå¸¦æœ‰ä¸‰ä¸ªå‚æ•°ï¼ˆ<code>bigLikeButton</code>ï¼Œ<code>alternativeBackgroundColor</code>ï¼Œ<code>isPremium</code>ï¼‰ï¼Œå®ƒèƒ½åƒå‰é¢çš„ <code>struct</code> ä¸€æ ·è¢«è®¿é—®ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">user.displayOptions.alternativeBackgroundColor = <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>æ›´å¥½çš„æ˜¯ï¼Œå‚æ•°å®šä¹‰ä¸éœ€è¦åšé¢å¤–çš„åˆå§‹åŒ–ï¼Œä¸€åˆ‡éƒ½äº•ç„¶æœ‰åºã€‚</p><h2 id="å¼ºåˆ¶ä¸å¯å˜æ€§"><a href="#å¼ºåˆ¶ä¸å¯å˜æ€§" class="headerlink" title="å¼ºåˆ¶ä¸å¯å˜æ€§"></a>å¼ºåˆ¶ä¸å¯å˜æ€§</h2><p>æœ€åï¼Œ<code>tuple</code> æ—¢å¯ä»¥æ˜¯ <code>å¯å˜çš„</code> ä¹Ÿå¯ä»¥æ˜¯ <code>ä¸å¯å˜çš„</code>ã€‚æ­£å¦‚ä½ åœ¨ç¬¬ä¸€è¡Œæ‰€çœ‹åˆ°çš„é‚£æ ·ï¼šæˆ‘ä»¬å®šä¹‰çš„æ˜¯ <code>var displayOptions</code> è€Œä¸æ˜¯ <code>var</code> æˆ– <code>let</code> <code>bigLikeButton</code>ã€‚<code>bigLikeButton</code> å’Œ <code>displayOptions</code> ä¸€æ ·ä¹Ÿæ˜¯ <code>var</code>ã€‚è¿™æ ·åšçš„å¥½å¤„åœ¨äºå¼ºåˆ¶æŠŠé™æ€å¸¸é‡ï¼ˆä¾‹å¦‚è¡Œé«˜ï¼Œå¤´éƒ¨é«˜åº¦ï¼‰æ”¾å…¥ä¸€ä¸ªä¸åŒçš„ï¼ˆ<code>let</code>ï¼‰ç»„ã€‚</p><h2 id="æ·»åŠ æ•°æ®"><a href="#æ·»åŠ æ•°æ®" class="headerlink" title="æ·»åŠ æ•°æ®"></a>æ·»åŠ æ•°æ®</h2><p>å½“éœ€è¦ç”¨ä¸€äº›å€¼åˆå§‹åŒ–å‚æ•°æ—¶ï¼Œä½ ä¹Ÿèƒ½å¾ˆå¥½çš„åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠ åˆ†é¡¹ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> displayOptions = (</span><br><span class="line">  bigLikeButton: <span class="literal">true</span>,</span><br><span class="line">  alternativeBackgroundColor: <span class="literal">false</span>,</span><br><span class="line">  isPremium: <span class="literal">false</span>,</span><br><span class="line">  defaultUsername: <span class="string">"Anonymous"</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä¸ä¹‹å‰çš„ä»£ç ç±»ä¼¼ï¼Œè¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªå…ƒç»„çš„é€‰é¡¹é›†ï¼ŒåŒæ—¶å°†å®ƒä»¬æ­£ç¡®è¿›è¡Œäº†åˆå§‹åŒ–ã€‚</p><h2 id="ç®€åŒ–"><a href="#ç®€åŒ–" class="headerlink" title="ç®€åŒ–"></a>ç®€åŒ–</h2><p>ç›¸æ¯”äºä½¿ç”¨ç»“æ„ä½“è€Œè¨€ï¼Œä½¿ç”¨äº†å…ƒç»„çš„é€‰é¡¹é›†èƒ½æ›´è½»æ˜“çš„ç®€åŒ–ä»£ç ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserFollowComponent</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> displayOptions = (</span><br><span class="line">        likeButton: (</span><br><span class="line">            bigButton: <span class="literal">true</span>,</span><br><span class="line">            alternativeBackgroundColor: <span class="literal">true</span></span><br><span class="line">            ),</span><br><span class="line">        imageView: (</span><br><span class="line">            highlightLineWidth: <span class="number">2.0</span>,</span><br><span class="line">            defaultColor: <span class="string">"#33854"</span></span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« ä¼šå¯¹ä½ æœ‰å¸®åŠ©ã€‚æˆ‘å¤§é‡åº”ç”¨è¿™äº›ç®€å•çš„æ¨¡å¼æ¥è®©ä»£ç æ›´å…·ç»“æ„åŒ–ã€‚å³ä¾¿æ˜¯åªå¯¹ 2 - 3 ä¸ªå‚æ•°åšè¿™æ ·çš„å¤„ç†ï¼Œä¹Ÿèƒ½ä»ä¸­è·ç›Šã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡æè¿°äº†å¦‚ä½•å·§å¦™åˆ©ç”¨ç»“æ„ä½“ä¸å…ƒç»„æ¥ç»“æ„åŒ–ç±»ã€‚
    
    </summary>
    
      <category term="APPVENTURE" scheme="https://swift.gg/categories/APPVENTURE/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>åƒå‘¼ä¸‡å”¤å§‹å‡ºæ¥â˜‘ï¸ï¼šSwiftWebUI</title>
    <link href="https://swift.gg/2019/09/12/swiftwebui/"/>
    <id>https://swift.gg/2019/09/12/swiftwebui/</id>
    <published>2019-09-12T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šThe Always Right Instituteï¼Œ<a href="http://www.alwaysrightinstitute.com/swiftwebui/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2019-06-30<br>è¯‘è€…ï¼š<a href="https://github.com/Ji4n1ng" target="_blank" rel="noopener">Ji4n1ng</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><hr><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>å…­æœˆåˆï¼ŒApple åœ¨ <a href="https://developer.apple.com/wwdc19/" target="_blank" rel="noopener">WWDC 2019</a> ä¸Šå‘å¸ƒäº† <a href="https://developer.apple.com/xcode/swiftui/" target="_blank" rel="noopener">SwiftUI</a>ã€‚SwiftUI æ˜¯ä¸€ä¸ªâ€œè·¨å¹³å°çš„â€ã€â€œå£°æ˜å¼â€æ¡†æ¶ï¼Œç”¨äºæ„å»º tvOSã€macOSã€watchOS å’Œ iOS ä¸Šçš„ç”¨æˆ·ç•Œé¢ã€‚<a href="https://github.com/SwiftWebUI/SwiftWebUI" target="_blank" rel="noopener">SwiftWebUI</a> åˆ™å°†å®ƒå¸¦åˆ°äº† Web å¹³å°ä¸Šâœ”ï¸ã€‚</p><a id="more"></a><p><strong>å…è´£å£°æ˜</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªç©å…·é¡¹ç›®ï¼ä¸è¦ç”¨äºç”Ÿäº§ã€‚ä½¿ç”¨ SwiftWebUI æ˜¯ä¸ºäº†äº†è§£æ›´å¤šå…³äº SwiftUI æœ¬èº«åŠå…¶å†…éƒ¨å·¥ä½œåŸç†çš„ä¿¡æ¯ã€‚</p><h2 id="SwiftWebUI"><a href="#SwiftWebUI" class="headerlink" title="SwiftWebUI"></a>SwiftWebUI</h2><p>é‚£ä¹ˆç©¶ç«Ÿä»€ä¹ˆæ˜¯ <a href="https://github.com/SwiftWebUI/SwiftWebUI" target="_blank" rel="noopener">SwiftWebUI</a>ï¼Ÿå®ƒå…è®¸ä½ ç¼–å†™å¯ä»¥åœ¨ Web æµè§ˆå™¨ä¸­æ˜¾ç¤ºçš„ SwiftUI çš„ <a href="https://developer.apple.com/documentation/swiftui/view" target="_blank" rel="noopener">è§†å›¾</a>ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftWebUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainPage</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">  @<span class="type">State</span> <span class="keyword">var</span> counter = <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">countUp</span><span class="params">()</span></span> &#123; counter += <span class="number">1</span> &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">VStack</span> &#123;</span><br><span class="line">      <span class="type">Text</span>(<span class="string">"ğŸ¥‘ğŸ #\(counter)"</span>)</span><br><span class="line">        .padding(.all)</span><br><span class="line">        .background(.green, cornerRadius: <span class="number">12</span>)</span><br><span class="line">        .foregroundColor(.white)</span><br><span class="line">        .tapAction(<span class="keyword">self</span>.countUp)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/AvocadoCounter/AvocadoCounter.gif" alt></p><p>ä¸å…¶ä»–ä¸€äº›å·¥ä½œä¸åŒï¼ŒSwiftWebUI ä¸ä»…ä»…æ˜¯å°† SwiftUI è§†å›¾æ¸²æŸ“ä¸º HTMLï¼Œè€Œä¸”è¿˜åœ¨æµè§ˆå™¨å’Œ Swift æœåŠ¡å™¨ä¸­æ‰˜ç®¡çš„ä»£ç ä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªè¿æ¥ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°å„ç§äº¤äº’åŠŸèƒ½â€”â€”æŒ‰é’®ã€é€‰æ‹©å™¨ã€æ­¥è¿›å™¨ã€åˆ—è¡¨ã€å¯¼èˆªç­‰ï¼Œè¿™äº›éƒ½å¯ä»¥åšåˆ°ï¼</p><p>æ¢å¥è¯è¯´ï¼š<a href="https://github.com/SwiftWebUI/SwiftWebUI" target="_blank" rel="noopener">SwiftWebUI</a> æ˜¯é’ˆå¯¹æµè§ˆå™¨çš„ SwiftUI APIï¼ˆå¾ˆå¤šéƒ¨åˆ†ä½†ä¸æ˜¯æ‰€æœ‰ï¼‰çš„ä¸€ç§å®ç°ã€‚</p><p>å†æ¬¡è¿›è¡Œ<strong>å…è´£å£°æ˜</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªç©å…·é¡¹ç›®ï¼ä¸è¦ç”¨äºç”Ÿäº§ã€‚ä½¿ç”¨ SwiftWebUI æ˜¯ä¸ºäº†äº†è§£æ›´å¤šå…³äº SwiftUI æœ¬èº«åŠå…¶å†…éƒ¨å·¥ä½œåŸç†çš„ä¿¡æ¯ã€‚</p><h2 id="å­¦ä¹ ä¸€æ¬¡ï¼Œéšå¤„ä½¿ç”¨"><a href="#å­¦ä¹ ä¸€æ¬¡ï¼Œéšå¤„ä½¿ç”¨" class="headerlink" title="å­¦ä¹ ä¸€æ¬¡ï¼Œéšå¤„ä½¿ç”¨"></a>å­¦ä¹ ä¸€æ¬¡ï¼Œéšå¤„ä½¿ç”¨</h2><p>SwiftUI çš„æ—¢å®šç›®æ ‡ä¸æ˜¯â€œ<a href="https://en.wikipedia.org/wiki/Write_once,_run_anywhere" target="_blank" rel="noopener">ç¼–å†™ä¸€æ¬¡ï¼Œéšå¤„è¿è¡Œ</a>â€ï¼Œè€Œæ˜¯â€œ<a href="https://developer.apple.com/videos/play/wwdc2019/216" target="_blank" rel="noopener">å­¦ä¹ ä¸€æ¬¡ï¼Œéšå¤„ä½¿ç”¨</a>â€ã€‚ä¸è¦æœŸæœ›åœ¨ iOS ä¸Šå¼€å‘äº†ä¸€ä¸ªæ¼‚äº®çš„ SwiftUI åº”ç”¨ç¨‹åºï¼Œç„¶åå°†å®ƒçš„ä»£ç æ”¾å…¥ SwiftWebUI é¡¹ç›®ä¸­ï¼Œå¹¶è®©å®ƒåœ¨æµè§ˆå™¨ä¸­å‘ˆç°å®Œå…¨ç›¸åŒçš„å†…å®¹ã€‚è¿™ä¸æ˜¯æˆ‘ä»¬çš„é‡ç‚¹ã€‚</p><p>å…³é”®æ˜¯èƒ½å¤Ÿé‡ç”¨ SwiftUI çš„åŸç†å¹¶ä½¿å…¶åœ¨ä¸åŒå¹³å°ä¹‹é—´å…±äº«ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒSwiftWebUI å°±è¾¾åˆ°ç›®çš„äº†âœ”ï¸ã€‚</p><p>ä½†æ˜¯å…ˆè®©æˆ‘ä»¬æ·±å…¥äº†è§£ä¸€ä¸‹ç»†èŠ‚ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªç®€å•çš„ SwiftWebUI åº”ç”¨ç¨‹åºã€‚æœ¬ç€â€œå­¦ä¹ ä¸€æ¬¡ï¼Œéšå¤„ä½¿ç”¨â€çš„ç²¾ç¥ï¼Œé¦–å…ˆè§‚çœ‹è¿™ä¸¤ä¸ª WWDC æ¼”è®²ï¼š<a href="https://developer.apple.com/videos/play/wwdc2019/204/" target="_blank" rel="noopener">ä»‹ç» SwiftUI</a> å’Œ <a href="https://developer.apple.com/videos/play/wwdc2019/216" target="_blank" rel="noopener">SwiftUI è¦ç‚¹</a>ã€‚æœ¬æ–‡ä¸ä¼šè¿‡å¤šçš„æ·±å…¥æ•°æ®æµæœ‰å…³çš„å†…å®¹ï¼Œä½†è¿™ç¯‡æ¼”è®²åŒæ ·æ¨èè§‚çœ‹ï¼ˆè¿™äº›æ¦‚å¿µåœ¨ SwiftWebUI ä¸­è¢«å¹¿æ³›æ”¯æŒï¼‰ï¼š<a href="https://developer.apple.com/videos/play/wwdc2019/226" target="_blank" rel="noopener">SwiftUI ä¸­çš„æ•°æ®æµ</a>ã€‚</p><h2 id="è¦æ±‚"><a href="#è¦æ±‚" class="headerlink" title="è¦æ±‚"></a>è¦æ±‚</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒSwiftWebUI éœ€è¦å®‰è£… <a href="https://www.apple.com/macos/catalina-preview/" target="_blank" rel="noopener">macOS Catalina</a> æ¥è¿è¡Œï¼ˆâ€œSwift ABIâ€ğŸ¤¦â€â™€ï¸ï¼‰ã€‚å¹¸è¿çš„æ˜¯ï¼Œå°† <a href="https://support.apple.com/en-us/HT208891" target="_blank" rel="noopener">Catalina å®‰è£…åœ¨å•ç‹¬çš„ APFS å·</a> ä¸Šéå¸¸å®¹æ˜“ã€‚å¹¶ä¸”éœ€è¦å®‰è£… <a href="https://developer.apple.com/xcode/" target="_blank" rel="noopener">Xcode 11</a> æ‰èƒ½è·å¾—åœ¨ SwiftUI ä¸­å¤§é‡ä½¿ç”¨çš„ Swift 5.1 æ–°åŠŸèƒ½ã€‚æ˜ç™½äº†å—ï¼Ÿå¾ˆå¥½ï¼</p><blockquote><p>Linux å‘¢ï¼Ÿè¿™ä¸ªé¡¹ç›®ç¡®å®å‡†å¤‡åœ¨ Linux ä¸Šè¿è¡Œï¼Œä½†å°šæœªå®Œæˆã€‚å”¯ä¸€è¿˜æ²¡å®Œæˆçš„äº‹æƒ…æ˜¯å¯¹ <a href="https://developer.apple.com/documentation/combine/passthroughsubject" target="_blank" rel="noopener">Combine PassthroughSubject</a> çš„ç®€å•å®ç°ä»¥åŠå›´ç»•å®ƒçš„ä¸€äº›åŸºç¡€è®¾æ–½ã€‚å‡†å¤‡ï¼š<a href="https://github.com/SwiftWebUI/SwiftWebUI/blob/master/Sources/SwiftWebUI/Misc/NoCombine.swift" target="_blank" rel="noopener">NoCombine</a>ã€‚æ¬¢è¿æ¥æ PRï¼</p></blockquote><blockquote><p>Mojave å‘¢ï¼Ÿæœ‰ä¸€ä¸ªå¯ä»¥åœ¨ Mojave å’Œ Xcode 11 ä¸Šè¿è¡Œçš„åŠæ³•ã€‚ä½ éœ€è¦åˆ›å»ºä¸€ä¸ª iOS 13 æ¨¡æ‹Ÿå™¨é¡¹ç›®å¹¶åœ¨å…¶ä¸­è¿è¡Œæ•´ä¸ªé¡¹ç›®ã€‚</p></blockquote><h2 id="å¼€å§‹ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº"><a href="#å¼€å§‹ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº" class="headerlink" title="å¼€å§‹ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº"></a>å¼€å§‹ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº</h2><h3 id="åˆ›å»º-SwiftWebUI-é¡¹ç›®"><a href="#åˆ›å»º-SwiftWebUI-é¡¹ç›®" class="headerlink" title="åˆ›å»º SwiftWebUI é¡¹ç›®"></a>åˆ›å»º SwiftWebUI é¡¹ç›®</h3><p>å¯åŠ¨ Xcode 11ï¼Œé€‰æ‹©â€œFile &gt; New &gt; Projectâ€¦â€æˆ–æŒ‰ Cmd-Shift-Nï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/ProjectSetup/1-new-project.png" alt></p><p>é€‰æ‹©â€œmacOS / Command Line Toolâ€é¡¹ç›®æ¨¡æ¿:</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/ProjectSetup/2-new-cmdline-tool.png" alt></p><p>ç»™å®ƒå–ä¸ªå¥½å¬çš„åå­—ï¼Œç”¨â€œAvocadoToastâ€å§ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/ProjectSetup/3-swift-project-name.png" alt></p><p>ç„¶åï¼Œæ·»åŠ  <a href="https://github.com/SwiftWebUI/SwiftWebUI" target="_blank" rel="noopener">SwiftWebUI</a> ä½œä¸º Swift Package Manager çš„ä¾èµ–é¡¹ã€‚è¯¥é€‰é¡¹éšè—åœ¨â€œFile / Swift Packagesâ€èœå•ä¸­ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/ProjectSetup/4-add-pkg-dep.png" alt></p><p>è¾“å…¥ <code>https://github.com/SwiftWebUI/SwiftWebUI.git</code> ä½œä¸ºåŒ…çš„ URLï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/ProjectSetup/5-add-swui-dep-large.png" alt></p><p>ä½¿ç”¨â€œBranchâ€ <code>master</code> é€‰é¡¹ï¼Œä»¥ä¾¿äºæ€»èƒ½è·å¾—æœ€æ–°å’Œæœ€å¥½çš„ç‰ˆæœ¬ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨ä¿®è®¢ç‰ˆæˆ– <code>develop</code> åˆ†æ”¯ï¼‰:</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/ProjectSetup/6-branch-select-large.png" alt></p><p>æœ€åï¼Œå°† SwiftWebUI åº“æ·»åŠ åˆ°ä½ çš„å·¥å…·çš„ <code>target</code> ä¸­:</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/ProjectSetup/7-target-select-large.png" alt></p><p>è¿™å°±å®Œæˆäº†åˆ›å»ºã€‚ä½ ç°åœ¨æœ‰äº†ä¸€ä¸ªå¯ä»¥å¯¼å…¥ SwiftWebUI çš„å·¥å…·é¡¹ç›®ã€‚ï¼ˆXcode å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´æ¥è·å–å’Œæ„å»ºä¾èµ–ã€‚ï¼‰</p><h3 id="SwiftWebUI-Hello-World"><a href="#SwiftWebUI-Hello-World" class="headerlink" title="SwiftWebUI Hello World"></a>SwiftWebUI Hello World</h3><p>è®©æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ SwiftWebUIã€‚æ‰“å¼€ <code>main.swift</code> æ–‡ä»¶ï¼Œå°†å…¶å†…å®¹æ›¿æ¢ä¸ºï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftWebUI</span><br><span class="line"></span><br><span class="line"><span class="type">SwiftWebUI</span>.serve(<span class="type">Text</span>(<span class="string">"Holy Cow!"</span>))</span><br></pre></td></tr></table></figure><p>åœ¨ Xcode ä¸­ç¼–è¯‘å¹¶è¿è¡Œè¯¥åº”ç”¨ç¨‹åºï¼Œæ‰“å¼€ Safariï¼Œç„¶åè®¿é—® <a href="http://localhost:1337/" target="_blank" rel="noopener"><code>http://localhost:1337/</code></a>ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/HolyCow/holycow.png" alt></p><p>è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼šé¦–å…ˆå¯¼å…¥ SwiftWebUI æ¨¡å—ï¼ˆä¸è¦æ„å¤–å¯¼å…¥ macOS SwiftUI ğŸ˜€ï¼‰ã€‚</p><p>ç„¶åæˆ‘ä»¬è°ƒç”¨äº† <code>SwiftWebUI.serve</code>ï¼Œå®ƒè¦ä¹ˆæ¥å—ä¸€ä¸ªè¿”å›è§†å›¾çš„é—­åŒ…ï¼Œè¦ä¹ˆå°±ç›´æ¥æ˜¯ä¸€ä¸ªè§†å›¾â€”â€”å¦‚ä¸‹æ‰€ç¤ºï¼šä¸€ä¸ª <a href="https://developer.apple.com/documentation/swiftui/text" target="_blank" rel="noopener"><code>Text</code></a> è§†å›¾ï¼ˆä¹Ÿç§°ä¸ºâ€œUILabelâ€ï¼Œå®ƒå¯ä»¥æ˜¾ç¤ºçº¯æ–‡æœ¬æˆ–æ ¼å¼åŒ–çš„æ–‡æœ¬ï¼‰ã€‚</p><h4 id="å¹•åå‘ç”Ÿçš„äº‹æƒ…"><a href="#å¹•åå‘ç”Ÿçš„äº‹æƒ…" class="headerlink" title="å¹•åå‘ç”Ÿçš„äº‹æƒ…"></a>å¹•åå‘ç”Ÿçš„äº‹æƒ…</h4><p>åœ¨å†…éƒ¨ï¼Œ<a href="https://github.com/SwiftWebUI/SwiftWebUI/blob/master/Sources/SwiftWebUI/ViewHosting/Serve.swift#L66" target="_blank" rel="noopener"><code>serve</code></a> å‡½æ•°åˆ›å»ºä¸€ä¸ªéå¸¸ç®€å•çš„ <a href="https://github.com/apple/swift-nio" target="_blank" rel="noopener">SwiftNIO</a> HTTP æœåŠ¡å™¨ï¼Œå®ƒå°†ä¼šç›‘å¬ 1337 ç«¯å£ã€‚å½“æµè§ˆå™¨è®¿é—®è¯¥æœåŠ¡å™¨æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ª <a href="https://github.com/SwiftWebUI/SwiftWebUI/blob/master/Sources/SwiftWebUI/ViewHosting/NIOHostingSession.swift" target="_blank" rel="noopener">session</a>ï¼ˆä¼šè¯ï¼‰å¹¶å°†ï¼ˆTextï¼‰è§†å›¾ä¼ é€’ç»™è¯¥ä¼šè¯ã€‚</p><p>æœ€åï¼ŒSwiftWebUI åœ¨æœåŠ¡å™¨ä¸Šæ ¹æ®è¿™ä¸ªè§†å›¾æ¥åˆ›å»ºä¸€ä¸ªâ€œShadow DOMâ€ï¼Œå°†å…¶æ¸²æŸ“ä¸º HTML å¹¶å°†ç»“æœå‘é€åˆ°æµè§ˆå™¨ã€‚â€œShadow DOMâ€ï¼ˆå’ŒçŠ¶æ€å¯¹è±¡ä¿æŒåœ¨ä¸€èµ·ï¼‰å­˜å‚¨åœ¨ä¼šè¯ä¸­ã€‚</p><blockquote><p>è¿™æ˜¯ SwiftWebUI åº”ç”¨ç¨‹åºä¸ watchOS æˆ– iOS SwiftUI åº”ç”¨ç¨‹åºä¹‹é—´çš„åŒºåˆ«ã€‚å•ä¸ª SwiftWebUI åº”ç”¨ç¨‹åºä¸ºä¸€ç»„ç”¨æˆ·æä¾›æœåŠ¡ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªç”¨æˆ·ã€‚</p></blockquote><h3 id="æ·»åŠ ä¸€äº›äº¤äº’"><a href="#æ·»åŠ ä¸€äº›äº¤äº’" class="headerlink" title="æ·»åŠ ä¸€äº›äº¤äº’"></a>æ·»åŠ ä¸€äº›äº¤äº’</h3><p>ç¬¬ä¸€æ­¥ï¼Œæ›´å¥½åœ°ç»„ç»‡ä»£ç ã€‚åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ Swift æ–‡ä»¶ï¼Œå¹¶å°†å…¶å‘½åä¸º <code>MainPage.swift</code>ã€‚ç„¶åå‘å…¶ä¸­æ·»åŠ ä¸€ä¸ªç®€å•çš„ SwiftUI è§†å›¾çš„å®šä¹‰ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftWebUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainPage</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">"Holy Cow!"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ <code>main.swift</code> æ¥è®© SwiftWebUI ä½œç”¨äºæˆ‘ä»¬çš„å®šåˆ¶è§†å›¾:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">SwiftWebUI</span>.serve(<span class="type">MainPage</span>())</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œå¯ä»¥æŠŠ <code>main.swift</code> æ”¾åˆ°ä¸€è¾¹ï¼Œåœ¨è‡ªå®šä¹‰è§†å›¾ä¸­å®Œæˆæ‰€æœ‰å·¥ä½œã€‚æ·»åŠ ä¸€äº›äº¤äº’ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainPage</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">  @<span class="type">State</span> <span class="keyword">var</span> counter = <span class="number">3</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">countUp</span><span class="params">()</span></span> &#123; counter += <span class="number">1</span> &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">"Count is: \(counter)"</span>)</span><br><span class="line">      .tapAction(<span class="keyword">self</span>.countUp)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://developer.apple.com/documentation/swiftui/view" target="_blank" rel="noopener"><code>è§†å›¾</code></a> æœ‰äº†ä¸€ä¸ªåä¸º counter çš„æŒä¹… <a href="https://developer.apple.com/documentation/swiftui/state" target="_blank" rel="noopener">çŠ¶æ€</a> å˜é‡ï¼ˆä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆï¼Ÿå†çœ‹ä¸€ä¸‹ SwiftUI çš„ä»‹ç»ï¼‰ã€‚è¿˜æœ‰ä¸€ä¸ªå¯ä»¥ä½¿è®¡æ•°å™¨åŠ ä¸€çš„å°å‡½æ•°ã€‚</p><p>ç„¶åï¼Œä½¿ç”¨ SwiftUI <a href="https://developer.apple.com/documentation/swiftui/text/3086357-tapaction" target="_blank" rel="noopener"><code>tapAction</code></a> ä¿®é¥°ç¬¦å°†äº‹ä»¶å¤„ç†ç¨‹åºé™„åŠ åˆ° <code>Text</code>ã€‚æœ€åï¼Œåœ¨æ ‡ç­¾ä¸­æ˜¾ç¤ºå½“å‰å€¼ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/HolyCow/ClickCounter.gif" alt></p><p>ğŸ§™<em>é­”æ³•</em>ğŸ§™</p><h4 id="å¹•åå‘ç”Ÿçš„äº‹æƒ…-1"><a href="#å¹•åå‘ç”Ÿçš„äº‹æƒ…-1" class="headerlink" title="å¹•åå‘ç”Ÿçš„äº‹æƒ…"></a>å¹•åå‘ç”Ÿçš„äº‹æƒ…</h4><p>è¿™æ˜¯å¦‚ä½•è¿ä½œçš„ï¼Ÿå½“æµè§ˆå™¨è®¿é—®ç«¯ç‚¹æ—¶ï¼ŒSwiftWebUI åœ¨å…¶ä¸­åˆ›å»ºäº†ä¼šè¯å’Œâ€œShadow DOMâ€ã€‚ç„¶åå°†æè¿°è§†å›¾çš„ HTML å‘é€åˆ°æµè§ˆå™¨ã€‚<code>tapAction</code> é€šè¿‡å‘ HTML æ·»åŠ  <code>onclick</code> å¤„ç†ç¨‹åºæ¥å·¥ä½œã€‚SwiftWebUI è¿˜å‘æµè§ˆå™¨å‘é€ JavaScriptï¼ˆå°‘é‡ï¼Œæ²¡æœ‰å¤§çš„ JavaScript æ¡†æ¶ï¼ï¼‰ï¼Œå¤„ç†ç‚¹å‡»å¹¶å°†å…¶è½¬å‘åˆ° Swift æœåŠ¡å™¨ã€‚</p><p>ç„¶å SwiftUI çš„é­”æ³•å¼€å§‹ç”Ÿæ•ˆã€‚SwiftWebUI å°† click äº‹ä»¶ä¸â€œShadow DOMâ€ä¸­çš„äº‹ä»¶å¤„ç†ç¨‹åºç›¸å…³è”ï¼Œå¹¶è°ƒç”¨ <code>countUp</code> å‡½æ•°ã€‚è¯¥å‡½æ•°é€šè¿‡ä¿®æ”¹ <code>counter</code> <a href="https://developer.apple.com/documentation/swiftui/state" target="_blank" rel="noopener"><code>çŠ¶æ€</code></a> å˜é‡ï¼Œä½¿è§†å›¾çš„æ¸²æŸ“æ— æ•ˆã€‚SwiftWebUI å¼€å§‹å·¥ä½œï¼Œå¹¶å¯¹â€œShadow DOMâ€ä¸­çš„å˜æ›´è¿›è¡Œå·®å¼‚æ¯”è¾ƒã€‚ç„¶åå°†è¿™äº›å˜æ›´å‘é€å›æµè§ˆå™¨ã€‚</p><blockquote><p>â€œå˜æ›´â€ä½œä¸º JSON æ•°ç»„å‘é€ï¼Œé¡µé¢ä¸­çš„å°å‹ JavaScript å¯ä»¥å¤„ç†è¿™äº›æ•°ç»„ã€‚å¦‚æœæ•´ä¸ªå­æ ‘å‘ç”Ÿäº†å˜åŒ–ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·å¯¼èˆªåˆ°ä¸€ä¸ªå…¨æ–°çš„è§†å›¾ï¼‰ï¼Œåˆ™å˜æ›´å¯ä»¥æ˜¯åº”ç”¨äº <code>innerHTML</code> æˆ– <code>outerHTML</code> çš„æ›´å¤§çš„ HTML ç‰‡æ®µã€‚</p><p>ä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™äº›å˜æ›´éƒ½å¾ˆå°ï¼Œä¾‹å¦‚ <code>æ·»åŠ ç±»</code>ï¼Œ<code>è®¾ç½® HTML å±æ€§</code> ç­‰ï¼ˆå³æµè§ˆå™¨ DOM ä¿®æ”¹ï¼‰ã€‚</p></blockquote><h2 id="ğŸ¥‘ğŸ-Avocado-Toast"><a href="#ğŸ¥‘ğŸ-Avocado-Toast" class="headerlink" title="ğŸ¥‘ğŸ Avocado Toast"></a>ğŸ¥‘ğŸ Avocado Toast</h2><p>å¤ªå¥½äº†ï¼ŒåŸºç¡€çš„éƒ¨åˆ†å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚è®©æˆ‘ä»¬å¼•å…¥æ›´å¤šçš„äº¤äº’ã€‚ä»¥ä¸‹æ˜¯åŸºäº <a href="https://developer.apple.com/videos/play/wwdc2019/216" target="_blank" rel="noopener">SwiftUI è¦ç‚¹</a> æ¼”è®²ä¸­æ¼”ç¤º SwiftUI çš„â€œAvocado Toast Appâ€ã€‚æ²¡çœ‹è¿‡å—ï¼Ÿä½ åº”è¯¥çœ‹çœ‹ï¼Œè®²çš„æ˜¯ç¾å‘³çš„åå¸ã€‚</p><blockquote><p>HTML / CSS æ ·å¼ä¸æ¼‚äº®ä¹Ÿä¸å®Œç¾ã€‚ä½ çŸ¥é“ï¼Œæˆ‘ä»¬ä¸æ˜¯ç½‘é¡µè®¾è®¡å¸ˆï¼Œè€Œä¸”éœ€è¦å¸®åŠ©ã€‚æ¬¢è¿æ¥æäº¤ PRï¼</p></blockquote><p>æƒ³è¦è·³è¿‡ç»†èŠ‚ï¼Œè§‚çœ‹åº”ç”¨ç¨‹åºçš„ GIF å¹¶åœ¨ GitHub ä¸Šä¸‹è½½ï¼š<a href="http://www.alwaysrightinstitute.com/swiftwebui/#the--finished-app" target="_blank" rel="noopener">ğŸ¥‘ğŸ</a>ã€‚</p><h3 id="ğŸ¥‘ğŸè®¢å•"><a href="#ğŸ¥‘ğŸè®¢å•" class="headerlink" title="ğŸ¥‘ğŸè®¢å•"></a>ğŸ¥‘ğŸè®¢å•</h3><p>è°ˆè¯ä»è¿™ï¼ˆ~6:00ï¼‰å¼€å§‹ï¼Œå¯ä»¥å°†è¿™äº›ä»£ç æ·»åŠ åˆ°æ–°çš„ <code>OrderForm.swift</code> æ–‡ä»¶ä¸­ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> includeSalt            = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">var</span> includeRedPepperFlakes = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">var</span> quantity               = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OrderForm</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">  @<span class="type">State</span> <span class="keyword">private</span> <span class="keyword">var</span> order = <span class="type">Order</span>()</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">submitOrder</span><span class="params">()</span></span> &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">VStack</span> &#123;</span><br><span class="line">      <span class="type">Text</span>(<span class="string">"Avocado Toast"</span>).font(.title)</span><br><span class="line">      </span><br><span class="line">      <span class="type">Toggle</span>(isOn: $order.includeSalt) &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">"Include Salt"</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">Toggle</span>(isOn: $order.includeRedPepperFlakes) &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">"Include Red Pepper Flakes"</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">Stepper</span>(value: $order.quantity, <span class="keyword">in</span>: <span class="number">1</span>...<span class="number">10</span>) &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">"Quantity: \(order.quantity)"</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="type">Button</span>(action: submitOrder) &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">"Order"</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>main.swift</code> ä¸­ç›´æ¥ç”¨ <code>SwiftWebUI.serve()</code> æµ‹è¯•æ–°çš„ <code>OrderForm</code> è§†å›¾ã€‚</p><p>è¿™å°±æ˜¯æµè§ˆå™¨ä¸­çš„æ ·å­ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/AvocadoOrder/orderit.gif" alt></p><blockquote><p><a href="https://semantic-ui.com/" target="_blank" rel="noopener">SemanticUI</a> ç”¨äºåœ¨ SwiftWebUI ä¸­è®¾ç½®ä¸€äº›æ ·å¼ã€‚SemanticUI å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œè¿™é‡Œåªæ˜¯ç”¨å®ƒçš„æ§ä»¶æ¥ç¾åŒ–ç•Œé¢ã€‚</p><p>æ³¨æ„ï¼šä»…ä½¿ç”¨ CSS å’Œå­—ä½“ï¼Œè€Œä¸æ˜¯ JavaScript ç»„ä»¶ã€‚</p></blockquote><h3 id="å¹•é—´ä¼‘æ¯ï¼šä¸€äº›-SwiftUI-å¸ƒå±€"><a href="#å¹•é—´ä¼‘æ¯ï¼šä¸€äº›-SwiftUI-å¸ƒå±€" class="headerlink" title="å¹•é—´ä¼‘æ¯ï¼šä¸€äº› SwiftUI å¸ƒå±€"></a>å¹•é—´ä¼‘æ¯ï¼šä¸€äº› SwiftUI å¸ƒå±€</h3><p>åœ¨ <a href="https://developer.apple.com/videos/play/wwdc2019/216" target="_blank" rel="noopener">SwiftUI è¦ç‚¹</a> æ¼”è®²çš„ 16:00 å·¦å³ï¼Œä»–ä»¬å°†ä»‹ç» SwiftUI å¸ƒå±€å’Œè§†å›¾ä¿®æ”¹å™¨æ’åºï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">  <span class="type">HStack</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">"ğŸ¥‘ğŸ"</span>)</span><br><span class="line">      .background(.green, cornerRadius: <span class="number">12</span>)</span><br><span class="line">      .padding(.all)</span><br><span class="line">    </span><br><span class="line">    <span class="type">Text</span>(<span class="string">" =&gt; "</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="type">Text</span>(<span class="string">"ğŸ¥‘ğŸ"</span>)</span><br><span class="line">      .padding(.all)</span><br><span class="line">      .background(.green, cornerRadius: <span class="number">12</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼Œè¯·æ³¨æ„ä¿®é¥°ç¬¦çš„æ’åºæ˜¯å¦‚ä½•ç›¸å…³çš„ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/AvocadoLayout.png" alt></p><blockquote><p>SwiftWebUI å°è¯•å¤åˆ¶å¸¸è§çš„ SwiftUI å¸ƒå±€ï¼Œä½†è¿˜æ²¡æœ‰å®Œå…¨æˆåŠŸã€‚æ¯•ç«Ÿå®ƒå¿…é¡»å¤„ç†æµè§ˆå™¨æä¾›çš„å¸ƒå±€ç³»ç»Ÿã€‚éœ€è¦å¸®åŠ©ï¼Œæ¬¢è¿å¼¹æ€§ç›’å¸ƒå±€ç›¸å…³çš„ä¸“å®¶ï¼</p></blockquote><h3 id="ğŸ¥‘ğŸè®¢å•å†å²"><a href="#ğŸ¥‘ğŸè®¢å•å†å²" class="headerlink" title="ğŸ¥‘ğŸè®¢å•å†å²"></a>ğŸ¥‘ğŸè®¢å•å†å²</h3><p>å›åˆ°åº”ç”¨ç¨‹åºï¼Œæ¼”è®²ï¼ˆ~19:50ï¼‰ä»‹ç»äº† <a href="https://developer.apple.com/documentation/swiftui/list" target="_blank" rel="noopener">åˆ—è¡¨</a> è§†å›¾ï¼Œç”¨äºæ˜¾ç¤º Avocado toast è®¢å•å†å²è®°å½•ã€‚è¿™å°±æ˜¯å®ƒåœ¨ Web ä¸Šçš„å¤–è§‚ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/OrderHistory/OrderHistory1.png" alt></p><p><code>åˆ—è¡¨</code> è§†å›¾éå†å·²å®Œæˆè®¢å•çš„æ•°ç»„ï¼Œå¹¶ä¸ºæ¯ä¸ªè®¢å•åˆ›å»ºä¸€ä¸ªå­è§†å›¾ï¼ˆ<code>OrderCell</code>ï¼‰ï¼Œå¹¶ä¼ å…¥åˆ—è¡¨ä¸­çš„å½“å‰é¡¹ã€‚</p><p>è¿™æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„ä»£ç ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OrderHistory</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> previousOrders : [ <span class="type">CompletedOrder</span> ]</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">List</span>(previousOrders) &#123; order <span class="keyword">in</span></span><br><span class="line">      <span class="type">OrderCell</span>(order: order)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OrderCell</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> order : <span class="type">CompletedOrder</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">HStack</span> &#123;</span><br><span class="line">      <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">        <span class="type">Text</span>(order.summary)</span><br><span class="line">        <span class="type">Text</span>(order.purchaseDate)</span><br><span class="line">          .font(.subheadline)</span><br><span class="line">          .foregroundColor(.secondary)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">Spacer</span>()</span><br><span class="line">      <span class="keyword">if</span> order.includeSalt &#123;</span><br><span class="line">        <span class="type">SaltIcon</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;&#125;</span><br><span class="line">      <span class="keyword">if</span> order.includeRedPepperFlakes &#123;</span><br><span class="line">        <span class="type">RedPepperFlakesIcon</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SaltIcon</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> body = <span class="type">Text</span>(<span class="string">"ğŸ§‚"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RedPepperFlakesIcon</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> body = <span class="type">Text</span>(<span class="string">"ğŸŒ¶"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Model</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CompletedOrder</span>: <span class="title">Identifiable</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> id           : <span class="type">Int</span></span><br><span class="line">  <span class="keyword">var</span> summary      : <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> purchaseDate : <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> includeSalt            = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">var</span> includeRedPepperFlakes = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SwiftWebUI åˆ—è¡¨è§†å›¾æ•ˆç‡å¾ˆä½ï¼Œå®ƒæ€»æ˜¯å‘ˆç°æ•´ä¸ªå­é›†åˆã€‚æ²¡æœ‰å•å…ƒæ ¼é‡ç”¨ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ğŸ˜ã€‚åœ¨ä¸€ä¸ªç½‘ç»œåº”ç”¨ç¨‹åºä¸­æœ‰å„ç§å„æ ·çš„æ–¹æ³•æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œä¾‹å¦‚ä½¿ç”¨åˆ†é¡µæˆ–æ›´å¤šå®¢æˆ·ç«¯é€»è¾‘ã€‚</p></blockquote><p>ä½ ä¸å¿…æ‰‹åŠ¨è¾“å…¥æ¼”è®²ä¸­çš„æ ·æœ¬æ•°æ®ï¼Œæˆ‘ä»¬ä¸ºä½ æä¾›äº†è¿™äº›æ•°æ®ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> previousOrders : [ <span class="type">CompletedOrder</span> ] = [</span><br><span class="line">  .<span class="keyword">init</span>(id:  <span class="number">1</span>, summary: <span class="string">"Rye with Almond Butter"</span>,  purchaseDate: <span class="string">"2019-05-30"</span>),</span><br><span class="line">  .<span class="keyword">init</span>(id:  <span class="number">2</span>, summary: <span class="string">"Multi-Grain with Hummus"</span>, purchaseDate: <span class="string">"2019-06-02"</span>,</span><br><span class="line">        includeRedPepperFlakes: <span class="literal">true</span>),</span><br><span class="line">  .<span class="keyword">init</span>(id:  <span class="number">3</span>, summary: <span class="string">"Sourdough with Chutney"</span>,  purchaseDate: <span class="string">"2019-06-08"</span>,</span><br><span class="line">        includeSalt: <span class="literal">true</span>, includeRedPepperFlakes: <span class="literal">true</span>),</span><br><span class="line">  .<span class="keyword">init</span>(id:  <span class="number">4</span>, summary: <span class="string">"Rye with Peanut Butter"</span>,  purchaseDate: <span class="string">"2019-06-09"</span>),</span><br><span class="line">  .<span class="keyword">init</span>(id:  <span class="number">5</span>, summary: <span class="string">"Wheat with Tapenade"</span>,     purchaseDate: <span class="string">"2019-06-12"</span>),</span><br><span class="line">  .<span class="keyword">init</span>(id:  <span class="number">6</span>, summary: <span class="string">"Sourdough with Vegemite"</span>, purchaseDate: <span class="string">"2019-06-14"</span>,</span><br><span class="line">        includeSalt: <span class="literal">true</span>),</span><br><span class="line">  .<span class="keyword">init</span>(id:  <span class="number">7</span>, summary: <span class="string">"Wheat with FÃ©roce"</span>,       purchaseDate: <span class="string">"2019-06-31"</span>),</span><br><span class="line">  .<span class="keyword">init</span>(id:  <span class="number">8</span>, summary: <span class="string">"Rhy with Honey"</span>,          purchaseDate: <span class="string">"2019-07-03"</span>),</span><br><span class="line">  .<span class="keyword">init</span>(id:  <span class="number">9</span>, summary: <span class="string">"Multigrain Toast"</span>,        purchaseDate: <span class="string">"2019-07-04"</span>,</span><br><span class="line">        includeSalt: <span class="literal">true</span>),</span><br><span class="line">  .<span class="keyword">init</span>(id: <span class="number">10</span>, summary: <span class="string">"Sourdough with Chutney"</span>,  purchaseDate: <span class="string">"2019-07-06"</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="ğŸ¥‘ğŸæ¶‚æŠ¹é…±é€‰æ‹©å™¨"><a href="#ğŸ¥‘ğŸæ¶‚æŠ¹é…±é€‰æ‹©å™¨" class="headerlink" title="ğŸ¥‘ğŸæ¶‚æŠ¹é…±é€‰æ‹©å™¨"></a>ğŸ¥‘ğŸæ¶‚æŠ¹é…±é€‰æ‹©å™¨</h3><p>é€‰æ‹©å™¨æ§ä»¶ä»¥åŠå¦‚ä½•å°†å®ƒä¸æšä¸¾ä¸€èµ·ä½¿ç”¨å°†åœ¨ï¼ˆ~43:00ï¼‰è¿›è¡Œæ¼”ç¤ºã€‚é¦–å…ˆæ˜¯å„ç§åå¸é€‰é¡¹çš„æšä¸¾ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">AvocadoStyle</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> sliced, mashed</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">BreadType</span>: <span class="title">CaseIterable</span>, <span class="title">Hashable</span>, <span class="title">Identifiable</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> wheat, white, rhy</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> name: <span class="type">String</span> &#123; <span class="keyword">return</span> <span class="string">"\(self)"</span>.capitalized &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Spread</span>: <span class="title">CaseIterable</span>, <span class="title">Hashable</span>, <span class="title">Identifiable</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="keyword">none</span>, almondButter, peanutButter, honey</span><br><span class="line">  <span class="keyword">case</span> almou, tapenade, hummus, mayonnaise</span><br><span class="line">  <span class="keyword">case</span> kyopolou, adjvar, pindjur</span><br><span class="line">  <span class="keyword">case</span> vegemite, chutney, cannedCheese, feroce</span><br><span class="line">  <span class="keyword">case</span> kartoffelkase, tartarSauce</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> name: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"\(self)"</span>.<span class="built_in">map</span> &#123; $<span class="number">0</span>.isUppercase ? <span class="string">" \($0)"</span> : <span class="string">"\($0)"</span> &#125;</span><br><span class="line">           .joined().capitalized</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å°†è¿™äº›ä»£ç æ·»åŠ åˆ° <code>Order</code> ç»“æ„ä½“ä¸­ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> includeSalt            = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">var</span> includeRedPepperFlakes = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">var</span> quantity               = <span class="number">0</span></span><br><span class="line">  <span class="keyword">var</span> avocadoStyle           = <span class="type">AvocadoStyle</span>.sliced</span><br><span class="line">  <span class="keyword">var</span> spread                 = <span class="type">Spread</span>.<span class="keyword">none</span></span><br><span class="line">  <span class="keyword">var</span> breadType              = <span class="type">BreadType</span>.wheat</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨ä¸åŒçš„é€‰æ‹©å™¨ç±»å‹æ¥æ˜¾ç¤ºå®ƒä»¬ã€‚å¦‚ä½•å¾ªç¯æšä¸¾å€¼éå¸¸ç®€å•ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">Form</span> &#123;</span><br><span class="line">  <span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">"Avocado Toast"</span>).font(.title)) &#123;</span><br><span class="line">    <span class="type">Picker</span>(selection: $order.breadType, label: <span class="type">Text</span>(<span class="string">"Bread"</span>)) &#123;</span><br><span class="line">      <span class="type">ForEach</span>(<span class="type">BreadType</span>.allCases) &#123; breadType <span class="keyword">in</span></span><br><span class="line">        <span class="type">Text</span>(breadType.name).tag(breadType)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .pickerStyle(.radioGroup)</span><br><span class="line">    </span><br><span class="line">    <span class="type">Picker</span>(selection: $order.avocadoStyle, label: <span class="type">Text</span>(<span class="string">"Avocado"</span>)) &#123;</span><br><span class="line">      <span class="type">Text</span>(<span class="string">"Sliced"</span>).tag(<span class="type">AvocadoStyle</span>.sliced)</span><br><span class="line">      <span class="type">Text</span>(<span class="string">"Mashed"</span>).tag(<span class="type">AvocadoStyle</span>.mashed)</span><br><span class="line">    &#125;</span><br><span class="line">    .pickerStyle(.radioGroup)</span><br><span class="line">    </span><br><span class="line">    <span class="type">Picker</span>(selection: $order.spread, label: <span class="type">Text</span>(<span class="string">"Spread"</span>)) &#123;</span><br><span class="line">      <span class="type">ForEach</span>(<span class="type">Spread</span>.allCases) &#123; spread <span class="keyword">in</span></span><br><span class="line">        <span class="type">Text</span>(spread.name).tag(spread) <span class="comment">// there is no .name?!</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/AvocadoOrder/picker.png" alt></p><blockquote><p>åŒæ ·ï¼Œè¿™éœ€è¦ä¸€äº›å¯¹ CSS çš„çƒ­çˆ±æ¥è®©å®ƒçœ‹èµ·æ¥æ›´å¥½çœ‹â€¦</p></blockquote><h3 id="å®Œæˆåçš„ğŸ¥‘ğŸåº”ç”¨"><a href="#å®Œæˆåçš„ğŸ¥‘ğŸåº”ç”¨" class="headerlink" title="å®Œæˆåçš„ğŸ¥‘ğŸåº”ç”¨"></a>å®Œæˆåçš„ğŸ¥‘ğŸåº”ç”¨</h3><p>ä¸ï¼Œæˆ‘ä»¬ä¸åŸç‰ˆç•¥æœ‰ä¸åŒï¼Œä¹Ÿæ²¡æœ‰çœŸæ­£å®Œæˆåº”ç”¨ã€‚å®ƒçœ‹èµ·æ¥å¹¶ä¸é‚£ä¹ˆæ£’ï¼Œä½†æ¯•ç«Ÿåªæ˜¯ä¸€ä¸ªæ¼”ç¤ºç¤ºä¾‹ğŸ˜ã€‚</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/AvocadoOrder/AvocadoToast.gif" alt></p><p>å®Œæˆåçš„åº”ç”¨ç¨‹åºå¯åœ¨GitHubï¼š<a href="https://github.com/SwiftWebUI/AvocadoToast" target="_blank" rel="noopener">AvocadoToast</a> ä¸Šè·å–ã€‚</p><h2 id="HTML-å’Œ-SemanticUI"><a href="#HTML-å’Œ-SemanticUI" class="headerlink" title="HTML å’Œ SemanticUI"></a>HTML å’Œ SemanticUI</h2><p><a href="https://developer.apple.com/documentation/swiftui/uiviewrepresentable" target="_blank" rel="noopener"><code>UIViewRepresentable</code></a> åœ¨ SwiftWebUI ä¸­å¯¹åº”çš„å®ç°ï¼Œæ˜¯ç›´æ¥ä½¿ç”¨åŸå§‹ HTMLã€‚</p><p>å®ƒæä¾›äº†ä¸¤ç§å˜ä½“ï¼Œä¸€ç§æ˜¯ HTML æŒ‰åŸæ ·è¾“å‡ºå­—ç¬¦ä¸²ï¼Œå¦ä¸€ç§æ˜¯é€šè¿‡ HTML è½¬ä¹‰å†…å®¹ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MyHTMLView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">VStack</span> &#123;</span><br><span class="line">      <span class="type">HTML</span>(<span class="string">"&lt;blink&gt;Blinken Lights&lt;/blink&gt;"</span>)</span><br><span class="line">      <span class="type">HTML</span>(<span class="string">"42 &gt; 1337"</span>, escape: <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿™ä¸ªåŸè¯­ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥æ„å»ºæ‰€éœ€çš„ä»»ä½• HTMLã€‚</p><p>è¿˜æœ‰ä¸€ç§æ›´é«˜çº§çš„ç”¨æ³•æ˜¯ HTMLContainerï¼ŒSwiftWebUI å†…éƒ¨ä¹Ÿç”¨åˆ°äº†å®ƒã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯æ­¥è¿›å™¨æ§ä»¶çš„å®ç°ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">  <span class="type">HStack</span> &#123;</span><br><span class="line">    <span class="type">HTMLContainer</span>(classes: [ <span class="string">"ui"</span>, <span class="string">"icon"</span>, <span class="string">"buttons"</span>, <span class="string">"small"</span> ]) &#123;</span><br><span class="line">      <span class="type">Button</span>(<span class="keyword">self</span>.decrement) &#123;</span><br><span class="line">        <span class="type">HTMLContainer</span>(<span class="string">"i"</span>, classes: [ <span class="string">"minus"</span>, <span class="string">"icon"</span> ], body: &#123;<span class="type">EmptyView</span>()&#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">Button</span>(<span class="keyword">self</span>.increment) &#123;</span><br><span class="line">        <span class="type">HTMLContainer</span>(<span class="string">"i"</span>, classes: [ <span class="string">"plus"</span>, <span class="string">"icon"</span> ], body: &#123;<span class="type">EmptyView</span>()&#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    label</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>HTMLContainer æ˜¯â€œå“åº”å¼çš„â€ï¼Œå³å¦‚æœç±»ã€æ ·å¼æˆ–å±æ€§å‘ç”Ÿå˜åŒ–ï¼Œå®ƒå°†è§¦å‘ï¼ˆemitï¼‰å¸¸è§„ DOM å˜æ›´ï¼ˆè€Œä¸æ˜¯é‡æ–°æ¸²æŸ“æ•´ä¸ªå†…å®¹ï¼‰ã€‚</p><h3 id="SemanticUI"><a href="#SemanticUI" class="headerlink" title="SemanticUI"></a>SemanticUI</h3><p>SwiftWebUI è¿˜é™„å¸¦äº†ä¸€äº›é¢„å…ˆè®¾ç½®çš„ <a href="https://semantic-ui.com/" target="_blank" rel="noopener">SemanticUI</a> æ§ä»¶ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">VStack</span> &#123;</span><br><span class="line">  <span class="type">SUILabel</span>(<span class="type">Image</span>(systemName: <span class="string">"mail"</span>)) &#123; <span class="type">Text</span>(<span class="string">"42"</span>) &#125;</span><br><span class="line">  <span class="type">HStack</span> &#123;</span><br><span class="line">    <span class="type">SUILabel</span>(<span class="type">Image</span>(...)) &#123; <span class="type">Text</span>(<span class="string">"Joe"</span>) &#125; ...</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">HStack</span> &#123;</span><br><span class="line">    <span class="type">SUILabel</span>(<span class="type">Image</span>(...)) &#123; <span class="type">Text</span>(<span class="string">"Joe"</span>) &#125; ...</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">HStack</span> &#123;</span><br><span class="line">    <span class="type">SUILabel</span>(<span class="type">Image</span>(...), <span class="type">Color</span>(<span class="string">"blue"</span>), </span><br><span class="line">             detail: <span class="type">Text</span>(<span class="string">"Friend"</span>)) </span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">Text</span>(<span class="string">"Veronika"</span>)</span><br><span class="line">    &#125; ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€¦â€¦æ¸²æŸ“ä¸ºå¦‚ä¸‹å†…å®¹ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/SemanticUI/labels.png" alt></p><blockquote><p>è¯·æ³¨æ„ï¼ŒSwiftWebUI è¿˜æ”¯æŒä¸€äº› SFSymbols å›¾åƒåç§°ï¼ˆé€šè¿‡ <code>Image(systemName:)</code> æ¥ä½¿ç”¨ï¼‰ã€‚è¿™äº›éƒ½å¾—åˆ°äº† SemanticUI <a href="https://semantic-ui.com/elements/icon.html" target="_blank" rel="noopener">å¯¹ Font Awesome çš„æ”¯æŒ</a>ã€‚</p></blockquote><p>è¿˜æœ‰ <code>SUISegment</code>ï¼Œ<code>SUIFlag</code> å’Œ <code>SUICARD</code>ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">SUICards</span> &#123;</span><br><span class="line">  <span class="type">SUICard</span>(<span class="type">Image</span>.unsplash(size: <span class="type">UXSize</span>(width: <span class="number">200</span>, height: <span class="number">200</span>),</span><br><span class="line">                         <span class="string">"Zebra"</span>, <span class="string">"Animal"</span>),</span><br><span class="line">          <span class="type">Text</span>(<span class="string">"Some Zebra"</span>),</span><br><span class="line">          meta: <span class="type">Text</span>(<span class="string">"Roaming the world since 1976"</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">"A striped animal."</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">SUICard</span>(<span class="type">Image</span>.unsplash(size: <span class="type">UXSize</span>(width: <span class="number">200</span>, height: <span class="number">200</span>),</span><br><span class="line">                         <span class="string">"Cow"</span>, <span class="string">"Animal"</span>),</span><br><span class="line">          <span class="type">Text</span>(<span class="string">"Some Cow"</span>),</span><br><span class="line">          meta: <span class="type">Text</span>(<span class="string">"Milk it"</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">"Holy cow!."</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€¦â€¦æ¸²æŸ“ä¸ºè¿™äº›å†…å®¹ï¼š</p><p><img src="http://www.alwaysrightinstitute.com/images/swiftwebui/SemanticUI/cards.png" alt></p><p>æ·»åŠ æ­¤ç±»è§†å›¾éå¸¸ç®€å•ï¼Œä¹Ÿéå¸¸æœ‰è¶£ã€‚å¯ä»¥ä½¿ç”¨ <del>WOComponent</del> çš„ SwiftUI è§†å›¾æ¥å¿«é€Ÿæ„å»ºç›¸å½“å¤æ‚å’Œç¾è§‚çš„å¸ƒå±€ã€‚</p><blockquote><p><code>Image.unsplash</code> æ ¹æ® <code>http://source.unsplash.com</code> ä¸Šè¿è¡Œçš„ Unsplash API æ¥æ„å»ºå›¾åƒçš„æŸ¥è¯¢ã€‚åªéœ€ç»™å®ƒä¸€äº›æŸ¥è¯¢è¯ã€å¤§å°å’Œå¯é€‰èŒƒå›´ã€‚</p><p>æ³¨æ„ï¼šæœ‰æ—¶ï¼Œç‰¹å®šçš„ Unsplash æœåŠ¡ä¼¼ä¹æœ‰ç‚¹æ…¢ä¸”ä¸å¯é ã€‚</p></blockquote><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™å°±æ˜¯æˆ‘ä»¬çš„æ¼”ç¤ºç¤ºä¾‹ã€‚æˆ‘ä»¬å¸Œæœ›ä½ èƒ½å–œæ¬¢ï¼ä½†è¦å†æ¬¡è¿›è¡Œ<strong>å…è´£å£°æ˜</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªç©å…·é¡¹ç›®ï¼ä¸è¦ç”¨äºç”Ÿäº§ã€‚ä½¿ç”¨ SwiftWebUI æ˜¯ä¸ºäº†äº†è§£æ›´å¤šå…³äº SwiftUI æœ¬èº«åŠå…¶å†…éƒ¨å·¥ä½œåŸç†çš„ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬è®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç©å…·ï¼Œå¯èƒ½ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰ä»·å€¼çš„å·¥å…·ï¼Œä»¥ä¾¿äºæ›´å¤šåœ°äº†è§£ SwiftUI çš„å†…éƒ¨å·¥ä½œåŸç†ã€‚</p><h2 id="æŠ€æœ¯éšè®°"><a href="#æŠ€æœ¯éšè®°" class="headerlink" title="æŠ€æœ¯éšè®°"></a>æŠ€æœ¯éšè®°</h2><p>è¿™äº›åªæ˜¯å…³äºè¯¥æŠ€æœ¯çš„å„ä¸ªæ–¹é¢çš„ä¸€äº›ç¬”è®°ã€‚å¯ä»¥è·³è¿‡ï¼Œè¿™ä¸ªä¸æ˜¯é‚£ä¹ˆçš„æœ‰è¶£ğŸ˜ã€‚</p><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>SwiftWebUI æœ‰å¾ˆå¤šé—®é¢˜ï¼Œæœ‰äº›æ˜¯åœ¨ GitHub ä¸Šæå‡ºçš„ï¼š<a href="https://github.com/SwiftWebUI/SwiftWebUI/issues" target="_blank" rel="noopener">Issues</a>ã€‚æ¬¢è¿æ¥ææ›´å¤šé—®é¢˜ã€‚</p><p>ç›¸å½“å¤šçš„ HTML å¸ƒå±€çš„ä¸œè¥¿æœ‰é—®é¢˜ï¼ˆä¾‹å¦‚ <code>ScrollView</code> å¹¶ä¸æ€»æ˜¯æ»šåŠ¨çš„ï¼‰ï¼Œè¿˜æœ‰ä¸€äº›åƒ Shapes è¿™æ ·çš„æ­£åœ¨è®¨è®ºæ–¹æ¡ˆçš„åŠŸèƒ½ä¹Ÿæœ‰é—®é¢˜ï¼ˆå¯èƒ½é€šè¿‡ SVG å’Œ CSS å¾ˆå®¹æ˜“åšåˆ°ï¼‰ã€‚</p><p>å“¦ï¼Œè¿˜æœ‰ä¸€ä¸ªä¾‹å­æ˜¯ If-ViewBuilder ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚ä¸æ˜ç™½ä¸ºä»€ä¹ˆï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">  <span class="type">VStack</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line">      <span class="type">SomeView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// currently need an empty else: `else &#123;&#125;` to make it compile.</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦å¸®å¿™ï¼æ¬¢è¿æ¥æäº¤ PRï¼</p><h3 id="ä¸åŸæ¥çš„-SwiftUI-ç›¸æ¯”"><a href="#ä¸åŸæ¥çš„-SwiftUI-ç›¸æ¯”" class="headerlink" title="ä¸åŸæ¥çš„ SwiftUI ç›¸æ¯”"></a>ä¸åŸæ¥çš„ SwiftUI ç›¸æ¯”</h3><p>æœ¬æ–‡çš„å®ç°éå¸¸ç®€å•ä¸”æ•ˆç‡ä½ä¸‹ã€‚åœ¨ç°å®æƒ…å†µä¸‹ï¼Œå¿…é¡»ä»¥æ›´é«˜çš„é€Ÿç‡æ¥å¤„ç†çŠ¶æ€ä¿®æ”¹äº‹ä»¶ï¼Œä»¥ 60Hz çš„å¸§é€Ÿç‡åšæ‰€æœ‰çš„åŠ¨ç”»ç­‰ç­‰ã€‚</p><p>æˆ‘ä»¬ä¾§é‡äºä½¿åŸºæœ¬æ“ä½œæ­£ç¡®ï¼Œä¾‹å¦‚çŠ¶æ€å’Œç»‘å®šå¦‚ä½•å·¥ä½œï¼Œè§†å›¾å¦‚ä½•ä»¥åŠä½•æ—¶æ›´æ–°ç­‰ç­‰ã€‚å¾ˆå¯èƒ½æœ¬æ–‡çš„å®ç°åœ¨æŸäº›æ–¹é¢å¹¶ä¸æ­£ç¡®ï¼Œå¯èƒ½æ˜¯å› ä¸º Apple å¿˜äº†å°†åŸå§‹èµ„æºä½œä¸º Xcode 11 çš„ä¸€éƒ¨åˆ†å‘é€ç»™æˆ‘ä»¬ã€‚</p><h3 id="WebSockets"><a href="#WebSockets" class="headerlink" title="WebSockets"></a>WebSockets</h3><p>æˆ‘ä»¬ç›®å‰ä½¿ç”¨ AJAX å°†æµè§ˆå™¨è¿æ¥åˆ°æœåŠ¡å™¨ã€‚ä½¿ç”¨ WebSockets æœ‰å¤šç§ä¼˜åŠ¿ï¼š</p><ul><li>ä¿è¯äº†äº‹ä»¶çš„é¡ºåºï¼ˆAJAX è¯·æ±‚å¯èƒ½ä¸åŒæ­¥åˆ°è¾¾ï¼‰</li><li>éç”¨æˆ·å‘èµ·çš„æœåŠ¡å™¨ç«¯ DOM æ›´æ–°ï¼ˆå®šæ—¶å™¨ã€æ¨é€ï¼‰</li><li>ä¼šè¯è¶…æ—¶æŒ‡ç¤ºå™¨</li></ul><p>è¿™ä¼šè®©å®ç°ä¸€ä¸ªèŠå¤©å®¢æˆ·ç«¯çš„æ¼”ç¤ºç¤ºä¾‹å˜å¾—éå¸¸å®¹æ˜“ã€‚</p><p>æ·»åŠ  WebSockets å®é™…ä¸Šéå¸¸ç®€å•ï¼Œå› ä¸ºäº‹ä»¶å·²ç»ä½œä¸º JSON å‘é€äº†ã€‚æˆ‘ä»¬åªéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„å«ç‰‡ï¼ˆshimsï¼‰ã€‚æ‰€æœ‰è¿™äº›éƒ½å·²ç»åœ¨ <a href="https://github.com/NozeIO/swift-nio-irc-webclient" target="_blank" rel="noopener">swift-nio-irc-webclient</a> ä¸­è¯•ç”¨è¿‡äº†ï¼Œåªéœ€è¦ç§»æ¤ä¸€ä¸‹ã€‚</p><h3 id="SPA"><a href="#SPA" class="headerlink" title="SPA"></a>SPA</h3><p>SwiftWebUI çš„å½“å‰ç‰ˆæœ¬æ˜¯ä¸€ä¸ªè¿æ¥åˆ°æœ‰çŠ¶æ€åç«¯æœåŠ¡å™¨çš„ SPAï¼ˆå•é¡µé¢åº”ç”¨ç¨‹åºï¼‰ã€‚</p><p>è¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œä¾‹å¦‚ï¼Œå½“ç”¨æˆ·é€šè¿‡æ­£å¸¸çš„é“¾æ¥éå†åº”ç”¨ç¨‹åºæ—¶ï¼Œä¿æŒæ ‘çš„çŠ¶æ€ã€‚åˆå WebObjectsã€‚;-)</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œæœ€å¥½èƒ½æ›´å¥½åœ°æ§åˆ¶ DOM ID ç”Ÿæˆã€é“¾æ¥ç”Ÿæˆä»¥åŠè·¯ç”±ç­‰ç­‰ã€‚è¿™å’Œ <a href="http://swiftobjects.org/" target="_blank" rel="noopener">SwiftObjects</a> æ‰€æä¾›çš„æ–¹å¼ç±»ä¼¼ã€‚</p><p>ä½†æ˜¯æœ€ç»ˆç”¨æˆ·å°†ä¸å¾—ä¸æ”¾å¼ƒå¾ˆå¤šæœ¬å¯ä»¥â€œå­¦ä¹ ä¸€æ¬¡ï¼Œéšå¤„ä½¿ç”¨â€çš„åŠŸèƒ½ï¼Œå› ä¸º SwiftUI æ“ä½œå¤„ç†ç¨‹åºé€šå¸¸æ˜¯å›´ç»•ç€æ•æ‰ä»»æ„çŠ¶æ€çš„äº‹å®æ¥æ„å»ºçš„ã€‚</p><p>æˆ‘ä»¬å°†ä¼šæœŸå¾…åŸºäº Swift çš„æœåŠ¡å™¨ç«¯æ¡†æ¶æå‡ºä»€ä¹ˆæ›´å¥½çš„ä¸œè¥¿æ¥ğŸ‘½ã€‚</p><h3 id="WASM"><a href="#WASM" class="headerlink" title="WASM"></a>WASM</h3><p>ä¸€æ—¦æˆ‘ä»¬æ‰¾åˆ°åˆé€‚çš„ Swift WASMï¼ˆWebAssemblyï¼‰ï¼ŒSwiftWebUI å°±ä¼šæ›´æœ‰ç”¨å¤„ã€‚æœŸå¾… WASMï¼</p><h3 id="WebIDs"><a href="#WebIDs" class="headerlink" title="WebIDs"></a>WebIDs</h3><p>æœ‰äº›åƒ <code>ForEach</code> è¿™æ ·çš„ SwiftUI è§†å›¾éœ€è¦ <code>Identifiable</code> å¯¹è±¡ï¼Œå…¶ä¸­çš„ <code>id</code> å¯ä»¥æ˜¯ä»»ä½• <code>Hashable</code>ã€‚è¿™åœ¨ DOM ä¸­ä¸å¤ªå¥½ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åŸºäºå­—ç¬¦ä¸²çš„ ID æ¥è¯†åˆ«èŠ‚ç‚¹ã€‚</p><p>è¿™æ˜¯é€šè¿‡å°† ID æ˜ å°„åˆ°å…¨å±€æ˜ å°„ä¸­çš„å­—ç¬¦ä¸²æ¥è§£å†³çš„ã€‚è¿™åœ¨æŠ€æœ¯ä¸Šæ˜¯æ— ç•Œçš„ï¼ˆä¸€ä¸ªç±»å¼•ç”¨çš„ç‰¹å®šé—®é¢˜ï¼‰ã€‚</p><p>æ€»ç»“ï¼šå¯¹äº web ä»£ç ï¼Œæœ€å¥½ä½¿ç”¨å­—ç¬¦ä¸²æˆ–æ•´å‹æ¥æ ‡è¯†ä¸ªä½“ã€‚</p><h3 id="è¡¨å•"><a href="#è¡¨å•" class="headerlink" title="è¡¨å•"></a>è¡¨å•</h3><p>è¡¨å•éœ€è¦åšå¾—æ›´å¥½ï¼š<a href="https://github.com/SwiftWebUI/SwiftWebUI/issues/10" target="_blank" rel="noopener">Issue</a>ã€‚</p><p>SemanticUI æœ‰ä¸€äº›å¾ˆå¥½çš„è¡¨å•å¸ƒå±€ï¼Œæˆ‘ä»¬å¯èƒ½å‚ç…§è¿™äº›å¸ƒå±€é‡å†™å­æ ‘ã€‚æœ‰å¾…å•†æ¦·ã€‚</p><h2 id="é¢å‘-Swift-çš„-WebObjects-6"><a href="#é¢å‘-Swift-çš„-WebObjects-6" class="headerlink" title="é¢å‘ Swift çš„ WebObjects 6"></a>é¢å‘ Swift çš„ WebObjects 6</h2><p>èŠ±äº†ç‚¹æ—¶é—´åœ¨æ–‡ç« ä¸­åµŒå…¥äº†ä¸‹é¢è¿™ä¸ªå¯ç‚¹å‡»çš„ Twitter æ§ä»¶ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šç”±äºæŸäº›åŸå› ï¼Œè¿™é‡Œæ²¡åŠæ³•åƒåŸæ–‡ä¸€æ ·åµŒå…¥ Twitter æ§ä»¶ï¼Œåªèƒ½æ”¾é“¾æ¥ã€‚ï¼‰</p><p><a href="https://twitter.com/helje5/status/1137092138104233987/photo/1?ref_src=twsrc^tfw|twcamp^tweetembed|twterm^1137092138104233987&amp;ref_url=http%3A%2F%2Fwww.alwaysrightinstitute.com%2Fswiftwebui%2F" target="_blank" rel="noopener">https://twitter.com/helje5/status/1137092138104233987/photo/1?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1137092138104233987&amp;ref_url=http%3A%2F%2Fwww.alwaysrightinstitute.com%2Fswiftwebui%2F</a></p><p>è‹¹æœç¡®å®ç»™äº†æˆ‘ä»¬ä¸€ä¸ªâ€œSwift é£æ ¼â€çš„ WebObjects 6ï¼</p><p>ä¸‹ä¸€ç¯‡ï¼šç›´é¢ Web å’Œä¸€äº› Swift åŒ–çš„ EOFï¼ˆåˆå CoreData åˆå ZeeQLï¼‰ã€‚</p><h2 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h2><ul><li>GitHubï¼š<a href="https://github.com/SwiftWebUI/SwiftWebUI" target="_blank" rel="noopener">SwiftWebUI</a></li><li>SwiftUI<ul><li><a href="https://developer.apple.com/videos/play/wwdc2019/204/" target="_blank" rel="noopener">ä»‹ç» SwiftUI</a>ï¼ˆ204ï¼‰</li><li><a href="https://developer.apple.com/videos/play/wwdc2019/216" target="_blank" rel="noopener">SwiftUI è¦ç‚¹</a> ï¼ˆ216ï¼‰</li><li><a href="https://developer.apple.com/videos/play/wwdc2019/226" target="_blank" rel="noopener">SwiftUI ä¸­çš„æ•°æ®æµ</a>ï¼ˆ226ï¼‰</li><li><a href="https://developer.apple.com/documentation/swiftui" target="_blank" rel="noopener">SwiftUI æ¡†æ¶ API</a></li></ul></li><li><a href="http://swiftobjects.org/" target="_blank" rel="noopener">SwiftObjects</a></li><li>SemanticUI<ul><li><a href="https://fontawesome.com/" target="_blank" rel="noopener">Font Awesome</a></li><li><a href="https://github.com/SwiftWebResources/SemanticUI-Swift" target="_blank" rel="noopener">SemanticUI Swift</a></li></ul></li><li><a href="https://github.com/apple/swift-nio" target="_blank" rel="noopener">SwiftNIO</a></li></ul><h2 id="è”ç³»æ–¹å¼"><a href="#è”ç³»æ–¹å¼" class="headerlink" title="è”ç³»æ–¹å¼"></a>è”ç³»æ–¹å¼</h2><p>å˜¿ï¼Œæˆ‘ä»¬å¸Œæœ›ä½ èƒ½å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œå¹¶ä¸”ä¹Ÿå¸Œæœ›å¾—åˆ°ä½ çš„åé¦ˆï¼</p><p>Twitterï¼ˆä»»ä½•ä¸€ä¸ªéƒ½å¯ä»¥ï¼‰ï¼š<a href="https://twitter.com/helje5" target="_blank" rel="noopener">@helje5</a>ï¼Œ<a href="https://twitter.com/ar_institute" target="_blank" rel="noopener">@ar_institute</a>ã€‚</p><p>ç”µå­é‚®ä»¶ï¼š<a href="mailto:wrong@alwaysrightinstitute.com" target="_blank" rel="noopener">wrong@alwaysrightinstitute.com</a></p><p>Slackï¼šåœ¨ SwiftDEã€swift-serverã€nozeã€ios-developers ä¸Šæ‰¾åˆ°æˆ‘ä»¬ã€‚</p><p><em>å†™äº 2019 å¹´ 6 æœˆ 30 æ—¥</em></p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡æ˜¯å…³äº SwiftWebUI çš„ä»‹ç»ã€‚SwiftWebUI å°† SwiftUI å¸¦åˆ°äº† Web å¹³å°ä¸Šã€‚
    
    </summary>
    
      <category term="The Always Right Institute" scheme="https://swift.gg/categories/The-Always-Right-Institute/"/>
    
    
      <category term="Swift è·¨å¹³å°" scheme="https://swift.gg/tags/Swift-%E8%B7%A8%E5%B9%B3%E5%8F%B0/"/>
    
  </entry>
  
  <entry>
    <title>Swift ä¸­çš„é¢å‘åè®®ç¼–ç¨‹ï¼šå¼•è¨€</title>
    <link href="https://swift.gg/2019/09/05/protocol-oriented-programming/"/>
    <id>https://swift.gg/2019/09/05/protocol-oriented-programming/</id>
    <published>2019-09-05T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šAndrew Jaffeeï¼Œ<a href="https://www.appcoda.com/protocol-oriented-programming/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-03-20<br>è¯‘è€…ï¼š<a href="https://github.com/dzyding" target="_blank" rel="noopener">ç°s</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œå¤æ‚æ€§æ˜¯æœ€å¤§çš„æ•Œäººï¼Œå› æ­¤æˆ‘ä¼šå»äº†è§£é‚£äº›å¯ä»¥å¸®åŠ©æˆ‘ç®¡ç†æ··ä¹±çš„æ–°æŠ€æœ¯ã€‚Swift ä¸­çš„â€œé¢å‘åè®®ç¼–ç¨‹â€ï¼ˆPOPï¼‰æ˜¯æœ€è¿‘ï¼ˆè‡³å°‘è‡ª2015å¹´ä»¥æ¥ï¼‰å¼•èµ·å¹¿æ³›å…³æ³¨çš„â€œçƒ­é—¨â€æ–¹æ³•ä¹‹ä¸€ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨ Swift 4ã€‚åœ¨æˆ‘è‡ªå·±ç¼–å†™ä»£ç æ—¶ï¼Œå‘ç° POP å¾ˆæœ‰å‰é€”ã€‚æ›´å¸å¼•äººçš„æ˜¯ï¼ŒApple å®£ç§° <a href="https://developer.apple.com/videos/play/wwdc2015/408/?time=868" target="_blank" rel="noopener"><strong>â€œSwift çš„æ ¸å¿ƒæ˜¯é¢å¯¹åè®®çš„â€</strong></a>ã€‚æˆ‘æƒ³åœ¨ä¸€ä¸ªæ­£å¼çš„æŠ¥å‘Šä¸­åˆ†äº«å…³äº POP çš„ç»éªŒï¼Œä¸€ç¯‡å…³äºè¿™ä¸ªæ–°å…´æŠ€æœ¯æ¸…æ™°è€Œç®€æ´çš„æ•™ç¨‹ã€‚  </p><p>æˆ‘å°†è§£é‡Šå…³é”®æ¦‚å¿µï¼Œæä¾›å¤§é‡ä»£ç ç¤ºä¾‹ï¼Œæ— æ³•é¿å…çš„å°† POP å’Œ OOP ï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å¯¹é¢å‘æµè¡Œç¼–ç¨‹ï¼ˆFOP?ï¼‰çš„äººç¾¤æ‰€å£°ç§°çš„ POP æ˜¯è§£å†³æ‰€æœ‰é—®é¢˜çš„çµä¸¹å¦™è¯è¿™ä¸€è¯´æ³•è¿›è¡Œæ³¼å†·æ°´ã€‚  </p><p>é¢å‘åè®®ç¼–ç¨‹æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„æ–°å·¥å…·ï¼Œå€¼å¾—<em>æ·»åŠ åˆ°ä½ ç°æœ‰çš„ç¼–ç¨‹å·¥å…·åº“ä¸­</em>ï¼Œä½†æ˜¯<strong>æ²¡æœ‰ä»€ä¹ˆ</strong>å¯ä»¥ä»£æ›¿é‚£äº›ç»ä¹…ä¸è¡°çš„åŸºæœ¬åŠŸï¼Œå°±åƒå°†å¤§çš„å‡½æ•°æ‹†åˆ†æˆè‹¥å¹²ä¸ªå°å‡½æ•°ï¼Œå°†å¤§çš„ä»£ç æ–‡ä»¶æ‹†åˆ†æˆè‹¥å¹²ä¸ªå°çš„æ–‡ä»¶ï¼Œä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡åï¼Œåœ¨æ•²ä»£ç ä¹‹å‰èŠ±æ—¶é—´è®¾è®¡æ¶æ„ï¼Œåˆç†è€Œä¸€è‡´çš„ä½¿ç”¨é—´è·å’Œç¼©è¿›ï¼Œå°†ç›¸å…³çš„å±æ€§å’Œè¡Œä¸ºåˆ†é…åˆ°ç±»å’Œç»“æ„ä½“ä¸­ - éµå¾ªè¿™äº›å¸¸è¯†å¯ä»¥è®©ä¸–ç•Œå˜å¾—ä¸åŒã€‚å¦‚æœä½ ç¼–å†™çš„ä»£ç æ— æ³•è¢«åŒäº‹ç†è§£ï¼Œé‚£å®ƒå°±æ˜¯æ— ç”¨çš„ä»£ç ã€‚  </p><p>å­¦ä¹ å’Œé‡‡ç”¨åƒ POP è¿™æ ·çš„æ–°æŠ€æœ¯å¹¶ä¸éœ€è¦ç»å¯¹çš„å”¯ä¸€ã€‚POP å’Œ OOP ä¸ä»…å¯ä»¥å…±å­˜ï¼Œè¿˜å¯ä»¥äº’ç›¸ååŠ©ã€‚å¯¹äºå¤§å¤šæ•°å¼€å‘è€…åŒ…æ‹¬æˆ‘è‡ªå·±ï¼ŒæŒæ¡ POP éœ€è¦æ—¶é—´å’Œè€å¿ƒã€‚å› ä¸º POP çœŸçš„å¾ˆé‡è¦ï¼Œæ‰€ä»¥æˆ‘å°†æ•™ç¨‹åˆ†æˆä¸¤ç¯‡æ–‡ç« ã€‚æœ¬æ–‡å°†ä¸»è¦ä»‹ç»å’Œè§£é‡Š Swift çš„åè®®å’Œ POPã€‚ç¬¬äºŒç¯‡æ–‡ç« å°†æ·±å…¥ç ”ç©¶ POP çš„é«˜çº§åº”ç”¨æ–¹å¼ï¼ˆæ¯”å¦‚ä»åè®®å¼€å§‹æ„å»ºåº”ç”¨ç¨‹åºçš„åŠŸèƒ½ï¼‰ï¼ŒèŒƒå‹åè®®ï¼Œä»å¼•ç”¨ç±»å‹åˆ°å€¼ç±»å‹è½¬å˜èƒŒåçš„åŠ¨æœºï¼Œåˆ—ä¸¾ POP çš„åˆ©å¼Šï¼Œåˆ—ä¸¾ OOP çš„åˆ©å¼Šï¼Œæ¯”è¾ƒ OOP å’Œ POPï¼Œé˜è¿°ä¸ºä»€ä¹ˆâ€œSwift æ˜¯é¢å‘åè®®çš„â€ï¼Œå¹¶ä¸”æ·±å…¥ç ”ç©¶ä¸€ä¸ªè¢«ç§°ä¸º <a href="https://developer.apple.com/videos/play/wwdc2016/419/?time=41" target="_blank" rel="noopener"><strong>â€œå±€éƒ¨æ¨ç†â€</strong></a> çš„æ¦‚å¿µï¼Œå®ƒè¢«è®¤ä¸ºæ˜¯é€šè¿‡ä½¿ç”¨ POP å¢å¼ºçš„ã€‚è¿™æ¬¡æˆ‘ä»¬åªä¼šç²—ç•¥æ¶‰åŠä¸€äº›é«˜çº§ä¸»é¢˜ã€‚<br><a id="more"></a> </p><h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>ä½œä¸ºè½¯ä»¶å¼€å‘è€…ï¼Œ<strong>ç®¡ç†å¤æ‚æ€§</strong>æœ¬è´¨ä¸Šæ˜¯æˆ‘ä»¬æœ€åº”è¯¥å…³æ³¨çš„é—®é¢˜ã€‚å½“æˆ‘ä»¬å°è¯•å­¦ä¹  POP è¿™é¡¹æ–°æŠ€æœ¯æ—¶ï¼Œä½ å¯èƒ½æ— æ³•ä»æ—¶é—´çš„æŠ•èµ„ä¸­çœ‹åˆ°å³æ—¶å›æŠ¥ã€‚ä½†æ˜¯ï¼Œå°±åƒä½ å¯¹æˆ‘çš„è®¤è¯†æœ‰ä¸ªè¿‡ç¨‹ä¸€æ ·ï¼Œä½ å°†ä¼šäº†è§£ <a href="https://developer.apple.com/videos/play/wwdc2015/408/" target="_blank" rel="noopener"><strong>POP å¤„ç†å¤æ‚æ€§çš„æ–¹æ³•</strong></a>ï¼ŒåŒæ—¶ä¸ºä½ æä¾›å¦ä¸€ç§å·¥å…·æ¥æ§åˆ¶è½¯ä»¶ç³»ç»Ÿä¸­å›ºæœ‰çš„æ··ä¹±ã€‚  </p><p>æˆ‘å¬åˆ°è¶Šæ¥è¶Šå¤šå…³äº POP çš„<em>è®¨è®º</em>ï¼Œä½†æ˜¯å´å¾ˆå°‘çœ‹åˆ°ä½¿ç”¨è¿™ç§æ–¹å¼ç¼–å†™çš„äº§å“ä»£ç ï¼Œæ¢å¥è¯è¯´ï¼Œæˆ‘è¿˜æ²¡æœ‰çœ‹åˆ°æœ‰å¾ˆå¤šäººä»åè®®è€Œä¸æ˜¯ç±»å¼€å§‹åˆ›å»ºåº”ç”¨ç¨‹åºçš„åŠŸèƒ½ã€‚è¿™ä¸ä»…ä»…æ˜¯å› ä¸ºäººç±»æœ‰æŠ—æ‹’æ”¹å˜çš„å€¾å‘ã€‚å­¦ä¹ ä¸€ç§å…¨æ–°çš„èŒƒå¼å¹¶å°†å…¶ä»˜è¯¸å®è·µï¼Œè¯´èµ·æ¥å®¹æ˜“åšèµ·æ¥éš¾ã€‚åœ¨æˆ‘ç¼–å†™æ–°åº”ç”¨ç¨‹åºæ—¶ï¼Œé€æ¸å‘ç°è‡ªå·±å¼€å§‹ä½¿ç”¨ POP æ¥è®¾è®¡å’Œå®ç°åŠŸèƒ½ â€” æœ‰ç»„ç»‡çš„ä¸”è‡ªç„¶è€Œç„¶çš„ã€‚  </p><p>ä¼´éšç€æ–°æ½®æµå¸¦æ¥çš„åˆºæ¿€ï¼Œå¾ˆå¤šäººéƒ½åœ¨è°ˆè®ºç”¨ POP <em>å–ä»£</em> OOPã€‚æˆ‘è®¤ä¸ºé™¤éåƒ Swift è¿™æ ·çš„ POP è¯­è¨€è¢«å¹¿æ³›æ”¹è¿›ï¼Œå¦åˆ™è¿™æ˜¯ä¸å¯èƒ½å‘ç”Ÿçš„ â€” ä¹Ÿæˆ–è®¸æ ¹æœ¬å°±ä¸ä¼šå‘ç”Ÿã€‚æˆ‘æ˜¯ä¸ªå®ç”¨ä¸»ä¹‰è€…ï¼Œè€Œä¸æ˜¯è¿½æ±‚æ—¶é«¦çš„äººã€‚åœ¨å¼€å‘æ–°çš„ Swift é¡¹ç›®æ—¶ï¼Œæˆ‘å‘ç°è‡ªå·±çš„è¡Œä¸ºæ˜¯ä¸€ç§æŠ˜è¡·çš„æ–¹æ³•ã€‚æˆ‘åœ¨åˆç†çš„åœ°æ–¹åˆ©ç”¨ OOPï¼Œè€Œç”¨ POP æ›´åˆé€‚çš„åœ°æ–¹ä¹Ÿä¸ä¼šæ­»è„‘ç­‹çš„ä¸€å®šè¦ä½¿ç”¨ OOPï¼Œè¿™æ ·åè€Œäº†è§£åˆ°è¿™ä¸¤ç§æ¨¡å¼<strong>å¹¶ä¸</strong>ç›¸äº’æ’æ–¥ã€‚æˆ‘æŠŠè¿™ä¸¤ç§æŠ€æœ¯ç»“åˆåœ¨ä¸€èµ·ã€‚åœ¨æœ¬æœŸç”±ä¸¤éƒ¨åˆ†ç»„æˆçš„ POP æ•™ç¨‹ä¸­ï¼Œä½ å°†äº†è§£æˆ‘åœ¨è¯´ä»€ä¹ˆã€‚  </p><p>æˆ‘æŠ•å…¥åˆ° OOP ä¸­å·²ç»æœ‰å¾ˆä¹…äº†ã€‚1990 å¹´ï¼Œæˆ‘ä¹°äº†ä¸€ä¸ªé›¶å”®ç‰ˆæœ¬çš„ Turbo Pascalã€‚åœ¨ä½¿ç”¨äº† OOP å¤§çº¦ä¸€å¹´åï¼Œæˆ‘å¼€å§‹è®¾è®¡ã€å¼€å‘å’Œå‘å¸ƒé¢å‘å¯¹è±¡çš„åº”ç”¨ç¨‹åºäº§å“ã€‚æˆ‘æˆäº†ä¸€ä¸ªå¿ ç²‰ã€‚å½“æˆ‘å‘ç°å¯ä»¥<strong>æ‰©å±•</strong>å’Œ<strong>å¢å¼º</strong>è‡ªå·±çš„ç±»ï¼Œç®€ç›´å…´å¥‹çš„é£èµ·ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒMicrosoft å’Œ Apple ç­‰å…¬å¸å¼€å§‹å¼€å‘åŸºäº OOP çš„å¤§å‹ä»£ç åº“ï¼Œå¦‚ Microsoft Foundation Classesï¼ˆMFCï¼‰å’Œ .NETï¼Œä»¥åŠ iOS å’Œ OS X SDKã€‚ç°åœ¨ï¼Œå¼€å‘äººå‘˜åœ¨å¼€å‘æ–°åº”ç”¨ç¨‹åºæ—¶å¾ˆå°‘éœ€è¦é‡æ–°é€ è½®å­ã€‚æ²¡æœ‰å®Œç¾çš„æ–¹æ³•ï¼ŒOOP ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œä½†æ˜¯ä¼˜ç‚¹ä»ç„¶å¤§äºç¼ºç‚¹ã€‚æˆ‘ä»¬å°†èŠ±ä¸€äº›æ—¶é—´æ¥æ¯”è¾ƒ OOP å’Œ POPã€‚  </p><h2 id="ç†è§£åè®®"><a href="#ç†è§£åè®®" class="headerlink" title="ç†è§£åè®®"></a>ç†è§£åè®®</h2><p>å½“å¼€å‘äººå‘˜è®¾è®¡ä¸€ä¸ªæ–°çš„ iOS åº”ç”¨ç¨‹åºçš„åŸºæœ¬ç»“æ„æ—¶ï¼Œä»–ä»¬å‡ ä¹æ€»æ˜¯ä» <code>Foundation</code> å’Œ <code>UIKit</code> ç­‰æ¡†æ¶ä¸­çš„ç°æœ‰ <code>ç±»</code> å¼€å§‹ã€‚æˆ‘èƒ½æƒ³åˆ°çš„å‡ ä¹æ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½éœ€è¦æŸç§ç”¨æˆ·ç•Œé¢å¯¼èˆªç³»ç»Ÿã€‚ç”¨æˆ·éœ€è¦ä¸€äº›è¿›å…¥åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹å’Œå¼•å¯¼ä»–ä»¬ä½¿ç”¨åº”ç”¨ç¨‹åºåŠŸèƒ½çš„è·¯æ ‡ã€‚å¯ä»¥æµè§ˆä¸€ä¸‹ä½ çš„ iPhone æˆ– iPad ä¸Šçš„åº”ç”¨ç¨‹åºã€‚  </p><p>å½“è¿™äº›åº”ç”¨ç¨‹åºæ‰“å¼€æ—¶ï¼Œä½ çœ‹åˆ°äº†ä»€ä¹ˆï¼Ÿæˆ‘æ‰“èµŒä½ çœ‹åˆ°çš„æ˜¯ <code>UITableViewController</code>ï¼Œ<code>UICollectionViewController</code> å’Œ <code>UIPageViewController</code> çš„å­ç±»ã€‚  </p><p>å½“ä½ ç¬¬ä¸€æ¬¡åˆ›å»ºæ–°çš„ iOS é¡¹ç›®æ—¶ï¼Œæ‰€æœ‰äººéƒ½å¿…é¡»è®¤è¯†ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªæ–°çš„ iOS é¡¹ç›®åŸºäº Xcode ä¸­çš„ <code>Single View Appï¼ˆå•è§†å›¾åº”ç”¨ï¼‰</code> æ¨¡æ¿ï¼š  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>éƒ¨åˆ†å¼€å‘äººå‘˜å°†åœ¨è¿™é‡Œåœä¸‹æ¥ï¼Œåˆ›å»ºå®Œå…¨å®šåˆ¶çš„æ¥å£ï¼Œä½†å¤§å¤šæ•°äººå°†é‡‡å–å¦ä¸€ä¸ªæ­¥éª¤ã€‚  </p><p>å½“ iOS å¼€å‘è€…å¼€å‘æ–°çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œæœ€å¸¸è§çš„ç‰¹å¾å°±æ˜¯ OOPï¼Œé‚£ä¹ˆ POP åœ¨è¿™é‡Œæ‰®æ¼”ä»€ä¹ˆè§’è‰²å‘¢ï¼Ÿ  </p><p>ä½ çŸ¥é“æˆ‘å°†æ€æ ·ç»§ç»­ä¹ˆï¼Ÿæƒ³è±¡å¤§å¤šæ•°å¼€å‘äººå‘˜çš„ä¸‹ä¸€ä¸ªä¸»è¦æ­¥éª¤æ˜¯ä»€ä¹ˆã€‚é‚£å°±æ˜¯<strong>éµå¾ªåè®®</strong>ï¼ˆå¹¶å®ç° <a href="https://appcoda.com/swift-delegate/" target="_blank" rel="noopener"><strong>å§”æ‰˜ï¼Œä½†æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡äº†</strong></a>ï¼‰ã€‚  </p><p>è®©æˆ‘ç»™ä½ ä»¬çœ‹ä¸€ä¸ªä¾‹å­ä½¿å…¶ä¾¿äºç†è§£ã€‚æˆ‘ç›¸ä¿¡ä½ ä»¬å¾ˆå¤šäººéƒ½ç”¨è¿‡ <code>UITableView</code>ã€‚è™½ç„¶è¿™ä¸æ˜¯ä¸€ä¸ªå…³äº <code>UITableView</code> çš„æ•™ç¨‹ï¼Œä½†æ˜¯ä½ åº”è¯¥çŸ¥é“åœ¨ <code>UIViewController</code> ä¸­å°†å…¶å®ç°æ—¶ï¼Œåè®®æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚åœ¨å‘ <code>UIViewController</code> ä¸­æ·»åŠ  <code>UITableView</code>æ—¶ï¼Œ<code>UIViewController</code> å¿…é¡»<strong>éµå¾ª</strong> <code>UITableViewDataSource</code> å’Œ <code>UITableViewDelegate</code> åè®®ï¼Œå°±åƒè¿™æ ·ï¼š  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span>, <span class="title">UITableViewDataSource</span>, <span class="title">UITableViewDelegate</span></span></span><br></pre></td></tr></table></figure><p>ç®€è€Œè¨€ä¹‹ï¼Œéµå¾ª <code>UITableViewDataSource</code> å…è®¸ä½ ç”¨æ•°æ®å¡«å……æ‰€æœ‰çš„ <code>UITableViewCell</code>ï¼Œæ¯”å¦‚ç»™ç”¨æˆ·æä¾›å¯¼èˆªçš„èœå•é¡¹åç§°ã€‚é‡‡ç”¨ <code>UITableViewDelegate</code>ï¼Œä½ å¯ä»¥å¯¹ç”¨æˆ·ä¸ <code>UITableView</code> çš„äº¤äº’è¿›è¡Œæ›´ç»†ç²’åº¦çš„æ§åˆ¶ï¼Œæ¯”å¦‚åœ¨ç”¨æˆ·ç‚¹å‡»ç‰¹å®šçš„ <code>UITableViewCell</code> æ—¶æ‰§è¡Œé€‚å½“çš„æ“ä½œã€‚  </p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>æˆ‘å‘ç°ï¼Œåœ¨è¿›è¡ŒæŠ€æœ¯æ€§å®šä¹‰å’Œè®¨è®ºä¹‹å‰ï¼Œç†è§£å¸¸ç”¨çš„æœ¯è¯­å®šä¹‰å¯ä»¥å¸®åŠ©è¯»è€…æ›´å¥½åœ°ç†è§£æŸä¸ªä¸»é¢˜ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬ è€ƒè™‘ <a href="https://en.oxforddictionaries.com/definition/protocol" target="_blank" rel="noopener"><strong>â€œåè®®â€ä¸€è¯çš„é€šä¿—å®šä¹‰</strong></a>ï¼š  </p><blockquote><p>â€¦â€¦ç®¡ç†å›½å®¶äº‹åŠ¡æˆ–å¤–äº¤é¢†åŸŸçš„æ­£å¼ç¨‹åºæˆ–è§„åˆ™ä½“ç³»ã€‚â€¦â€¦<br>åœ¨ä»»ä½•å›¢ä½“ã€ç»„ç»‡æˆ–å½¢åŠ¿ä¸‹ï¼Œå…¬è®¤æˆ–å·²åˆ¶å®šçš„ç¨‹åºæˆ–è¡Œä¸ºå‡†åˆ™ã€‚â€¦â€¦<br>è¿›è¡Œç§‘å­¦å®éªŒæ—¶çš„ç¨‹åºâ€¦â€¦</p></blockquote><p>Apple çš„â€œSwift ç¼–ç¨‹è¯­è¨€ï¼ˆSwift 4.0.3ï¼‰â€ <a href="https://docs.swift.org/swift-book/LanguageGuide/Protocols.html#//apple_ref/doc/uid/TP40014097-CH25-ID267" target="_blank" rel="noopener">æ–‡æ¡£ä¸­çš„å£°æ˜</a>ï¼š  </p><blockquote><p>åè®®å®šä¹‰äº†é€‚åˆç‰¹å®šä»»åŠ¡æˆ–åŠŸèƒ½çš„æ–¹æ³•ã€å±æ€§å’Œå…¶ä»–éœ€æ±‚çš„è“å›¾ã€‚ç„¶åï¼Œç±»ã€ç»“æ„ä½“æˆ–æšä¸¾å¯ä»¥éµå¾ªè¯¥åè®®æ¥æä¾›è¿™äº›éœ€æ±‚çš„å®é™…å®ç°ã€‚ä»»ä½•æ»¡è¶³åè®®è¦æ±‚çš„ç±»å‹éƒ½è¢«ç§°ä¸ºéµå¾ªè¯¥åè®®ã€‚</p></blockquote><p>åè®®æ˜¯æœ€é‡è¦çš„å·¥å…·ä¹‹ä¸€ï¼Œæˆ‘ä»¬å¿…é¡»ç»™è½¯ä»¶å›ºæœ‰çš„æ··ä¹±å¸¦æ¥ä¸€äº›ç§©åºã€‚åè®®ä½¿æˆ‘ä»¬èƒ½å¤Ÿè¦æ±‚ä¸€ä¸ªæˆ–å¤šä¸ªç±»å’Œç»“æ„ä½“åŒ…å«ç‰¹å®šçš„æœ€å°ä¸”å¿…éœ€çš„å±æ€§ï¼Œå’Œ/æˆ–æä¾›ç‰¹å®šçš„æœ€å°ä¸”å¿…éœ€çš„å®ç°/æ–¹æ³•ã€‚é€šè¿‡ <a href="https://docs.swift.org/swift-book/LanguageGuide/Protocols.html#//apple_ref/doc/uid/TP40014097-CH25-ID521" target="_blank" rel="noopener"><strong>åè®®æ‰©å±•</strong></a>ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºä¸€äº›æˆ–æ‰€æœ‰åè®®çš„æ–¹æ³•æä¾›é»˜è®¤å®ç°ã€‚  </p><h3 id="éµå¾ªåè®®"><a href="#éµå¾ªåè®®" class="headerlink" title="éµå¾ªåè®®"></a>éµå¾ªåè®®</h3><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°†ä½¿è‡ªå®šä¹‰çš„ <code>Person</code> ç±»<strong>éµå¾ª</strong>ï¼ˆ<strong>é‡‡ç”¨</strong>ï¼‰Apple è‡ªå¸¦ <a href="https://developer.apple.com/documentation/swift/equatable" target="_blank" rel="noopener"><code>Equatable</code></a> åè®®ã€‚  </p><blockquote><p>éµå¾ª Equatable åè®®ä»¥åå¯ä»¥ä½¿ç”¨ç­‰äºè¿ç®—ç¬¦ï¼ˆ==ï¼‰æ¥åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼Œä½¿ç”¨ä¸ç­‰äºè¿ç®—ç¬¦ï¼ˆ!=ï¼‰æ¥åˆ¤æ–­æ˜¯å¦ä¸ç­‰ã€‚Swift æ ‡å‡†åº“ä¸­çš„å¤§éƒ¨åˆ†åŸºç¡€ç±»å‹éƒ½éµå¾ªäº† Equatable åè®®â€¦â€¦  </p></blockquote><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> : <span class="title">Equatable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> weight:<span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> sex:<span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(weight:<span class="type">Int</span>, name:<span class="type">String</span>, sex:<span class="type">String</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">        <span class="keyword">self</span>.weight = weight</span><br><span class="line">        <span class="keyword">self</span>.sex = sex</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> == <span class="params">(lhs: Person, rhs: Person)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> lhs.weight == rhs.weight &amp;&amp;</span><br><span class="line">            lhs.name == rhs.name &amp;&amp;</span><br><span class="line">            lhs.sex == rhs.sex</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Apple <a href="https://docs.swift.org/swift-book/LanguageGuide/Protocols.html#//apple_ref/doc/uid/TP40014097-CH25-ID267" target="_blank" rel="noopener">è§„å®š</a>ï¼Œâ€œè‡ªå®šä¹‰ç±»å‹å£°æ˜å®ƒä»¬é‡‡ç”¨ç‰¹å®šçš„åè®®ï¼Œéœ€è¦å°†åè®®çš„åç§°æ”¾åœ¨ç±»å‹åç§°ä¹‹åï¼Œä»¥å†’å·åˆ†éš”ï¼Œä½œä¸ºå…¶å®šä¹‰çš„ä¸€éƒ¨åˆ†ã€‚â€è¿™ä¹Ÿæ­£æ˜¯æˆ‘æ‰€åšçš„ï¼š  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> : <span class="title">Equatable</span></span></span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥å°†åè®®ç†è§£ä¸ºä¸“é—¨é’ˆå¯¹ <code>class</code>ã€<code>struct</code> æˆ– <code>enum</code> çš„<strong>çº¦å®š</strong>æˆ–<strong>æ‰¿è¯º</strong>ã€‚æˆ‘é€šè¿‡ <code>Equatable</code> åè®®ä½¿è‡ªå®šä¹‰çš„ <code>Person</code> ç±»éµå®ˆäº†ä¸€ä¸ªçº¦å®šï¼Œ<code>Person</code> ç±»<strong><em>æ‰¿è¯º</em></strong>é€šè¿‡ç°å® <code>Equatable</code> åè®®éœ€è¦çš„æ–¹æ³•æˆ–æˆå‘˜å˜é‡æ¥å±¥è¡Œè¯¥çº¦å®šï¼Œå³å°†å…¶å®ç°ã€‚  </p><p><code>Equatable</code> åè®®<strong><em>å¹¶æ²¡æœ‰å®ç°ä»»ä½•ä¸œè¥¿</em></strong>ã€‚å®ƒåªæ˜¯æŒ‡æ˜äº†<strong><em>é‡‡ç”¨ï¼ˆéµå¾ªï¼‰</em></strong> <code>Equatable</code> åè®®çš„ <code>class</code>ï¼Œ<code>struct</code>ï¼Œæˆ–è€… <code>enum</code> <strong><em>å¿…é¡»å®ç°</em></strong>çš„æ–¹æ³•å’Œ/æˆ–æˆå‘˜å˜é‡ã€‚æœ‰ä¸€äº›åè®®é€šè¿‡ <code>extensions</code> å®ç°äº†åŠŸèƒ½ï¼Œç¨åæˆ‘ä»¬ä¼šè¿›è¡Œè®¨è®ºã€‚æˆ‘ä¸ä¼šèŠ±å¤ªå¤šæ—¶é—´æ¥è®²è¿°å…³äº <code>enum</code> çš„ POP ç”¨æ³•ã€‚æˆ‘å°†å®ƒä½œä¸ºç»ƒä¹ ç•™ç»™ä½ ã€‚  </p><h3 id="å®šä¹‰åè®®"><a href="#å®šä¹‰åè®®" class="headerlink" title="å®šä¹‰åè®®"></a>å®šä¹‰åè®®</h3><p>ç†è§£åè®®æœ€å¥½çš„æ–¹å¼æ˜¯é€šè¿‡ä¾‹å­ã€‚æˆ‘å°†è‡ªå·±æ„å»ºä¸€ä¸ª <code>Equatable</code> æ¥å‘ä½ å±•ç¤ºåè®®çš„ç”¨æ³•ï¼š  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">IsEqual</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> == <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> != <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯·è®°ä½ï¼Œæˆ‘çš„â€œIsEqualâ€åè®®å¹¶æ²¡æœ‰å¯¹ <code>==</code> å’Œ <code>!=</code> è¿ç®—ç¬¦è¿›è¡Œå®ç°ã€‚â€œIsEqualâ€éœ€è¦åè®®çš„éµå¾ªè€…<strong><em>å®ç°ä»–ä»¬è‡ªå·±çš„</em></strong> <code>==</code> å’Œ <code>!=</code> è¿ç®—ç¬¦ã€‚  </p><p>æ‰€æœ‰å®šä¹‰åè®®å±æ€§å’Œæ–¹æ³•çš„è§„åˆ™éƒ½åœ¨ <a href="https://docs.swift.org/swift-book/LanguageGuide/Protocols.html#//apple_ref/doc/uid/TP40014097-CH25-ID267" target="_blank" rel="noopener"><strong>Apple çš„ Swift æ–‡æ¡£</strong></a> ä¸­è¿›è¡Œäº†æ€»ç»“ã€‚æ¯”å¦‚ï¼Œåœ¨åè®®ä¸­å®šä¹‰å±æ€§æ°¸è¿œä¸è¦ç”¨ <code>let</code> å…³é”®å­—ã€‚åªè¯»å±æ€§è§„å®šä½¿ç”¨ <code>var</code> å…³é”®å­—ï¼Œå¹¶åœ¨åé¢å•ç‹¬è·Ÿä¸Š <code>{ get }</code>ã€‚å¦‚æœæœ‰ä¸€ä¸ªæ–¹æ³•æ”¹å˜äº†ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§ï¼Œä½ éœ€è¦æ ‡è®°å®ƒä¸º <code>mutating</code>ã€‚ä½ éœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘é‡å†™çš„ <code>==</code> å’Œ <code>!=</code> æ“ä½œç¬¦è¢«å®šä¹‰ä¸º <code>static</code>ã€‚å¦‚æœä½ ä¸çŸ¥é“ï¼Œæ‰¾å‡ºåŸå› å°†ä¼šæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç»ƒä¹ ã€‚  </p><p>ä¸ºäº†å‘ä½ å±•ç¤ºæˆ‘çš„ <code>IsEqual</code>ï¼ˆæˆ–è€… <code>Equatable</code>ï¼‰è¿™æ ·çš„åè®®å…·æœ‰å¹¿æ³›çš„é€‚ç”¨æ€§ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒåœ¨ä¸‹é¢æ„å»ºä¸€ä¸ªç±»ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆè®¨è®ºä¸€ä¸‹â€œå¼•ç”¨ç±»å‹â€ä¸â€œå€¼ç±»å‹â€ã€‚  </p><h2 id="å¼•ç”¨ç±»å‹ä¸å€¼ç±»å‹"><a href="#å¼•ç”¨ç±»å‹ä¸å€¼ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹ä¸å€¼ç±»å‹"></a>å¼•ç”¨ç±»å‹ä¸å€¼ç±»å‹</h2><p>åœ¨ç»§ç»­ä¹‹å‰ï¼Œæ‚¨åº”è¯¥é˜…è¯» Apple å…³äº <a href="https://developer.apple.com/swift/blog/?id=10" target="_blank" rel="noopener"><strong>â€œå€¼å’Œå¼•ç”¨ç±»å‹â€</strong></a> çš„æ–‡ç« ã€‚å®ƒå°†è®©ä½ æ€è€ƒå¼•ç”¨<em>ç±»å‹</em>å’Œå€¼<em>ç±»å‹</em>ã€‚æˆ‘<strong>æ•…æ„</strong>ä¸åœ¨è¿™é‡Œè®²å¤ªå¤šç»†èŠ‚ï¼Œå› ä¸ºæˆ‘æƒ³è®©ä½ ä»¬æ€è€ƒå¹¶ç†è§£è¿™ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚å®ƒå¤ªè¿‡é‡è¦ï¼Œä»¥è‡³äºé’ˆå¯¹ POP <strong>å’Œ</strong> å¼•ç”¨/å€¼ç±»å‹çš„è®¨è®º<strong>åŒæ—¶</strong>å‡ºç°åœ¨è¿™äº›åœ°æ–¹ï¼š  </p><ol><li>WWDC 2015 å±•ç¤ºçš„ <a href="https://developer.apple.com/videos/play/wwdc2015/408/?time=2558" target="_blank" rel="noopener"><strong>â€œProtocol-Oriented Programming in Swiftâ€</strong></a>  </li><li>WWDC 2015 å±•ç¤ºçš„ <a href="https://developer.apple.com/videos/play/wwdc2015-414/?time=48" target="_blank" rel="noopener"><strong>â€œBuilding Better Apps with Value Types in Swiftâ€</strong></a>  </li><li>WWDC 2016 å±•ç¤ºçš„ <a href="https://developer.apple.com/videos/play/wwdc2016-419/?time=340" target="_blank" rel="noopener"><strong>â€œProtocol and Value Oriented Programming in UIKit Appsâ€</strong></a>  </li></ol><p>æˆ‘ä¼šç»™ä½ ä¸€ä¸ªæç¤ºå’Œä½œä¸šâ€¦â€¦å‡è®¾ä½ æœ‰å¤šä¸ªæŒ‡å‘åŒä¸€ä¸ªç±»å®ä¾‹çš„å¼•ç”¨ï¼Œç”¨äºä¿®æ”¹æˆ–â€œæ”¹å˜â€å±æ€§ã€‚è¿™äº›å¼•ç”¨æŒ‡å‘ç›¸åŒçš„æ•°æ®å—ï¼Œå› æ­¤å°†å…¶ç§°ä¸ºâ€œå…±äº«â€æ•°æ®å¹¶ä¸å¤¸å¼ ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå…±äº«æ•°æ®å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ï¼Œå¦‚ä¸‹é¢çš„ç¤ºä¾‹æ‰€ç¤ºã€‚è¿™æ˜¯å¦è¡¨ç¤ºæˆ‘ä»¬è¦å°†æ‰€æœ‰çš„ä»£ç æ”¹æˆå€¼ç±»å‹ï¼Ÿ<strong>å¹¶ä¸æ˜¯ï¼</strong>å°±åƒ Apple çš„ä¸€ä¸ªå·¥ç¨‹å¸ˆæŒ‡å‡ºï¼š<a href="https://developer.apple.com/videos/play/wwdc2015-408/?time=2566" target="_blank" rel="noopener"><strong>â€œä¾‹å¦‚ï¼Œä»¥ Window ä¸ºä¾‹ã€‚å¤åˆ¶ä¸€ä¸ª Window æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿâ€</strong></a> æŸ¥çœ‹ä¸‹é¢çš„ä»£ç ï¼Œå¹¶æ€è€ƒè¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="å¼•ç”¨ç±»å‹"><a href="#å¼•ç”¨ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹"></a>å¼•ç”¨ç±»å‹</h3><p>ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ¥è‡ª Xcode playgroundï¼Œåœ¨åˆ›å»ºå¯¹è±¡å‰¯æœ¬ç„¶åæ›´æ”¹å±æ€§æ—¶ï¼Œä¼šé‡åˆ°ä¸€ä¸ªæœ‰è¶£çš„éš¾é¢˜ã€‚ä½ èƒ½æ‰¾åˆ°é—®é¢˜ä¹ˆï¼Ÿæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚  </p><p>è¿™æ®µä»£ç åŒæ—¶ä¹Ÿæ¼”ç¤ºäº†åè®®çš„å®šä¹‰å’Œ <code>extension</code>ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¼•ç”¨ç±»å‹ï¼šæ¯ä¸ªäººéƒ½ä½¿ç”¨ç±»å¾ˆé•¿æ—¶é—´äº† </span></span><br><span class="line"><span class="comment">// -- æƒ³æƒ³ COCOA ä¸­è¿›è¡Œçš„æ‰€æœ‰éšå¼å¤åˆ¶ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">ObjectThatFlies</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flightTerminology: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fly</span><span class="params">()</span></span> <span class="comment">// ä¸éœ€è¦æä¾›å®ç°ï¼Œé™¤éæˆ‘æƒ³</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ObjectThatFlies</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fly</span><span class="params">()</span></span> -&gt; <span class="type">Void</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> myType = <span class="type">String</span>(describing: type(of: <span class="keyword">self</span>))</span><br><span class="line">        <span class="keyword">let</span> flightTerminologyForType = myType + <span class="string">" "</span> + flightTerminology + <span class="string">"\n"</span></span><br><span class="line">        <span class="built_in">print</span>(flightTerminologyForType)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span> : <span class="title">ObjectThatFlies</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flightTerminology: <span class="type">String</span> = <span class="string">"flies WITH feathers, and flaps wings differently than bats"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bat</span> : <span class="title">ObjectThatFlies</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flightTerminology: <span class="type">String</span> = <span class="string">"flies WITHOUT feathers, and flaps wings differently than birds"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼•ç”¨ç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bat = <span class="type">Bat</span>()</span><br><span class="line">bat.fly()</span><br><span class="line"><span class="comment">// "Bat flies WITHOUT feathers, and flaps wings differently than birds"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bird = <span class="type">Bird</span>()</span><br><span class="line">bird.fly()</span><br><span class="line"><span class="comment">// "Bird flies WITH feathers, and flaps wings differently than bats"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> batCopy = bat</span><br><span class="line">batCopy.fly()</span><br><span class="line"><span class="comment">// "Bird flies WITH feathers, and flaps wings differently than bats"</span></span><br><span class="line"></span><br><span class="line">batCopy.flightTerminology = <span class="string">""</span></span><br><span class="line">batCopy.fly()</span><br><span class="line"><span class="comment">// æ§åˆ¶å°è¾“å‡º "Bat"</span></span><br><span class="line"></span><br><span class="line">bat.fly()</span><br><span class="line"><span class="comment">// æ§åˆ¶å°è¾“å‡º "Bat"</span></span><br></pre></td></tr></table></figure><p><strong><em>æ¥è‡ªå‰é¢ä»£ç ç‰‡æ®µçš„æ§åˆ¶å°è¾“å‡º</em></strong>  </p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Bat flies WITHOUT feathers, and flaps wings differently than birds</span><br><span class="line"></span><br><span class="line">Bird flies WITH feathers, and flaps wings differently than bats</span><br><span class="line"></span><br><span class="line">Bird flies WITH feathers, and flaps wings differently than bats</span><br><span class="line"></span><br><span class="line">Bat</span><br><span class="line"></span><br><span class="line">Bat</span><br></pre></td></tr></table></figure><h3 id="å€¼ç±»å‹"><a href="#å€¼ç±»å‹" class="headerlink" title="å€¼ç±»å‹"></a>å€¼ç±»å‹</h3><p>åœ¨æ¥ä¸‹æ¥çš„ Swift ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>struct</code> æ›¿ä»£ <code>class</code>ã€‚åœ¨è¿™é‡Œï¼Œä»£ç çœ‹èµ·æ¥æ›´å®‰å…¨ï¼Œè€Œ Apple ä¼¼ä¹åœ¨æ¨å¹¿å€¼ç±»å‹å’Œ POPã€‚æ³¨æ„ï¼Œ<a href="https://developer.apple.com/videos/play/wwdc2015/408/?time=2677" target="_blank" rel="noopener"><strong>ä»–ä»¬ç›®å‰è¿˜æ²¡æœ‰æ”¾å¼ƒ <code>class</code></strong></a>ã€‚  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿™æ˜¯èŒƒå¼è½¬å˜çš„èµ·ç‚¹ï¼Œä¸ä»…ä»…æ˜¯åè®®ï¼Œè¿˜æœ‰å€¼ç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">ObjectThatFlies</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flightTerminology: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fly</span><span class="params">()</span></span> <span class="comment">// ä¸éœ€è¦æä¾›å®ç°ï¼Œé™¤éæˆ‘æƒ³</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ObjectThatFlies</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fly</span><span class="params">()</span></span> -&gt; <span class="type">Void</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> myType = <span class="type">String</span>(describing: type(of: <span class="keyword">self</span>))</span><br><span class="line">        <span class="keyword">let</span> flightTerminologyForType = myType + <span class="string">" "</span> + flightTerminology + <span class="string">"\n"</span></span><br><span class="line">        <span class="built_in">print</span>(flightTerminologyForType)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Bird</span> : <span class="title">ObjectThatFlies</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flightTerminology: <span class="type">String</span> = <span class="string">"flies WITH feathers, and flaps wings differently than bats"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Bat</span> : <span class="title">ObjectThatFlies</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flightTerminology: <span class="type">String</span> = <span class="string">"flies WITHOUT feathers, and flaps wings differently than birds"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å€¼ç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bat = <span class="type">Bat</span>()</span><br><span class="line">bat.fly()</span><br><span class="line"><span class="comment">// "Bat flies WITHOUT feathers, and flaps wings differently than birds"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bird = <span class="type">Bird</span>()</span><br><span class="line">bird.fly()</span><br><span class="line"><span class="comment">// "Bird flies WITH feathers, and flaps wings differently than bats"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> batCopy = bat</span><br><span class="line">batCopy.fly()</span><br><span class="line"><span class="comment">// "Bird flies WITH feathers, and flaps wings differently than bats"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ‘åœ¨è¿™é‡Œå¯¹ Bat å®ä¾‹æ‰€åšçš„äº‹æƒ…æ˜¯æ˜¾è€Œæ˜“è§çš„</span></span><br><span class="line">batCopy.flightTerminology = <span class="string">""</span></span><br><span class="line">batCopy.fly()</span><br><span class="line"><span class="comment">// æ§åˆ¶å°è¾“å‡º "Bat"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½†æ˜¯ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å€¼ç±»å‹ï¼Œæ‰€ä»¥ Bat å®ä¾‹çš„åŸå§‹æ•°æ®å¹¶æ²¡æœ‰å› ä¸ºä¹‹å‰çš„æ“ä½œè€Œè¢«ç¯¡æ”¹ã€‚</span></span><br><span class="line">bat.fly()</span><br><span class="line"><span class="comment">// "Bat flies WITHOUT feathers, and flaps wings differently than birds"</span></span><br></pre></td></tr></table></figure><p><strong><em>æ¥è‡ªå‰é¢ä»£ç ç‰‡æ®µçš„æ§åˆ¶å°è¾“å‡º</em></strong>  </p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Bat flies WITHOUT feathers, and flaps wings differently than birds</span><br><span class="line"></span><br><span class="line">Bird flies WITH feathers, and flaps wings differently than bats</span><br><span class="line"></span><br><span class="line">Bat flies WITHOUT feathers, and flaps wings differently than birds</span><br><span class="line"></span><br><span class="line">Bat </span><br><span class="line"></span><br><span class="line">Bat flies WITHOUT feathers, and flaps wings differently than birds</span><br></pre></td></tr></table></figure><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><p>æˆ‘å†™äº†ä¸€äº›é¢å‘åè®®çš„ä»£ç ã€‚è¯·é€šè¯»ä»£ç ï¼Œé˜…è¯»å†…è”æ³¨é‡Šï¼Œé˜…è¯»é™„å¸¦çš„æ–‡ç« ï¼Œè·Ÿéšæˆ‘çš„è¶…é“¾æ¥ï¼Œå¹¶å……åˆ†ç†è§£æˆ‘åœ¨åšä»€ä¹ˆã€‚ä½ å°†åœ¨ä¸‹ä¸€ç¯‡å…³äº POP çš„æ–‡ç« ä¸­ç”¨åˆ°å®ƒã€‚  </p><h3 id="é‡‡ç”¨å¤šç§åè®®"><a href="#é‡‡ç”¨å¤šç§åè®®" class="headerlink" title="é‡‡ç”¨å¤šç§åè®®"></a>é‡‡ç”¨å¤šç§åè®®</h3><p>åˆšå¼€å§‹å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘å¾ˆè´ªå¿ƒï¼Œæƒ³è¦è‡ªå®šä¹‰ä¸€ä¸ªåè®®ï¼Œä½¿å®ƒèƒ½<strong><em>åŒæ—¶</em></strong>ä½“ç° Apple çš„å†…ç½®åè®® <code>Equatable</code> å’Œ <code>Comparable</code>ï¼š  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">IsEqualAndComparable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> == <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> != <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &gt; <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &lt; (lhs: Self, rhs: Self) -&gt; <span class="title">Bool</span></span></span><br><span class="line"><span class="function">    </span></span><br><span class="line"><span class="function">    <span class="title">static</span> <span class="title">func</span> &gt;= <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &lt;= (lhs: Self, rhs: Self) -&gt; <span class="title">Bool</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure><p>æˆ‘æ„è¯†åˆ°åº”è¯¥å°†å®ƒä»¬åˆ†å¼€ï¼Œä½¿æˆ‘çš„ä»£ç å°½å¯èƒ½çµæ´»ã€‚ä¸ºä»€ä¹ˆä¸å‘¢ï¼ŸApple å£°æ˜åŒä¸€ä¸ªç±»ï¼Œç»“æ„ä½“ï¼Œæšä¸¾å¯ä»¥éµå¾ªå¤šä¸ªåè®®ï¼Œå°±åƒæ¥ä¸‹æ¥æˆ‘ä»¬å°†çœ‹åˆ°çš„ä¸€æ ·ã€‚ä¸‹é¢æ˜¯æˆ‘æå‡ºçš„ä¸¤ä¸ªåè®®ï¼š  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">IsEqual</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> == <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> != <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Comparable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &gt; <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &lt; (lhs: Self, rhs: Self) -&gt; <span class="title">Bool</span></span></span><br><span class="line"><span class="function">    </span></span><br><span class="line"><span class="function">    <span class="title">static</span> <span class="title">func</span> &gt;= <span class="params">(lhs: <span class="keyword">Self</span>, rhs: <span class="keyword">Self</span>)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &lt;= (lhs: Self, rhs: Self) -&gt; <span class="title">Bool</span></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="è®°ä½ä½ çš„ç®—æ³•"><a href="#è®°ä½ä½ çš„ç®—æ³•" class="headerlink" title="è®°ä½ä½ çš„ç®—æ³•"></a>è®°ä½ä½ çš„ç®—æ³•</h3><p>ä½ éœ€è¦ç£¨ç»ƒçš„ä¸€é¡¹é‡è¦æŠ€èƒ½æ˜¯ç¼–ç¨‹çš„ç®—æ³•ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºä»£ç ã€‚æˆ‘ä¿è¯åœ¨å°†æ¥çš„æŸä¸€å¤©ï¼Œä¼šæœ‰äººç»™ä½ ä¸€ä¸ªå¤æ‚è¿‡ç¨‹çš„å£å¤´æè¿°å¹¶è¦æ±‚ä½ å¯¹å®ƒè¿›è¡Œç¼–ç ã€‚ç”¨äººç±»è¯­è¨€æè¿°æŸäº›æ­¥éª¤ï¼Œä¹‹åç”¨è½¯ä»¶å°†å…¶å®ç°ï¼Œå®ƒä»¬ä¹‹é—´ä¸€èˆ¬éƒ½ä¼šæœ‰å¾ˆå¤§çš„å·®è·ã€‚å½“æˆ‘æƒ³è¦å°† <code>IsEqual</code> å’Œ <code>Comparable</code> åº”ç”¨äºè¡¨ç¤ºç›´çº¿ï¼ˆå‘é‡ï¼‰çš„ç±»æ—¶ï¼Œæˆ‘æ„è¯†åˆ°äº†è¿™ä¸€ç‚¹ã€‚æˆ‘è®°å¾—è®¡ç®—ä¸€ä¸ªç›´çº¿çš„é•¿åº¦æ˜¯åŸºäºå‹¾è‚¡å®šç†çš„ï¼ˆå‚è€ƒ <a href="https://orion.math.iastate.edu/dept/links/formulas/form2.pdf" target="_blank" rel="noopener"><strong>è¿™é‡Œ</strong></a>å’Œ <a href="https://www.mathwarehouse.com/algebra/distance_formula/index.php" target="_blank" rel="noopener"><strong>è¿™é‡Œ</strong></a>ï¼‰ï¼Œå¹¶ä¸”å¯¹å‘é‡ä½¿ç”¨ <code>==</code>ï¼Œ<code>!=</code>ï¼Œ<code>&lt;</code>ï¼Œ<code>&gt;</code>ï¼Œ<code>&lt;=</code>ï¼Œå’Œ <code>&gt;=</code> è¿™äº›è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œç›´çº¿çš„é•¿åº¦æ˜¯å¿…é¡»çš„ã€‚æˆ‘çš„ <code>Line</code> ç±»è¿Ÿæ—©ä¼šæ´¾ä¸Šç”¨åœºï¼Œä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç»˜å›¾åº”ç”¨ç¨‹åºæˆ–æ¸¸æˆä¸­ï¼Œç”¨æˆ·ç‚¹å‡»å±å¹•ä¸Šçš„ä¸¤ä¸ªä½ç½®ï¼Œåœ¨ä¸¤ç‚¹ä¹‹é—´åˆ›å»ºä¸€æ¡çº¿ã€‚</p><h3 id="è‡ªå®šä¹‰ç±»é‡‡ç”¨å¤šä¸ªåè®®"><a href="#è‡ªå®šä¹‰ç±»é‡‡ç”¨å¤šä¸ªåè®®" class="headerlink" title="è‡ªå®šä¹‰ç±»é‡‡ç”¨å¤šä¸ªåè®®"></a>è‡ªå®šä¹‰ç±»é‡‡ç”¨å¤šä¸ªåè®®</h3><p>è¿™æ˜¯æˆ‘çš„ <code>Line</code> ç±»ï¼Œå®ƒé‡‡ç”¨äº†ä¸¤ä¸ªåè®®ï¼Œ<code>IsEqual</code> å’Œ <code>Comparable</code>ï¼ˆå¦‚ä¸‹ï¼‰ã€‚è¿™æ˜¯å¤šç»§æ‰¿çš„ä¸€ç§å½¢å¼ï¼  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Line</span> : <span class="title">IsEqual</span>, <span class="title">Comparable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> beginPoint:<span class="type">CGPoint</span></span><br><span class="line">    <span class="keyword">var</span> endPoint:<span class="type">CGPoint</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        beginPoint = <span class="type">CGPoint</span>(x: <span class="number">0</span>, y: <span class="number">0</span>);</span><br><span class="line">        endPoint = <span class="type">CGPoint</span>(x: <span class="number">0</span>, y: <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(beginPoint:<span class="type">CGPoint</span>, endPoint:<span class="type">CGPoint</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">self</span>.beginPoint = <span class="type">CGPoint</span>( x: beginPoint.x, y: beginPoint.y )</span><br><span class="line">        <span class="keyword">self</span>.endPoint = <span class="type">CGPoint</span>( x: endPoint.x, y: endPoint.y )</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// çº¿é•¿çš„è®¡ç®—åŸºäºå‹¾è‚¡å®šç†ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">length</span> <span class="params">()</span></span> -&gt; <span class="type">CGFloat</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> length = sqrt( pow(endPoint.x - beginPoint.x, <span class="number">2</span>) + pow(endPoint.y - beginPoint.y, <span class="number">2</span>) )</span><br><span class="line">        <span class="keyword">return</span> length</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> == <span class="params">(leftHandSideLine: Line, rightHandSideLine: Line)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (leftHandSideLine.length() == rightHandSideLine.length())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> != <span class="params">(leftHandSideLine: Line, rightHandSideLine: Line)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (leftHandSideLine.length() != rightHandSideLine.length())</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &gt; <span class="params">(leftHandSideLine: Line, rightHandSideLine: Line)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (leftHandSideLine.length() &gt; rightHandSideLine.length())</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &lt; (leftHandSideLine: Line, rightHandSideLine: Line) -&gt; <span class="title">Bool</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (leftHandSideLine.length() &lt; rightHandSideLine.length())</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &gt;= <span class="params">(leftHandSideLine: Line, rightHandSideLine: Line)</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (leftHandSideLine.length() &gt;= rightHandSideLine.length())</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> &lt;= (leftHandSideLine: Line, rightHandSideLine: Line) -&gt; <span class="title">Bool</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (leftHandSideLine.length() &lt;= rightHandSideLine.length())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="comment">// ç±»çš„ç»“æŸè¡Œï¼šIsEqual, Comparable</span></span><br></pre></td></tr></table></figure><h3 id="éªŒè¯ä½ çš„ç®—æ³•"><a href="#éªŒè¯ä½ çš„ç®—æ³•" class="headerlink" title="éªŒè¯ä½ çš„ç®—æ³•"></a>éªŒè¯ä½ çš„ç®—æ³•</h3><p>æˆ‘ä½¿ç”¨ç”µå­åˆ¶è¡¨è½¯ä»¶ Apple Numbersï¼Œå¹¶å‡†å¤‡äº†ä¸¤ä¸ªå‘é‡çš„å¯è§†åŒ–è¡¨ç¤ºï¼Œå¯¹ <code>Line</code> ç±»çš„ <code>length()</code> æ–¹æ³•åšäº†ä¸€äº›åŸºæœ¬æµ‹è¯•ï¼š  </p><p><img src="https://www.appcoda.com/wp-content/uploads/2018/03/swift-pop-1.png" alt>  </p><p>è¿™é‡Œæ˜¯æˆ‘æ ¹æ®ä¸Šé¢å›¾è¡¨ä¸­çš„ç‚¹ï¼Œå†™çš„æµ‹è¯•ä»£ç ï¼š  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> x1 = <span class="type">CGPoint</span>(x: <span class="number">0</span>, y: <span class="number">0</span>)</span><br><span class="line"><span class="keyword">let</span> y1 = <span class="type">CGPoint</span>(x: <span class="number">2</span>, y: <span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> line1 = <span class="type">Line</span>(beginPoint: x1, endPoint: y1)</span><br><span class="line">line1.length()</span><br><span class="line"><span class="comment">// returns 2.82842712474619</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> x2 = <span class="type">CGPoint</span>(x: <span class="number">3</span>, y: <span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> y2 = <span class="type">CGPoint</span>(x: <span class="number">5</span>, y: <span class="number">4</span>)</span><br><span class="line"><span class="keyword">let</span> line2 = <span class="type">Line</span>(beginPoint: x2, endPoint: y2)</span><br><span class="line">line2.length()</span><br><span class="line"><span class="comment">// returns 2.82842712474619</span></span><br><span class="line"></span><br><span class="line">line1 == line2</span><br><span class="line"><span class="comment">// returns true</span></span><br><span class="line">line1 != line2</span><br><span class="line"><span class="comment">// returns false</span></span><br><span class="line">line1 &gt; line2</span><br><span class="line"><span class="comment">// returns false</span></span><br><span class="line">line1 &lt;= line2</span><br><span class="line"><span class="comment">// returns true</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-Xcode-â€œSingle-Viewâ€-playground-æ¨¡ç‰ˆæµ‹è¯•-åŸå‹åŒ–-UI"><a href="#ä½¿ç”¨-Xcode-â€œSingle-Viewâ€-playground-æ¨¡ç‰ˆæµ‹è¯•-åŸå‹åŒ–-UI" class="headerlink" title="ä½¿ç”¨ Xcode â€œSingle Viewâ€ playground æ¨¡ç‰ˆæµ‹è¯•/åŸå‹åŒ– UI"></a>ä½¿ç”¨ Xcode â€œSingle Viewâ€ playground æ¨¡ç‰ˆæµ‹è¯•/åŸå‹åŒ– UI</h3><p>ä½ æ˜¯å¦çŸ¥é“å¯ä»¥ä½¿ç”¨ Xcode 9 <code>Single View</code> playground æ¨¡æ¿æ¥åŸå‹åŒ–å’Œæµ‹è¯•ç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰ï¼Ÿå®ƒéå¸¸æ£’ - å¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´å¹¶å¿«é€ŸåŸå‹åŒ–çš„å·¥å…·ã€‚ä¸ºäº†æ›´å¥½çš„æµ‹è¯•æˆ‘çš„ <code>Line</code> ç±»ï¼Œæˆ‘åˆ›å»ºäº†è¿™æ ·ä¸€ä¸ª playgroundã€‚<strong>ä½œä¸šï¼šåœ¨æˆ‘è§£é‡Šä¹‹å‰ï¼Œæˆ‘æƒ³è®©ä½ è‡ªå·±è¯•ä¸€ä¸‹ã€‚</strong>æˆ‘<strong>å°†</strong>å‘ä½ å±•ç¤ºæˆ‘çš„ playground ä»£ç ã€æ¨¡æ‹Ÿå™¨è¾“å‡ºå’Œæˆ‘çš„ Swift æµ‹è¯•è¯­å¥ã€‚  </p><p>è¿™é‡Œæ˜¯æˆ‘çš„ playground ä»£ç ï¼š  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> PlaygroundSupport</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LineDrawingView</span>: <span class="title">UIView</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">draw</span><span class="params">(<span class="number">_</span> rect: CGRect)</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> currGraphicsContext = <span class="type">UIGraphicsGetCurrentContext</span>()</span><br><span class="line">        currGraphicsContext?.setLineWidth(<span class="number">2.0</span>)</span><br><span class="line">        currGraphicsContext?.setStrokeColor(<span class="type">UIColor</span>.blue.cgColor)</span><br><span class="line">        currGraphicsContext?.move(to: <span class="type">CGPoint</span>(x: <span class="number">40</span>, y: <span class="number">400</span>))</span><br><span class="line">        currGraphicsContext?.addLine(to: <span class="type">CGPoint</span>(x: <span class="number">320</span>, y: <span class="number">40</span>))</span><br><span class="line">        currGraphicsContext?.strokePath()</span><br><span class="line">        </span><br><span class="line">        currGraphicsContext?.setLineWidth(<span class="number">4.0</span>)</span><br><span class="line">        currGraphicsContext?.setStrokeColor(<span class="type">UIColor</span>.red.cgColor)</span><br><span class="line">        currGraphicsContext?.move(to: <span class="type">CGPoint</span>(x: <span class="number">40</span>, y: <span class="number">400</span>))</span><br><span class="line">        currGraphicsContext?.addLine(to: <span class="type">CGPoint</span>(x: <span class="number">320</span>, y: <span class="number">60</span>))</span><br><span class="line">        currGraphicsContext?.strokePath()</span><br><span class="line">        </span><br><span class="line">        currGraphicsContext?.setLineWidth(<span class="number">6.0</span>)</span><br><span class="line">        currGraphicsContext?.setStrokeColor(<span class="type">UIColor</span>.green.cgColor)</span><br><span class="line">        currGraphicsContext?.move(to: <span class="type">CGPoint</span>(x: <span class="number">40</span>, y: <span class="number">400</span>))</span><br><span class="line">        currGraphicsContext?.addLine(to: <span class="type">CGPoint</span>(x: <span class="number">250</span>, y: <span class="number">80</span>))</span><br><span class="line">        currGraphicsContext?.strokePath()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyViewController</span> : <span class="title">UIViewController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">loadView</span><span class="params">()</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">LineDrawingView</span>()</span><br><span class="line">        view.backgroundColor = .white</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.view = view</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨å®æ—¶è§†å›¾çª—å£ä¸­æ˜¾ç¤ºè§†å›¾æ§åˆ¶å™¨</span></span><br><span class="line"><span class="type">PlaygroundPage</span>.current.liveView = <span class="type">MyViewController</span>()</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æˆ‘åœ¨ playground æ¨¡æ‹Ÿå™¨ä¸Šçš„è§†å›¾è¾“å‡ºï¼š  </p><p><img src="https://www.appcoda.com/wp-content/uploads/2018/03/swift-pop-2.png" alt>  </p><p>ä¸‹é¢æ˜¯æµ‹è¯•æˆ‘çš„ <code>Line</code> ç±»å‹å®ä¾‹ä¸æˆ‘åœ¨ playground ä¸Šæ‰€ç”»å‘é‡åŒ¹é…çš„ Swift ä»£ç ï¼š  </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> xxBlue = <span class="type">CGPoint</span>(x: <span class="number">40</span>, y: <span class="number">400</span>)</span><br><span class="line"><span class="keyword">let</span> yyBlue = <span class="type">CGPoint</span>(x: <span class="number">320</span>, y: <span class="number">40</span>)</span><br><span class="line"><span class="keyword">let</span> lineBlue = <span class="type">Line</span>(beginPoint: xxBlue, endPoint: yyBlue)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xxRed = <span class="type">CGPoint</span>(x: <span class="number">40</span>, y: <span class="number">400</span>)</span><br><span class="line"><span class="keyword">let</span> yyRed = <span class="type">CGPoint</span>(x: <span class="number">320</span>, y: <span class="number">60</span>)</span><br><span class="line"><span class="keyword">let</span> lineRed = <span class="type">Line</span>(beginPoint: xxRed, endPoint: yyRed)</span><br><span class="line">lineRed.length()</span><br><span class="line"><span class="comment">// returns 440.454310910905</span></span><br><span class="line"></span><br><span class="line">lineBlue != lineRed</span><br><span class="line"><span class="comment">// returns true</span></span><br><span class="line">lineBlue &gt; lineRed</span><br><span class="line"><span class="comment">// returns true</span></span><br><span class="line">lineBlue &gt;= lineRed</span><br><span class="line"><span class="comment">// returns true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xxGreen = <span class="type">CGPoint</span>(x: <span class="number">40</span>, y: <span class="number">400</span>)</span><br><span class="line"><span class="keyword">let</span> yyGreen = <span class="type">CGPoint</span>(x: <span class="number">250</span>, y: <span class="number">80</span>)</span><br><span class="line"><span class="keyword">let</span> lineGreen = <span class="type">Line</span>(beginPoint: xxGreen, endPoint: yyGreen)</span><br><span class="line">lineGreen.length()</span><br><span class="line"><span class="comment">// returns 382.753184180093</span></span><br><span class="line">lineGreen &lt; lineBlue</span><br><span class="line"><span class="comment">// returns true</span></span><br><span class="line">lineGreen &lt;= lineRed</span><br><span class="line"><span class="comment">// returns true</span></span><br><span class="line">lineGreen &gt; lineBlue</span><br><span class="line"><span class="comment">// returns false</span></span><br><span class="line">lineGreen &gt;= lineBlue</span><br><span class="line"><span class="comment">// returns false</span></span><br><span class="line">lineGreen == lineGreen</span><br><span class="line"><span class="comment">// returns true</span></span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘å¸Œæœ›ä½ å–œæ¬¢ä»Šå¤©çš„æ–‡ç« ï¼Œå¹¶ä¸”éå¸¸æœŸå¾…é˜…è¯»æœ¬æ–‡çš„â€œç¬¬äºŒéƒ¨åˆ†â€ã€‚è®°ä½ï¼Œæˆ‘ä»¬å°†æ·±å…¥ç ”ç©¶ä½¿ç”¨ POP çš„å…ˆè¿›åº”ç”¨ç¨‹åºï¼ŒèŒƒå‹åè®®ï¼Œä»å¼•ç”¨ç±»å‹åˆ°å€¼ç±»å‹èƒŒåçš„åŠ¨æœºï¼Œåˆ—ä¸¾ POP çš„ä¼˜ç¼ºç‚¹ï¼Œåˆ—ä¸¾ OOP çš„ä¼˜ç¼ºç‚¹ï¼Œæ¯”è¾ƒ OOP å’Œ POPï¼Œç¡®å®šä¸ºä»€ä¹ˆâ€œSwift æ˜¯é¢å‘åè®®çš„â€ï¼Œå¹¶æ·±å…¥ç ”ç©¶ç§°ä¸ºâ€œå±€éƒ¨æ¨ç†â€çš„æ¦‚å¿µã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      å¯¹é¢å‘åè®®ç¼–ç¨‹ï¼Œåšäº†ä¸€ä¸ªç®€å•çš„å¼•è¨€ï¼Œä¸ºç¬¬äºŒç¯‡æ–‡ç« åšå‡†å¤‡å·¥ä½œã€‚
    
    </summary>
    
      <category term="POP" scheme="https://swift.gg/categories/POP/"/>
    
      <category term="SWIFT" scheme="https://swift.gg/categories/POP/SWIFT/"/>
    
    
      <category term="æ•™ç¨‹" scheme="https://swift.gg/tags/%E6%95%99%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Swift å…³é”®å­—</title>
    <link href="https://swift.gg/2019/08/22/Swift-Keywords/"/>
    <id>https://swift.gg/2019/08/22/Swift-Keywords/</id>
    <published>2019-08-22T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šJordan Morganï¼Œ<a href="https://www.swiftjectivec.com/swift-keywords-v-3-0-1/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-02-11<br>è¯‘è€…ï¼š<a href="https://www.jianshu.com/u/076cc5e18bb8" target="_blank" rel="noopener">éƒ‘ä¸€ä¸€</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles" target="_blank" rel="noopener">pmst</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>æœ‰å¥è¯ä¹‹å‰æˆ‘æè¿‡ï¼Œä»Šå¤©è¿˜æƒ³å†è¯´ä¸€æ¬¡ã€‚é‚£å°±æ˜¯æ‰“é“è¿˜éœ€è‡ªèº«ç¡¬ã€‚å¯¹äºè‡ªèº«èƒ½åŠ›çš„ä¸¥æ ¼è¦æ±‚ï¼Œå¯ä»¥å¸®åŠ©å®ç°æˆ‘ä»¬æ‰€æœ‰æ¢¦å¯ä»¥æ±‚çš„ä¸œè¥¿ã€‚</p><p>è¯´èµ·æ¥å¯èƒ½æœ‰äº›æ¶ˆæï¼ŒçŸ¥è¯†æ¯•ç«Ÿæ˜¯æ°¸è¿œå­¦ä¸å®Œçš„ã€‚ä¸è®ºå¦‚ä½•ï¼Œä»Šå¤© <a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/LexicalStructure.html" target="_blank" rel="noopener">æˆ‘ä»¬å…ˆæ¥å­¦ä¹ ä¸€ä¸‹ Swift ä¸­çš„æ¯ä¸€ä¸ªå…³é”®å­—</a>ï¼ˆV3.0.1ï¼‰ï¼Œåœ¨ä»‹ç»æ¯ä¸ªå…³é”®å­—çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šé™„å¸¦ä¸€æ®µä»£ç åŠ ä»¥è¯´æ˜ã€‚</p><p>åœ¨è¿™äº›å…³é”®å­—ä¹‹ä¸­ï¼Œä¼šæœ‰ä½ ç†Ÿæ‚‰æˆ–è€…ä¸ç†Ÿæ‚‰çš„éƒ¨åˆ†ã€‚ä½†ä¸ºäº†æœ€å¥½çš„é˜…è¯»å’Œå­¦ä¹ ä½“éªŒï¼Œæˆ‘æŠŠå®ƒä»¬å…¨éƒ¨åˆ—å‡ºæ¥äº†ã€‚æ–‡ç« ç¯‡å¹…æœ‰äº›é•¿ï¼Œä½ å‡†å¤‡å¥½äº†ä¹ˆï¼Ÿ</p><p>è®©æˆ‘ä»¬ç°åœ¨å°±å¼€å§‹å§ã€‚</p><a id="more"></a><h2 id="å£°æ˜å¼å…³é”®å­—"><a href="#å£°æ˜å¼å…³é”®å­—" class="headerlink" title="å£°æ˜å¼å…³é”®å­—"></a>å£°æ˜å¼å…³é”®å­—</h2><p><strong>associatedtype</strong>ï¼šåœ¨åè®®ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªç±»å‹çš„å ä½ç¬¦åç§°ã€‚ç›´åˆ°åè®®è¢«å®ç°ï¼Œè¯¥å ä½ç¬¦æ‰ä¼šè¢«æŒ‡å®šå…·ä½“çš„ç±»å‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Entertainment</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">MediaType</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> : <span class="title">Entertainment</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">MediaType</span> = <span class="type">String</span> <span class="comment">//å¯ä»¥æŒ‡å®šä»»æ„ç±»å‹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>class</strong>ï¼šé€šç”¨ã€çµæ´»çš„ç»“æ„ä½“ï¼Œæ˜¯ç¨‹åºçš„åŸºç¡€ç»„æˆéƒ¨åˆ†ã€‚ä¸ struct ç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼š</p><ul><li>å…è®¸ä¸€ä¸ªç±»ç»§æ‰¿å¦ä¸€ä¸ªç±»çš„ç‰¹æ€§ã€‚</li><li>ç±»å‹è½¬æ¢ï¼Œå…è®¸åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’ŒæŒ‡å®šä¸€ä¸ªç±»çš„å®é™…ç±»å‹ã€‚</li><li>ææ„æ–¹æ³•å…è®¸ç±»çš„å®ä¾‹é‡Šæ”¾æ‰€æœ‰èµ„æºã€‚</li><li>å¼•ç”¨è®¡æ•°å…è®¸å¤šä¸ªå¼•ç”¨æŒ‡å‘ä¸€ä¸ªå®ä¾‹ã€‚</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span>  </span><br><span class="line">    <span class="keyword">var</span> age:<span class="type">Int</span>  </span><br><span class="line">    <span class="keyword">var</span> gender:<span class="type">String</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>deinit</strong>ï¼šå½“ä¸€ä¸ªç±»çš„å®ä¾‹å³å°†è¢«é”€æ¯æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span>  </span><br><span class="line">    <span class="keyword">var</span> age:<span class="type">Int</span>  </span><br><span class="line">    <span class="keyword">var</span> gender:<span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="comment">//ä»å †ä¸­é‡Šæ”¾ï¼Œå¹¶é‡Šæ”¾çš„èµ„æº</span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>enum</strong>ï¼šå®šä¹‰äº†åŒ…å«ä¸€ç»„æœ‰å…³è”çš„å€¼çš„ç±»å‹ï¼Œå¹¶å¯ä»¥ä»¥ä¸€ç§ç±»å‹å®‰å…¨çš„æ–¹å¼ä½¿ç”¨è¿™äº›å€¼ã€‚åœ¨ Swift ä¸­ï¼Œæšä¸¾æ˜¯ä¸€ç­‰ç±»å‹ï¼Œæ‹¥æœ‰åœ¨å…¶å®ƒè¯­è¨€ä¸­åªæœ‰ class æ‰ä¼šæ”¯æŒçš„ç‰¹æ€§ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Gender</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">case</span> male  </span><br><span class="line">    <span class="keyword">case</span> female  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>extension</strong>ï¼šå…è®¸ç»™å·²æœ‰çš„ç±»ã€ç»“æ„ä½“ã€æšä¸¾ã€åè®®ç±»å‹ï¼Œæ·»åŠ æ–°åŠŸèƒ½ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span> = <span class="string">""</span>  </span><br><span class="line">    <span class="keyword">var</span> age:<span class="type">Int</span> = <span class="number">0</span>  </span><br><span class="line">    <span class="keyword">var</span> gender:<span class="type">String</span> = <span class="string">""</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printInfo</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"My name is \(name), I'm \(age) years old and I'm a \(gender)."</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>fileprivate</strong>ï¼šè®¿é—®æ§åˆ¶æƒé™ï¼Œåªå…è®¸åœ¨å®šä¹‰æºæ–‡ä»¶ä¸­è®¿é—®ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> jobTitle:<span class="type">String</span> = <span class="string">""</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">//å½“ extension å’Œ class åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­æ—¶ï¼Œå…è®¸è®¿é—®</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printJobTitle</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"My job is (jobTitle)"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>func</strong>ï¼šåŒ…å«ç”¨äºæ‰§è¡Œç‰¹å®šä»»åŠ¡çš„ä»£ç å—ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addNumbers</span><span class="params">(num1:Int, num2:Int)</span></span> -&gt; <span class="type">Int</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">return</span> num1+num2  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>import</strong>ï¼šå¼•å…¥ä¸€ä¸ªä»¥ç‹¬ç«‹å•å…ƒæ„å»ºçš„æ¡†æ¶æˆ–è€…åº”ç”¨ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯ä»¥ä½¿ç”¨ UIKit æ¡†æ¶ä¸‹çš„æ‰€æœ‰ä»£ç </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure><p><strong>init</strong>ï¼šç±»ã€ç»“æ„ä½“ã€æšä¸¾çš„å®ä¾‹çš„åˆå§‹åŒ–å‡†å¤‡è¿‡ç¨‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">init</span>()  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="comment">//è®¾ç½®é»˜è®¤å€¼ï¼Œå®ä¾‹å‡†å¤‡è¢«ä½¿ç”¨</span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>inout</strong>ï¼šå°†ä¸€ä¸ªå€¼ä¼ å…¥å‡½æ•°ï¼Œå¹¶å¯ä»¥è¢«å‡½æ•°ä¿®æ”¹ï¼Œç„¶åå°†å€¼ä¼ å›åˆ°è°ƒç”¨å¤„ï¼Œæ¥æ›¿æ¢åˆå§‹å€¼ã€‚é€‚ç”¨äºå¼•ç”¨ç±»å‹å’Œå€¼ç±»å‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">dangerousOp</span><span class="params">(<span class="number">_</span> error:<span class="keyword">inout</span> NSError?)</span></span>  </span><br><span class="line">&#123;  </span><br><span class="line">    error = <span class="type">NSError</span>(domain: <span class="string">""</span>, code: <span class="number">0</span>, userInfo: [<span class="string">""</span>:<span class="string">""</span>])  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> potentialError:<span class="type">NSError?</span></span><br><span class="line">dangerousOp(&amp;potentialError)</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»£ç è¿è¡Œåˆ°è¿™é‡Œï¼ŒpotentialError ä¸å†æ˜¯ nilï¼Œè€Œæ˜¯å·²ç»è¢«åˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure><p><strong>internal</strong>ï¼šè®¿é—®æ§åˆ¶æƒé™ï¼Œå…è®¸åŒä¸€ä¸ªæ¨¡å—ä¸‹çš„æ‰€æœ‰æºæ–‡ä»¶è®¿é—®ï¼Œå¦‚æœåœ¨ä¸åŒæ¨¡å—ä¸‹åˆ™ä¸å…è®¸è®¿é—®ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">var</span> jobTitle:<span class="type">String</span> = <span class="string">""</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aPerson = <span class="type">Person</span>()  </span><br><span class="line">aPerson.jobTitle = <span class="string">"This can set anywhere in the application"</span></span><br></pre></td></tr></table></figure><p><strong>let</strong>ï¼šå®šä¹‰ä¸€ä¸ªä¸å¯å˜çš„å˜é‡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> constantString = <span class="string">"This cannot be mutated going forward"</span></span><br></pre></td></tr></table></figure><p><strong>open</strong>ï¼šè®¿é—®æ§åˆ¶æƒé™ï¼Œå…è®¸åœ¨å®šä¹‰çš„æ¨¡å—å¤–ä¹Ÿå¯ä»¥è®¿é—®æºæ–‡ä»¶é‡Œçš„æ‰€æœ‰ç±»ï¼Œå¹¶è¿›è¡Œå­ç±»åŒ–ã€‚å¯¹äºç±»æˆå‘˜ï¼Œå…è®¸åœ¨å®šä¹‰çš„æ¨¡å—ä¹‹å¤–è®¿é—®å’Œé‡å†™ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="keyword">var</span> foo:<span class="type">String?</span> <span class="comment">//è¿™ä¸ªå±æ€§å…è®¸åœ¨ app å†…æˆ– app å¤–é‡å†™å’Œè®¿é—®ã€‚åœ¨å¼€å‘æ¡†æ¶çš„æ—¶å€™ï¼Œä¼šåº”ç”¨åˆ°è¿™ä¸ªè®¿é—®ä¿®é¥°ç¬¦ã€‚</span></span><br></pre></td></tr></table></figure><p><strong>operator</strong>ï¼šç‰¹æ®Šç¬¦å·ï¼Œç”¨äºæ£€æŸ¥ã€ä¿®æ”¹ã€ç»„åˆå€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä¸€å…ƒè¿ç®—ç¬¦ "-"ï¼Œæ”¹å˜å€¼çš„ç¬¦å·</span></span><br><span class="line"><span class="keyword">let</span> foo = <span class="number">5</span>  </span><br><span class="line"><span class="keyword">let</span> anotherFoo = -foo <span class="comment">//anotherFoo ç­‰äº -5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//äºŒå…ƒè¿ç®—ç¬¦ "+" å°†ä¸¤ä¸ªå€¼ç›¸åŠ </span></span><br><span class="line"><span class="keyword">let</span> box = <span class="number">5</span> + <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//é€»è¾‘è¿ç®—ç¬¦ "&amp;&amp;" å°†ä¸¤ä¸ªå¸ƒå°”å€¼è¿›è¡Œç»„åˆè¿ç®—</span></span><br><span class="line"><span class="keyword">if</span> didPassCheckOne &amp;&amp; didPassCheckTwo</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‰å…ƒè¿ç®—ç¬¦éœ€è¦ä½¿ç”¨ä¸‰ä¸ªå€¼</span></span><br><span class="line"><span class="keyword">let</span> isLegalDrinkingAgeInUS:<span class="type">Bool</span> = age &gt;= <span class="number">21</span> ? <span class="literal">true</span> : <span class="literal">false</span></span><br></pre></td></tr></table></figure><p><strong>private</strong>ï¼šè®¿é—®æ§åˆ¶æƒé™ï¼Œåªå…è®¸å®ä½“åœ¨å®šä¹‰çš„ç±»ä»¥åŠç›¸åŒæºæ–‡ä»¶å†…çš„ extension ä¸­è®¿é—®ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> jobTitle:<span class="type">String</span> = <span class="string">""</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“ extension å’Œ class ä¸åœ¨åŒä¸€ä¸ªæºæ–‡ä»¶æ—¶</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// æ— æ³•ç¼–è¯‘é€šè¿‡ï¼Œåªæœ‰åœ¨åŒä¸€ä¸ªæºæ–‡ä»¶ä¸‹æ‰å¯ä»¥è®¿é—®</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printJobTitle</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"My job is (jobTitle)"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>protocol</strong>ï¼šå®šä¹‰äº†ä¸€ç»„æ–¹æ³•ã€å±æ€§æˆ–å…¶å®ƒè¦æ±‚ï¼Œç”¨äºæ»¡è¶³ç‰¹å®šä»»åŠ¡å’Œä¸€ç³»åˆ—åŠŸèƒ½ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Blog</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> wordCount:<span class="type">Int</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printReaderStats</span><span class="params">()</span></span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TTIDGPost</span> : <span class="title">Blog</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> wordCount:<span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(wordCount:<span class="type">Int</span>)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">self</span>.wordCount = wordCount  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printReaderStats</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="comment">//æ‰“å° post çš„æ•°æ®  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>public</strong>ï¼šè®¿é—®æ§åˆ¶æƒé™ï¼Œå…è®¸åœ¨å®šä¹‰çš„æ¨¡å—å¤–ä¹Ÿå¯ä»¥è®¿é—®æºæ–‡ä»¶é‡Œçš„æ‰€æœ‰ç±»ï¼Œä½†åªæœ‰åœ¨åŒä¸€ä¸ªæ¨¡å—å†…å¯ä»¥è¿›è¡Œå­ç±»åŒ–ã€‚å¯¹äºç±»æˆå‘˜ï¼Œå…è®¸åœ¨åŒä¸ªæ¨¡å—ä¸‹è®¿é—®å’Œé‡å†™ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> foo:<span class="type">String?</span> <span class="comment">//åªå…è®¸åœ¨ app å†…é‡å†™å’Œè®¿é—®ã€‚</span></span><br></pre></td></tr></table></figure><p><strong>static</strong>ï¼šç”¨äºå®šä¹‰ç±»æ–¹æ³•ï¼Œåœ¨ç±»å‹æœ¬èº«è¿›è¡Œè°ƒç”¨ã€‚æ­¤å¤–è¿˜å¯ä»¥å®šä¹‰é™æ€æˆå‘˜ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> jobTitle:<span class="type">String?</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">assignRandomName</span><span class="params">(<span class="number">_</span> aPerson:Person)</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        aPerson.jobTitle = <span class="string">"Some random job"</span>  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> somePerson = <span class="type">Person</span>()  </span><br><span class="line"><span class="type">Person</span>.assignRandomName(somePerson)  </span><br><span class="line"><span class="comment">//somePerson.jobTitle çš„å€¼æ˜¯ "Some random job"</span></span><br></pre></td></tr></table></figure><p><strong>struct</strong>ï¼šé€šç”¨ã€çµæ´»çš„ç»“æ„ä½“ï¼Œæ˜¯ç¨‹åºçš„åŸºç¡€ç»„æˆéƒ¨åˆ†ï¼Œå¹¶æä¾›äº†é»˜è®¤åˆå§‹åŒ–æ–¹æ³•ã€‚ä¸ class ä¸åŒï¼Œå½“ struct åœ¨ä»£ç ä¸­è¢«ä¼ é€’æ—¶ï¼Œæ˜¯è¢«æ‹·è´çš„ï¼Œå¹¶ä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œstruct æ²¡æœ‰ä¸‹é¢çš„è¿™äº›åŠŸèƒ½ï¼š</p><ul><li>ä½¿ç”¨ç»§æ‰¿ã€‚</li><li>è¿è¡Œæ—¶çš„ç±»å‹è½¬æ¢ã€‚</li><li>ä½¿ç”¨ææ„æ–¹æ³•ã€‚</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span>  </span><br><span class="line">    <span class="keyword">var</span> age:<span class="type">Int</span>  </span><br><span class="line">    <span class="keyword">var</span> gender:<span class="type">String</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>subscript</strong>ï¼šè®¿é—®é›†åˆã€åˆ—è¡¨ã€åºåˆ—ä¸­æˆå‘˜å…ƒç´ çš„å¿«æ·æ–¹å¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> postMetrics = [<span class="string">"Likes"</span>:<span class="number">422</span>, <span class="string">"ReadPercentage"</span>:<span class="number">0.58</span>, <span class="string">"Views"</span>:<span class="number">3409</span>]  </span><br><span class="line"><span class="keyword">let</span> postLikes = postMetrics[<span class="string">"Likes"</span>]</span><br></pre></td></tr></table></figure><p><strong>typealias</strong>ï¼šç»™ä»£ç ä¸­å·²ç»å­˜åœ¨çš„ç±»ï¼Œå–åˆ«åã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">JSONDictionary</span> = [<span class="type">String</span>: <span class="type">AnyObject</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">parseJSON</span><span class="params">(<span class="number">_</span> deserializedData:JSONDictionary)</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure><p><strong>var</strong>ï¼šå®šä¹‰å¯å˜å˜é‡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> mutableString = <span class="string">""</span>  </span><br><span class="line">mutableString = <span class="string">"Mutated"</span></span><br></pre></td></tr></table></figure><h2 id="è¯­å¥ä¸­çš„å…³é”®è¯"><a href="#è¯­å¥ä¸­çš„å…³é”®è¯" class="headerlink" title="è¯­å¥ä¸­çš„å…³é”®è¯"></a>è¯­å¥ä¸­çš„å…³é”®è¯</h2><p><strong>break</strong>ï¼šç»ˆæ­¢ç¨‹åºä¸­å¾ªç¯çš„æ‰§è¡Œï¼Œæ¯”å¦‚ if è¯­å¥ã€switch è¯­å¥ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="number">0</span>...<span class="number">3</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">if</span> idx % <span class="number">2</span> == <span class="number">0</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="comment">//å½“ idx ç­‰äºå¶æ•°æ—¶ï¼Œé€€å‡º for å¾ªç¯  </span></span><br><span class="line">        <span class="keyword">break</span>  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>case</strong>ï¼šè¯¥è¯­å¥åœ¨ switch è¯­å¥ä¸­åˆ—å‡ºï¼Œåœ¨æ¯ä¸ªåˆ†æ”¯å¯ä»¥è¿›è¡Œæ¨¡å¼åŒ¹é…ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> box = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> box  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box equals 0"</span>)  </span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box equals 1"</span>)  </span><br><span class="line">    <span class="keyword">default</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box doesn't equal 0 or 1"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>continue</strong>ï¼šç”¨äºç»ˆæ­¢å¾ªç¯çš„å½“å‰è¿­ä»£ï¼Œå¹¶è¿›å…¥ä¸‹ä¸€æ¬¡è¿­ä»£ï¼Œè€Œä¸ä¼šåœæ­¢æ•´ä¸ªå¾ªç¯çš„æ‰§è¡Œã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="number">0</span>...<span class="number">3</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">if</span> idx % <span class="number">2</span> == <span class="number">0</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="comment">//ç›´æ¥å¼€å§‹å¾ªç¯çš„ä¸‹ä¸€æ¬¡è¿­ä»£</span></span><br><span class="line">        <span class="keyword">continue</span>  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"This code never fires on even numbers"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>default</strong>ï¼šç”¨äºæ¶µç›–åœ¨ switch è¯­å¥ä¸­ï¼Œæ‰€æœ‰æœªæ˜ç¡®åˆ—å‡ºçš„æšä¸¾æˆå‘˜ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> box = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> box  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box equals 0"</span>)  </span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box equals 1"</span>)  </span><br><span class="line">    <span class="keyword">default</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Covers any scenario that doesn't get addressed above."</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>defer</strong>ï¼šç”¨äºåœ¨ç¨‹åºç¦»å¼€å½“å‰ä½œç”¨åŸŸä¹‹å‰ï¼Œæ‰§è¡Œä¸€æ®µä»£ç ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cleanUpIO</span><span class="params">()</span></span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">defer</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"This is called right before exiting scope"</span>)  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­æ–‡ä»¶æµç­‰ã€‚  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>do</strong>ï¼šç”¨äºè¡¨ç¤ºå¤„ç†é”™è¯¯ä»£ç æ®µçš„å¼€å§‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">try</span> expression  </span><br><span class="line">    <span class="comment">//è¯­å¥</span></span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">catch</span> someError ex  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="comment">//å¤„ç†é”™è¯¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>else</strong>ï¼šä¸ if è¯­å¥ç»“åˆä½¿ç”¨ã€‚å½“æ¡ä»¶ä¸º trueï¼Œæ‰§è¡Œä¸€æ®µä»£ç ã€‚å½“æ¡ä»¶ä¸º falseï¼Œæ‰§è¡Œå¦ä¸€æ®µä»£ç ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> val &gt; <span class="number">1</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"val is greater than 1"</span>)  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">else</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"val is not greater than 1"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>fallthrough</strong>ï¼šæ˜¾å¼åœ°å…è®¸ä»å½“å‰ case è·³è½¬åˆ°ä¸‹ä¸€ä¸ªç›¸é‚» case ç»§ç»­æ‰§è¡Œä»£ç ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> box = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> box  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box equals 0"</span>)  </span><br><span class="line">    <span class="keyword">fallthrough</span>  </span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box equals 0 or 1"</span>)  </span><br><span class="line">    <span class="keyword">default</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box doesn't equal 0 or 1"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>for</strong>ï¼šåœ¨åºåˆ—ä¸Šè¿­ä»£ï¼Œæ¯”å¦‚ä¸€ç»„ç‰¹å®šèŒƒå›´å†…çš„æ•°å­—ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ ï¼Œå­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ã€‚*ä¸å…³é”®å­— in æˆå¯¹ä½¿ç”¨ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="number">3</span> &#123; <span class="built_in">print</span> (<span class="string">"This prints 3 times"</span>) &#125;</span><br></pre></td></tr></table></figure><p><strong>guard</strong>ï¼šå½“æœ‰ä¸€ä¸ªä»¥ä¸Šçš„æ¡ä»¶ä¸æ»¡è¶³è¦æ±‚æ—¶ï¼Œå°†ç¦»å¼€å½“å‰ä½œç”¨åŸŸã€‚åŒæ—¶è¿˜æä¾›è§£åŒ…å¯é€‰ç±»å‹çš„åŠŸèƒ½ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">printRecordFromLastName</span><span class="params">(userLastName: String?)</span></span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> name = userLastName, name != <span class="string">"Null"</span> <span class="keyword">else</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="comment">//userLastName = "Null"ï¼Œéœ€è¦æå‰é€€å‡º</span></span><br><span class="line">        <span class="keyword">return</span>  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç»§ç»­æ‰§è¡Œä»£ç </span></span><br><span class="line">    <span class="built_in">print</span>(dataStore.findByLastName(name))  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>if</strong>ï¼šå½“æ¡ä»¶æ»¡è¶³æ—¶ï¼Œæ‰§è¡Œä»£ç ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="number">1</span> &gt; <span class="number">2</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"This will never execute"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>in</strong>ï¼šåœ¨åºåˆ—ä¸Šè¿­ä»£ï¼Œæ¯”å¦‚ä¸€ç»„ç‰¹å®šèŒƒå›´å†…çš„æ•°å­—ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ ï¼Œå­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ã€‚*ä¸å…³é”®å­— key æ­é…ä½¿ç”¨ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="number">3</span> &#123; <span class="built_in">print</span> (<span class="string">"This prints 3 times"</span>) &#125;</span><br></pre></td></tr></table></figure><p><strong>repeat</strong>ï¼šåœ¨ä½¿ç”¨å¾ªç¯çš„åˆ¤æ–­æ¡ä»¶ä¹‹å‰ï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡å¾ªç¯ä¸­çš„ä»£ç ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">repeat</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Always executes at least once before the condition is considered"</span>)  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span> &gt; <span class="number">2</span></span><br></pre></td></tr></table></figure><p><strong>return</strong>ï¼šç«‹åˆ»ç»ˆæ­¢å½“å‰ä¸Šä¸‹æ–‡ï¼Œç¦»å¼€å½“å‰ä½œç”¨åŸŸï¼Œæ­¤å¤–åœ¨è¿”å›æ—¶å¯ä»¥é¢å¤–æºå¸¦ä¸€ä¸ªå€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">doNothing</span><span class="params">()</span></span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="comment">//ç›´æ¥ç¦»å¼€å½“å‰ä¸Šä¸‹æ–‡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> anInt = <span class="number">0</span>  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"This never prints (anInt)"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’Œ</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">returnName</span><span class="params">()</span></span> -&gt; <span class="type">String?</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.userName <span class="comment">//ç¦»å¼€ï¼Œå¹¶è¿”å› userName çš„å€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>switch</strong>ï¼šå°†ç»™å®šçš„å€¼ä¸åˆ†æ”¯è¿›è¡Œæ¯”è¾ƒã€‚æ‰§è¡Œç¬¬ä¸€ä¸ªæ¨¡å¼åŒ¹é…æˆåŠŸçš„åˆ†æ”¯ä»£ç ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> box = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> box  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box equals 0"</span>)  </span><br><span class="line">    <span class="keyword">fallthrough</span>  </span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box equals 0 or 1"</span>)  </span><br><span class="line">    <span class="keyword">default</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Box doesn't equal 0 or 1"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>where</strong>ï¼šè¦æ±‚å…³è”ç±»å‹å¿…é¡»éµå®ˆç‰¹å®šåè®®ï¼Œæˆ–è€…ç±»å‹å‚æ•°å’Œå…³è”ç±»å‹å¿…é¡»ä¿æŒä¸€è‡´ã€‚ä¹Ÿå¯ä»¥ç”¨äºåœ¨ case ä¸­æä¾›é¢å¤–æ¡ä»¶ï¼Œç”¨äºæ»¡è¶³æ§åˆ¶è¡¨è¾¾å¼ã€‚</p><blockquote><p>where ä»å¥å¯ä»¥åº”ç”¨äºå¤šç§åœºæ™¯ã€‚ä»¥ä¸‹ä¾‹å­æŒ‡æ˜äº† where çš„ä¸»è¦åº”ç”¨åœºæ™¯ï¼Œæ³›å‹ä¸­çš„æ¨¡å¼åŒ¹é…ã€‚</p></blockquote><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Nameable</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span> &#123;<span class="keyword">get</span> <span class="keyword">set</span>&#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createdFormattedName</span><span class="params">(<span class="number">_</span> namedEntity:T)</span></span> -&gt; <span class="type">String</span> <span class="keyword">where</span> <span class="type">T</span>:<span class="type">Equatable</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="comment">//åªæœ‰å½“å®ä½“åŒæ—¶éµå®ˆ Nameable å’Œ Equatable åè®®çš„æ—¶å€™ï¼Œæ‰å…è®¸è°ƒç”¨è¿™ä¸ªå‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"This things name is "</span> + namedEntity.name  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’Œ</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>â€¦<span class="number">3</span> <span class="keyword">where</span> i % <span class="number">2</span> == <span class="number">0</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(i) <span class="comment">//æ‰“å° 0 å’Œ 2  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>while</strong>ï¼šå¾ªç¯æ‰§è¡Œç‰¹å®šçš„ä¸€æ®µè¯­å¥ï¼Œç›´åˆ°æ¡ä»¶ä¸æ»¡è¶³æ—¶ï¼Œåœæ­¢å¾ªç¯ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> foo != bar  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Keeps going until the foo == bar"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è¡¨è¾¾å¼å’Œç±»å‹ä¸­çš„å…³é”®å­—"><a href="#è¡¨è¾¾å¼å’Œç±»å‹ä¸­çš„å…³é”®å­—" class="headerlink" title="è¡¨è¾¾å¼å’Œç±»å‹ä¸­çš„å…³é”®å­—"></a>è¡¨è¾¾å¼å’Œç±»å‹ä¸­çš„å…³é”®å­—</h2><p><strong>Any</strong>ï¼šç”¨äºè¡¨ç¤ºä»»æ„ç±»å‹çš„å®ä¾‹ï¼ŒåŒ…æ‹¬å‡½æ•°ç±»å‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> anything = [<span class="type">Any</span>]()</span><br><span class="line"></span><br><span class="line">anything.append(<span class="string">"Any Swift type can be added"</span>)  </span><br><span class="line">anything.append(<span class="number">0</span>)  </span><br><span class="line">anything.append(&#123;(foo: <span class="type">String</span>) -&gt; <span class="type">String</span> <span class="keyword">in</span> <span class="string">"Passed in (foo)"</span>&#125;)</span><br></pre></td></tr></table></figure><p><strong>as</strong>ï¼šç±»å‹è½¬æ¢è¿ç®—ç¬¦ï¼Œç”¨äºå°è¯•å°†å€¼è½¬æˆå…¶å®ƒç±»å‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> anything = [<span class="type">Any</span>]()</span><br><span class="line"></span><br><span class="line">anything.append(<span class="string">"Any Swift type can be added"</span>)  </span><br><span class="line">anything.append(<span class="number">0</span>)  </span><br><span class="line">anything.append(&#123;(foo: <span class="type">String</span>) -&gt; <span class="type">String</span> <span class="keyword">in</span> <span class="string">"Passed in (foo)"</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> intInstance = anything[<span class="number">1</span>] <span class="keyword">as</span>? <span class="type">Int</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> anything = [<span class="type">Any</span>]()</span><br><span class="line"></span><br><span class="line">anything.append(<span class="string">"Any Swift type can be added"</span>)  </span><br><span class="line">anything.append(<span class="number">0</span>)  </span><br><span class="line">anything.append(&#123;(foo: <span class="type">String</span>) -&gt; <span class="type">String</span> <span class="keyword">in</span> <span class="string">"Passed in (foo)"</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> thing <span class="keyword">in</span> anything  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">switch</span> thing  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span> <span class="keyword">as</span> <span class="type">Int</span>:  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"It's zero and an Int type"</span>)  </span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> someInt <span class="keyword">as</span> <span class="type">Int</span>:  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"It's an Int that's not zero but (someInt)"</span>)  </span><br><span class="line">        <span class="keyword">default</span>:  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Who knows what it is"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>catch</strong>ï¼šå¦‚æœåœ¨ do ä¸­æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œcatch ä¼šå°è¯•è¿›è¡ŒåŒ¹é…ï¼Œå¹¶å†³å®šå¦‚ä½•å¤„ç†é”™è¯¯ã€‚<a href="https://swiftjectivec.com/swift-error-handling" target="_blank" rel="noopener">*æˆ‘å†™çš„ä¸€ç¯‡ Swift é”™è¯¯å¤„ç†çš„åšå®¢èŠ‚é€‰</a>ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">try</span> haveAWeekend(<span class="number">4</span>)  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">catch</span> <span class="type">WeekendError</span>.<span class="type">Overtime</span>(<span class="keyword">let</span> hoursWorked)  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"You worked (hoursWorked) more than you should have"</span>)  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">catch</span> <span class="type">WeekendError</span>.<span class="type">WorkAllWeekend</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"You worked 48 hours :-0"</span>)  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">catch</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Gulping the weekend exception"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>false</strong>ï¼šSwift ç”¨äºè¡¨ç¤ºå¸ƒå°”å€¼çš„ä¸¤ä¸ªå¸¸é‡å€¼ä¹‹ä¸€ï¼Œtrue çš„ç›¸åå€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> alwaysFalse = <span class="literal">false</span>  </span><br><span class="line"><span class="keyword">let</span> alwaysTrue = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> alwaysFalse &#123; <span class="built_in">print</span>(<span class="string">"Won't print, alwaysFalse is false ğŸ˜‰"</span>)&#125;</span><br></pre></td></tr></table></figure><p><strong>is</strong>ï¼šç±»å‹æ£€æŸ¥è¿ç®—ç¬¦ï¼Œç”¨äºç¡®å®šå®ä¾‹æ˜¯å¦ä¸ºæŸä¸ªå­ç±»ç±»å‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;&#125;  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span> : <span class="title">Person</span> </span>&#123;&#125;  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Nurse</span> : <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> people = [<span class="type">Programmer</span>(), <span class="type">Nurse</span>()]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> aPerson <span class="keyword">in</span> people  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">if</span> aPerson <span class="keyword">is</span> <span class="type">Programmer</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"This person is a dev"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> aPerson <span class="keyword">is</span> <span class="type">Nurse</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"This person is a nurse"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>nil</strong>ï¼šåœ¨ Swift ä¸­è¡¨ç¤ºä»»æ„ç±»å‹çš„æ— çŠ¶æ€å€¼ã€‚</p><blockquote><p>ä¸ Objective-C ä¸­çš„ nil ä¸åŒï¼ŒObjective-C ä¸­çš„ nil è¡¨ç¤ºæŒ‡å‘ä¸å­˜åœ¨å¯¹è±¡çš„æŒ‡é’ˆã€‚</p></blockquote><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;&#125;  </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Place</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»»ä½• Swift ç±»å‹æˆ–å®ä¾‹å¯ä»¥ä¸º nil</span></span><br><span class="line"><span class="keyword">var</span> statelessPerson:<span class="type">Person?</span> = <span class="literal">nil</span>  </span><br><span class="line"><span class="keyword">var</span> statelessPlace:<span class="type">Place?</span> = <span class="literal">nil</span>  </span><br><span class="line"><span class="keyword">var</span> statelessInt:<span class="type">Int?</span> = <span class="literal">nil</span>  </span><br><span class="line"><span class="keyword">var</span> statelessString:<span class="type">String?</span> = <span class="literal">nil</span></span><br></pre></td></tr></table></figure><p><strong>rethrows</strong>ï¼šæŒ‡æ˜å½“å‰å‡½æ•°åªæœ‰å½“å‚æ•°æŠ›å‡º error æ—¶ï¼Œæ‰ä¼šæŠ›å‡º errorã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">networkCall</span><span class="params">(onComplete:<span class="params">()</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Void</span>) <span class="keyword">rethrows</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">do</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">try</span> onComplete()  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">catch</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">throw</span> <span class="type">SomeError</span>.error  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>super</strong>ï¼šåœ¨å­ç±»ä¸­ï¼Œæš´éœ²çˆ¶ç±»çš„æ–¹æ³•ã€å±æ€§ã€ä¸‹æ ‡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printName</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Printing a name. "</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span> : <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">printName</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">super</span>.printName()  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Hello World!"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aDev = <span class="type">Programmer</span>()  </span><br><span class="line">aDev.printName() <span class="comment">//æ‰“å° Printing a name. Hello World!</span></span><br></pre></td></tr></table></figure><p><strong>self</strong>ï¼šä»»ä½•ç±»å‹çš„å®ä¾‹éƒ½æ‹¥æœ‰çš„éšå¼å±æ€§ï¼Œç­‰åŒäºå®ä¾‹æœ¬èº«ã€‚æ­¤å¤–è¿˜å¯ä»¥ç”¨äºåŒºåˆ†å‡½æ•°å‚æ•°å’Œæˆå‘˜å±æ€§åç§°ç›¸åŒçš„æƒ…å†µã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printSelf</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"This is me: (self)"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aPerson = <span class="type">Person</span>()  </span><br><span class="line">aPerson.printSelf() <span class="comment">//æ‰“å° "This is me: Person"</span></span><br></pre></td></tr></table></figure><p><strong>Self</strong>ï¼šåœ¨åè®®ä¸­ï¼Œè¡¨ç¤ºéµå®ˆå½“å‰åè®®çš„å®ä½“ç±»å‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Printable</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printTypeTwice</span><span class="params">(otherMe:<span class="keyword">Self</span>)</span></span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Foo</span> : <span class="title">Printable</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printTypeTwice</span><span class="params">(otherMe: Foo)</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"I am me plus (otherMe)"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aFoo = <span class="type">Foo</span>()  </span><br><span class="line"><span class="keyword">let</span> anotherFoo = <span class="type">Foo</span>()</span><br><span class="line"></span><br><span class="line">aFoo.printTypeTwice(otherMe: anotherFoo) <span class="comment">//æ‰“å° I am me plus Foo()</span></span><br></pre></td></tr></table></figure><p><strong>throw</strong>ï¼šç”¨äºåœ¨å½“å‰ä¸Šä¸‹æ–‡ï¼Œæ˜¾å¼æŠ›å‡º errorã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">WeekendError</span>: <span class="title">Error</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">case</span> <span class="type">Overtime</span>  </span><br><span class="line">    <span class="keyword">case</span> <span class="type">WorkAllWeekend</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">workOvertime</span> <span class="params">()</span></span> <span class="keyword">throws</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">throw</span> <span class="type">WeekendError</span>.<span class="type">Overtime</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>throws</strong>ï¼šæŒ‡æ˜åœ¨ä¸€ä¸ªå‡½æ•°ã€æ–¹æ³•ã€åˆå§‹åŒ–æ–¹æ³•ä¸­å¯èƒ½ä¼šæŠ›å‡º errorã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">WeekendError</span>: <span class="title">Error</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">case</span> <span class="type">Overtime</span>  </span><br><span class="line">    <span class="keyword">case</span> <span class="type">WorkAllWeekend</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">workOvertime</span> <span class="params">()</span></span> <span class="keyword">throws</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">throw</span> <span class="type">WeekendError</span>.<span class="type">Overtime</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//"throws" è¡¨æ˜åœ¨è°ƒç”¨æ–¹æ³•æ—¶ï¼Œéœ€è¦ä½¿ç”¨ tryï¼Œtry?ï¼Œtry!</span></span><br><span class="line"><span class="keyword">try</span> workOvertime()</span><br></pre></td></tr></table></figure><p><strong>true</strong>ï¼šSwift ç”¨äºè¡¨ç¤ºå¸ƒå°”å€¼çš„ä¸¤ä¸ªå¸¸é‡å€¼ä¹‹ä¸€ï¼Œè¡¨ç¤ºä¸ºçœŸã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> alwaysFalse = <span class="literal">false</span>  </span><br><span class="line"><span class="keyword">let</span> alwaysTrue = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> alwaysTrue &#123; <span class="built_in">print</span>(<span class="string">"Always prints"</span>)&#125;</span><br></pre></td></tr></table></figure><p><strong>try</strong>ï¼šè¡¨æ˜æ¥ç€è°ƒç”¨çš„å‡½æ•°å¯èƒ½ä¼šæŠ›å‡º errorã€‚æœ‰ä¸‰ç§ä¸åŒçš„ä½¿ç”¨æ–¹å¼ï¼štryï¼Œtry?ï¼Œ try!ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> aResult = <span class="keyword">try</span> dangerousFunction() <span class="comment">//å¤„ç† errorï¼Œæˆ–è€…ç»§ç»­ä¼ é€’ error  </span></span><br><span class="line"><span class="keyword">let</span> aResult = <span class="keyword">try</span>! dangerousFunction() <span class="comment">//ç¨‹åºå¯èƒ½ä¼šé—ªé€€  </span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> aResult = <span class="keyword">try</span>? dangerousFunction() <span class="comment">//è§£åŒ…å¯é€‰ç±»å‹ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="æ¨¡å¼ä¸­çš„å…³é”®å­—"><a href="#æ¨¡å¼ä¸­çš„å…³é”®å­—" class="headerlink" title="æ¨¡å¼ä¸­çš„å…³é”®å­—"></a>æ¨¡å¼ä¸­çš„å…³é”®å­—</h2><p><strong>_</strong>ï¼šç”¨äºåŒ¹é…æˆ–çœç•¥ä»»æ„å€¼çš„é€šé…ç¬¦ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="number">3</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Just loop 3 times, index has no meaning"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–ä¸€ç§ç”¨æ³•ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="number">_</span> = <span class="type">Singleton</span>() <span class="comment">//å¿½ç•¥ä¸ä½¿ç”¨çš„å˜é‡</span></span><br></pre></td></tr></table></figure><h2 id="ä»¥-å¼€å¤´çš„å…³é”®å­—"><a href="#ä»¥-å¼€å¤´çš„å…³é”®å­—" class="headerlink" title="ä»¥#å¼€å¤´çš„å…³é”®å­—"></a>ä»¥#å¼€å¤´çš„å…³é”®å­—</h2><p><strong>#available</strong>ï¼šåŸºäºå¹³å°å‚æ•°ï¼Œé€šè¿‡ <strong>if</strong>ï¼Œ<strong>while</strong>ï¼Œ<strong>guard</strong> è¯­å¥çš„æ¡ä»¶ï¼Œåœ¨è¿è¡Œæ—¶æ£€æŸ¥ API çš„å¯ç”¨æ€§ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> #available(iOS <span class="number">10</span>, *)  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"iOS 10 APIs are available"</span>)  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>#colorLiteral</strong>ï¼šåœ¨ playground ä¸­ä½¿ç”¨çš„å­—é¢è¡¨è¾¾å¼ï¼Œç”¨äºåˆ›å»ºé¢œè‰²é€‰å–å™¨ï¼Œé€‰å–åèµ‹å€¼ç»™å˜é‡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> aColor = #colorLiteral <span class="comment">//åˆ›å»ºé¢œè‰²é€‰å–å™¨</span></span><br></pre></td></tr></table></figure><p><strong>#column</strong>ï¼šä¸€ç§ç‰¹æ®Šçš„å­—é¢é‡è¡¨è¾¾å¼ï¼Œç”¨äºè·å–å­—é¢é‡è¡¨ç¤ºå¼çš„èµ·å§‹åˆ—æ•°ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printInfo</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Some person info - on column (#column)"</span>)</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aPerson = <span class="type">Person</span>()  </span><br><span class="line">aPerson.printInfo() <span class="comment">//Some person info - on column 53</span></span><br></pre></td></tr></table></figure><p><strong>#else</strong>ï¼šæ¡ä»¶ç¼–è¯‘æ§åˆ¶è¯­å¥ï¼Œç”¨äºæ§åˆ¶ç¨‹åºåœ¨ä¸åŒæ¡ä»¶ä¸‹æ‰§è¡Œä¸åŒä»£ç ã€‚ä¸ <strong>#if</strong> è¯­å¥ç»“åˆä½¿ç”¨ã€‚å½“æ¡ä»¶ä¸º trueï¼Œæ‰§è¡Œå¯¹åº”ä»£ç ã€‚å½“æ¡ä»¶ä¸º falseï¼Œæ‰§è¡Œå¦ä¸€æ®µä»£ç ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">#<span class="keyword">if</span> os(iOS)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Compiled for an iOS device"</span>)  </span><br><span class="line">#<span class="keyword">else</span>  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Not on an iOS device"</span>)  </span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p><strong>#elseif</strong>ï¼šæ¡ä»¶ç¼–è¯‘æ§åˆ¶è¯­å¥ï¼Œç”¨äºæ§åˆ¶ç¨‹åºåœ¨ä¸åŒæ¡ä»¶ä¸‹æ‰§è¡Œä»£ç ã€‚ä¸ <strong>#if</strong> è¯­å¥ç»“åˆä½¿ç”¨ã€‚å½“æ¡ä»¶ä¸º trueï¼Œæ‰§è¡Œå¯¹åº”ä»£ç ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">#<span class="keyword">if</span> os(iOS)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Compiled for an iOS device"</span>)  </span><br><span class="line">#elseif os(macOS)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Compiled on a mac computer"</span>)  </span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p><strong>#endif</strong>ï¼šæ¡ä»¶ç¼–è¯‘æ§åˆ¶è¯­å¥ï¼Œç”¨äºæ§åˆ¶ç¨‹åºåœ¨ä¸åŒæ¡ä»¶ä¸‹æ‰§è¡Œä»£ç ã€‚ç”¨äºè¡¨æ˜æ¡ä»¶ç¼–è¯‘ä»£ç çš„ç»“å°¾ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">#<span class="keyword">if</span> os(iOS)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Compiled for an iOS device"</span>)  </span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p><strong>#file</strong>ï¼šç‰¹æ®Šå­—é¢é‡è¡¨è¾¾å¼ï¼Œè¿”å›å½“å‰ä»£ç æ‰€åœ¨æºæ–‡ä»¶çš„åç§°ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printInfo</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Some person info - inside file (#file)"</span>)</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aPerson = <span class="type">Person</span>()  </span><br><span class="line">aPerson.printInfo() <span class="comment">//Some person info - inside file /*ä»£ç æ‰€åœ¨ playground æ–‡ä»¶è·¯å¾„*/</span></span><br></pre></td></tr></table></figure><p><strong>#fileReference</strong>ï¼šplayground å­—é¢é‡è¯­æ³•ï¼Œç”¨äºåˆ›å»ºæ–‡ä»¶é€‰å–å™¨ï¼Œé€‰å–å¹¶è¿”å› NSURL å®ä¾‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fontFilePath = #fileReference <span class="comment">//åˆ›å»ºæ–‡ä»¶é€‰å–å™¨</span></span><br></pre></td></tr></table></figure><p><strong>#function</strong>ï¼šç‰¹æ®Šå­—é¢é‡è¡¨è¾¾å¼ï¼Œè¿”å›å‡½æ•°åç§°ã€‚åœ¨æ–¹æ³•ä¸­ï¼Œè¿”å›æ–¹æ³•åã€‚åœ¨å±æ€§çš„ getter æˆ–è€… setter ä¸­ï¼Œè¿”å›å±æ€§åã€‚åœ¨ç‰¹æ®Šçš„æˆå‘˜ä¸­ï¼Œæ¯”å¦‚ init æˆ– subscript ä¸­ï¼Œè¿”å›å…³é”®å­—åç§°ã€‚åœ¨æ–‡ä»¶çš„æœ€é¡¶å±‚æ—¶ï¼Œè¿”å›å½“å‰æ‰€åœ¨æ¨¡å—åç§°ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printInfo</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Some person info - inside function (#function)"</span>)</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aPerson = <span class="type">Person</span>()  </span><br><span class="line">aPerson.printInfo() <span class="comment">//Some person info - inside function printInfo()</span></span><br></pre></td></tr></table></figure><p><strong>#if</strong>ï¼šæ¡ä»¶ç¼–è¯‘æ§åˆ¶è¯­å¥ï¼Œç”¨äºæ§åˆ¶ç¨‹åºåœ¨ä¸åŒæ¡ä»¶ä¸‹ç¼–è¯‘ä»£ç ã€‚é€šè¿‡åˆ¤æ–­æ¡ä»¶ï¼Œå†³å®šæ˜¯å¦æ‰§è¡Œä»£ç ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">#<span class="keyword">if</span> os(iOS)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Compiled for an iOS device"</span>)  </span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p><strong>#imageLiteral</strong>ï¼šplayground å­—é¢é‡è¯­æ³•ï¼Œåˆ›å»ºå›¾ç‰‡é€‰å–å™¨ï¼Œé€‰æ‹©å¹¶è¿”å› UIImage å®ä¾‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> anImage = #imageLiteral <span class="comment">//åœ¨ playground æ–‡ä»¶ä¸­é€‰å–å›¾ç‰‡</span></span><br></pre></td></tr></table></figure><p><strong>#line</strong>ï¼šç‰¹æ®Šå­—é¢é‡è¡¨è¾¾å¼ï¼Œç”¨äºè·å–å½“å‰ä»£ç çš„è¡Œæ•°ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printInfo</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Some person info - on line number (#line)"</span>)</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aPerson = <span class="type">Person</span>()  </span><br><span class="line">aPerson.printInfo() <span class="comment">//Some person info - on line number 5</span></span><br></pre></td></tr></table></figure><p><strong>#selector</strong>ï¼šç”¨äºåˆ›å»º Objective-C selector çš„è¡¨è¾¾å¼ï¼Œå¯ä»¥é™æ€æ£€æŸ¥æ–¹æ³•æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æš´éœ²ç»™ Objective-Cã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é™æ€æ£€æŸ¥ï¼Œç¡®ä¿ doAnObjCMethod æ–¹æ³•å­˜åœ¨  </span></span><br><span class="line">control.sendAction(#selector(doAnObjCMethod), to: target, forEvent: event)</span><br></pre></td></tr></table></figure><p><strong>#sourceLocation</strong>ï¼šè¡Œæ§åˆ¶è¯­å¥ï¼Œå¯ä»¥æŒ‡å®šä¸åŸå…ˆå®Œå…¨ä¸åŒçš„è¡Œæ•°å’Œæºæ–‡ä»¶åã€‚é€šå¸¸åœ¨ Swift è¯Šæ–­ã€debug æ—¶ä½¿ç”¨ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">#sourceLocation(file:<span class="string">"foo.swift"</span>, line:<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°æ–°å€¼</span></span><br><span class="line"><span class="built_in">print</span>(#file)  </span><br><span class="line"><span class="built_in">print</span>(#line)</span><br><span class="line"></span><br><span class="line"><span class="comment">//é‡ç½®è¡Œæ•°å’Œæ–‡ä»¶å</span></span><br><span class="line">#sourceLocation()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(#file)  </span><br><span class="line"><span class="built_in">print</span>(#line)</span><br></pre></td></tr></table></figure><h2 id="ç‰¹å®šä¸Šä¸‹æ–‡ä¸­çš„å…³é”®å­—"><a href="#ç‰¹å®šä¸Šä¸‹æ–‡ä¸­çš„å…³é”®å­—" class="headerlink" title="ç‰¹å®šä¸Šä¸‹æ–‡ä¸­çš„å…³é”®å­—"></a>ç‰¹å®šä¸Šä¸‹æ–‡ä¸­çš„å…³é”®å­—</h2><blockquote><p>è¿™äº›å…³é”®å­—ï¼Œåœ¨å¤„äºå¯¹åº”ä¸Šä¸‹æ–‡ä¹‹å¤–æ—¶ï¼Œå¯ä»¥ç”¨ä½œæ ‡è¯†ç¬¦ã€‚</p></blockquote><p><strong>associativity</strong>ï¼šæŒ‡æ˜åŒä¸€ä¼˜å…ˆçº§çš„è¿ç®—ç¬¦ï¼Œåœ¨ç¼ºå°‘å¤§æ‹¬å·çš„æƒ…å†µï¼ŒæŒ‰ä»€ä¹ˆé¡ºåºç»“åˆã€‚ä½¿ç”¨ <strong>left</strong>ã€<strong>right</strong>ã€<strong>none</strong>ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">infix</span> <span class="keyword">operator</span> ~ &#123; <span class="keyword">associativity</span> <span class="keyword">right</span> <span class="keyword">precedence</span> <span class="number">140</span> &#125;  </span><br><span class="line"><span class="number">4</span> ~ <span class="number">8</span></span><br></pre></td></tr></table></figure><p><strong>convenience</strong>ï¼šæ¬¡ç­‰çš„ä¾¿åˆ©æ„é€ å™¨ï¼Œæœ€åä¼šè°ƒç”¨æŒ‡å®šæ„é€ å™¨åˆå§‹åŒ–å®ä¾‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="number">_</span> name:<span class="type">String</span>)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">self</span>.name = name  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span>()  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(<span class="string">"No Name"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> me = <span class="type">Person</span>()  </span><br><span class="line"><span class="built_in">print</span>(me.name)<span class="comment">//æ‰“å° "No Name"</span></span><br></pre></td></tr></table></figure><p><strong>dynamic</strong>ï¼šæŒ‡æ˜ç¼–è¯‘å™¨ä¸ä¼šå¯¹ç±»æˆå‘˜æˆ–è€…å‡½æ•°çš„æ–¹æ³•è¿›è¡Œå†…è”æˆ–è™šæ‹ŸåŒ–ã€‚è¿™æ„å‘³ç€å¯¹è¿™ä¸ªæˆå‘˜çš„è®¿é—®æ˜¯ä½¿ç”¨ Objective-C è¿è¡Œæ—¶è¿›è¡ŒåŠ¨æ€æ´¾å‘çš„ï¼ˆä»£æ›¿é™æ€è°ƒç”¨ï¼‰ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="comment">//éšå¼æŒ‡æ˜å«æœ‰ "objc" å±æ€§</span></span><br><span class="line">    <span class="comment">//è¿™å¯¹ä¾èµ–äº Objc-C é»‘é­”æ³•çš„åº“æˆ–è€…æ¡†æ¶éå¸¸æœ‰ç”¨</span></span><br><span class="line">    <span class="comment">//æ¯”å¦‚ KVOã€KVCã€Swizzling</span></span><br><span class="line">    <span class="keyword">dynamic</span> <span class="keyword">var</span> name:<span class="type">String?</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>didSet</strong>ï¼šå±æ€§è§‚å¯Ÿè€…ï¼Œå½“å€¼å­˜å‚¨åˆ°å±æ€§åé©¬ä¸Šè°ƒç”¨ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> data = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">didSet</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        tableView.reloadData()  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>final</strong>ï¼šé˜²æ­¢æ–¹æ³•ã€å±æ€§ã€ä¸‹æ ‡è¢«é‡å†™ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;&#125;  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span> : <span class="title">Person</span> </span>&#123;&#125; <span class="comment">//ç¼–è¯‘é”™è¯¯</span></span><br></pre></td></tr></table></figure><p><strong>get</strong>ï¼šè¿”å›æˆå‘˜çš„å€¼ã€‚è¿˜å¯ä»¥ç”¨åœ¨è®¡ç®—å‹å±æ€§ä¸Šï¼Œé—´æ¥è·å–å…¶å®ƒå±æ€§çš„å€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span>.name &#125;  </span><br><span class="line">        <span class="keyword">set</span> &#123; <span class="keyword">self</span>.name = newValue&#125;  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> indirectSetName:<span class="type">String</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">get</span>  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> aFullTitle = <span class="keyword">self</span>.fullTitle  </span><br><span class="line">            &#123;  </span><br><span class="line">                <span class="keyword">return</span> aFullTitle  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>  </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">set</span> (newTitle)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="comment">//å¦‚æœæ²¡æœ‰å®šä¹‰ newTitleï¼Œå¯ä»¥ä½¿ç”¨ newValue</span></span><br><span class="line">            <span class="keyword">self</span>.fullTitle = <span class="string">"(self.name) :(newTitle)"</span>  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>infix</strong>ï¼šæŒ‡æ˜ä¸€ä¸ªç”¨äºä¸¤ä¸ªå€¼ä¹‹é—´çš„è¿ç®—ç¬¦ã€‚å¦‚æœä¸€ä¸ªå…¨æ–°çš„å…¨å±€è¿ç®—ç¬¦è¢«å®šä¹‰ä¸º infixï¼Œè¿˜éœ€è¦æŒ‡å®šä¼˜å…ˆçº§ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> twoIntsAdded = <span class="number">2</span> + <span class="number">3</span></span><br></pre></td></tr></table></figure><p><strong>indirect</strong>ï¼šæŒ‡æ˜åœ¨æšä¸¾ç±»å‹ä¸­ï¼Œå­˜åœ¨æˆå‘˜ä½¿ç”¨ç›¸åŒæšä¸¾ç±»å‹çš„å®ä¾‹ä½œä¸ºå…³è”å€¼çš„æƒ…å†µã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">indirect</span> <span class="class"><span class="keyword">enum</span> <span class="title">Entertainment</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">case</span> eventType(<span class="type">String</span>)  </span><br><span class="line">    <span class="keyword">case</span> oneEvent(<span class="type">Entertainment</span>)  </span><br><span class="line">    <span class="keyword">case</span> twoEvents(<span class="type">Entertainment</span>, <span class="type">Entertainment</span>)  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dinner = <span class="type">Entertainment</span>.eventType(<span class="string">"Dinner"</span>)  </span><br><span class="line"><span class="keyword">let</span> movie = <span class="type">Entertainment</span>.eventType(<span class="string">"Movie"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dateNight = <span class="type">Entertainment</span>.twoEvents(dinner, movie)</span><br></pre></td></tr></table></figure><p><strong>lazy</strong>ï¼šæŒ‡æ˜å±æ€§çš„åˆå§‹å€¼ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡è¢«ä½¿ç”¨æ—¶ï¼Œæ‰è¿›è¡Œåˆå§‹åŒ–ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> personalityTraits = &#123;  </span><br><span class="line">        <span class="comment">//æ˜‚è´µçš„æ•°æ®åº“å¼€é”€  </span></span><br><span class="line">        <span class="keyword">return</span> [<span class="string">"Nice"</span>, <span class="string">"Funny"</span>]  </span><br><span class="line">    &#125;()  </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> aPerson = <span class="type">Person</span>()  </span><br><span class="line">aPerson.personalityTraits <span class="comment">//å½“ personalityTraits é¦–æ¬¡è¢«è®¿é—®æ—¶ï¼Œæ•°æ®åº“æ‰å¼€å§‹å·¥ä½œ</span></span><br></pre></td></tr></table></figure><p><strong>left</strong>ï¼šæŒ‡æ˜è¿ç®—ç¬¦çš„ç»“åˆæ€§æ˜¯ä»å·¦åˆ°å³ã€‚åœ¨æ²¡æœ‰ä½¿ç”¨å¤§æ‹¬å·æ—¶ï¼Œå¯ä»¥ç”¨äºæ­£ç¡®åˆ¤æ–­åŒä¸€ä¼˜å…ˆçº§è¿ç®—ç¬¦çš„æ‰§è¡Œé¡ºåºã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//"-" è¿ç®—ç¬¦çš„ç»“åˆæ€§æ˜¯ä»å·¦åˆ°å³</span></span><br><span class="line"><span class="number">10</span>-<span class="number">2</span>-<span class="number">4</span> <span class="comment">//æ ¹æ®ç»“åˆæ€§ï¼Œå¯ä»¥çœ‹åš (10-2) - 4</span></span><br></pre></td></tr></table></figure><p><strong>mutating</strong>ï¼šå…è®¸åœ¨æ–¹æ³•ä¸­ä¿®æ”¹ç»“æ„ä½“æˆ–è€…æšä¸¾å®ä¾‹çš„å±æ€§å€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> job = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">assignJob</span><span class="params">(newJob:String)</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">self</span> = <span class="type">Person</span>(job: newJob)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> aPerson = <span class="type">Person</span>()  </span><br><span class="line">aPerson.job <span class="comment">//""</span></span><br><span class="line"></span><br><span class="line">aPerson.assignJob(newJob: <span class="string">"iOS Engineer at Buffer"</span>)  </span><br><span class="line">aPerson.job <span class="comment">//iOS Engineer at Buffer</span></span><br></pre></td></tr></table></figure><p><strong>none</strong>ï¼šæ˜¯ä¸€ä¸ªæ²¡æœ‰ç»“åˆæ€§çš„è¿ç®—ç¬¦ã€‚ä¸å…è®¸è¿™æ ·çš„è¿ç®—ç¬¦ç›¸é‚»å‡ºç°ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//"&lt;" æ˜¯éç»“åˆæ€§çš„è¿ç®—ç¬¦</span></span><br><span class="line"><span class="number">1</span> &lt; <span class="number">2</span> &lt; <span class="number">3</span> <span class="comment">//ç¼–è¯‘å¤±è´¥</span></span><br></pre></td></tr></table></figure><p><strong>nonmutating</strong>ï¼šæŒ‡æ˜æˆå‘˜çš„ setter æ–¹æ³•ä¸ä¼šä¿®æ”¹å®ä¾‹çš„å€¼ï¼Œä½†å¯èƒ½ä¼šæœ‰å…¶å®ƒåæœã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Paygrade</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">case</span> <span class="type">Junior</span>, <span class="type">Middle</span>, <span class="type">Senior</span>, <span class="type">Master</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> experiencePay:<span class="type">String?</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">get</span>  </span><br><span class="line">        &#123;  </span><br><span class="line">            database.payForGrade(<span class="type">String</span>(describing:<span class="keyword">self</span>))  </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">nonmutating</span> <span class="keyword">set</span>  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> newPay = newValue  </span><br><span class="line">            &#123;  </span><br><span class="line">                database.editPayForGrade(<span class="type">String</span>(describing:<span class="keyword">self</span>), newSalary:newPay)  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> currentPay = <span class="type">Paygrade</span>.<span class="type">Middle</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å°† Middle pay æ›´æ–°ä¸º 45k, ä½†ä¸ä¼šä¿®æ”¹ experiencePay å€¼</span></span><br><span class="line">currentPay.experiencePay = <span class="string">"$45,000"</span></span><br></pre></td></tr></table></figure><p><strong>optional</strong>ï¼šç”¨äºæŒ‡æ˜åè®®ä¸­çš„å¯é€‰æ–¹æ³•ã€‚éµå®ˆè¯¥åè®®çš„å®ä½“ç±»å¯ä»¥ä¸å®ç°è¿™ä¸ªæ–¹æ³•ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="meta">@objc</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Foo</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">requiredFunction</span><span class="params">()</span></span>  </span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">optional</span> <span class="function"><span class="keyword">func</span> <span class="title">optionalFunction</span><span class="params">()</span></span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> : <span class="title">Foo</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">requiredFunction</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Conformance is now valid"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>override</strong>ï¼šæŒ‡æ˜å­ç±»ä¼šæä¾›è‡ªå®šä¹‰å®ç°ï¼Œè¦†ç›–çˆ¶ç±»çš„å®ä¾‹æ–¹æ³•ã€ç±»å‹æ–¹æ³•ã€å®ä¾‹å±æ€§ã€ç±»å‹å±æ€§ã€ä¸‹æ ‡ã€‚å¦‚æœæ²¡æœ‰å®ç°ï¼Œåˆ™ä¼šç›´æ¥ç»§æ‰¿è‡ªçˆ¶ç±»ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printInfo</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"I'm just a person!"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span> : <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">printInfo</span><span class="params">()</span></span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"I'm a person who is a dev!"</span>)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aPerson = <span class="type">Person</span>()  </span><br><span class="line"><span class="keyword">let</span> aDev = <span class="type">Programmer</span>()</span><br><span class="line"></span><br><span class="line">aPerson.printInfo() <span class="comment">//æ‰“å° I'm just a person!  </span></span><br><span class="line">aDev.printInfo() <span class="comment">//æ‰“å° I'm a person who is a dev!</span></span><br></pre></td></tr></table></figure><p><strong>postfix</strong>ï¼šä½äºå€¼åé¢çš„è¿ç®—ç¬¦ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> optionalStr:<span class="type">String?</span> = <span class="string">"Optional"</span>  </span><br><span class="line"><span class="built_in">print</span>(optionalStr!)</span><br></pre></td></tr></table></figure><p><strong>precedence</strong>ï¼šæŒ‡æ˜æŸä¸ªè¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é«˜äºåˆ«çš„è¿ç®—ç¬¦ï¼Œä»è€Œè¢«ä¼˜å…ˆä½¿ç”¨ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">infix</span> <span class="keyword">operator</span> ~ &#123; <span class="keyword">associativity</span> <span class="keyword">right</span> <span class="keyword">precedence</span> <span class="number">140</span> &#125;  </span><br><span class="line"><span class="number">4</span> ~ <span class="number">8</span></span><br></pre></td></tr></table></figure><p><strong>prefix</strong>ï¼šä½äºå€¼å‰é¢çš„è¿ç®—ç¬¦ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> anInt = <span class="number">2</span>  </span><br><span class="line">anInt = -anInt <span class="comment">//anInt ç­‰äº -2</span></span><br></pre></td></tr></table></figure><p><strong>required</strong>ï¼šç¡®ä¿ç¼–è¯‘å™¨ä¼šæ£€æŸ¥è¯¥ç±»çš„æ‰€æœ‰å­ç±»ï¼Œå…¨éƒ¨å®ç°äº†æŒ‡å®šçš„æ„é€ å™¨æ–¹æ³•ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String?</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>(<span class="number">_</span> name:<span class="type">String</span>)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">self</span>.name = name  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span> : <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="comment">//å¦‚æœä¸å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œç¼–è¯‘ä¸ä¼šé€šè¿‡</span></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>(<span class="number">_</span> name: <span class="type">String</span>)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(name)  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>right</strong>ï¼šæŒ‡æ˜è¿ç®—ç¬¦çš„ç»“åˆæ€§æ˜¯ä»å³åˆ°å·¦çš„ã€‚åœ¨æ²¡æœ‰ä½¿ç”¨å¤§æ‹¬å·æ—¶ï¼Œå¯ä»¥ç”¨äºæ­£ç¡®åˆ¤æ–­åŒä¸€ä¼˜å…ˆçº§è¿ç®—ç¬¦çš„é¡ºåºã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//"??" è¿ç®—ç¬¦ç»“åˆæ€§æ˜¯ä»å³åˆ°å·¦</span></span><br><span class="line"><span class="keyword">var</span> box:<span class="type">Int?</span>  </span><br><span class="line"><span class="keyword">var</span> sol:<span class="type">Int?</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> foo:<span class="type">Int</span> = box ?? sol ?? <span class="number">0</span> <span class="comment">//Foo ç­‰äº 2</span></span><br></pre></td></tr></table></figure><p><strong>set</strong>ï¼šé€šè¿‡è·å–çš„æ–°å€¼æ¥è®¾ç½®æˆå‘˜çš„å€¼ã€‚åŒæ ·å¯ä»¥ç”¨äºè®¡ç®—å‹å±æ€§æ¥é—´æ¥è®¾ç½®å…¶å®ƒå±æ€§ã€‚å¦‚æœè®¡ç®—å‹å±æ€§çš„ setter æ²¡æœ‰å®šä¹‰æ–°å€¼çš„åç§°ï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤çš„ newValueã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span>.name &#125;  </span><br><span class="line">        <span class="keyword">set</span> &#123; <span class="keyword">self</span>.name = newValue&#125;  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> indirectSetName:<span class="type">String</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">get</span>  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> aFullTitle = <span class="keyword">self</span>.fullTitle  </span><br><span class="line">            &#123;  </span><br><span class="line">                <span class="keyword">return</span> aFullTitle  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>  </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">set</span> (newTitle)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="comment">//å¦‚æœæ²¡æœ‰å®šä¹‰ newTitleï¼Œå¯ä»¥ä½¿ç”¨ newValue</span></span><br><span class="line">            <span class="keyword">self</span>.fullTitle = <span class="string">"(self.name) :(newTitle)"</span>  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Type</strong>ï¼šè¡¨ç¤ºä»»æ„ç±»å‹çš„ç±»å‹ï¼ŒåŒ…æ‹¬ç±»ç±»å‹ã€ç»“æ„ç±»å‹ã€æšä¸¾ç±»å‹ã€åè®®ç±»å‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;&#125;  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span> : <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aDev:<span class="type">Programmer</span>.<span class="type">Type</span> = <span class="type">Programmer</span>.<span class="keyword">self</span></span><br></pre></td></tr></table></figure><p><strong>unowned</strong>ï¼šè®©å¾ªç¯å¼•ç”¨ä¸­çš„å®ä¾‹ A ä¸è¦å¼ºå¼•ç”¨å®ä¾‹ Bã€‚å‰ææ¡ä»¶æ˜¯å®ä¾‹ B çš„ç”Ÿå‘½å‘¨æœŸè¦é•¿äº A å®ä¾‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> occupation:<span class="type">Job?</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“ Person å®ä¾‹ä¸å­˜åœ¨æ—¶ï¼Œjob ä¹Ÿä¸ä¼šå­˜åœ¨ã€‚job çš„ç”Ÿå‘½å‘¨æœŸå–å†³äºæŒæœ‰å®ƒçš„ Personã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Job</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">unowned</span> <span class="keyword">let</span> employee:<span class="type">Person</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(with employee:<span class="type">Person</span>)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">self</span>.employee = employee  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>weak</strong>ï¼šå…è®¸å¾ªç¯å¼•ç”¨ä¸­çš„å®ä¾‹ A å¼±å¼•ç”¨å®ä¾‹ B ï¼Œè€Œä¸æ˜¯å¼ºå¼•ç”¨ã€‚å®ä¾‹ B çš„ç”Ÿå‘½å‘¨æœŸæ›´çŸ­ï¼Œå¹¶ä¼šè¢«å…ˆé‡Šæ”¾ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> residence:<span class="type">House?</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">House</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">weak</span> <span class="keyword">var</span> occupant:<span class="type">Person?</span>  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> me:<span class="type">Person?</span> = <span class="type">Person</span>()  </span><br><span class="line"><span class="keyword">var</span> myHome:<span class="type">House?</span> = <span class="type">House</span>()</span><br><span class="line"></span><br><span class="line">me!.residence = myHome  </span><br><span class="line">myHome!.occupant = me</span><br><span class="line"></span><br><span class="line">me = <span class="literal">nil</span>  </span><br><span class="line">myHome!.occupant <span class="comment">// myHome ç­‰äº nil</span></span><br></pre></td></tr></table></figure><p><strong>willSet</strong>ï¼šå±æ€§è§‚å¯Ÿè€…ï¼Œåœ¨å€¼å­˜å‚¨åˆ°å±æ€§ä¹‹å‰è°ƒç”¨ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String?</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">willSet</span>(newValue) &#123;<span class="built_in">print</span>(<span class="string">"I've got a new name, it's (newValue)!"</span>)&#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> aPerson = <span class="type">Person</span>()  </span><br><span class="line">aPerson.name = <span class="string">"Jordan"</span> <span class="comment">//åœ¨èµ‹å€¼ä¹‹å‰ï¼Œæ‰“å° "I've got a new name, it's Jordan!"</span></span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å“‡å™¢ï¼</p><p>è¿™çœŸæ˜¯ä¸€æ¬¡æœ‰è¶£çš„åˆ›ä½œã€‚æˆ‘å­¦ä¼šäº†å¥½å¤šåœ¨å†™ä¹‹å‰æ²¡æƒ³åˆ°çš„ä¸œè¥¿ã€‚ä½†æˆ‘è®¤ä¸ºè¿™é‡Œçš„è¯€çªå¹¶ä¸æ˜¯è¦æŠŠå®ƒè®°ä½ï¼Œè€Œæ˜¯æŠŠå®ƒå½“åšä¸€ä»½å¯ä»¥ç”¨äºæµ‹éªŒçš„å®šä¹‰æ¸…å•ã€‚</p><p>ç›¸ååœ°ï¼Œæˆ‘å»ºè®®ä½ æŠŠè¿™ä»½æ¸…å•æ”¾åœ¨æ‰‹è¾¹ï¼Œå¹¶æ—¶ä¸æ—¶åœ°å›é¡¾ä¸€ä¸‹ã€‚å¦‚æœä½ èƒ½è¿™æ ·åšçš„è¯ï¼Œä¸‹ä¸€æ¬¡åœ¨ä¸åŒåœºæ™¯ä¸‹éœ€è¦ä½¿ç”¨ç‰¹å®šçš„å…³é”®å­—ï¼Œä½ è‚¯å®šå°±èƒ½é©¬ä¸Šå›æƒ³èµ·æ¥å¹¶ä½¿ç”¨å®ƒå•¦ã€‚</p><p>ä¸‹å›å†è§å’¯ã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šJordan Morganï¼Œ&lt;a href=&quot;https://www.swiftjectivec.com/swift-keywords-v-3-0-1/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-02-11&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://www.jianshu.com/u/076cc5e18bb8&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;éƒ‘ä¸€ä¸€&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://numbbbbb.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;numbbbbb&lt;/a&gt;ï¼Œ&lt;a href=&quot;http://www.jianshu.com/users/596f2ba91ce9/latest_articles&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;pmst&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/Pancf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Pancf&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;æœ‰å¥è¯ä¹‹å‰æˆ‘æè¿‡ï¼Œä»Šå¤©è¿˜æƒ³å†è¯´ä¸€æ¬¡ã€‚é‚£å°±æ˜¯æ‰“é“è¿˜éœ€è‡ªèº«ç¡¬ã€‚å¯¹äºè‡ªèº«èƒ½åŠ›çš„ä¸¥æ ¼è¦æ±‚ï¼Œå¯ä»¥å¸®åŠ©å®ç°æˆ‘ä»¬æ‰€æœ‰æ¢¦å¯ä»¥æ±‚çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;è¯´èµ·æ¥å¯èƒ½æœ‰äº›æ¶ˆæï¼ŒçŸ¥è¯†æ¯•ç«Ÿæ˜¯æ°¸è¿œå­¦ä¸å®Œçš„ã€‚ä¸è®ºå¦‚ä½•ï¼Œä»Šå¤© &lt;a href=&quot;https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/LexicalStructure.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ‘ä»¬å…ˆæ¥å­¦ä¹ ä¸€ä¸‹ Swift ä¸­çš„æ¯ä¸€ä¸ªå…³é”®å­—&lt;/a&gt;ï¼ˆV3.0.1ï¼‰ï¼Œåœ¨ä»‹ç»æ¯ä¸ªå…³é”®å­—çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šé™„å¸¦ä¸€æ®µä»£ç åŠ ä»¥è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™äº›å…³é”®å­—ä¹‹ä¸­ï¼Œä¼šæœ‰ä½ ç†Ÿæ‚‰æˆ–è€…ä¸ç†Ÿæ‚‰çš„éƒ¨åˆ†ã€‚ä½†ä¸ºäº†æœ€å¥½çš„é˜…è¯»å’Œå­¦ä¹ ä½“éªŒï¼Œæˆ‘æŠŠå®ƒä»¬å…¨éƒ¨åˆ—å‡ºæ¥äº†ã€‚æ–‡ç« ç¯‡å¹…æœ‰äº›é•¿ï¼Œä½ å‡†å¤‡å¥½äº†ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬ç°åœ¨å°±å¼€å§‹å§ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="swiftjectivec" scheme="https://swift.gg/categories/swiftjectivec/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>ç»™ UIView æ¥ç‚¹çƒŸèŠ±</title>
    <link href="https://swift.gg/2019/08/14/add-fireworks-and-sparks-to-a-uiview/"/>
    <id>https://swift.gg/2019/08/14/add-fireworks-and-sparks-to-a-uiview/</id>
    <published>2019-08-14T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šTomasz Szulcï¼Œ<a href="http://szulctomasz.com/programming-blog/2018/09/add-fireworks-and-sparks-to-a-uiview/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-09<br>è¯‘è€…ï¼š<a href="https://github.com/joeytat" target="_blank" rel="noopener">Joeytat</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/Pancf" target="_blank" rel="noopener">Pancf</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><a id="more"></a><p>ä½ ä¹Ÿå¾ˆå–œæ¬¢å¸¸ç”¨ app é‡Œçš„é‚£äº›å°ç»†èŠ‚å§ï¼Ÿå½“æˆ‘ä» <a href="https://dribbble.com/" target="_blank" rel="noopener">dribbble</a> ä¸­å¯»æ‰¾çµæ„Ÿæ—¶ï¼Œå°±å‘ç°äº†è¿™ä¸ªæ¼‚äº®çš„è®¾è®¡ï¼šå½“ç”¨æˆ·åœ¨æŸä¸ªé‡è¦çš„è§†å›¾ä¸­ä¿®æ”¹è®¾ç½®æˆ–è€…è¿›è¡Œäº†ä»€ä¹ˆæ“ä½œæ—¶ï¼Œä¼šæœ‰çƒŸèŠ±åœ¨å‘¨å›´ç»½æ”¾ã€‚äºæ˜¯æˆ‘å°±åœ¨æƒ³è¿™ä¸ªä¸œè¥¿æœ‰å¤šéš¾å®ç°ï¼Œç„¶åè¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œæˆ‘å®Œæˆäº† :)</p><p><img src="https://swift.gg/img/articles/add-fireworks-and-sparks-to-a-uiview/hero.gif1565786277.3434784" alt="hero"></p><h2 id="çƒŸèŠ±çš„ç»†èŠ‚"><a href="#çƒŸèŠ±çš„ç»†èŠ‚" class="headerlink" title="çƒŸèŠ±çš„ç»†èŠ‚"></a><em>çƒŸèŠ±çš„ç»†èŠ‚</em></h2><p>ä¸‹é¢æ˜¯å¯¹äºè¿™ä¸ªæ•ˆæœçš„è¯¦ç»†æè¿°ã€‚çƒŸèŠ±åº”è¯¥åœ¨è§†å›¾å‘¨å›´çš„æŸä¸ªç‰¹æ®Šçš„ä½ç½®çˆ†å¼€ï¼Œå¯èƒ½æ˜¯æŒ‰é’®åœ¨ç‚¹å‡»äº‹ä»¶å“åº”æ—¶ã€‚å½“ç‚¹å‡»å‘ç”Ÿæ—¶ï¼ŒçƒŸèŠ±åº”è¯¥åœ¨æŒ‰é’®çš„å››è§’çˆ†å¼€ï¼Œå¹¶ä¸”çˆ†ç‚¸äº§ç”Ÿçš„ç«èŠ±åº”è¯¥æŒ‰ç…§è‡ªèº«çš„è½¨è¿¹ç§»åŠ¨ã€‚</p><p><img src="https://swift.gg/img/articles/add-fireworks-and-sparks-to-a-uiview/final.jpg1565786278.2018952" alt="final"></p><p><em>è¶…å–œæ¬¢è¿™ä¸ªæ•ˆæœ! ä¸ä»…è®©æˆ‘æ„Ÿå—åˆ°è§†è§‰ä¸Šçš„æ„‰æ‚¦ï¼Œè¿˜è®©æˆ‘æƒ³è¦ä¸åœåœ°æˆ³è¿™ä¸ªæŒ‰é’®ï¼ :) ğŸ‰</em></p><p>ç°åœ¨è®©æˆ‘ä»¬å†çœ‹ä¸€çœ¼è¿™ä¸ªåŠ¨ç”»ã€‚æ¯æ¬¡ç”Ÿæˆçš„çƒŸèŠ±ï¼Œå…¶æ•´ä½“è¡Œä¸ºæ˜¯å¤§è‡´ç›¸ä¼¼çš„ã€‚ä½†è¿˜æ˜¯åœ¨ç«èŠ±çš„è½¨è¿¹å’Œå¤§å°ä¸Šæœ‰ä¸€äº›åŒºåˆ«ã€‚è®©æˆ‘ä»¬æ‹†å¼€æ¥è¯´ã€‚</p><ul><li>æ¯ä¸€æ¬¡ç‚¹å‡»éƒ½ä¼šäº§ç”Ÿ<em>ä¸¤å¤„çƒŸèŠ±</em>ï¼Œ</li><li>æ¯ä¸€å¤„çƒŸèŠ±ä¼šäº§ç”Ÿ <em>8 ä¸ªç«èŠ±</em>ï¼Œ</li><li>æ¯ä¸ªç«èŠ±éƒ½éµå¾ªç€è‡ªå·±çš„<em>è½¨è¿¹</em>ï¼Œ</li><li>è½¨è¿¹çœ‹èµ·æ¥<em>ç›¸ä¼¼</em>ï¼Œä½†å…¶å®<em>ä¸å®Œå…¨ä¸€æ ·</em>ã€‚ä»çˆ†ç‚¸<em>å¼€å§‹</em>çš„ä½ç½®æ¥çœ‹ï¼Œæœ‰éƒ¨åˆ†æœ<em>å³</em>ï¼Œæœ‰éƒ¨åˆ†æœ<em>å·¦</em>ï¼Œå‰©ä½™çš„æœ<em>ä¸Š</em>æˆ–<em>ä¸‹</em>ã€‚</li></ul><h2 id="ç«èŠ±çš„åˆ†å¸ƒ"><a href="#ç«èŠ±çš„åˆ†å¸ƒ" class="headerlink" title="ç«èŠ±çš„åˆ†å¸ƒ"></a><em>ç«èŠ±çš„åˆ†å¸ƒ</em></h2><p>è¿™ä¸ªçƒŸèŠ±ç‰¹æ•ˆæœ‰ç€ç®€å•çš„ç«èŠ±åˆ†å¸ƒè§„åˆ™ã€‚å°†çˆ†ç‚¸ç‚¹åˆ†ä¸ºå››å—ã€Œè§†çº¿åŒºåŸŸã€æ¥çœ‹ï¼šä¸Šå·¦ï¼Œä¸Šå³ï¼Œä¸‹å·¦ï¼Œä¸‹å³ï¼Œæ¯ä¸ªåŒºåŸŸéƒ½æœ‰ä¸¤ä¸ªç«èŠ±ã€‚</p><p><img src="https://swift.gg/img/articles/add-fireworks-and-sparks-to-a-uiview/sparks-distribution.jpg1565786278.5224512" alt="sparks distribution"></p><h2 id="ç«èŠ±çš„è½¨è¿¹"><a href="#ç«èŠ±çš„è½¨è¿¹" class="headerlink" title="ç«èŠ±çš„è½¨è¿¹"></a><em>ç«èŠ±çš„è½¨è¿¹</em></h2><p>ç«èŠ±çš„ç§»åŠ¨æœ‰ç€è‡ªå·±çš„è½¨è¿¹ã€‚åœ¨ä¸€å¤„çƒŸèŠ±ä¸­æœ‰ 8 ä¸ªç«èŠ±ï¼Œé‚£è‡³å°‘éœ€è¦ 8 é“è½¨è¿¹ã€‚ç†æƒ³çŠ¶æ€ä¸‹åº”è¯¥æœ‰æ›´å¤šçš„è½¨è¿¹ï¼Œå¯ä»¥å¢åŠ ä¸€äº›éšæœºæ€§ï¼Œè¿™æ ·è¿ç»­çˆ†å‘çƒŸèŠ±çš„æ—¶å€™ï¼Œä¸ä¼šçœ‹èµ·æ¥å’Œå‰ä¸€ä¸ªå®Œå…¨ä¸€æ ·ã€‚</p><p><img src="https://swift.gg/img/articles/add-fireworks-and-sparks-to-a-uiview/spark-trajectories.jpg1565786278.861796" alt="spark-trajectories"></p><p>æˆ‘ä¸ºæ¯ä¸€ä¸ªåŒºåŸŸåˆ›å»ºäº† 4 æ¡è½¨è¿¹ï¼Œè¿™æ ·å°±èµ‹äºˆäº†ä¸¤å€äºç«èŠ±æ•°é‡çš„éšæœºæ€§ã€‚ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œæˆ‘ç»Ÿä¸€äº†æ¯æ¡è½¨è¿¹çš„åˆå§‹ç‚¹ã€‚å› ä¸ºæˆ‘ç”¨äº†ä¸åŒçš„å·¥å…·æ¥å¯è§†åŒ–è¿™äº›è½¨è¿¹ï¼Œæ‰€ä»¥å›¾ä¸Šçš„è½¨è¿¹å’Œæˆ‘å®Œæˆçš„æ•ˆæœç•¥æœ‰ä¸åŒ - ä½†ä½ èƒ½æ˜ç™½æˆ‘çš„æƒ³æ³•å°±è¡Œ :)</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="_å®ç°_"></a>_å®ç°_</h2><p>ç†è®ºè¶³å¤Ÿäº†ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬æŠŠå„ä¸ªæ¨¡å—æ‹¼å‡‘èµ·æ¥ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">SparkTrajectory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// å­˜å‚¨ç€å®šä¹‰è½¨è¿¹æ‰€éœ€è¦çš„æ‰€æœ‰çš„ç‚¹</span></span><br><span class="line">    <span class="keyword">var</span> points: [<span class="type">CGPoint</span>] &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// ç”¨ path æ¥è¡¨ç°è½¨è¿¹</span></span><br><span class="line">    <span class="keyword">var</span> path: <span class="type">UIBezierPath</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªç”¨äºè¡¨ç¤ºç«èŠ±è½¨è¿¹çš„åè®®ã€‚ä¸ºäº†èƒ½å¤Ÿæ›´ç®€å•åœ°åˆ›å»ºå„å¼å„æ ·çš„è½¨è¿¹ï¼Œæˆ‘å®šä¹‰äº†è¿™ä¸ªé€šç”¨æ¥å£åè®®ï¼Œå¹¶ä¸”é€‰æ‹©åŸºäºä¸‰é˜¶ <a href="https://en.wikipedia.org/wiki/B%C3%A9zier_curve" target="_blank" rel="noopener">è´å¡å°”æ›²çº¿</a> æ¥å®ç°è½¨è¿¹ï¼›è¿˜æ·»åŠ äº†ä¸€ä¸ª <code>init</code> æ–¹æ³•ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥é€šè¿‡ä¸€è¡Œä»£ç æ¥åˆ›å»ºè½¨è¿¹äº†ã€‚ä¸‰é˜¶è´å¡å°”æ›²çº¿å¿…é¡»åŒ…å«å››ä¸ªç‚¹ã€‚ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªç‚¹å®šä¹‰äº†è½¨è¿¹çš„å¼€å§‹å’Œç»“æŸçš„ä½ç½®ï¼Œä¸­é—´çš„ä¸¤ä¸ªç‚¹ç”¨äºæ§åˆ¶æ›²çº¿çš„å¼¯æ›²åº¦ã€‚ä½ å¯ä»¥ç”¨åœ¨çº¿æ•°å­¦å·¥å…· <a href="https://www.desmos.com/calculator/epunzldltu" target="_blank" rel="noopener">desmos</a> æ¥è°ƒæ•´è‡ªå·±çš„è´å¡å°”æ›²çº¿ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// æ‹¥æœ‰ä¸¤ä¸ªæ§åˆ¶ç‚¹çš„è´å¡å°”æ›²çº¿</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CubicBezierTrajectory</span>: <span class="title">SparkTrajectory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> points = [<span class="type">CGPoint</span>]()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="number">_</span> x0: <span class="type">CGFloat</span>, <span class="number">_</span> y0: <span class="type">CGFloat</span>,</span><br><span class="line">         <span class="number">_</span> x1: <span class="type">CGFloat</span>, <span class="number">_</span> y1: <span class="type">CGFloat</span>,</span><br><span class="line">         <span class="number">_</span> x2: <span class="type">CGFloat</span>, <span class="number">_</span> y2: <span class="type">CGFloat</span>,</span><br><span class="line">         <span class="number">_</span> x3: <span class="type">CGFloat</span>, <span class="number">_</span> y3: <span class="type">CGFloat</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.points.append(<span class="type">CGPoint</span>(x: x0, y: y0))</span><br><span class="line">        <span class="keyword">self</span>.points.append(<span class="type">CGPoint</span>(x: x1, y: y1))</span><br><span class="line">        <span class="keyword">self</span>.points.append(<span class="type">CGPoint</span>(x: x2, y: y2))</span><br><span class="line">        <span class="keyword">self</span>.points.append(<span class="type">CGPoint</span>(x: x3, y: y3))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> path: <span class="type">UIBezierPath</span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">self</span>.points.<span class="built_in">count</span> == <span class="number">4</span> <span class="keyword">else</span> &#123; <span class="built_in">fatalError</span>(<span class="string">"4 points required"</span>) &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> path = <span class="type">UIBezierPath</span>()</span><br><span class="line">        path.move(to: <span class="keyword">self</span>.points[<span class="number">0</span>])</span><br><span class="line">        path.addCurve(to: <span class="keyword">self</span>.points[<span class="number">3</span>], controlPoint1: <span class="keyword">self</span>.points[<span class="number">1</span>], controlPoint2: <span class="keyword">self</span>.points[<span class="number">2</span>])</span><br><span class="line">        <span class="keyword">return</span> path</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://swift.gg/img/articles/add-fireworks-and-sparks-to-a-uiview/desmos-tool.png1565786279.294991" alt="desmos-tool"></p><p>æ¥ä¸‹æ¥è¦å®ç°çš„æ˜¯ä¸€ä¸ªèƒ½å¤Ÿåˆ›å»ºéšæœºè½¨è¿¹çš„å·¥å‚ã€‚å‰é¢çš„å›¾ä¸­ä½ å¯ä»¥çœ‹åˆ°è½¨è¿¹æ˜¯æ ¹æ®é¢œè‰²æ¥åˆ†ç»„çš„ã€‚æˆ‘åªåˆ›å»ºäº†ä¸Šå³å’Œä¸‹å³ä¸¤å—ä½ç½®çš„è½¨è¿¹ï¼Œç„¶åè¿›è¡Œäº†é•œåƒå¤åˆ¶ã€‚è¿™å¯¹äºæˆ‘ä»¬å°†è¦å‘å°„çš„çƒŸèŠ±æ¥è¯´å·²ç»è¶³å¤Ÿäº†ğŸš€</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">SparkTrajectoryFactory</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">ClassicSparkTrajectoryFactoryProtocol</span>: <span class="title">SparkTrajectoryFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">randomTopRight</span><span class="params">()</span></span> -&gt; <span class="type">SparkTrajectory</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">randomBottomRight</span><span class="params">()</span></span> -&gt; <span class="type">SparkTrajectory</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassicSparkTrajectoryFactory</span>: <span class="title">ClassicSparkTrajectoryFactoryProtocol</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">lazy</span> <span class="keyword">var</span> topRight: [<span class="type">SparkTrajectory</span>] = &#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="type">CubicBezierTrajectory</span>(<span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.31</span>, -<span class="number">0.46</span>, <span class="number">0.74</span>, -<span class="number">0.29</span>, <span class="number">0.99</span>, <span class="number">0.12</span>),</span><br><span class="line">            <span class="type">CubicBezierTrajectory</span>(<span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.31</span>, -<span class="number">0.46</span>, <span class="number">0.62</span>, -<span class="number">0.49</span>, <span class="number">0.88</span>, -<span class="number">0.19</span>),</span><br><span class="line">            <span class="type">CubicBezierTrajectory</span>(<span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.10</span>, -<span class="number">0.54</span>, <span class="number">0.44</span>, -<span class="number">0.53</span>, <span class="number">0.66</span>, -<span class="number">0.30</span>),</span><br><span class="line">            <span class="type">CubicBezierTrajectory</span>(<span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.19</span>, -<span class="number">0.46</span>, <span class="number">0.41</span>, -<span class="number">0.53</span>, <span class="number">0.65</span>, -<span class="number">0.45</span>),</span><br><span class="line">        ]</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">lazy</span> <span class="keyword">var</span> bottomRight: [<span class="type">SparkTrajectory</span>] = &#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="type">CubicBezierTrajectory</span>(<span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.42</span>, -<span class="number">0.01</span>, <span class="number">0.68</span>, <span class="number">0.11</span>, <span class="number">0.87</span>, <span class="number">0.44</span>),</span><br><span class="line">            <span class="type">CubicBezierTrajectory</span>(<span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.35</span>, <span class="number">0.00</span>, <span class="number">0.55</span>, <span class="number">0.12</span>, <span class="number">0.62</span>, <span class="number">0.45</span>),</span><br><span class="line">            <span class="type">CubicBezierTrajectory</span>(<span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.21</span>, <span class="number">0.05</span>, <span class="number">0.31</span>, <span class="number">0.19</span>, <span class="number">0.32</span>, <span class="number">0.45</span>),</span><br><span class="line">            <span class="type">CubicBezierTrajectory</span>(<span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.18</span>, <span class="number">0.00</span>, <span class="number">0.31</span>, <span class="number">0.11</span>, <span class="number">0.35</span>, <span class="number">0.25</span>),</span><br><span class="line">        ]</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">randomTopRight</span><span class="params">()</span></span> -&gt; <span class="type">SparkTrajectory</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.topRight[<span class="type">Int</span>(arc4random_uniform(<span class="type">UInt32</span>(<span class="keyword">self</span>.topRight.<span class="built_in">count</span>)))]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">randomBottomRight</span><span class="params">()</span></span> -&gt; <span class="type">SparkTrajectory</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.bottomRight[<span class="type">Int</span>(arc4random_uniform(<span class="type">UInt32</span>(<span class="keyword">self</span>.bottomRight.<span class="built_in">count</span>)))]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå…ˆåˆ›å»ºäº†ç”¨æ¥è¡¨ç¤ºç«èŠ±è½¨è¿¹å·¥å‚çš„æŠ½è±¡åè®®ï¼Œè¿˜æœ‰ä¸€ä¸ªæˆ‘å°†å…¶å‘½åä¸º<em>ç»å…¸çƒŸèŠ±</em>çš„ç«èŠ±è½¨è¿¹çš„æŠ½è±¡åè®®ï¼Œè¿™æ ·çš„æŠ½è±¡å¯ä»¥æ–¹ä¾¿åç»­å°†å…¶æ›¿æ¢æˆå…¶ä»–çš„è½¨è¿¹åè®®ã€‚</p><p>å¦‚åŒæˆ‘å‰é¢æåˆ°çš„ï¼Œæˆ‘é€šè¿‡ <a href="https://www.desmos.com/calculator/epunzldltu" target="_blank" rel="noopener">desmos</a> åˆ›å»ºäº†ä¸¤ç»„è½¨è¿¹ï¼Œå¯¹åº”ç€å³ä¸Šï¼Œå’Œå³ä¸‹ä¸¤å—åŒºåŸŸã€‚</p><p><strong>é‡è¦æé†’</strong>ï¼šå¦‚æœåœ¨ desmos ä¸Š y è½´æ‰€æ˜¾ç¤ºçš„æ˜¯æ­£æ•°ï¼Œé‚£ä¹ˆä½ åº”è¯¥å°†å…¶è½¬æ¢æˆè´Ÿæ•°ã€‚å› ä¸ºåœ¨ iOS ç³»ç»Ÿä¸­ï¼Œè¶Šæ¥è¿‘å±å¹•é¡¶éƒ¨ y è½´çš„å€¼è¶Šå°ï¼Œæ‰€ä»¥ y è½´çš„å€¼éœ€è¦ç¿»è½¬ä¸€ä¸‹ã€‚</p><p>å¹¶ä¸”å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸ºäº†åé¢å¥½è®¡ç®—ï¼Œæ‰€æœ‰çš„è½¨è¿¹åˆå§‹ç‚¹éƒ½æ˜¯ (0,0)ã€‚</p><p>æˆ‘ä»¬ç°åœ¨åˆ›å»ºå¥½äº†è½¨è¿¹ã€‚æ¥ä¸‹æ¥åˆ›å»ºä¸€äº›è§†å›¾æ¥è¡¨ç¤ºç«èŠ±ã€‚å¯¹äºç»å…¸çƒŸèŠ±æ¥è¯´ï¼Œåªéœ€è¦æœ‰é¢œè‰²çš„åœ†åœˆå°±è¡Œã€‚é€šè¿‡æŠ½è±¡å¯ä»¥è®©æˆ‘ä»¬åœ¨æœªæ¥ä»¥æ›´ä½çš„æˆæœ¬ï¼Œåˆ›å»ºä¸åŒçš„ç«èŠ±è§†å›¾ã€‚æ¯”å¦‚å°é¸­å­å›¾ç‰‡ï¼Œæˆ–è€…æ˜¯èƒ–å‰çŒ« :)</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SparkView</span>: <span class="title">UIView</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CircleColorSparkView</span>: <span class="title">SparkView</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(color: <span class="type">UIColor</span>, size: <span class="type">CGSize</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: <span class="type">CGRect</span>(origin: .zero, size: size))</span><br><span class="line">        <span class="keyword">self</span>.backgroundColor = color</span><br><span class="line">        <span class="keyword">self</span>.layer.cornerRadius = <span class="keyword">self</span>.frame.width / <span class="number">2.0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(coder: aDecoder)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIColor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> sparkColorSet1: [<span class="type">UIColor</span>] = &#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="type">UIColor</span>(red:<span class="number">0.89</span>, green:<span class="number">0.58</span>, blue:<span class="number">0.70</span>, alpha:<span class="number">1.00</span>),</span><br><span class="line">            <span class="type">UIColor</span>(red:<span class="number">0.96</span>, green:<span class="number">0.87</span>, blue:<span class="number">0.62</span>, alpha:<span class="number">1.00</span>),</span><br><span class="line">            <span class="type">UIColor</span>(red:<span class="number">0.67</span>, green:<span class="number">0.82</span>, blue:<span class="number">0.94</span>, alpha:<span class="number">1.00</span>),</span><br><span class="line">            <span class="type">UIColor</span>(red:<span class="number">0.54</span>, green:<span class="number">0.56</span>, blue:<span class="number">0.94</span>, alpha:<span class="number">1.00</span>),</span><br><span class="line">        ]</span><br><span class="line">    &#125;()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†åˆ›å»ºç«èŠ±è§†å›¾ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå·¥å‚æ•°æ®ä»¥å¡«å……ï¼Œéœ€è¦çš„æ•°æ®æ˜¯ç«èŠ±çš„å¤§å°ï¼Œä»¥åŠç”¨æ¥å†³å®šç«èŠ±åœ¨å“ªä¸ªçƒŸèŠ±çš„ç´¢å¼•ï¼ˆç”¨äºå¢åŠ éšæœºæ€§ï¼‰ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">SparkViewFactoryData</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> size: <span class="type">CGSize</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="keyword">var</span> index: <span class="type">Int</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">SparkViewFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">create</span><span class="params">(with data: SparkViewFactoryData)</span></span> -&gt; <span class="type">SparkView</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CircleColorSparkViewFactory</span>: <span class="title">SparkViewFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> colors: [<span class="type">UIColor</span>] &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIColor</span>.sparkColorSet1</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">create</span><span class="params">(with data: SparkViewFactoryData)</span></span> -&gt; <span class="type">SparkView</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> color = <span class="keyword">self</span>.colors[data.index % <span class="keyword">self</span>.colors.<span class="built_in">count</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="type">CircleColorSparkView</span>(color: color, size: data.size)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ çœ‹è¿™æ ·æŠ½è±¡äº†ä¹‹åï¼Œå°±ç®—å†å®ç°ä¸€ä¸ªåƒèƒ–å‰çŒ«çš„ç«èŠ±ä¹Ÿä¼šå¾ˆç®€å•ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥åˆ›å»º<em>ç»å…¸çƒŸèŠ±</em>ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">FireworkSpark</span> = (sparkView: <span class="type">SparkView</span>, trajectory: <span class="type">SparkTrajectory</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Firework</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// çƒŸèŠ±çš„åˆå§‹ä½ç½®</span></span><br><span class="line">    <span class="keyword">var</span> origin: <span class="type">CGPoint</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// å®šä¹‰äº†è½¨è¿¹çš„å¤§å°. è½¨è¿¹éƒ½æ˜¯ç»Ÿä¸€å¤§å°</span></span><br><span class="line">    <span class="comment">/// æ‰€ä»¥éœ€è¦åœ¨å±•ç¤ºåˆ°å±å¹•ä¸Šå‰å°†å…¶æ”¾å¤§</span></span><br><span class="line">    <span class="keyword">var</span> scale: <span class="type">CGFloat</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// ç«èŠ±çš„å¤§å°</span></span><br><span class="line">    <span class="keyword">var</span> sparkSize: <span class="type">CGSize</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// è·å–è½¨è¿¹</span></span><br><span class="line">    <span class="keyword">var</span> trajectoryFactory: <span class="type">SparkTrajectoryFactory</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// è·å–ç«èŠ±è§†å›¾</span></span><br><span class="line">    <span class="keyword">var</span> sparkViewFactory: <span class="type">SparkViewFactory</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">sparkViewFactoryData</span><span class="params">(at index: Int)</span></span> -&gt; <span class="type">SparkViewFactoryData</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">sparkView</span><span class="params">(at index: Int)</span></span> -&gt; <span class="type">SparkView</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">trajectory</span><span class="params">(at index: Int)</span></span> -&gt; <span class="type">SparkTrajectory</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Firework</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// å¸®åŠ©æ–¹æ³•ï¼Œç”¨äºè¿”å›ç«èŠ±è§†å›¾åŠå¯¹åº”çš„è½¨è¿¹</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">spark</span><span class="params">(at index: Int)</span></span> -&gt; <span class="type">FireworkSpark</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">FireworkSpark</span>(<span class="keyword">self</span>.sparkView(at: index), <span class="keyword">self</span>.trajectory(at: index))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å°±æ˜¯çƒŸèŠ±çš„æŠ½è±¡ã€‚ä¸ºäº†è¡¨ç¤ºä¸€ä¸ªçƒŸèŠ±éœ€è¦è¿™äº›ä¸œè¥¿:</p><ul><li><em>origin</em></li><li><em>scale</em></li><li><em>sparkSize</em></li><li><em>trajectoryFactory</em></li><li><em>sparkViewFactory</em></li></ul><p>åœ¨æˆ‘ä»¬å®ç°åè®®ä¹‹å‰ï¼Œè¿˜æœ‰ä¸€ä¸ªæˆ‘ä¹‹å‰æ²¡æœ‰æåˆ°è¿‡çš„å«åš<em>æŒ‰è½¨è¿¹ç¼©æ”¾</em>çš„æ¦‚å¿µã€‚å½“ç«èŠ±å¤„äºè½¨è¿¹ &lt;-1, 1&gt; æˆ–ç›¸ä¼¼çš„ä½ç½®æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒçš„å¤§å°ä¼šè·Ÿéšè½¨è¿¹å˜åŒ–ã€‚æˆ‘ä»¬è¿˜éœ€è¦æ”¾å¤§è·¯å¾„ä»¥è¦†ç›–æ›´å¤§çš„å±å¹•æ˜¾ç¤ºæ•ˆæœã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ”¯æŒæ°´å¹³ç¿»è½¬è·¯å¾„ï¼Œä»¥æ–¹ä¾¿æˆ‘ä»¬å®ç°ç»å…¸çƒŸèŠ±å·¦ä¾§éƒ¨åˆ†çš„è½¨è¿¹ï¼Œå¹¶ä¸”è¿˜è¦è®©è½¨è¿¹èƒ½æœæŸä¸ªæŒ‡å®šæ–¹å‘åç§»ä¸€ç‚¹ï¼ˆå¢åŠ éšæœºæ€§ï¼‰ã€‚ä¸‹é¢æ˜¯ä¸¤ä¸ªèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬è¾¾åˆ°ç›®çš„çš„æ–¹æ³•ï¼Œæˆ‘ç›¸ä¿¡è¿™æ®µä»£ç å·²ç»ä¸éœ€è¦æ›´å¤šæè¿°äº†ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">SparkTrajectory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// ç¼©æ”¾è½¨è¿¹ä½¿å…¶ç¬¦åˆå„ç§ UI çš„è¦æ±‚</span></span><br><span class="line">    <span class="comment">/// åœ¨å„ç§å½¢å˜å’Œ shift: ä¹‹å‰ä½¿ç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">scale</span><span class="params">(by value: CGFloat)</span></span> -&gt; <span class="type">SparkTrajectory</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> copy = <span class="keyword">self</span></span><br><span class="line">        (<span class="number">0</span>..&lt;<span class="keyword">self</span>.points.<span class="built_in">count</span>).forEach &#123; copy.points[$<span class="number">0</span>].multiply(by: value) &#125;</span><br><span class="line">        <span class="keyword">return</span> copy</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// æ°´å¹³ç¿»è½¬è½¨è¿¹</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">flip</span><span class="params">()</span></span> -&gt; <span class="type">SparkTrajectory</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> copy = <span class="keyword">self</span></span><br><span class="line">        (<span class="number">0</span>..&lt;<span class="keyword">self</span>.points.<span class="built_in">count</span>).forEach &#123; copy.points[$<span class="number">0</span>].x *= -<span class="number">1</span> &#125;</span><br><span class="line">        <span class="keyword">return</span> copy</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// åç§»è½¨è¿¹ï¼Œåœ¨æ¯ä¸ªç‚¹ä¸Šç”Ÿæ•ˆ</span></span><br><span class="line">    <span class="comment">/// åœ¨å„ç§å½¢å˜å’Œ scale: å’Œä¹‹åä½¿ç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">shift</span><span class="params">(to point: CGPoint)</span></span> -&gt; <span class="type">SparkTrajectory</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> copy = <span class="keyword">self</span></span><br><span class="line">        <span class="keyword">let</span> vector = <span class="type">CGVector</span>(dx: point.x, dy: point.y)</span><br><span class="line">        (<span class="number">0</span>..&lt;<span class="keyword">self</span>.points.<span class="built_in">count</span>).forEach &#123; copy.points[$<span class="number">0</span>].add(vector: vector) &#125;</span><br><span class="line">        <span class="keyword">return</span> copy</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å®ç°ç»å…¸çƒŸèŠ±ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassicFirework</span>: <span class="title">Firework</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     x     |     x</span></span><br><span class="line"><span class="comment">        x  |   x</span></span><br><span class="line"><span class="comment">           |</span></span><br><span class="line"><span class="comment">     ---------------</span></span><br><span class="line"><span class="comment">         x |  x</span></span><br><span class="line"><span class="comment">       x   |</span></span><br><span class="line"><span class="comment">           |     x</span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">struct</span> <span class="title">FlipOptions</span>: <span class="title">OptionSet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> rawValue: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">let</span> horizontally = <span class="type">FlipOptions</span>(rawValue: <span class="number">1</span> &lt;&lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">let</span> vertically = <span class="type">FlipOptions</span>(rawValue: <span class="number">1</span> &lt;&lt; <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">enum</span> <span class="title">Quarter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> topRight</span><br><span class="line">        <span class="keyword">case</span> bottomRight</span><br><span class="line">        <span class="keyword">case</span> bottomLeft</span><br><span class="line">        <span class="keyword">case</span> topLeft</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> origin: <span class="type">CGPoint</span></span><br><span class="line">    <span class="keyword">var</span> scale: <span class="type">CGFloat</span></span><br><span class="line">    <span class="keyword">var</span> sparkSize: <span class="type">CGSize</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> maxChangeValue: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> trajectoryFactory: <span class="type">SparkTrajectoryFactory</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">ClassicSparkTrajectoryFactory</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> classicTrajectoryFactory: <span class="type">ClassicSparkTrajectoryFactoryProtocol</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.trajectoryFactory <span class="keyword">as</span>! <span class="type">ClassicSparkTrajectoryFactoryProtocol</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> sparkViewFactory: <span class="type">SparkViewFactory</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">CircleColorSparkViewFactory</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> quarters = [<span class="type">Quarter</span>]()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(origin: <span class="type">CGPoint</span>, sparkSize: <span class="type">CGSize</span>, scale: <span class="type">CGFloat</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.origin = origin</span><br><span class="line">        <span class="keyword">self</span>.scale = scale</span><br><span class="line">        <span class="keyword">self</span>.sparkSize = sparkSize</span><br><span class="line">        <span class="keyword">self</span>.quarters = <span class="keyword">self</span>.shuffledQuarters()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">sparkViewFactoryData</span><span class="params">(at index: Int)</span></span> -&gt; <span class="type">SparkViewFactoryData</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">DefaultSparkViewFactoryData</span>(size: <span class="keyword">self</span>.sparkSize, index: index)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">sparkView</span><span class="params">(at index: Int)</span></span> -&gt; <span class="type">SparkView</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.sparkViewFactory.create(with: <span class="keyword">self</span>.sparkViewFactoryData(at: index))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">trajectory</span><span class="params">(at index: Int)</span></span> -&gt; <span class="type">SparkTrajectory</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> quarter = <span class="keyword">self</span>.quarters[index]</span><br><span class="line">        <span class="keyword">let</span> flipOptions = <span class="keyword">self</span>.flipOptions(<span class="keyword">for</span>: quarter)</span><br><span class="line">        <span class="keyword">let</span> changeVector = <span class="keyword">self</span>.randomChangeVector(flipOptions: flipOptions, maxValue: <span class="keyword">self</span>.maxChangeValue)</span><br><span class="line">        <span class="keyword">let</span> sparkOrigin = <span class="keyword">self</span>.origin.adding(vector: changeVector)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.randomTrajectory(flipOptions: flipOptions).scale(by: <span class="keyword">self</span>.scale).shift(to: sparkOrigin)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">flipOptions</span><span class="params">(`<span class="keyword">for</span>` quarter: Quarter)</span></span> -&gt; <span class="type">FlipOptions</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> flipOptions: <span class="type">FlipOptions</span> = []</span><br><span class="line">        <span class="keyword">if</span> quarter == .bottomLeft || quarter == .topLeft &#123;</span><br><span class="line">            flipOptions.insert(.horizontally)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> quarter == .bottomLeft || quarter == .bottomRight &#123;</span><br><span class="line">            flipOptions.insert(.vertically)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> flipOptions</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">shuffledQuarters</span><span class="params">()</span></span> -&gt; [<span class="type">Quarter</span>] &#123;</span><br><span class="line">        <span class="keyword">var</span> quarters: [<span class="type">Quarter</span>] = [</span><br><span class="line">            .topRight, .topRight,</span><br><span class="line">            .bottomRight, .bottomRight,</span><br><span class="line">            .bottomLeft, .bottomLeft,</span><br><span class="line">            .topLeft, .topLeft</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> shuffled = [<span class="type">Quarter</span>]()</span><br><span class="line">        <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;quarters.<span class="built_in">count</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> idx = <span class="type">Int</span>(arc4random_uniform(<span class="type">UInt32</span>(quarters.<span class="built_in">count</span>)))</span><br><span class="line">            shuffled.append(quarters[idx])</span><br><span class="line">            quarters.remove(at: idx)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> shuffled</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">randomTrajectory</span><span class="params">(flipOptions: FlipOptions)</span></span> -&gt; <span class="type">SparkTrajectory</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> trajectory: <span class="type">SparkTrajectory</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> flipOptions.<span class="built_in">contains</span>(.vertically) &#123;</span><br><span class="line">            trajectory = <span class="keyword">self</span>.classicTrajectoryFactory.randomBottomRight()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            trajectory = <span class="keyword">self</span>.classicTrajectoryFactory.randomTopRight()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> flipOptions.<span class="built_in">contains</span>(.horizontally) ? trajectory.flip() : trajectory</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">randomChangeVector</span><span class="params">(flipOptions: FlipOptions, maxValue: Int)</span></span> -&gt; <span class="type">CGVector</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> values = (<span class="keyword">self</span>.randomChange(maxValue), <span class="keyword">self</span>.randomChange(maxValue))</span><br><span class="line">        <span class="keyword">let</span> changeX = flipOptions.<span class="built_in">contains</span>(.horizontally) ? -values.<span class="number">0</span> : values.<span class="number">0</span></span><br><span class="line">        <span class="keyword">let</span> changeY = flipOptions.<span class="built_in">contains</span>(.vertically) ? values.<span class="number">1</span> : -values.<span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> <span class="type">CGVector</span>(dx: changeX, dy: changeY)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">randomChange</span><span class="params">(<span class="number">_</span> maxValue: Int)</span></span> -&gt; <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">CGFloat</span>(arc4random_uniform(<span class="type">UInt32</span>(maxValue)))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§å¤šæ•°ä»£ç éƒ½æ˜¯ <code>Firework</code> åè®®çš„å®ç°ï¼Œæ‰€ä»¥åº”è¯¥å¾ˆå®¹æ˜“ç†è§£ã€‚æˆ‘ä»¬åœ¨å„å¤„ä¼ é€’äº†éœ€è¦çš„å·¥å‚ç±»ï¼Œè¿˜æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„æšä¸¾ç±»å‹æ¥éšæœºåœ°ä¸ºæ¯ä¸ªç«èŠ±æŒ‡å®šè½¨è¿¹ã€‚</p><p>æœ‰å°‘æ•°å‡ ä¸ªæ–¹æ³•ç”¨æ¥ä¸ºçƒŸèŠ±å’Œç«èŠ±å¢åŠ éšæœºæ€§ã€‚</p><p>è¿˜å¼•å…¥äº†ä¸€ä¸ª <code>quarters</code> å±æ€§ï¼Œå…¶ä¸­åŒ…å«äº†ç«èŠ±çš„æ‰€æœ‰çš„æ–¹ä½ã€‚æˆ‘ä»¬é€šè¿‡  <code>shuffledQuarters:</code> æ¥é‡æ–°æ’åˆ—ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬ä¸ä¼šæ€»æ˜¯åœ¨ç›¸åŒçš„æ–¹ä½åˆ›å»ºç›¸åŒæ•°é‡çš„ç«èŠ±ã€‚</p><p>å¥½äº†ï¼Œæˆ‘ä»¬åˆ›å»ºå¥½äº†çƒŸèŠ±ï¼Œæ¥ä¸‹æ¥æ€ä¹ˆè®©ç«èŠ±åŠ¨èµ·æ¥å‘¢ï¼Ÿè¿™å°±å¼•å…¥äº†ç«èŠ±åŠ¨ç”»å¯åŠ¨å™¨çš„æ¦‚å¿µã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">SparkViewAnimator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">animate</span><span class="params">(spark: FireworkSpark, duration: TimeInterval)</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ªåŒ…å«ç«èŠ±è§†å›¾å’Œå…¶å¯¹åº”è½¨è¿¹çš„å…ƒç»„ <code>FireworkSpark</code>ï¼Œä»¥åŠåŠ¨ç”»çš„æŒç»­æ—¶é—´ã€‚æ–¹æ³•çš„å®ç°å–å†³äºæˆ‘ä»¬ã€‚æˆ‘è‡ªå·±çš„å®ç°è›®å¤šçš„ï¼Œä½†ä¸»è¦åšäº†ä¸‰ä»¶äº‹æƒ…ï¼šè®©ç«èŠ±è§†å›¾è·Ÿéšè½¨è¿¹ï¼ŒåŒæ—¶ç¼©æ”¾ç«èŠ±ï¼ˆå¸¦æœ‰éšæœºæ€§ï¼‰ï¼Œä¿®æ”¹å…¶ä¸é€æ˜åº¦ã€‚ç®€å•å§ã€‚åŒæ—¶å¾—ç›Šäº <code>SparkViewAnimator</code> çš„æŠ½è±¡åº¦ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¾ˆç®€å•åœ°å°†å…¶æ›¿æ¢æˆä»»ä½•æˆ‘ä»¬æƒ³è¦çš„åŠ¨ç”»æ•ˆæœã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ClassicFireworkAnimator</span>: <span class="title">SparkViewAnimator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">animate</span><span class="params">(spark: FireworkSpark, duration: TimeInterval)</span></span> &#123;</span><br><span class="line">        spark.sparkView.isHidden = <span class="literal">false</span> <span class="comment">// show previously hidden spark view</span></span><br><span class="line"></span><br><span class="line">        <span class="type">CATransaction</span>.begin()</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç«èŠ±çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">let</span> positionAnim = <span class="type">CAKeyframeAnimation</span>(keyPath: <span class="string">"position"</span>)</span><br><span class="line">        positionAnim.path = spark.trajectory.path.cgPath</span><br><span class="line">        positionAnim.calculationMode = kCAAnimationLinear</span><br><span class="line">        positionAnim.rotationMode = kCAAnimationRotateAuto</span><br><span class="line">        positionAnim.duration = duration</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç«èŠ±çš„ç¼©æ”¾</span></span><br><span class="line">        <span class="keyword">let</span> randomMaxScale = <span class="number">1.0</span> + <span class="type">CGFloat</span>(arc4random_uniform(<span class="number">7</span>)) / <span class="number">10.0</span></span><br><span class="line">        <span class="keyword">let</span> randomMinScale = <span class="number">0.5</span> + <span class="type">CGFloat</span>(arc4random_uniform(<span class="number">3</span>)) / <span class="number">10.0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> fromTransform = <span class="type">CATransform3DIdentity</span></span><br><span class="line">        <span class="keyword">let</span> byTransform = <span class="type">CATransform3DScale</span>(fromTransform, randomMaxScale, randomMaxScale, randomMaxScale)</span><br><span class="line">        <span class="keyword">let</span> toTransform = <span class="type">CATransform3DScale</span>(<span class="type">CATransform3DIdentity</span>, randomMinScale, randomMinScale, randomMinScale)</span><br><span class="line">        <span class="keyword">let</span> transformAnim = <span class="type">CAKeyframeAnimation</span>(keyPath: <span class="string">"transform"</span>)</span><br><span class="line"></span><br><span class="line">        transformAnim.values = [</span><br><span class="line">            <span class="type">NSValue</span>(caTransform3D: fromTransform),</span><br><span class="line">            <span class="type">NSValue</span>(caTransform3D: byTransform),</span><br><span class="line">            <span class="type">NSValue</span>(caTransform3D: toTransform)</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        transformAnim.duration = duration</span><br><span class="line">        transformAnim.timingFunction = <span class="type">CAMediaTimingFunction</span>(name: kCAMediaTimingFunctionEaseOut)</span><br><span class="line">        spark.sparkView.layer.transform = toTransform</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç«èŠ±çš„ä¸é€æ˜åº¦</span></span><br><span class="line">        <span class="keyword">let</span> opacityAnim = <span class="type">CAKeyframeAnimation</span>(keyPath: <span class="string">"opacity"</span>)</span><br><span class="line">        opacityAnim.values = [<span class="number">1.0</span>, <span class="number">0.0</span>]</span><br><span class="line">        opacityAnim.keyTimes = [<span class="number">0.95</span>, <span class="number">0.98</span>]</span><br><span class="line">        opacityAnim.duration = duration</span><br><span class="line">        spark.sparkView.layer.opacity = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç»„åˆåŠ¨ç”»</span></span><br><span class="line">        <span class="keyword">let</span> groupAnimation = <span class="type">CAAnimationGroup</span>()</span><br><span class="line">        groupAnimation.animations = [positionAnim, transformAnim, opacityAnim]</span><br><span class="line">        groupAnimation.duration = duration</span><br><span class="line"></span><br><span class="line">        <span class="type">CATransaction</span>.setCompletionBlock(&#123;</span><br><span class="line">            spark.sparkView.removeFromSuperview()</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        spark.sparkView.layer.add(groupAnimation, forKey: <span class="string">"spark-animation"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="type">CATransaction</span>.commit()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨çš„ä»£ç å·²ç»è¶³å¤Ÿè®©æˆ‘ä»¬åœ¨ç‰¹å®šçš„è§†å›¾ä¸Šå±•ç¤ºçƒŸèŠ±äº†ã€‚æˆ‘åˆæ›´è¿›äº†ä¸€æ­¥ï¼Œåˆ›å»ºäº†ä¸€ä¸ª <code>ClassicFireworkController</code> æ¥å¤„ç†æ‰€æœ‰çš„å·¥ä½œï¼Œè¿™æ ·ç”¨ä¸€è¡Œä»£ç å°±èƒ½å¯åŠ¨çƒŸèŠ±ã€‚</p><p>è¿™ä¸ªçƒŸèŠ±æ§åˆ¶å™¨è¿˜åšäº†å¦ä¸€ä»¶äº‹ã€‚å®ƒå¯ä»¥ä¿®æ”¹çƒŸèŠ±çš„ <code>zPosition</code>ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥è®©çƒŸèŠ±ä¸€å‰ä¸€ååœ°å±•ç¤ºï¼Œæ•ˆæœæ›´å¥½çœ‹ä¸€äº›ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassicFireworkController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> sparkAnimator: <span class="type">SparkViewAnimator</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">ClassicFireworkAnimator</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">createFirework</span><span class="params">(at origin: CGPoint, sparkSize: CGSize, scale: CGFloat)</span></span> -&gt; <span class="type">Firework</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">ClassicFirework</span>(origin: origin, sparkSize: sparkSize, scale: scale)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// è®©çƒŸèŠ±åœ¨å…¶æºè§†å›¾çš„è§’è½é™„è¿‘çˆ†å¼€</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">addFireworks</span><span class="params">(<span class="built_in">count</span> fireworksCount: Int = <span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                      sparks sparksCount: Int,</span></span></span><br><span class="line"><span class="function"><span class="params">                      around sourceView: UIView,</span></span></span><br><span class="line"><span class="function"><span class="params">                      sparkSize: CGSize = CGSize<span class="params">(width: <span class="number">7</span>, height: <span class="number">7</span>)</span></span></span>,</span><br><span class="line">                      scale: <span class="type">CGFloat</span> = <span class="number">45.0</span>,</span><br><span class="line">                      maxVectorChange: <span class="type">CGFloat</span> = <span class="number">15.0</span>,</span><br><span class="line">                      animationDuration: <span class="type">TimeInterval</span> = <span class="number">0.4</span>,</span><br><span class="line">                      canChangeZIndex: <span class="type">Bool</span> = <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> superview = sourceView.superview <span class="keyword">else</span> &#123; <span class="built_in">fatalError</span>() &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> origins = [</span><br><span class="line">            <span class="type">CGPoint</span>(x: sourceView.frame.minX, y: sourceView.frame.minY),</span><br><span class="line">            <span class="type">CGPoint</span>(x: sourceView.frame.maxX, y: sourceView.frame.minY),</span><br><span class="line">            <span class="type">CGPoint</span>(x: sourceView.frame.minX, y: sourceView.frame.maxY),</span><br><span class="line">            <span class="type">CGPoint</span>(x: sourceView.frame.maxX, y: sourceView.frame.maxY),</span><br><span class="line">            ]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;fireworksCount &#123;</span><br><span class="line">            <span class="keyword">let</span> idx = <span class="type">Int</span>(arc4random_uniform(<span class="type">UInt32</span>(origins.<span class="built_in">count</span>)))</span><br><span class="line">            <span class="keyword">let</span> origin = origins[idx].adding(vector: <span class="keyword">self</span>.randomChangeVector(<span class="built_in">max</span>: maxVectorChange))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> firework = <span class="keyword">self</span>.createFirework(at: origin, sparkSize: sparkSize, scale: scale)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> sparkIndex <span class="keyword">in</span> <span class="number">0</span>..&lt;sparksCount &#123;</span><br><span class="line">                <span class="keyword">let</span> spark = firework.spark(at: sparkIndex)</span><br><span class="line">                spark.sparkView.isHidden = <span class="literal">true</span></span><br><span class="line">                superview.addSubview(spark.sparkView)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> canChangeZIndex &#123;</span><br><span class="line">                    <span class="keyword">let</span> zIndexChange: <span class="type">CGFloat</span> = arc4random_uniform(<span class="number">2</span>) == <span class="number">0</span> ? -<span class="number">1</span> : +<span class="number">1</span></span><br><span class="line">                    spark.sparkView.layer.zPosition = sourceView.layer.zPosition + zIndexChange</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    spark.sparkView.layer.zPosition = sourceView.layer.zPosition</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">self</span>.sparkAnimator.animate(spark: spark, duration: animationDuration)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">randomChangeVector</span><span class="params">(<span class="built_in">max</span>: CGFloat)</span></span> -&gt; <span class="type">CGVector</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">CGVector</span>(dx: <span class="keyword">self</span>.randomChange(<span class="built_in">max</span>: <span class="built_in">max</span>), dy: <span class="keyword">self</span>.randomChange(<span class="built_in">max</span>: <span class="built_in">max</span>))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">randomChange</span><span class="params">(<span class="built_in">max</span>: CGFloat)</span></span> -&gt; <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">CGFloat</span>(arc4random_uniform(<span class="type">UInt32</span>(<span class="built_in">max</span>))) - (<span class="built_in">max</span> / <span class="number">2.0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ§åˆ¶å™¨åªåšäº†å‡ ä»¶äº‹æƒ…ã€‚éšæœºé€‰æ‹©äº†ä¸€ä¸ªè§’è½å±•ç¤ºçƒŸèŠ±ã€‚åœ¨çƒŸèŠ±å‡ºç°çš„ä½ç½®ï¼ŒçƒŸèŠ±å’Œç«èŠ±çš„æ•°é‡ä¸Šå¢åŠ äº†ä¸€äº›éšæœºæ€§ã€‚ç„¶åå°†ç«èŠ±æ·»åŠ åˆ°ç›®æ ‡è§†å›¾ä¸Šï¼Œå¦‚æœéœ€è¦çš„è¯è¿˜ä¼šè°ƒæ•´ <code>zIndex</code>ï¼Œæœ€åå¯åŠ¨äº†åŠ¨ç”»ã€‚</p><p>å‡ ä¹æ‰€æœ‰çš„å‚æ•°éƒ½è®¾ç½®äº†é»˜è®¤å‚æ•°ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä¸ç®¡ä»–ä»¬ã€‚ç›´æ¥é€šè¿‡ä½ çš„æ§åˆ¶å™¨è°ƒç”¨è¿™ä¸ªï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">self</span>.fireworkController.addFireworks(<span class="built_in">count</span>: <span class="number">2</span>, sparks: <span class="number">8</span>, around: button)</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œå“‡!</p><p><img src="https://swift.gg/img/articles/add-fireworks-and-sparks-to-a-uiview/classic.gif1565786279.8336995" alt="classic"></p><p>ä»è¿™ä¸€æ­¥èµ·ï¼Œæ–°æ·»åŠ ä¸€ä¸ªåƒä¸‹é¢è¿™æ ·çš„çƒŸèŠ±å°±å˜å¾—éå¸¸ç®€å•äº†ã€‚ä½ åªéœ€è¦å®šä¹‰æ–°çš„è½¨è¿¹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„çƒŸèŠ±ï¼Œå¹¶ä¸”æŒ‰ç…§ä½ å¸Œæœ›çš„æ ·å­æ¥å®ç°å³å¯ã€‚å°†è¿™äº›ä»£ç æ”¾å…¥ä¸€ä¸ªæ§åˆ¶å™¨å¯ä»¥è®©ä½ æƒ³åœ¨å“ªé‡Œå¯åŠ¨çƒŸèŠ±éƒ½å¾ˆç®€å• :) æˆ–è€…ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ª<em>å–·æ³‰çƒŸèŠ±</em>ï¼Œæˆ‘å·²ç»æŠŠå®ƒæ”¾åœ¨äº†æˆ‘çš„ github é¡¹ç›® <a href="https://github.com/tomkowz/fireworks" target="_blank" rel="noopener">tomkowz/fireworks</a> ä¸­ã€‚</p><p><img src="https://swift.gg/img/articles/add-fireworks-and-sparks-to-a-uiview/fountain.gif1565786280.6926286" alt="fountain"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="_æ€»ç»“_"></a>_æ€»ç»“_</h2><p>è¿™ä¸ªåŠ¨ç”»æ•ˆæœçš„å®ç°å¹¶ä¸ç®€å•ä½†ä¹Ÿä¸ç®—å¾ˆéš¾ã€‚é€šè¿‡å¯¹é—®é¢˜ï¼ˆåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹æ˜¯åŠ¨ç”»æ•ˆæœï¼‰çš„æ­£ç¡®åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶åˆ†è§£æˆå¤šä¸ªå°é—®é¢˜ï¼Œé€ä¸ªè§£å†³ç„¶åå°†å…¶ç»„åˆåœ¨ä¸€èµ·ã€‚çœŸå¸Œæœ›æˆ‘æœ‰æœºä¼šèƒ½å¤Ÿåœ¨æœªæ¥çš„çš„é¡¹ç›®ä¸­ä½¿ç”¨è¿™ä¸ªæ•ˆæœğŸ‰</p><p>å¥½å•¦è¿™å°±æ˜¯ä»Šå¤©çš„å†…å®¹ã€‚æ„Ÿè°¢é˜…è¯»ï¼</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šTomasz Szulcï¼Œ&lt;a href=&quot;http://szulctomasz.com/programming-blog/2018/09/add-fireworks-and-sparks-to-a-uiview/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-09&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://github.com/joeytat&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Joeytat&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://numbbbbb.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;numbbbbb&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://github.com/WAMaker&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;WAMaker&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/Pancf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Pancf&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
    
    </summary>
    
      <category term="Tomasz Szulc" scheme="https://swift.gg/categories/Tomasz-Szulc/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
      <category term="æ•™ç¨‹" scheme="https://swift.gg/tags/%E6%95%99%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Bundles and Packages</title>
    <link href="https://swift.gg/2019/07/19/nshipster-bundles-and-packages/"/>
    <id>https://swift.gg/2019/07/19/nshipster-bundles-and-packages/</id>
    <published>2019-07-19T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šMatttï¼Œ<a href="https://nshipster.com/bundles-and-packages/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-12-17<br>è¯‘è€…ï¼š<a href="https://github.com/WAMaker" target="_blank" rel="noopener">WAMaker</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="https://bignerdcoding.com/" target="_blank" rel="noopener">BigNerdCoding</a>ï¼›å®šç¨¿ï¼š<a href="http://forelax.space" target="_blank" rel="noopener">Forelax</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>åœ¨è¿™ä¸ªç»™äºˆçš„å­£èŠ‚ï¼Œè®©æˆ‘ä»¬åœä¸‹è„šæ­¥ï¼Œæ€è€ƒä¸€ä¸ªç°ä»£è®¡ç®—æœºç³»ç»Ÿèµäºˆæˆ‘ä»¬çš„æœ€æ£’çš„ç¤¼ç‰©ï¼šæŠ½è±¡ã€‚</p><p>åœ¨æ•°ç™¾ä¸‡ CPU æ™¶ä½“ç®¡ã€SSD æ‰‡åŒºå’Œ LCD åƒç´ å…±åŒåä½œä¸‹ï¼Œå…¨çƒæ•°åäº¿äººèƒ½å¤Ÿæ—¥å¸¸ä½¿ç”¨è®¡ç®—æœºå’Œç§»åŠ¨è®¾å¤‡è€Œå¯¹æ­¤å…¨ç„¶ä¸çŸ¥ã€‚è¿™ä¸€åˆ‡éƒ½åº”å½’åŠŸäºåƒæ–‡ä»¶ï¼Œç›®å½•ï¼Œåº”ç”¨å’Œæ–‡æ¡£è¿™æ ·çš„æŠ½è±¡ã€‚</p><p>è¿™å‘¨çš„ NSHipsterï¼Œæˆ‘ä»¬å°†è®¨è®ºè‹¹æœå¹³å°ä¸Šä¸¤ä¸ªé‡è¦çš„æŠ½è±¡ï¼šåŒ…ä¸åŒ…è£¹ã€‚ğŸ</p><a id="more"></a><hr><p>å°½ç®¡æ˜¯ä¸åŒçš„æ¦‚å¿µï¼ŒåŒ…ä¸åŒ…è£¹è¿™ä¸¤ä¸ªæœ¯è¯­ç»å¸¸ä¼šè¢«æ›¿æ¢ä½¿ç”¨ã€‚æ¯«æ— ç–‘é—®ï¼Œé€ æˆå›°æƒ‘çš„éƒ¨åˆ†åŸå› å‡ºè‡ªå®ƒä»¬ç›¸ä¼¼çš„åç§°ï¼Œä½†æˆ–è®¸ä¸»è¦åŸå› æ˜¯è®¸å¤šåŒ…æ°å¥½ä¹Ÿæ˜¯åŒ…è£¹ï¼ˆåä¹‹äº¦ç„¶ï¼‰ã€‚</p><p>åœ¨æˆ‘ä»¬æ·±å…¥ä¹‹å‰ï¼Œå…ˆå®šä¹‰ä¸€ä¸‹è¿™ä¸¤ä¸ªæœ¯è¯­ï¼š</p><ul><li>åŒ…æ˜¯æŒ‡å…·æœ‰å·²çŸ¥ç»“æ„çš„ï¼ŒåŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä»¥åŠä»£ç æ‰€éœ€çš„èµ„æºçš„ç›®å½•ã€‚</li><li>åŒ…è£¹æ˜¯æŒ‡åœ¨è®¿è¾¾ä¸­çœ‹èµ·æ¥åƒæ˜¯æ–‡ä»¶çš„ç›®å½•ã€‚</li></ul><p>ä¸‹å›¾å±•ç¤ºäº†åŒ…ä¸åŒ…è£¹ä¹‹é—´çš„å…³ç³»ï¼Œå°†åº”ç”¨ã€æ¡†æ¶åŒ…ã€æ’ä»¶åŒ…å’Œæ–‡æ¡£åˆ†åˆ«æ”¾å…¥ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†ç±»ä¹‹ä¸­ï¼š<br><img src="https://nshipster.com/assets/packages-and-bundles-diagram-a604d818c7decc7430fffc8642f0743728d2f6be4dfae15b274a599655cd3e40.svg" alt="diagram"></p><blockquote><p>å¦‚æœå¯¹ä¸¤è€…çš„åŒºåˆ«ä½ ä¾ç„¶æ„Ÿåˆ°å›°æƒ‘ï¼Œè¿™ä¸ªç±»æ¯”æˆ–è®¸èƒ½å¸®åŠ©ä½ ç†è§£ï¼š<br>æŠŠåŒ…è£¹æƒ³è±¡æˆæ˜¯ä¸€ä¸ªå†…å®¹è¢«éšè—çš„ç›’å­ï¼ˆğŸ“¦ï¼‰ï¼Œä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å®ä½“è€Œå­˜åœ¨ã€‚è¿™ç‚¹ä¸åŒ…ä¸åŒï¼ŒåŒ…æ›´åƒæ˜¯ä¸€ä¸ªèƒŒåŒ…ï¼ˆğŸ’ï¼‰ â€”â€” æ¯ä¸€æ¬¾éƒ½æœ‰ç‰¹æ®Šçš„å£è¢‹å’Œéš”å±‚ç”¨æ¥æºå¸¦ä½ éœ€è¦çš„ä¸œè¥¿ï¼Œä¸åŒçš„é…ç½®ç”¨ä»¥å†³å®šæ˜¯å¸¦å»å­¦æ ¡ï¼Œå»å·¥ä½œï¼Œè¿˜æ˜¯å»å¥èº«æˆ¿ã€‚å¦‚æœæŸæ ·ä¸œè¥¿æ—¢æ˜¯åŒ…ä¹Ÿæ˜¯åŒ…è£¹ï¼Œæ°ä¼¼è¡Œæï¼ˆğŸ§³ï¼‰ä¸€èˆ¬ï¼šåƒç›’å­ä¸€æ ·æµ‘ç„¶ä¸€ä½“ï¼ŒåƒèƒŒåŒ…ä¸€æ ·åˆ†éš”è‡ªå¦‚ã€‚</p></blockquote><h2 id="åŒ…ï¼ˆBundlesï¼‰"><a href="#åŒ…ï¼ˆBundlesï¼‰" class="headerlink" title="åŒ…ï¼ˆBundlesï¼‰"></a>åŒ…ï¼ˆBundlesï¼‰</h2><p>åŒ…ä¸ºä»£ç å’Œèµ„æºçš„ç»„ç»‡æä¾›äº†ç‰¹å®šç»“æ„ï¼Œæ„åœ¨<strong>æå‡å¼€å‘è€…çš„ä½“éªŒ</strong>ã€‚è¿™ä¸ªç»“æ„ä¸ä»…å…è®¸é¢„æµ‹æ€§çš„åŠ è½½ä»£ç å’Œèµ„æºï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒç±»ä¼¼äºæœ¬åœ°åŒ–è¿™æ ·çš„ç³»ç»Ÿæ€§ç‰¹æ€§ã€‚</p><p>åŒ…åˆ†å±äºä»¥ä¸‹ä¸‰ä¸ªç±»åˆ«ï¼Œæ¯ä¸€ç§éƒ½æœ‰å®ƒè‡ªå·±ç‰¹æ®Šçš„ç»“æ„å’Œè¦æ±‚ï¼š</p><ul><li><strong>åº”ç”¨åŒ…ï¼ˆApp Bundlesï¼‰</strong>ï¼šåŒ…å«ä¸€ä¸ªèƒ½è¢«å¯åŠ¨çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸€ä¸ªæè¿°å¯æ‰§è¡Œæ–‡ä»¶çš„ <code>Info.plist</code> æ–‡ä»¶ï¼Œåº”ç”¨å›¾æ ‡ï¼Œå¯åŠ¨å›¾ç‰‡ï¼Œèƒ½è¢«å¯æ‰§è¡Œæ–‡ä»¶è°ƒç”¨çš„æ¥å£æ–‡ä»¶ï¼Œå­—ç¬¦ä¸²æ–‡ä»¶ï¼Œä»¥åŠæ•°æ®æ–‡ä»¶ã€‚</li><li><strong>æ¡†æ¶åŒ…ï¼ˆFramework Bundlesï¼‰</strong>ï¼šåŒ…å«åŠ¨æ€åˆ†äº«åº“æ‰€éœ€è¦çš„ä»£ç å’Œèµ„æºã€‚</li><li><strong>å¯åŠ è½½åŒ…ï¼ˆLoadable Bundlesï¼‰</strong>ï¼šç±»ä¼¼äºæ’ä»¶ï¼ŒåŒ…å«æ‰©å±•åº”ç”¨åŠŸèƒ½çš„å¯æ‰§è¡Œä»£ç å’Œèµ„æºã€‚</li></ul><h3 id="è®¿é—®åŒ…å†…å®¹"><a href="#è®¿é—®åŒ…å†…å®¹" class="headerlink" title="è®¿é—®åŒ…å†…å®¹"></a>è®¿é—®åŒ…å†…å®¹</h3><p>å¯¹äºåº”ç”¨ï¼Œplaygroundsï¼Œä»¥åŠå…¶å®ƒä½ æ„Ÿå…´è¶£çš„åŒ…æ¥è¯´ï¼Œéƒ½èƒ½é€šè¿‡ <code>Bundle.main</code> è¿›è¡Œè®¿é—®ã€‚å¤§å¤šæ•°æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ <code>url(forResource:withExtension:)</code>ï¼ˆæˆ–å®ƒçš„ä¸€ç§å˜ä½“ï¼‰æ¥è·å–ç‰¹å®šèµ„æºçš„è·¯å¾„ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœåº”ç”¨ä¸­åŒ…å«äº†ä¸€ä¸ªåå« <code>Photo.jpg</code> çš„æ–‡ä»¶ï¼Œç”¨ä¸‹é¢çš„æ–¹æ³•èƒ½è·å¾—è®¿é—®å®ƒçš„ URLï¼š<br><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">Bundle</span>.main.url(forResource: <span class="string">"Photo"</span>, withExtension: <span class="string">"jpg"</span>)</span><br></pre></td></tr></table></figure></p><blockquote><p>å¦‚æœä½¿ç”¨ Asset Catalogï¼Œä½ å¯ä»¥ä»åª’ä½“åº“ï¼ˆ<kbd>â‡§</kbd><kbd>âŒ˜</kbd><kbd>M</kbd>ï¼‰æ‹–æ‹½åˆ°ç¼–è¾‘å™¨æ¥åˆ›å»ºå›¾åƒã€‚</p></blockquote><p>é™¤æ­¤ä¹‹å¤–ï¼Œ<code>Bundle</code> æä¾›äº†ä¸€äº›å®ä¾‹æ–¹æ³•å’Œå˜é‡æ¥è·å–æ ‡å‡†åŒ…å†…å®¹çš„ä½ç½®ï¼Œè¿”å› URL æˆ– String ç±»å‹çš„è·¯å¾„ï¼š</p><table><thead><tr><th>URL</th><th>Path</th><th>æè¿°</th></tr></thead><tbody><tr><td>executableURL</td><td>executablePath</td><td>å¯æ‰§è¡Œæ–‡ä»¶</td></tr><tr><td>url(forAuxiliaryExecutable:)</td><td>path(forAuxiliaryExecutable:)</td><td>è¾…åŠ©çš„å¯æ‰§è¡Œæ–‡ä»¶</td></tr><tr><td>resourceURL</td><td>resourcePath</td><td>åŒ…å«èµ„æºçš„å­ç›®å½•</td></tr><tr><td>sharedFrameworksURL</td><td>sharedFrameworksPath</td><td>åŒ…å«å…±äº«æ¡†æ¶çš„å­ç›®å½•</td></tr><tr><td>privateFrameworksURL</td><td>privateFrameworksPath</td><td>åŒ…å«ç§æœ‰æ¡†æ¶çš„å­ç›®å½•</td></tr><tr><td>builtInPlugInsURL</td><td>builtInPlugInsPath</td><td>åŒ…å«æ’ä»¶çš„å­ç›®å½•</td></tr><tr><td>sharedSupportURL</td><td>sharedSupportPath</td><td>åŒ…å«å…±äº«æ”¯æ´æ–‡ä»¶çš„å­ç›®å½•</td></tr><tr><td>appStoreReceiptURL</td><td></td><td>App Store çš„æ”¶æ®</td></tr></tbody></table><h3 id="è·å–åº”ç”¨ä¿¡æ¯"><a href="#è·å–åº”ç”¨ä¿¡æ¯" class="headerlink" title="è·å–åº”ç”¨ä¿¡æ¯"></a>è·å–åº”ç”¨ä¿¡æ¯</h3><p>æ‰€æœ‰çš„åº”ç”¨åŒ…éƒ½å¿…é¡»æœ‰ä¸€ä¸ªåŒ…å«åº”ç”¨ä¿¡æ¯çš„ <code>Info.plist</code> æ–‡ä»¶ã€‚</p><p><code>bundleURL</code> å’Œ <code>bundleIdentifier</code> è¿™æ ·çš„åŸæ•°æ®èƒ½å¤Ÿé€šè¿‡ bundle å®ä¾‹è¢«ç›´æ¥è®¿é—®ã€‚<br><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bundle = <span class="type">Bundle</span>.main</span><br><span class="line"></span><br><span class="line">bundle.bundleURL        <span class="comment">// "/path/to/Example.app"</span></span><br><span class="line">bundle.bundleIdentifier <span class="comment">// "com.nshipster.example"</span></span><br></pre></td></tr></table></figure></p><p>é€šè¿‡ä¸‹æ ‡èƒ½ä» <code>infoDictionary</code> å˜é‡è·å¾—å…¶ä»–ä¿¡æ¯ï¼ˆå¦‚æœä¿¡æ¯è¦å±•ç¤ºç»™ç”¨æˆ·ï¼Œè¯·ä½¿ç”¨ <code>localizedInfoDictionary</code>ï¼‰ã€‚<br><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">bundle.infoDictionary[<span class="string">"CFBundleName"</span>] <span class="comment">// "Example"</span></span><br><span class="line">bundle.localizedInfoDictionary[<span class="string">"CFBundleName"</span>] <span class="comment">// "Esempio" (`it_IT` locale)</span></span><br></pre></td></tr></table></figure></p><h3 id="è·å–æœ¬åœ°åŒ–å­—ç¬¦ä¸²"><a href="#è·å–æœ¬åœ°åŒ–å­—ç¬¦ä¸²" class="headerlink" title="è·å–æœ¬åœ°åŒ–å­—ç¬¦ä¸²"></a>è·å–æœ¬åœ°åŒ–å­—ç¬¦ä¸²</h3><p>åŒ…çš„å­˜åœ¨è®©æœ¬åœ°åŒ–å˜å¾—å®¹æ˜“ã€‚å¼ºåˆ¶æœ¬åœ°åŒ–èµ„æºçš„å­˜æ”¾ä½ç½®åï¼Œç³»ç»Ÿä¾¿èƒ½å°†åŠ è½½å“ªä¸ªç‰ˆæœ¬çš„æ–‡ä»¶çš„é€»è¾‘ä»å¼€å‘è€…å±‚é¢æŠ½è±¡å‡ºæ¥ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼ŒåŒ…è´Ÿè´£åŠ è½½åº”ç”¨çš„æœ¬åœ°åŒ–å­—ç¬¦ä¸²ã€‚ä½¿ç”¨ <code>localizedString(forKey:value:table:)</code> æ–¹æ³•å°±å¯ä»¥è·å–åˆ°è¿™äº›å€¼ã€‚<br><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bundle = <span class="type">Bundle</span>.main</span><br><span class="line">bundle.localizedString(forKey: <span class="string">"Hello, %@"</span>,</span><br><span class="line">                       value: <span class="string">"Hello, $&#123;username&#125;"</span>,</span><br><span class="line">                       table: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure></p><p>ç„¶è€Œï¼Œé€šå¸¸æ¥è¯´ç”¨ <code>NSLocalizedString</code> ä¼šæ›´å¥½ï¼Œåƒ <code>genstrings</code> è¿™æ ·çš„å·¥å…·èƒ½å¤Ÿè‡ªåŠ¨å–å‡ºé”®å’Œæ³¨é‡Šåˆ° <code>.strings</code> æ–‡ä»¶ä¸­ä¾¿äºç¿»è¯‘ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// Terminal</span><br><span class="line">$ find . \( -name &quot;*.swift&quot; !           \ # æ‰¾å‡ºæ‰€æœ‰ swift æ–‡ä»¶</span><br><span class="line">            ! -path &quot;./Carthage/*&quot;      \ # æ— è§† Carthage ä¸ CocoaPods çš„ä¾èµ–</span><br><span class="line">            ! -path &quot;./Pods/*&quot;</span><br><span class="line">         \)    |                        \</span><br><span class="line">  tr &apos;\n&apos; &apos;\0&apos; |                        \ # æ›¿æ¢åˆ†éš”ç¬¦</span><br><span class="line">  xargs -0 genstrings -o .              \ # å¤„ç†å¸¦ç©ºæ ¼çš„è·¯å¾„</span><br></pre></td></tr></table></figure></p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">NSLocalizedString</span>(<span class="string">"Hello, %@"</span>, comment: <span class="string">"Hello, $&#123;username&#125;"</span>)</span><br></pre></td></tr></table></figure><h2 id="åŒ…è£¹ï¼ˆPackagesï¼‰"><a href="#åŒ…è£¹ï¼ˆPackagesï¼‰" class="headerlink" title="åŒ…è£¹ï¼ˆPackagesï¼‰"></a>åŒ…è£¹ï¼ˆPackagesï¼‰</h2><p>åŒ…è£¹æŠŠç›¸å…³èµ„æºå°è£…å’ŒåŠ å›ºæˆä¸€ä¸ªç‹¬ç«‹å•å…ƒï¼Œæ„åœ¨<strong>æå‡ç”¨æˆ·ä½“éªŒ</strong>ã€‚</p><p>æ»¡è¶³ä»¥ä¸‹ä»»æ„ä¸€ä¸ªæ¡ä»¶ï¼Œç›®å½•å°±ä¼šè¢«è®¿è¾¾è®¤ä¸ºæ˜¯åŒ…è£¹ï¼š</p><ul><li>ç›®å½•æœ‰ç±»ä¼¼äº <code>.app</code>ï¼Œ<code>.playground</code> æˆ– <code>.plugin</code> ç­‰ç‰¹æ®Šæ‰©å±•ã€‚</li><li>ç›®å½•æœ‰ä¸€ä¸ªè¢«ä¸€ä¸ªåº”ç”¨æ³¨å†Œä½œä¸ºæ–‡æ¡£ç±»å‹çš„æ‰©å±•ã€‚</li><li>ç›®å½•å…·æœ‰æœ‰æ‰©å±•å±æ€§ï¼Œå°†å…¶æŒ‡å®šä¸ºåŒ…è£¹ã€‚</li></ul><h3 id="è®¿é—®åŒ…è£¹ä¸­çš„å†…å®¹"><a href="#è®¿é—®åŒ…è£¹ä¸­çš„å†…å®¹" class="headerlink" title="è®¿é—®åŒ…è£¹ä¸­çš„å†…å®¹"></a>è®¿é—®åŒ…è£¹ä¸­çš„å†…å®¹</h3><p>åœ¨è®¿è¾¾ä¸­ï¼Œå³é”®å±•ç¤ºé€‰ä¸­é¡¹ç›®çš„å¯æ“ä½œç›®å½•ã€‚å¦‚æœé€‰ä¸­é¡¹ç›®æ˜¯åŒ…è£¹ï¼Œâ€œæ‰“å¼€â€æ“ä½œä¸‹ä¼šå‡ºç°â€œæ˜¾ç¤ºåŒ…å†…å®¹â€é€‰é¡¹ã€‚<br><img src="https://nshipster.com/assets/show-package-contents-c7cc72f58a573cb2fbe349e6f76a4ef29d14fbada3cd9b8376fc37979da16bf3.png" alt></p><p>ç‚¹å‡»è¿™ä¸ªé€‰é¡¹ä¼šä»åŒ…è£¹ç›®å½•æ‰“å¼€ä¸€ä¸ªæ–°çš„è®¿è¾¾çª—å£ã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»£ç è®¿é—®åŒ…è£¹ä¸­çš„å†…å®¹ã€‚åŒ…è£¹çš„ç±»å‹å†³å®šäº†è·å–å†…å®¹çš„æœ€ä½³æ–¹å¼ï¼š</p><ul><li>å¦‚æœåŒ…è£¹æœ‰åŒ…çš„ç»“æ„ï¼Œå‰æ–‡æ‰€è¯´çš„ <code>Bundle</code> å°±èƒ½è½»æ¾èƒœä»»ã€‚</li><li>å¦‚æœåŒ…è£¹æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼Œåœ¨ macOS ä¸Šä½¿ç”¨ <code>NSDocument</code> æˆ–åœ¨ iOS ä¸Šä½¿ç”¨ <code>UIDocument</code> æ¥è®¿é—®ã€‚</li><li>å…¶ä»–æƒ…å†µä¸‹ï¼Œç”¨ <code>FileWrapper</code> å¯¼èˆªç›®å½•ï¼Œæ–‡ä»¶å’Œç¬¦å·é“¾æ¥ï¼Œç”¨ <code>FileHandler</code> æ¥è¯»å†™æ–‡ä»¶æè¿°ã€‚</li></ul><h3 id="åˆ¤æ–­ä¸€ä¸ªç›®å½•æ˜¯å¦æ˜¯åŒ…è£¹"><a href="#åˆ¤æ–­ä¸€ä¸ªç›®å½•æ˜¯å¦æ˜¯åŒ…è£¹" class="headerlink" title="åˆ¤æ–­ä¸€ä¸ªç›®å½•æ˜¯å¦æ˜¯åŒ…è£¹"></a>åˆ¤æ–­ä¸€ä¸ªç›®å½•æ˜¯å¦æ˜¯åŒ…è£¹</h3><p>è™½è¯´æ˜¯ç”±è®¿è¾¾å†³å®šå¦‚ä½•å±•ç¤ºæ–‡ä»¶å’Œç›®å½•ï¼Œå¤§å¤šæ•°çš„åˆ¤æ–­ä¼šè¢«ä»£ç†ç»™æ“ä½œç³»ç»Ÿä»¥åŠç®¡ç†ç»Ÿä¸€ç±»å‹æ ‡è¯†ï¼ˆUTIï¼‰çš„æœåŠ¡ã€‚</p><p>å¦‚æœæƒ³è¦ç¡®å®šä¸€ä¸ªæ–‡ä»¶æ‰©å±•æ˜¯ä¸€ä¸ªå†…ç½®ç³»ç»ŸåŒ…è£¹ç±»å‹ï¼Œè¿˜æ˜¯ä¸€ä¸ªè¢«å·²å®‰è£…çš„åº”ç”¨ä½¿ç”¨çš„æ–‡æ¡£ç±»å‹ï¼Œè°ƒç”¨ Core Services æ–¹æ³• <code>UTTypeCreatePreferredIdentifierForTag(_:_:_:)</code> ä¸ <code>UTTypeConformsTo(_:_:)</code> èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼š<br><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> CoreServices</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">directoryIsPackage</span><span class="params">(<span class="number">_</span> url: URL)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> filenameExtension: <span class="type">CFString</span> = url.pathExtension <span class="keyword">as</span> <span class="type">NSString</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> uti = <span class="type">UTTypeCreatePreferredIdentifierForTag</span>(</span><br><span class="line">                        kUTTagClassFilenameExtension,</span><br><span class="line">                        filenameExtension, <span class="literal">nil</span></span><br><span class="line">                    )?.takeRetainedValue()</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="type">UTTypeConformsTo</span>(uti, kUTTypePackage)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xcode = <span class="type">URL</span>(fileURLWithPath: <span class="string">"/Applications/Xcode.app"</span>)</span><br><span class="line">directoryIsPackage(xcode) <span class="comment">// true</span></span><br></pre></td></tr></table></figure></p><blockquote><p>æˆ‘ä»¬æ‰¾ä¸åˆ°ä»»ä½•æè¿°å¦‚ä½•è®¾ç½®æ‰€è°“çš„åŒ…è£¹æ¯”ç‰¹ï¼ˆpackage bitï¼‰çš„æ–‡æ¡£ï¼Œä½†æ ¹æ® <a href="https://opensource.apple.com/source/CarbonHeaders/CarbonHeaders-8A428/Finder.h" target="_blank" rel="noopener">CarbonCore/Finder.h</a>ï¼Œåœ¨ <code>com.apple.FindlerInfo</code> æ‰©å±•å‚æ•°ä¸­è®¾ç½® <code>kHasBundleï¼ˆ0x2000ï¼‰</code> æ ‡ç¤ºèƒ½å¤Ÿå®ç°ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; $ xattr -wx com.apple.FinderInfo /path/to/package \</span><br><span class="line">&gt;  00 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 \</span><br><span class="line">&gt;  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p></blockquote><hr><p>æ­£å¦‚æˆ‘ä»¬çœ‹åˆ°çš„é‚£æ ·ï¼Œå¹¶éåªæœ‰ç»ˆç«¯ç”¨æˆ·ä»æŠ½è±¡ä¸­è·ç›Š â€”â€” æ— è®ºæ˜¯åƒ Swift è¿™æ ·çš„é«˜çº§ç¼–ç¨‹è¯­è¨€çš„å®‰å…¨æ€§å’Œè¡¨ç°åŠ›ï¼Œè¿˜æ˜¯åƒ Foundation è¿™æ ·çš„ API çš„ä¾¿åˆ©æ€§ï¼Œä½œä¸ºå¼€å‘è€…ä¹Ÿå¯ä»¥åˆ©ç”¨æŠ½è±¡å¼€å‘å‡ºä¼˜ç§€çš„è½¯ä»¶ã€‚</p><p>æˆ–è®¸æˆ‘ä»¬ä¼šæŠ±æ€¨ <a href="https://en.wikipedia.org/wiki/Leaky_abstraction" target="_blank" rel="noopener">æŠ½è±¡æ³„æ¼</a> ä¸ <a href="https://en.wikipedia.org/wiki/Abstraction_inversion" target="_blank" rel="noopener">æŠ½è±¡åè½¬</a> å¸¦æ¥çš„é—®é¢˜ï¼Œä½†é‡è¦çš„æ˜¯é€€ä¸€æ­¥ï¼Œäº†è§£æˆ‘ä»¬æ¯å¤©å¤„ç†å¤šå°‘æœ‰ç”¨çš„æŠ½è±¡ï¼Œä»¥åŠå®ƒä»¬å¸¦ç»™äº†æˆ‘ä»¬å¤šå°‘å¯èƒ½æ€§ã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šMatttï¼Œ&lt;a href=&quot;https://nshipster.com/bundles-and-packages/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-12-17&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://github.com/WAMaker&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;WAMaker&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://numbbbbb.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;numbbbbb&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://bignerdcoding.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BigNerdCoding&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;http://forelax.space&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Forelax&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;åœ¨è¿™ä¸ªç»™äºˆçš„å­£èŠ‚ï¼Œè®©æˆ‘ä»¬åœä¸‹è„šæ­¥ï¼Œæ€è€ƒä¸€ä¸ªç°ä»£è®¡ç®—æœºç³»ç»Ÿèµäºˆæˆ‘ä»¬çš„æœ€æ£’çš„ç¤¼ç‰©ï¼šæŠ½è±¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ•°ç™¾ä¸‡ CPU æ™¶ä½“ç®¡ã€SSD æ‰‡åŒºå’Œ LCD åƒç´ å…±åŒåä½œä¸‹ï¼Œå…¨çƒæ•°åäº¿äººèƒ½å¤Ÿæ—¥å¸¸ä½¿ç”¨è®¡ç®—æœºå’Œç§»åŠ¨è®¾å¤‡è€Œå¯¹æ­¤å…¨ç„¶ä¸çŸ¥ã€‚è¿™ä¸€åˆ‡éƒ½åº”å½’åŠŸäºåƒæ–‡ä»¶ï¼Œç›®å½•ï¼Œåº”ç”¨å’Œæ–‡æ¡£è¿™æ ·çš„æŠ½è±¡ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å‘¨çš„ NSHipsterï¼Œæˆ‘ä»¬å°†è®¨è®ºè‹¹æœå¹³å°ä¸Šä¸¤ä¸ªé‡è¦çš„æŠ½è±¡ï¼šåŒ…ä¸åŒ…è£¹ã€‚ğŸ&lt;/p&gt;
    
    </summary>
    
      <category term="Swift" scheme="https://swift.gg/categories/Swift/"/>
    
      <category term="NSHipster" scheme="https://swift.gg/categories/Swift/NSHipster/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
      <category term="NSHipster" scheme="https://swift.gg/tags/NSHipster/"/>
    
  </entry>
  
  <entry>
    <title>Swift ä¸­çš„é›†åˆï¼ˆSetï¼‰</title>
    <link href="https://swift.gg/2019/07/09/Sets-in-Swift/"/>
    <id>https://swift.gg/2019/07/09/Sets-in-Swift/</id>
    <published>2019-07-09T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šThomas Hanningï¼Œ<a href="http://www.thomashanning.com/sets-in-swift/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-09-06<br>è¯‘è€…ï¼š<a href="https://github.com/rsenjoyer" target="_blank" rel="noopener">rsenjoyer</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles" target="_blank" rel="noopener">pmst</a>ï¼›å®šç¨¿ï¼š<a href="http://forelax.space" target="_blank" rel="noopener">Forelax</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>é›†åˆï¼ˆSetï¼‰æ˜¯ Swift é›†åˆç±»å‹ï¼ˆcollection typesï¼‰ä¹‹ä¸€ï¼Œé›†åˆç”¨æ¥å­˜å‚¨ç±»å‹ç›¸åŒä¸”æ²¡æœ‰ç¡®å®šé¡ºåºå”¯ä¸€çš„å€¼ã€‚ä½ å¯ä»¥å°†é›†åˆæƒ³è±¡æˆä¸€ç›’å°çƒï¼šå®ƒä»¬åœ¨é¢œè‰²å’Œæ•°é‡ä¸Šç‹¬ä¸€æ— äºŒï¼Œä½†åœ¨ç›’å†…æ˜¯æ— åºçš„ã€‚</p><p><img src="https://swift.gg/img/articles/Sets-in-Swift/billiard.jpg1562643187.9223473" alt></p><a id="more"></a><p><em>æç¤ºï¼šè¿™ç¯‡æ–‡ç« ä½¿ç”¨çš„æ˜¯ Swift 4 å’Œ Xcode 10</em></p><h2 id="åˆ›å»ºé›†åˆ"><a href="#åˆ›å»ºé›†åˆ" class="headerlink" title="åˆ›å»ºé›†åˆ"></a>åˆ›å»ºé›†åˆ</h2><p>åˆ›å»ºä¸€ä¸ªé›†åˆéå¸¸ç®€å•ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> setA: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = [<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>]</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåˆ›å»ºä¸€ä¸ª <code>String</code> ç±»å‹çš„é›†åˆï¼Œå‘½åä¸º <code>setA</code>ã€‚å®ƒå­˜å‚¨ç€ <code>a</code>ã€<code>b</code>ã€<code>c</code> ä¸‰ä¸ªå€¼ã€‚ä¸æ•°ç»„ç›¸æ¯”ï¼Œé›†åˆå†…å…ƒç´ æ˜¯æ— åºçš„ã€‚é€šè¿‡ç¼–è¯‘å™¨çš„ç±»å‹æ¨å¯¼åŠŸèƒ½ï¼Œä½ ä¹Ÿå¯ä»¥åƒå¦‚ä¸‹æ–¹å¼åˆ›å»ºé›†åˆï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> setB: <span class="type">Set</span> = [<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>]</span><br></pre></td></tr></table></figure><p>åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨é›†åˆçš„æ„é€ å™¨ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> setC = <span class="type">Set</span>([<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>])</span><br></pre></td></tr></table></figure><p>è·Ÿæ•°ç»„ä¸€æ ·ï¼Œå¦‚æœä½¿ç”¨ <code>let</code> æ¥å®šä¹‰ä¸€ä¸ªé›†åˆï¼Œå®ƒå°±æ˜¯ä¸å¯å˜çš„ã€‚ä½¿ç”¨ <code>var</code>å®šä¹‰çš„æ˜¯ä¸€ä¸ªå¯å˜é›†åˆã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> setD = <span class="type">Set</span>([<span class="string">"a"</span>,<span class="string">"b"</span>])</span><br></pre></td></tr></table></figure><p>ç¨åæˆ‘ä»¬å°†äº†è§£æ›´å¤šæœ‰å…³å¯å˜é›†åˆçš„ä¿¡æ¯ã€‚</p><h2 id="è®¿é—®é›†åˆä¸­çš„å…ƒç´ "><a href="#è®¿é—®é›†åˆä¸­çš„å…ƒç´ " class="headerlink" title="è®¿é—®é›†åˆä¸­çš„å…ƒç´ "></a>è®¿é—®é›†åˆä¸­çš„å…ƒç´ </h2><p>ä½ å¯ä»¥ä½¿ç”¨å¾ªç¯æ¥è®¿é—®é›†åˆä¸­çš„å…ƒç´ ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> setA &#123;</span><br><span class="line">     <span class="built_in">print</span>(value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæ¯æ¬¡è¿è¡Œä»£ç æ—¶ï¼Œå¾ªç¯ä¸­å€¼çš„é¡ºåºå¯èƒ½ä¸åŒã€‚ä»è¡¨é¢æ¥çœ‹ï¼Œå®ƒä»¬åƒæ˜¯éšæœºè¿”å›ä¸€æ ·ã€‚</p><h2 id="é›†åˆåˆ†æ"><a href="#é›†åˆåˆ†æ" class="headerlink" title="é›†åˆåˆ†æ"></a>é›†åˆåˆ†æ</h2><p>é¦–å…ˆï¼Œä½ å¯ä»¥æ£€æŸ¥é›†åˆæ˜¯å¦ä¸ºç©ºï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(setA.isEmpty)</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è·å–é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(setA.<span class="built_in">count</span>)</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ“ä½œå¯¹æ•°ç»„åŒæ ·æœ‰æ•ˆï¼Œå¯¹é›†åˆè€Œè¨€ï¼Œæ›´åŠ æ™®éçš„é—®é¢˜æ˜¯åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>contains</code> æ–¹æ³•ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(setA.<span class="built_in">contains</span>(<span class="string">"a"</span>))</span><br></pre></td></tr></table></figure><h2 id="ä»é›†åˆä¸­æ·»åŠ å’Œåˆ é™¤å…ƒç´ "><a href="#ä»é›†åˆä¸­æ·»åŠ å’Œåˆ é™¤å…ƒç´ " class="headerlink" title="ä»é›†åˆä¸­æ·»åŠ å’Œåˆ é™¤å…ƒç´ "></a>ä»é›†åˆä¸­æ·»åŠ å’Œåˆ é™¤å…ƒç´ </h2><p>ä½ å¯ä»¥å‘å¯å˜é›†åˆé‡Œé¢æ·»åŠ å’Œåˆ é™¤å…ƒç´ :</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">setD.insert(<span class="string">"c"</span>)</span><br><span class="line">setD.remove(<span class="string">"a"</span>)</span><br></pre></td></tr></table></figure><p>ç”±äºé›†åˆå…ƒç´ çš„å”¯ä¸€æ€§ï¼Œå› æ­¤åªèƒ½å°†åŒä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°é›†åˆä¸­ä¸€æ¬¡ã€‚å¯ä»¥å¤šæ¬¡ä½¿ç”¨ç›¸åŒçš„å€¼è°ƒç”¨ <code>insert</code> æ–¹æ³•ï¼Œä½†é›†åˆä¸ä¼šæ”¹å˜ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> setE: <span class="type">Set</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"> </span><br><span class="line">setE.insert(<span class="number">5</span>)</span><br><span class="line">setE.insert(<span class="number">5</span>)</span><br><span class="line">setE.insert(<span class="number">5</span>)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(setE) <span class="comment">//[4,5,1,2,3]</span></span><br></pre></td></tr></table></figure><p>å’Œå‰é¢æ‰€è¯´çš„ä¸€æ ·ï¼Œä¸Šé¢ä»£ç æ¯æ¬¡æ‰§è¡Œæ—¶è¾“å‡ºçš„é¡ºåºå¯èƒ½ä¸åŒï¼Œå› ä¸ºé›†åˆå…ƒç´ æ— åºã€‚</p><h2 id="é›†åˆæ¯”è¾ƒ"><a href="#é›†åˆæ¯”è¾ƒ" class="headerlink" title="é›†åˆæ¯”è¾ƒ"></a>é›†åˆæ¯”è¾ƒ</h2><p>é›†åˆé—´èƒ½è¿›è¡Œæ¯”è¾ƒã€‚æ˜¾ç„¶ï¼Œå¯ä»¥æ¯”è¾ƒä¸¤ä¸ªé›†åˆæ˜¯å¦ç›¸ç­‰ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> setA: = [â€œaâ€, â€œbâ€, â€œ<span class="built_in">c</span>â€]</span><br><span class="line"><span class="keyword">let</span> setB: = [â€œaâ€, â€œbâ€, â€œ<span class="built_in">c</span>â€]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> setA == setB &#123;</span><br><span class="line">     <span class="built_in">print</span>(â€œthe sets are <span class="built_in">equal</span>â€)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æƒ…å†µä¸‹ï¼Œé›†åˆæ˜¯ç›¸ç­‰çš„ã€‚</p><p>æ¯”è¾ƒä¸¤ä¸ªé›†åˆçš„å¤§å°æ˜¯æ²¡æœ‰æ˜ç¡®çš„å®šä¹‰ï¼Œä½†å¯ä»¥æ£€æŸ¥ä¸€ä¸ªé›†åˆæ˜¯å¦æ˜¯å¦ä¸€ä¸ªé›†åˆçš„å­é›†ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> intSetA: <span class="type">Set</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span>]</span><br><span class="line"><span class="keyword">let</span> intSetB: <span class="type">Set</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">intSetB.isSubset(of: intSetA) <span class="comment">//true</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æ£€æŸ¥é›†åˆæ˜¯å¦æ˜¯å¦ä¸€ä¸ªé›†åˆçš„çœŸå­é›†ã€‚è¿™ç§æƒ…å†µå°±æ˜¯è¯¥é›†åˆæ˜¯å¦ä¸€ä¸ªé›†åˆçš„å­é›†ä½†ä¸æƒ³ç­‰ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> intSetA: <span class="type">Set</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span>]</span><br><span class="line"><span class="keyword">let</span> intSetB: <span class="type">Set</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span>]</span><br><span class="line"><span class="keyword">let</span> intSetC: <span class="type">Set</span> = [<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"> </span><br><span class="line">intSetB.isSubset(of: intSetA) <span class="comment">//true</span></span><br><span class="line">intSetB.isStrictSubset(of: intSetA) <span class="comment">//false</span></span><br><span class="line">intSetC.isSubset(of: intSetA) <span class="comment">// true</span></span><br><span class="line">intSetC.isStrictSubset(of: intSetA) <span class="comment">//true</span></span><br></pre></td></tr></table></figure><p>ä¸ä¹‹ç›¸å¯¹çš„æ¦‚å¿µå°±æ˜¯è¶…é›†ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> intSetA: <span class="type">Set</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span>]</span><br><span class="line"><span class="keyword">let</span> intSetC: <span class="type">Set</span> = [<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line">intSetA.isSuperset(of: intSetC) <span class="comment">//true</span></span><br><span class="line">intSetA.isStrictSuperset(of: intSetC) <span class="comment">//true</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸¤ä¸ªé›†åˆæ²¡æœ‰ç›¸åŒçš„å…ƒç´ ï¼Œé‚£ä¹ˆå°±è¯´è¿™ä¸¤ä¸ªé›†åˆä¸ç›¸äº¤</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> intSetA: <span class="type">Set</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span>]</span><br><span class="line"><span class="keyword">let</span> intSetC: <span class="type">Set</span> = [<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">let</span> intSetD: <span class="type">Set</span> = [<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>]</span><br><span class="line"> </span><br><span class="line">intSetA.isDisjoint(with: intSetC) <span class="comment">//false</span></span><br><span class="line">intSetA.isDisjoint(with: intSetD) <span class="comment">//true</span></span><br></pre></td></tr></table></figure><h2 id="é›†åˆç»“åˆ"><a href="#é›†åˆç»“åˆ" class="headerlink" title="é›†åˆç»“åˆ"></a>é›†åˆç»“åˆ</h2><p>ä½ å¯ä»¥å°†ä¸¤ä¸ªé›†åˆåˆå¹¶æˆä¸ºä¸€ä¸ªæ–°é›†åˆï¼Œæ–°çš„é›†åˆä¸­åŒ…å«ä¸¤ä¸ªé›†åˆä¸­æ‰€æœ‰çš„å…ƒç´ ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> stringSetA: <span class="type">Set</span> = [<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>]</span><br><span class="line"><span class="keyword">let</span> stringSetB: <span class="type">Set</span> = [<span class="string">"c"</span>,<span class="string">"d"</span>,<span class="string">"e"</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> unionSetAB = stringSetA.union(stringSetB)</span><br><span class="line"><span class="built_in">print</span>(unionSetAB) <span class="comment">//["d", "b", "c", "a", "e"]</span></span><br></pre></td></tr></table></figure><p>å¦ä¸€æ–¹é¢ï¼Œäº¤é›†å°±æ˜¯ä»…åŒ…å«ä¸¤ä¸ªé›†åˆä¸­å…±åŒçš„å…ƒç´ ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> stringSetA: <span class="type">Set</span> = [<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>]</span><br><span class="line"><span class="keyword">let</span> stringSetB: <span class="type">Set</span> = [<span class="string">"c"</span>,<span class="string">"d"</span>,<span class="string">"e"</span>]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> intersectionAB = stringSetA.intersection(stringSetB)</span><br><span class="line"><span class="built_in">print</span>(intersectionAB) <span class="comment">//[â€œcâ€]</span></span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰é›†åˆå…ƒç´ ç±»å‹"><a href="#è‡ªå®šä¹‰é›†åˆå…ƒç´ ç±»å‹" class="headerlink" title="è‡ªå®šä¹‰é›†åˆå…ƒç´ ç±»å‹"></a>è‡ªå®šä¹‰é›†åˆå…ƒç´ ç±»å‹</h2><p>ä½ å¯ä»¥åœ¨é›†åˆä¸­å­˜å‚¨è‡ªå®šä¹‰çš„ç±»å‹ã€‚è¿™ç§ç±»å‹å¯ä»¥æ˜¯ç±»æˆ–è€…ç»“æ„ä½“ã€‚ä¸ºäº†èƒ½æ­£å¸¸ä½¿ç”¨é›†åˆï¼Œè¯¥ç±»å‹å¿…é¡»éµå¾ª <code>hashable</code> åè®®ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Movie</span>: <span class="title">Hashable</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">var</span> title: <span class="type">String</span></span><br><span class="line">     <span class="keyword">var</span> year: <span class="type">Int</span></span><br><span class="line"> </span><br><span class="line">     <span class="keyword">init</span>(title: <span class="type">String</span>, year: <span class="type">Int</span>) &#123;</span><br><span class="line">          <span class="keyword">self</span>.title = title</span><br><span class="line">          <span class="keyword">self</span>.year = year</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> == <span class="params">(lhs: Movie, rhs: Movie)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> lhs.title == rhs.title &amp;&amp;</span><br><span class="line">          lhs.year == rhs.year</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">var</span> hashValue: <span class="type">Int</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> title.hashValue ^ year.hashValue</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> terminator = <span class="type">Movie</span>(title: <span class="string">"Terminator"</span>, year: <span class="number">1980</span>)</span><br><span class="line"><span class="keyword">let</span> backToTheFuture = <span class="type">Movie</span>(title: <span class="string">"Back to the Future"</span>, year: <span class="number">1985</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> movieSetA: <span class="type">Set</span> = [terminator,backToTheFuture]</span><br></pre></td></tr></table></figure><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      å…³äº Swift ä¸­çš„é›†åˆï¼ˆSetï¼‰
    
    </summary>
    
      <category term="thomashanning" scheme="https://swift.gg/categories/thomashanning/"/>
    
    
      <category term="Swiftï¼ŒiOSå¼€å‘ï¼ŒSwiftè¿›é˜¶" scheme="https://swift.gg/tags/Swift%EF%BC%8CiOS%E5%BC%80%E5%8F%91%EF%BC%8CSwift%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>PhotoKit çš„æ•°æ®æ¨¡å‹</title>
    <link href="https://swift.gg/2019/07/01/photos-data-model/"/>
    <id>https://swift.gg/2019/07/01/photos-data-model/</id>
    <published>2019-07-01T00:00:00.000Z</published>
    <updated>2020-04-11T08:27:36.612Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½œè€…ï¼šOle Begemannï¼Œ<a href="https://oleb.net/2018/photos-data-model/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2018-09-28<br>è¯‘è€…ï¼š<a href="https://github.com/zhangchi25806" target="_blank" rel="noopener">å¼ å¼›</a>ï¼›æ ¡å¯¹ï¼š<a href="http://numbbbbb.com/" target="_blank" rel="noopener">numbbbbb</a>ï¼Œ<a href="http://blog.yousanflics.com.cn" target="_blank" rel="noopener">Yousanflics</a>ï¼›å®šç¨¿ï¼š<a href="http://forelax.space" target="_blank" rel="noopener">Forelax</a></p></blockquote><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p>åœ¨ iOS ç³»ç»Ÿä¸­ï¼Œ<a href="https://developer.apple.com/documentation/photokit" target="_blank" rel="noopener">PhotoKit æ¡†æ¶</a> ä¸ä»…è¢«ç³»ç»Ÿçš„ç…§ç‰‡ App æ‰€ä½¿ç”¨ï¼ŒåŒæ—¶å®ƒä¹Ÿä¸ºå¼€å‘äººå‘˜è®¿é—®è®¾å¤‡çš„ç…§ç‰‡åº“æä¾›äº†æ¥å£æ”¯æŒã€‚è€Œå®ƒçš„åº•å±‚åˆ™æ˜¯ <a href="https://developer.apple.com/documentation/coredata" target="_blank" rel="noopener">Core Data</a> å®ç°çš„ã€‚</p><a id="more"></a><p>è‡³å°‘ä»è¿™ä¸¤ä¸ªåœ°æ–¹ï¼Œä½ å°±å¯ä»¥ç¡®è®¤è¿™ä¸€ç‚¹ï¼š</p><ol><li>ç¼–å†™ä¸€ä¸ªèƒ½å¤Ÿè®¿é—®ç…§ç‰‡åº“çš„åº”ç”¨ï¼Œå¹¶ä½¿ç”¨ <a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreData/TroubleshootingCoreData.html#//apple_ref/doc/uid/TP40001075-CH26-SW21" target="_blank" rel="noopener"><code>-com.apple.CoreData.SQLDebug 1.</code></a> æ¥å¯åŠ¨è¿™ä¸ªåº”ç”¨ç¨‹åºã€‚å½“ä½ è®¿é—®ç…§ç‰‡åº“æ—¶ï¼Œä»æ§åˆ¶å°å°±å¯ä»¥çœ‹åˆ° Core Data çš„è°ƒè¯•ä¿¡æ¯ã€‚</li><li>å¦‚æœæŸ¥çœ‹ PhotoKit æ¡†æ¶çš„ <a href="http://stevenygard.com/projects/class-dump/" target="_blank" rel="noopener">class dump</a>ï¼Œä½ å°†ä¼šåœ¨ä¸»è¦çš„ç±»ä¸­çœ‹åˆ°å¯¹ <a href="https://developer.apple.com/documentation/coredata/nsmanagedobjectid" target="_blank" rel="noopener"><code>NSManagedObjectID</code></a> å’Œå…¶ä»– Core Data ç±»å‹çš„å¼•ç”¨ï¼Œä¾‹å¦‚ï¼Œ <a href="https://github.com/nst/iOS-Runtime-Headers/blob/fbb634c78269b0169efdead80955ba64eaaa2f21/Frameworks/Photos.framework/PHObject.h" target="_blank" rel="noopener"><code>PHObject</code> æœ‰ä¸€ä¸ª <code>_objectIDï¼šNSManagedObjectID</code> çš„ ivar</a>ã€‚</li></ol><h2 id="å¯»æ‰¾-PhotoKit-çš„æ ¸å¿ƒæ•°æ®æ¨¡å‹"><a href="#å¯»æ‰¾-PhotoKit-çš„æ ¸å¿ƒæ•°æ®æ¨¡å‹" class="headerlink" title="å¯»æ‰¾ PhotoKit çš„æ ¸å¿ƒæ•°æ®æ¨¡å‹"></a>å¯»æ‰¾ PhotoKit çš„æ ¸å¿ƒæ•°æ®æ¨¡å‹</h2><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£ PhotoKit æ¡†æ¶ï¼ˆç‰¹åˆ«æ˜¯å®ƒçš„æ€§èƒ½ç‰¹å¾ï¼‰ï¼Œæˆ‘æ£€æŸ¥äº†å®ƒçš„æ•°æ®æ¨¡å‹ã€‚æˆ‘åœ¨ Xcode 10.0 åº”ç”¨ç¨‹åºçš„åŒ…å†…å®¹ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªåä¸º <code>PhotoLibraryServices.framework / photos.momd / photos-10.0.mom</code> çš„æ–‡ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/Applications/Xcode-10.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/PrivateFrameworks/PhotoLibraryServices.framework/photos.momd/photos-10.0.mom</span><br></pre></td></tr></table></figure><blockquote><p>ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥æŸ¥æ‰¾ Xcode ä¸­æ¨¡æ‹Ÿå™¨è¿è¡Œæ—¶å†…çš„å…¶ä»– Core Data æ¨¡å‹ï¼š</p><p><code>find /Applications/Xcode-10.app -name &#39;*.mom&#39;</code></p></blockquote><h2 id="åœ¨-Xcode-ä¸­æ‰“å¼€å·²ç¼–è¯‘çš„-Core-Data-æ¨¡å‹"><a href="#åœ¨-Xcode-ä¸­æ‰“å¼€å·²ç¼–è¯‘çš„-Core-Data-æ¨¡å‹" class="headerlink" title="åœ¨ Xcode ä¸­æ‰“å¼€å·²ç¼–è¯‘çš„ Core Data æ¨¡å‹"></a>åœ¨ Xcode ä¸­æ‰“å¼€å·²ç¼–è¯‘çš„ Core Data æ¨¡å‹</h2><p><code>.mom</code> æ–‡ä»¶æ˜¯<em>å·²ç¼–è¯‘çš„</em> Core Data æ•°æ®æ¨¡å‹ã€‚Xcode æ— æ³•ç›´æ¥æ‰“å¼€å®ƒï¼Œä½†å¯ä»¥å°†å®ƒ<em>å¯¼å…¥</em>åˆ°å¦ä¸€ä¸ª Core Data æ¨¡å‹ä¸­ã€‚é€šè¿‡å¦‚ä¸‹çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ Xcode ä¸­æŸ¥çœ‹è¿™ä¸ªæ¨¡å‹ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºé¡¹ç›®ã€‚å› ä¸ºä½¿ç”¨ Xcode 10 åœ¨é¡¹ç›®ä¹‹å¤–æ˜¾ç¤º Core Data æ¨¡å‹åŒ…å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚</li><li>åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„â€œCore Data æ•°æ®æ¨¡å‹â€æ–‡ä»¶ã€‚ è¿™å°†åˆ›å»ºä¸€ä¸ª <code>.xcdatamodeld</code> åŒ…ã€‚</li><li>æ‰“å¼€æ–°æ•°æ®æ¨¡å‹ï¼Œç„¶åé€‰æ‹© ç¼–è¾‘å™¨ &gt; å¯¼å…¥â€¦. ï¼Œé€‰æ‹©è¦å¯¼å…¥çš„ <code>.mom</code> æ–‡ä»¶ã€‚</li></ol><p>ä¸å¹¸çš„æ˜¯ï¼Œç¼–è¯‘çš„æ¨¡å‹å¹¶ä¸å­˜å‚¨ Xcode çš„æ¨¡å‹ç¼–è¾‘å™¨çš„å¸ƒå±€ä¿¡æ¯ï¼Œå› æ­¤ä½ å¿…é¡»æ‰‹åŠ¨å°†ç¼–è¾‘å™¨ä¸­çš„å®ä½“æ‹–å‡ºæ¥ä¸€ä¸ªæ¼‚äº®çš„æ ·å¼ä¸­ã€‚è¿™èŠ±äº†æˆ‘å‡ ä¸ªå°æ—¶ã€‚</p><blockquote><p>æ¸©é¦¨æç¤ºï¼šä½ å¯ä»¥ä½¿ç”¨ç®­å¤´é”®ï¼ˆå’Œ shift é”®+ç®­å¤´é”®ï¼‰ç²¾ç¡®å®šä½äº‹ç‰©ã€‚</p><p>ä¸“å®¶æç¤ºï¼šè¯·å‹¿ç‚¹å‡» âŒ˜Z æ’¤æ¶ˆç§»åŠ¨æ“ä½œã€‚å¯¹å›¾å½¢çš„ç¼–è¾‘ä¸ä¼šè¢« Xcode è§†ä½œä¸€ä¸ªå¯æ’¤é”€çš„æ“ä½œï¼Œå› æ­¤ Xcode å¯èƒ½ä¼šæ’¤æ¶ˆä¸€å¼€å§‹çš„å¯¼å…¥æ“ä½œï¼Œè¿™æ„å‘³ç€ä½ å°†ä¸¢å¤±æ‰€æœ‰æœªä¿å­˜çš„å·¥ä½œã€‚</p></blockquote><h2 id="å¸¦æœ‰è‰¯å¥½æ ¼å¼çš„-PhotoKit-çš„æ¨¡å‹"><a href="#å¸¦æœ‰è‰¯å¥½æ ¼å¼çš„-PhotoKit-çš„æ¨¡å‹" class="headerlink" title="å¸¦æœ‰è‰¯å¥½æ ¼å¼çš„ PhotoKit çš„æ¨¡å‹"></a>å¸¦æœ‰è‰¯å¥½æ ¼å¼çš„ PhotoKit çš„æ¨¡å‹</h2><p>è¿™æ˜¯ä¸ Xcode 10.0ï¼ˆiOS 12.0ï¼‰æ†ç»‘åœ¨ä¸€èµ·çš„ <code>photos-10.0.mom</code>ï¼š</p><p><img src="https://oleb.net/media/photos-10.0-core-data-model-5974px.png" alt="iOS 12.0 ä¸­ PhotoLibraryServices.framework çš„ Core Data æ•°æ®æ¨¡å‹ã€‚è¯·ä¸‹è½½å›¾ç‰‡å¹¶åœ¨æœ¬åœ°æ‰“å¼€ä»¥è·å¾—æœ€ä½³æ•ˆæœã€‚"></p><p>å¹¶éæ‰€æœ‰çš„å†…å®¹éƒ½èƒ½åœ¨è¿™å¼ å›¾ç‰‡ä¸­è¢«çœ‹åˆ°ã€‚ä½ å¯ä»¥ <a href="https://github.com/ole/AppleCoreDataModels" target="_blank" rel="noopener">ä¸‹è½½å®Œæ•´æ¨¡å‹</a> å¹¶åœ¨ Xcode ä¸­æŸ¥çœ‹å®ƒçš„ä¸€äº›å±æ€§ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™ä¸ä¸€å®šæ˜¯ iOS ä¸Šçš„ç…§ç‰‡çš„å®Œæ•´æ•°æ®æ¨¡å‹ã€‚æ›´å¤šçš„ä¸€äº› Core Data æ¨¡å‹è¢«æ”¾ç½®åœ¨ <code>PrivateFrameworks/PhotoAnalysis.framework</code> ä¸­ã€‚</p><blockquote><p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      PhotoKit çš„æ•°æ®æ¨¡å‹
    
    </summary>
    
      <category term="PhotoKit" scheme="https://swift.gg/categories/PhotoKit/"/>
    
      <category term="Ole Begemann" scheme="https://swift.gg/categories/PhotoKit/Ole-Begemann/"/>
    
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/tags/iOS-%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
</feed>
