<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>SwiftGG</title>
  <subtitle>èµ°å¿ƒçš„ Swift ç¿»è¯‘ç»„</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://swift.gg/"/>
  <updated>2017-07-19T05:24:14.000Z</updated>
  <id>https://swift.gg/</id>
  
  <author>
    <name>SwiftGG</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>TableViewController çš„æœ€ä½³å®è·µ</title>
    <link href="https://swift.gg/2017/07/19/the-best-table-view-controller-mar-2016-edition/"/>
    <id>https://swift.gg/2017/07/19/the-best-table-view-controller-mar-2016-edition/</id>
    <published>2017-07-18T16:00:00.000Z</published>
    <updated>2017-07-19T05:24:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šDominik Hauserï¼Œ<a href="http://swiftandpainless.com/the-best-table-view-controller-mar-2016-edition/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016-03-28<br>è¯‘è€…ï¼š<a href="undefined">Doye</a>ï¼›æ ¡å¯¹ï¼š<a href="undefined">way</a>ï¼›å®šç¨¿ï¼š<a href="http://codebuild.me/" target="_blank" rel="external">shanks</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>åœ¨é˜…è¯» <a href="https://www.objc.io/issues/1-view-controllers/lighter-view-controllers/" target="_blank" rel="external">obc.ioå…³äºè½»é‡çº§çš„viewConrollerç›¸å…³è®¨è®º</a>ä¹‹åï¼Œæ¯éš”å‡ ä¸ªæœˆæˆ‘éƒ½ä¼šåæ€æ€æ ·åšæ‰æ˜¯TableviewController çš„æœ€ä½³å®è·µï¼Œæˆ‘æ›¾ç»å°è¯•è¿‡å‡ ç§ä¸åŒçš„æ–¹æ³•åŒ…æ‹¬æŠŠ datasource å’Œ delefate æ”¾åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ç±»ä¸­æˆ–è€…ä½¿ç”¨ MVVM æ¶æ„æ¥å¯¹ Cell è¿›è¡Œå®šåˆ¶ã€‚</p>
<p>æœ¬ç¯‡æ˜¯åœ¨ 2016 å¹´æˆ‘å¯¹è¿™ä¸ªé—®é¢˜çš„æ€ç´¢ï¼Œè€Œä¸”æˆ‘å¯¹è¿™ä¸ªæ–¹æ¡ˆååˆ†æ»¡æ„ï¼Œæ–¹æ¡ˆæ¶‰åŠåˆ°äº†æ³›å‹ï¼Œåè®®ï¼Œå’Œå€¼ç±»å‹ã€‚<br><a id="more"></a></p>
<p>æœ€ä¸»è¦çš„ä¸€éƒ¨åˆ†æ˜¯ TableviewController çš„åŸºç±»ï¼Œå®ƒç®¡ç†ç€æ¨¡å‹æ•°æ®å­˜å‚¨çš„æ•°ç»„ï¼Œè¿˜éœ€è¦æ³¨å†Œ Cell ç±»å’Œå®ç° tableView æ‰€éœ€è¦çš„ datasoure ç›¸å…³çš„å‡½æ•°ã€‚</p>
<p>æˆ‘ä»¬çš„ç±»å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TableViewController</span>&lt;<span class="title">T</span>, <span class="title">Cell</span>: <span class="title">UITableViewCell</span> <span class="title">where</span> <span class="title">Cell</span>: <span class="title">Configurable</span>&gt;: <span class="title">UITableViewController</span> </span>&#123;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæˆ‘ä»¬è®¾è®¡çš„åŸºç±»æ˜¯ä¸€ä¸ª <strong>UITableViewController</strong> çš„å­ç±»ï¼Œå½¢å‚ <em>Cell<strong> æ˜¯ä¸€ä¸ªéµå¾ª </strong>Configurable<strong> åè®®çš„ </strong>UITableViewCell*</em>ï¼Œè¿™ä¸ªåè®®ååˆ†ç®€å•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Configurable</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">func</span> <span class="title">config</span><span class="params">(withItem item: Any)</span></span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ª Cell å°†ä¼šåœ¨ <strong>TableViewController</strong> ä¸­æ³¨å†Œç„¶åå¡è¿›é˜Ÿåˆ—ï¼Œå¯¹äºè¿™ä¸ª Cell çš„ identifier æˆ‘ä»¬å¯ä»¥æœ‰ä¸€ä¸ªç§æœ‰å±æ€§çš„å¯¹åº”ï¼š</p>
<p>ç„¶åæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨è¦åœ¨ table View ä¸­è¦å±•ç¤ºçš„æ•°æ®ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> data = [<span class="type">T</span>]() &#123;</div><div class="line">  <span class="keyword">didSet</span> &#123;</div><div class="line">    tableView.reloadData()</div><div class="line">    <span class="keyword">if</span> tableView.numberOfRowsInSection(<span class="number">0</span>) &gt; <span class="number">0</span> &#123;</div><div class="line">      tableView.scrollToRowAtIndexPath(<span class="type">NSIndexPath</span>(forRow: <span class="number">0</span>,inSection: <span class="number">0</span>),</div><div class="line">                                       atScrollPosition: .<span class="type">Top</span>,</div><div class="line">                                       animated: <span class="literal">true</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ— è®ºæ•°æ®ä»€ä¹ˆæ—¶å€™è¢«æ›´æ–°ï¼Œåœ¨åˆ—è¡¨è§†å›¾ä¸­çš„ <strong>reloadData()</strong> æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œè€Œä¸”æ•´ä¸ªåˆ—è¡¨è§†å›¾å°†ä¸Šæ»‘è‡³é¡¶éƒ¨ï¼Œä¸‹é¢æˆ‘ä»¬å®šä¹‰åˆå§‹åŒ–æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">init</span>() &#123; <span class="keyword">super</span>.<span class="keyword">init</span>(nibName: <span class="literal">nil</span>, bundle: <span class="literal">nil</span>) &#125;</div></pre></td></tr></table></figure>
<p>åœ¨ <strong>viewDidLoad()</strong> ä¹‹ä¸­æˆ‘ä»¬å¯¹äº TableView è¿›è¡Œè®¾ç½®ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">  <span class="keyword">super</span>.viewDidLoad()</div><div class="line">  tableView.registerClass(<span class="type">Cell</span>.<span class="keyword">self</span>, forCellReuseIdentifier: cellIdentifier)</div><div class="line">  tableView.rowHeight = <span class="type">UITableViewAutomaticDimension</span></div><div class="line">  tableView.estimatedRowHeight = <span class="number">60</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å‰©ä¸‹çš„å°±æ˜¯å¯¹ <strong>UITableViewDataSource</strong> è¿›è¡Œè¡¥å…¨ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">  <span class="keyword">return</span> data.<span class="built_in">count</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView,</span></span></div><div class="line">                        cellForRowAtIndexPath indexPath: NSIndexPath) -&gt; <span class="type">UITableViewCell</span> &#123;</div><div class="line">  <span class="keyword">let</span> cell = tableView.dequeueReusableCellWithIdentifier(cellIdentifier,</div><div class="line">                                                         forIndexPath: indexPath) <span class="keyword">as</span>! <span class="type">Cell</span></div><div class="line">  cell.config(withItem: data[indexPath.row])</div><div class="line">  <span class="keyword">return</span> cell</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œä¸€ä¸ªéœ€è¦æ³¨æ„çš„éƒ¨åˆ†æ˜¯ <strong>cell.config(withItem: data[indexPath.row])</strong> è¿™æ„å‘³ç€ cell å°†è´Ÿè´£å…¶å†…éƒ¨å„ç§æ§ä»¶å±•ç¤ºçš„å†…å®¹çš„å¡«å……ã€‚</p>
<p>è¿™é‡Œæ˜¯å®Œæ•´çš„åŸºç±»çš„ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TableViewController</span>&lt;<span class="title">T</span>, <span class="title">Cell</span>: <span class="title">UITableViewCell</span> <span class="title">where</span> <span class="title">Cell</span>: <span class="title">Configurable</span>&gt;: <span class="title">UITableViewController</span> </span>&#123;</div><div class="line">  </div><div class="line">  <span class="keyword">private</span> <span class="keyword">let</span> cellIdentifier = <span class="type">String</span>(<span class="type">Cell</span>)</div><div class="line">  <span class="keyword">var</span> data = [<span class="type">T</span>]() &#123;</div><div class="line">    <span class="keyword">didSet</span> &#123;</div><div class="line">      tableView.reloadData()</div><div class="line">      <span class="keyword">if</span> tableView.numberOfRowsInSection(<span class="number">0</span>) &gt; <span class="number">0</span> &#123;</div><div class="line">        tableView.scrollToRowAtIndexPath(<span class="type">NSIndexPath</span>(forRow: <span class="number">0</span>,inSection: <span class="number">0</span>),</div><div class="line">                                         atScrollPosition: .<span class="type">Top</span>,</div><div class="line">                                         animated: <span class="literal">true</span>)</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">init</span>() &#123; <span class="keyword">super</span>.<span class="keyword">init</span>(nibName: <span class="literal">nil</span>, bundle: <span class="literal">nil</span>) &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidLoad()</div><div class="line">    tableView.registerClass(<span class="type">Cell</span>.<span class="keyword">self</span>, forCellReuseIdentifier: cellIdentifier)</div><div class="line">    tableView.rowHeight = <span class="type">UITableViewAutomaticDimension</span></div><div class="line">    tableView.estimatedRowHeight = <span class="number">60</span></div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="comment">// MARK: - Table view data source</span></div><div class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    <span class="keyword">return</span> data.<span class="built_in">count</span></div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView,</span></span></div><div class="line">                          cellForRowAtIndexPath indexPath: NSIndexPath) -&gt; <span class="type">UITableViewCell</span> &#123;</div><div class="line">    <span class="keyword">let</span> cell = tableView.dequeueReusableCellWithIdentifier(cellIdentifier,</div><div class="line">                                                           forIndexPath: indexPath) <span class="keyword">as</span>! <span class="type">Cell</span></div><div class="line">    cell.config(withItem: data[indexPath.row])</div><div class="line">    <span class="keyword">return</span> cell</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªåŸºç±»æ¥å®šä¹‰ä¸€ä¸ª TableViewController æ¥å®ç°è®©ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹äº Github çš„ç”¨æˆ·æ¥è¿›è¡ŒåŒ¹é…æŸ¥æ‰¾ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserSearchTableViewController</span>&lt;<span class="title">T</span>: <span class="title">protocol</span>&lt;<span class="title">DictCreatable</span>, <span class="title">LabelsPresentable</span>, <span class="title">UserProtocol</span>&gt;&gt;: <span class="title">TableViewController</span>&lt;<span class="title">T</span>, <span class="title">TwoLabelCell</span>&gt;, <span class="title">UISearchBarDelegate</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> searchString: <span class="type">String</span>? &#123;</div><div class="line">    <span class="keyword">didSet</span> &#123;</div><div class="line">      <span class="keyword">guard</span> <span class="keyword">let</span> searchString = searchString <span class="keyword">where</span> searchString.characters.<span class="built_in">count</span> &gt; <span class="number">0</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</div><div class="line">      <span class="keyword">let</span> fetch = <span class="type">APIClient</span>&lt;<span class="type">T</span>&gt;().fetchUsers(forSearchString: searchString)</div><div class="line">      fetch &#123; (items, error) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> theItems = items <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</div><div class="line">        <span class="keyword">self</span>.data = theItems.<span class="built_in">map</span> &#123; $<span class="number">0</span> &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidLoad()</div><div class="line">    </div><div class="line">    title = <span class="string">"User"</span></div><div class="line">    </div><div class="line">    <span class="keyword">let</span> searchBar = <span class="type">UISearchBar</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: view.frame.size.width, height: <span class="number">40</span>))</div><div class="line">    searchBar.placeholder = <span class="string">"Github username"</span></div><div class="line">    searchBar.delegate = <span class="keyword">self</span></div><div class="line">    tableView.tableHeaderView = searchBar</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">func</span> <span class="title">searchBarSearchButtonClicked</span><span class="params">(searchBar: UISearchBar)</span></span> &#123;</div><div class="line">    searchBar.resignFirstResponder()</div><div class="line">    searchString = searchBar.text</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, didSelectRowAtIndexPath indexPath: NSIndexPath)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> next = <span class="type">RepositoriesTableViewController</span>&lt;<span class="type">Repository</span>&gt;()</div><div class="line">    next.username = <span class="keyword">self</span>.data[indexPath.row].name</div><div class="line">    navigationController?.pushViewController(next, animated: <span class="literal">true</span>)</div><div class="line">    </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä¾¿æ˜¯ä¸€ä¸ªå®Œæ•´çš„ TableViewControllerï¼Œå¤§éƒ¨åˆ†çš„ä»£ç å¯¹äº searchBar çš„å±•ç¤ºå’Œé€»è¾‘å¤„ç†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€æ´ï¼Ÿ</p>
<p>æˆ‘ä»¬ä¼šè¿™æ ·æ¥åˆå§‹åŒ– <strong>UserSearchTableViewController</strong>ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> viewController = <span class="type">UserSearchTableViewController</span>&lt;<span class="type">User</span>&gt;()</div></pre></td></tr></table></figure>
<p>æœ€åï¼Œè¿™é‡Œæ˜¯ <strong>TwoLabelCell</strong> æˆ‘è‡ªå·±çš„å®ç°</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TwoLabelCell</span>: <span class="title">UITableViewCell</span>, <span class="title">Configurable</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">let</span> nameLabel: <span class="type">UILabel</span></div><div class="line">  <span class="keyword">let</span> descriptionLabel: <span class="type">UILabel</span></div><div class="line">  </div><div class="line">  <span class="keyword">override</span> <span class="keyword">init</span>(style: <span class="type">UITableViewCellStyle</span>, reuseIdentifier: <span class="type">String</span>?) &#123;</div><div class="line">    nameLabel = <span class="type">UILabel</span>()</div><div class="line">    nameLabel.font = <span class="type">UIFont</span>.preferredFontForTextStyle(<span class="type">UIFontTextStyleHeadline</span>)</div><div class="line">    </div><div class="line">    descriptionLabel = <span class="type">UILabel</span>()</div><div class="line">    descriptionLabel.font = <span class="type">UIFont</span>.preferredFontForTextStyle(<span class="type">UIFontTextStyleSubheadline</span>)</div><div class="line">    descriptionLabel.numberOfLines = <span class="number">2</span></div><div class="line">    </div><div class="line">    <span class="keyword">let</span> stackView = <span class="type">UIStackView</span>(arrangedSubviews: [nameLabel, descriptionLabel])</div><div class="line">    stackView.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></div><div class="line">    stackView.axis = .<span class="type">Vertical</span></div><div class="line">    </div><div class="line">    <span class="keyword">super</span>.<span class="keyword">init</span>(style: style, reuseIdentifier: reuseIdentifier)</div><div class="line">    </div><div class="line">    addSubview(stackView)</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> views = [<span class="string">"stackView"</span>: stackView]</div><div class="line">    <span class="keyword">var</span> layoutConstraints = [<span class="type">NSLayoutConstraint</span>]()</div><div class="line">    layoutConstraints += <span class="type">NSLayoutConstraint</span>.constraintsWithVisualFormat(<span class="string">"|-[stackView]-|"</span>, options: [], metrics: <span class="literal">nil</span>, views: views)</div><div class="line">    layoutConstraints += <span class="type">NSLayoutConstraint</span>.constraintsWithVisualFormat(<span class="string">"V:|-[stackView]-|"</span>, options: [], metrics: <span class="literal">nil</span>, views: views)</div><div class="line">    <span class="type">NSLayoutConstraint</span>.activateConstraints(layoutConstraints)</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">    <span class="built_in">fatalError</span>(<span class="string">"init(coder:) has not been implemented"</span>)</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">func</span> <span class="title">config</span><span class="params">(withItem item: Any)</span></span> &#123;</div><div class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> item = item <span class="keyword">as</span>? <span class="type">LabelsPresentable</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</div><div class="line">    <span class="keyword">let</span> texts = item.texts</div><div class="line">    <span class="keyword">if</span> texts.<span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</div><div class="line">      nameLabel.text = texts[<span class="number">0</span>]</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> texts.<span class="built_in">count</span> &gt; <span class="number">1</span> &amp;&amp; texts[<span class="number">1</span>].characters.<span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</div><div class="line">      descriptionLabel.text = texts[<span class="number">1</span>]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨<a href="https://github.com/dasdom/TableViewMarch2016" target="_blank" rel="external">Github</a>æœ‰æºç è¿˜æœ‰å¦ä¸€ä¸ªéµå¾ªç±»ä¼¼æ¶æ„çš„ TableViewController å®ä¾‹</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      TableViewControllerçš„æœ€ä½³å®è·µ
    
    </summary>
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/categories/iOS-%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="Swift And Painless" scheme="https://swift.gg/tags/Swift-And-Painless/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•æ£€æµ‹æ‘‡ä¸€æ‘‡æ‰‹åŠ¿</title>
    <link href="https://swift.gg/2017/07/18/detect-shake-gestures-ios-tutorial-ios10/"/>
    <id>https://swift.gg/2017/07/18/detect-shake-gestures-ios-tutorial-ios10/</id>
    <published>2017-07-17T16:00:00.000Z</published>
    <updated>2017-07-19T05:24:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šArthur Knopperï¼Œ<a href="https://www.ioscreator.com/tutorials/detect-shake-gestures-ios-tutorial-ios10" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-04-18<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›æ ¡å¯¹ï¼š<a href="undefined">way</a>ï¼›å®šç¨¿ï¼š<a href="http://codebuild.me/" target="_blank" rel="external">shanks</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>iOS è®¾å¤‡å¯ä»¥æ£€æµ‹æ‘‡ä¸€æ‘‡æ‰‹åŠ¿ï¼Œåœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•æ£€æµ‹æ‘‡ä¸€æ‘‡æ‰‹åŠ¿ï¼Œæ£€æµ‹åˆ°è¯¥æ‰‹åŠ¿åï¼Œæ›´æ–° label çš„æ–‡æ¡ˆã€‚æœ¬èŠ‚æ•™ç¨‹ä½¿ç”¨çš„æ˜¯ Xcode 8.3 å’Œ iOS 10.3ã€‚<br><a id="more"></a></p>
<h3 id="è®¾ç½®å·¥ç¨‹"><a href="#è®¾ç½®å·¥ç¨‹" class="headerlink" title="è®¾ç½®å·¥ç¨‹"></a>è®¾ç½®å·¥ç¨‹</h3><p>æ‰“å¼€ Xcodeï¼Œåˆ›å»ºä¸€ä¸ª Single View Applicationã€‚</p>
<p><img src="/img/articles/detect-shake-gestures-ios-tutorial-ios10/single-view-xcode-templateformat=1500w1500341429.27" alt=""></p>
<p>Product Name ä½¿ç”¨ <strong>IOS10ShakeGestureTutorial</strong>ï¼Œå¡«å†™è‡ªå·±çš„ Organization Name å’Œ Organization Identifierï¼ŒLanguage ä¸€æ é€‰æ‹© Swiftï¼ŒDevices ä¸€æ é€‰æ‹© iPhoneã€‚</p>
<p><img src="/img/articles/detect-shake-gestures-ios-tutorial-ios10/shake-gesture-projectformat=1500w1500341431.78" alt=""></p>
<p>æ‰“å¼€ <strong>Storyboard</strong>ï¼Œä» Object Library ä¸­æ‹–æ‹½ä¸€ä¸ª Label æ§ä»¶æ”¾åˆ° View Controller ä¸Šï¼ŒåŒå‡» Label æ§ä»¶å°†æ–‡æ¡ˆä¿®æ”¹ä¸º <em>â€œShake meâ€</em>ã€‚é€‰ä¸­è¯¥ Labelï¼Œç‚¹å‡» Auto Layout çš„ Align æŒ‰é’®ã€‚é€‰ä¸­ â€œHorizontally in Containerâ€ï¼Œç‚¹å‡» â€œAdd 1 Constraintâ€ã€‚</p>
<p><img src="/img/articles/detect-shake-gestures-ios-tutorial-ios10/auto-layout-horizontally-in-containerformat=750w1500341433.06" alt=""></p>
<p>é€‰ä¸­ Labelï¼Œç‚¹å‡» Auto Layout çš„ Pin æŒ‰é’®ï¼Œé€‰ä¸­ä¸Šè¾¹è·çº¦æŸçº¿ï¼Œç‚¹å‡» â€œAdd 1 Constraintâ€ã€‚</p>
<p><img src="/img/articles/detect-shake-gestures-ios-tutorial-ios10/auto-layout-pin-to-topformat=750w1500341433.89" alt=""></p>
<p>Storyboard çœ‹èµ·æ¥åº”å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="/img/articles/detect-shake-gestures-ios-tutorial-ios10/shake-gesture-storyboardformat=1000w1500341434.83" alt=""></p>
<p>æ‰“å¼€ Assistant Editorï¼Œç¡®ä¿ <strong>ViewController.swift</strong> å¯è§ã€‚æŒ‰ä½ Control é”®ï¼Œå°† Label æ‹–æ‹½åˆ° ViewController ç±»ä¸‹ï¼Œåˆ›å»ºä¸‹å›¾çš„ Outletã€‚</p>
<p><img src="/img/articles/detect-shake-gestures-ios-tutorial-ios10/shake-label-outletformat=750w1500341435.62" alt=""></p>
<p>æ‰“å¼€ ViewController.swift æ–‡ä»¶ï¼Œé¦–å…ˆè¦è®© View Controller å›åº”ç‚¹å‡»äº‹ä»¶ï¼Œå¯ä»¥é€šè¿‡ ViewController FirstResponder å®ç°ï¼Œæ·»åŠ ä¸‹åˆ—æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">becomeFirstResponder</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼Œè¦æƒ³æ£€æµ‹æ‘‡ä¸€æ‘‡æ‰‹åŠ¿ï¼Œæ·»åŠ  <strong>motionEnded(_:with:)</strong> æ–¹æ³•ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">motionEnded</span><span class="params">(<span class="number">_</span> motion: UIEventSubtype, with event: UIEvent?)</span></span> &#123;</div><div class="line">    <span class="keyword">if</span> motion == .motionShake &#123;</div><div class="line">        shakeLabel.text = <span class="string">"Shaken, not stirred"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœç¡®å®æ˜¯ä¸€ä¸ª Shake Gestureï¼ˆæ‘‡ä¸€æ‘‡ï¼‰ï¼Œé‚£ä¹ˆ Label çš„æ–‡æ¡ˆå°±ä¼šæ›´æ–°ã€‚è¿è¡Œå·¥ç¨‹ï¼Œæ‘‡ä¸€æ‘‡æµ‹è¯•æœºã€‚å¯ä»¥ç‚¹å‡» iOS æ¨¡æ‹Ÿå™¨èœå•æ  Hardware é€‰é¡¹ä¸‹çš„ Shake Gesture æ¥æ‘‡ä¸€æ‘‡ã€‚</p>
<p><img src="/img/articles/detect-shake-gestures-ios-tutorial-ios10/shake-gesture-simulatorformat=750w1500341436.36" alt=""></p>
<p>å¯ä»¥ä» <a href="https://github.com/ioscreator/ioscreator" target="_blank" rel="external">github</a> ä¸Šä¸‹è½½ <strong>IOS10ShakeGestureTutorial</strong> æ•™ç¨‹çš„æºä»£ç ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      å¦‚ä½•æ£€æµ‹æ‘‡ä¸€æ‘‡æ‰‹åŠ¿
    
    </summary>
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/categories/iOS-%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="IOSCREATOR" scheme="https://swift.gg/tags/IOSCREATOR/"/>
    
  </entry>
  
  <entry>
    <title>iOS æ•™ç¨‹ï¼šå±æ€§å­—ç¬¦ä¸²</title>
    <link href="https://swift.gg/2017/07/17/attributed-strings-ios-tutorial-ios10/"/>
    <id>https://swift.gg/2017/07/17/attributed-strings-ios-tutorial-ios10/</id>
    <published>2017-07-16T16:00:00.000Z</published>
    <updated>2017-07-19T05:24:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šArthur Knopperï¼Œ<a href="https://www.ioscreator.com/tutorials/attributed-strings-ios-tutorial-ios10" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-04-04<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›æ ¡å¯¹ï¼š<a href="undefined">way</a>ï¼›å®šç¨¿ï¼š<a href="http://codebuild.me/" target="_blank" rel="external">shanks</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<blockquote>
<p>è¯‘è€…æ³¨ï¼šæœ¬æ–‡æ˜¯ä¹‹å‰ä¸€ç¯‡æ–‡ç« çš„æ›´æ–°ç‰ˆæœ¬ï¼Œ<a href="https://www.ioscreator.com/tutorials/attributed-strings-tutorial-ios8-swift" target="_blank" rel="external">æ—§æ–‡é“¾æ¥</a>ï¼Œæ—§æ–‡ä½¿ç”¨çš„ Swift ç‰ˆæœ¬ä¸æ˜¯ 3.0ï¼Œæœ¬æ–‡æ›´æ–°äº†ä»£ç ï¼Œå‡çº§åˆ°äº† Swift 3.0ã€‚</p>
</blockquote>
<p>å±æ€§å­—ç¬¦ä¸²ï¼ˆAttributed Stringsï¼‰å¯ä»¥ä¸ºæ–‡æœ¬èµ‹äºˆå„ç§å„æ ·çš„å±æ€§ï¼Œè¿˜èƒ½ä¸€æ¬¡ç»™ï¼ˆéƒ¨åˆ†ï¼‰æ–‡æœ¬èµ‹å€¼å¤šä¸ªå±æ€§ã€‚åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œå°†å­¦ä¼šç»™ label æ–‡æœ¬é‡Œçš„æ¯ä¸ªå•è¯å„è®¾ç½®ä¸ä¸€æ ·çš„æ ·å¼ã€‚æœ¬èŠ‚æ•™ç¨‹ä½¿ç”¨çš„æ˜¯ Xcode 8 å’Œ iOS 10ã€‚<br><a id="more"></a></p>
<p>æ‰“å¼€ Xcodeï¼Œåˆ›å»ºä¸€ä¸ª Single View Applicationã€‚</p>
<p><img src="/img/articles/attributed-strings-ios-tutorial-ios10/single-view-xcode-templateformat=1500w1500254455.03" alt=""></p>
<p>Product Name ä½¿ç”¨ <strong>IOS10AttributedStringsTutorial</strong>ï¼Œå¡«å†™è‡ªå·±çš„ Organization Name å’Œ Organization Identifierï¼ŒLanguage ä¸€æ é€‰æ‹© Swiftï¼ŒDevices ä¸€æ é€‰æ‹© iPhoneã€‚</p>
<p><img src="/img/articles/attributed-strings-ios-tutorial-ios10/attributed-strings-projectformat=1500w1500254455.98" alt=""></p>
<p>æ‰“å¼€ <strong>Storyboard</strong>ï¼Œä» Object-Libraryï¼ˆæ§ä»¶åº“ï¼‰ä¸­æ‹–æ‹½ä¸€ä¸ª Label æ§ä»¶åˆ°ä¸»ç•Œé¢ï¼Œç‚¹å‡» Storyboard å³ä¸‹è§’ Auto Layout çš„ Align æŒ‰é’®ï¼Œæ·»åŠ ä¸‹å›¾æ‰€ç¤ºçº¦æŸï¼Œç‚¹å‡» â€œAdd 1 Constraintâ€ã€‚ã€‚</p>
<p><img src="/img/articles/attributed-strings-ios-tutorial-ios10/auto-layout-horizontally-in-containerformat=750w1500254456.86" alt=""></p>
<p>ç‚¹å‡» Auto Layout çš„ Pin æŒ‰é’®ï¼Œæ·»åŠ å¦‚ä¸‹å›¾æ‰€ç¤ºçº¦æŸï¼Œç‚¹å‡» â€œAdd 1 Constraintâ€ã€‚</p>
<p><img src="/img/articles/attributed-strings-ios-tutorial-ios10/auto-layout-pin--to-topformat=750w1500254457.69" alt=""></p>
<p>ç‚¹å‡» Assistant Editorï¼Œç¡®ä¿ <strong>ViewController.swift</strong> æ–‡ä»¶å¯è§ã€‚æŒ‰ä½ Control é”®ï¼Œå°† Label æ§ä»¶æ‹–æ‹½åˆ° ViewController ç±»ä¸‹é¢ï¼Œåˆ›å»ºä¸‹åˆ— Outlet è¿æ¥ã€‚</p>
<p><img src="/img/articles/attributed-strings-ios-tutorial-ios10/attributes-label-outletformat=750w1500254459.19" alt=""></p>
<p>æ‰“å¼€ <strong>ViewController.swift</strong> æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºå¯¹ <strong>viewDidLoad</strong> æ–¹æ³•è¿›è¡Œä¿®æ”¹ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        </div><div class="line">    <span class="comment">// 1</span></div><div class="line">    <span class="keyword">let</span> string = <span class="string">"Testing Attributed Strings"</span></div><div class="line">    <span class="keyword">let</span> attributedString = <span class="type">NSMutableAttributedString</span>(string: string)</div><div class="line">        </div><div class="line">    <span class="comment">// 2</span></div><div class="line">    <span class="keyword">let</span> firstAttributes:[<span class="type">String</span>:<span class="type">Any</span>] = [<span class="type">NSForegroundColorAttributeName</span>: <span class="type">UIColor</span>.blue, <span class="type">NSBackgroundColorAttributeName</span>: <span class="type">UIColor</span>.yellow, <span class="type">NSUnderlineStyleAttributeName</span>: <span class="number">1</span>]</div><div class="line">    <span class="keyword">let</span> secondAttributes:[<span class="type">String</span>:<span class="type">Any</span>] = [<span class="type">NSForegroundColorAttributeName</span>: <span class="type">UIColor</span>.red, <span class="type">NSBackgroundColorAttributeName</span>: <span class="type">UIColor</span>.blue, <span class="type">NSStrikethroughStyleAttributeName</span>: <span class="number">1</span>]</div><div class="line">    <span class="keyword">let</span> thirdAttributes:[<span class="type">String</span>:<span class="type">Any</span>] = [<span class="type">NSForegroundColorAttributeName</span>: <span class="type">UIColor</span>.green, <span class="type">NSBackgroundColorAttributeName</span>: <span class="type">UIColor</span>.black, <span class="type">NSFontAttributeName</span>: <span class="type">UIFont</span>.systemFont(ofSize: <span class="number">40</span>)]</div><div class="line">        </div><div class="line">    <span class="comment">// 3</span></div><div class="line">    attributedString.addAttributes(firstAttributes, range: <span class="type">NSRange</span>(location: <span class="number">0</span>, length: <span class="number">8</span>))</div><div class="line">    attributedString.addAttributes(secondAttributes, range: <span class="type">NSRange</span>(location: <span class="number">8</span>, length: <span class="number">11</span>))</div><div class="line">    attributedString.addAttributes(thirdAttributes, range: <span class="type">NSRange</span>(location: <span class="number">19</span>, length: <span class="number">7</span>))</div><div class="line">        </div><div class="line">    <span class="comment">// 4</span></div><div class="line">    attributedLabel.attributedText = attributedString</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>åˆ›å»ºä¸€ä¸ªæ™®é€šçš„å­—ç¬¦ä¸²ï¼Œå°†ä¼šè½¬æ¢æˆå¤šç§å±æ€§å­—ç¬¦ä¸²ã€‚</li>
<li>åˆ›å»ºè§ 3 ä¸ªå­—å…¸ï¼Œå­˜å‚¨å±æ€§çš„é”®å’Œå€¼ã€‚</li>
<li>å°†å±æ€§æ·»åŠ åˆ° <code>attributedString</code> å¯¹è±¡ä¸­ã€‚</li>
<li>æœ€åï¼Œå°†å±æ€§å­—ç¬¦ä¸²èµ‹å€¼ç»™ Labelã€‚</li>
</ol>
<p><strong>è¿è¡Œ</strong>ç¨‹åºï¼Œå±æ€§å­—ç¬¦ä¸²çš„å®ç°æ•ˆæœå¦‚ä¸‹ã€‚</p>
<p><img src="/img/articles/attributed-strings-ios-tutorial-ios10/attributed-strings-simulatorformat=750w1500254459.94" alt=""></p>
<p>å¯ä»¥ä» <a href="https://github.com/ioscreator/ioscreator" target="_blank" rel="external">github</a> ä¸Šä¸‹è½½ <strong>IOS10AttributedStringsTutorial</strong> æ•™ç¨‹çš„æºä»£ç ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      iOS æ•™ç¨‹ï¼šå±æ€§å­—ç¬¦ä¸²
    
    </summary>
    
      <category term="iOS" scheme="https://swift.gg/categories/iOS/"/>
    
      <category term="Swift å…¥é—¨" scheme="https://swift.gg/categories/iOS/Swift-%E5%85%A5%E9%97%A8/"/>
    
    
      <category term="IOSCREATOR" scheme="https://swift.gg/tags/IOSCREATOR/"/>
    
  </entry>
  
  <entry>
    <title>Swift å‘¨æŠ¥ #74</title>
    <link href="https://swift.gg/2017/07/16/swift_weekly_issue_74/"/>
    <id>https://swift.gg/2017/07/16/swift_weekly_issue_74/</id>
    <published>2017-07-15T16:00:00.000Z</published>
    <updated>2017-07-19T05:24:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šJesse Squiresï¼Œ<a href="https://swiftweekly.github.io/issue-74/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-06-15<br>è¯‘è€…ï¼š<a href="https://kemchenj.github.io" target="_blank" rel="external">å››å¨˜</a>ï¼›æ ¡å¯¹ï¼š<a href="http://weibo.com/277195544" target="_blank" rel="external">Cwift</a>ï¼›å®šç¨¿ï¼š<a href="http://codebuild.me/" target="_blank" rel="external">shanks</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>WWDC å·²ç»è¿‡å»ä¸€å‘¨äº†ï¼Œä½ æœ‰å¤§æ¦‚äº†è§£ä½ çš„ä»£ç è¦æ€ä¹ˆè¿ç§»åˆ° Swift 4 å—ï¼Ÿæˆ‘æœ€å…ˆæ¥è§¦åˆ°çš„æ˜¯ä¸€å †è­¦å‘Šï¼Œæç¤ºæœ‰å¤šä½™çš„åè®®éµå®ˆï¼ŒæŸ¥è¯å¾—çŸ¥<a href="https://bugs.swift.org/browse/SR-5153" target="_blank" rel="external">è¿™æ˜¯ä¸ª bug</a>ã€‚ä½†è¯´å›æ¥ï¼Œæ¯”èµ·å»å¹´æˆ‘èŠ±äº†ä¸¤ä¸ªæ˜ŸæœŸè¿ç§»åˆ° Swift 3 æ¥è¯´ï¼Œè¿™æ¬¡çš„å‡çº§å·²ç»å¥½å¾ˆå¤šäº†ã€‚</p>
<p>è€Œä¸”ï¼Œç‰¢è®° Swift 3.2 ç‰ˆæœ¬å®é™…æ˜¯åœ¨ Swift 3 å…¼å®¹æ¨¡å¼ä¸‹è¿è¡Œ Swift 4 çš„ç¼–è¯‘å™¨ï¼ˆ<code>-swift-version 3</code>ï¼Œé€šè¿‡è¿™å±Š WWDCï¼Œæˆ‘ç†è§£äº†å¾ˆå¤šä¸œè¥¿ï¼‰ã€‚å½“ä½ åœ¨æµè§ˆ  <a href="https://bugs.swift.org/" target="_blank" rel="external">bugs.swift.org</a>  æ—¶è®°ä½è¿™ä¸€ç‚¹ä¹Ÿä¼šå¾ˆæœ‰å¸®åŠ©ã€‚<br><a id="more"></a></p>
<blockquote>
<p>æƒ³è¦èµåŠ© Swift Weekly Brief å—? <a href="https://swiftweekly.github.io/sponsorship/" target="_blank" rel="external">ç‚¹å‡»æ­¤å¤„äº†è§£æ›´å¤š</a>  </p>
</blockquote>
<h2 id="ç¤¾åŒºä»»åŠ¡"><a href="#ç¤¾åŒºä»»åŠ¡" class="headerlink" title="ç¤¾åŒºä»»åŠ¡"></a>ç¤¾åŒºä»»åŠ¡</h2><ul>
<li>SR-4866ï¼šStack overflow: ç©ºæ‹¬å·è¡¨è¾¾å¼è¯­æ³•åˆ†æé”™è¯¯</li>
<li>SR-4830ï¼šç¼–è¯‘å™¨çš„ log åŠ ä¸Šé¢œè‰²åŒºåˆ†</li>
</ul>
<p>å¯ä»¥é€šè¿‡ <a href="https://github.com/SwiftWeekly/swiftweekly.github.io/compare" target="_blank" rel="external">pull request</a> æˆ–è€… <a href="https://twitter.com/swiftlybrief" target="_blank" rel="external">tweet</a> æäº¤ä»»åŠ¡ã€‚</p>
<h2 id="Swift-æ‰©å±•"><a href="#Swift-æ‰©å±•" class="headerlink" title="Swift æ‰©å±•"></a>Swift æ‰©å±•</h2><p>ç¬¬ 15 é›†ï¼š <a href="https://spec.fm/podcasts/swift-unwrapped/70809" target="_blank" rel="external">Swift æ›´æ–°å†…å®¹ï¼Œ Part 2</a></p>
<p>JP Simard å’Œ Jesse Squires ç»§ç»­è®¨è®º Swift çš„æ›´æ–°å†…å®¹</p>
<h2 id="èµ„è®¯åŠç¤¾åŒº"><a href="#èµ„è®¯åŠç¤¾åŒº" class="headerlink" title="èµ„è®¯åŠç¤¾åŒº"></a>èµ„è®¯åŠç¤¾åŒº</h2><p>John Sundell å†™äº†ç¯‡<a href="https://www.swiftbysundell.com/posts/exploring-the-new-string-api-in-swift-4" target="_blank" rel="external">å…³äº Swift 4 æ–°çš„å­—ç¬¦ä¸² API çš„æ–‡ç« </a>ï¼Œè¿™ç¯‡æ–‡ç« åŒ…æ‹¬äº†å¾ˆå¤šå®ç”¨çš„ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ Swift æ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨æ–°çš„å­—ç¬¦ä¸² APIã€‚</p>
<p>Slava Pestov åœ¨ Twitter <a href="https://twitter.com/slava_pestov/status/873751462630760449" target="_blank" rel="external">æäº†ä¸€ä¸ªè°œé¢˜</a>ï¼š<code>print(type{ })</code>ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿï¼ˆ<a href="https://twitter.com/nicklockwood/status/873796388768841728" target="_blank" rel="external">ç­”æ¡ˆåœ¨è¿™é‡Œ</a>ï¼‰</p>
<p>Slava ä¹Ÿ<a href="https://twitter.com/slava_pestov/status/873744097353256961" target="_blank" rel="external">å¼ºè°ƒäº†</a> Swift ç¼–è¯‘å™¨å›¢é˜Ÿï¼Œè‡ªä» 2014 å¹´çš„<a href="https://github.com/apple/swift/commit/d8ce0b80cbb7732cb32b245f9fadd47c11a4b163" target="_blank" rel="external">è¿™ä¸€ä¸ª commit</a> å¼€å§‹å·²ç»ä¿®å¤äº†<strong>è¶…è¿‡ 5500 ä¸ª bug äº†</strong>ã€‚</p>
<h2 id="æäº¤å’Œåˆå¹¶çš„è¯·æ±‚"><a href="#æäº¤å’Œåˆå¹¶çš„è¯·æ±‚" class="headerlink" title="æäº¤å’Œåˆå¹¶çš„è¯·æ±‚"></a>æäº¤å’Œåˆå¹¶çš„è¯·æ±‚</h2><p>Slava Pestove <a href="https://github.com/apple/swift/pull/10195" target="_blank" rel="external">ä¿®å¤äº†ä¸€ä¸ª Swift 3.1 å’Œ Swift 4 çš„ bug</a>ï¼Œ å½“ä¸€ä¸ªç±»çš„çˆ¶ç±»åˆå§‹åŒ–æ–¹æ³•æ˜¯ä¸€ä¸ª Objective-C é‡Œå®šä¹‰çš„ç±»å·¥å‚æ–¹æ³•æ—¶ï¼ŒSwift å¯èƒ½ä¼šæŠ¥é”™æç¤º <code>self.init</code> ä¼šè®© self é€ƒé€¸ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ç¼–è¯‘ã€‚</p>
<p>Devin Coughlin <a href="https://github.com/apple/swift/pull/10191" target="_blank" rel="external">åŠ å…¥äº†å¯¹äº inout çš„é™æ€åˆ†æ</a>ï¼ŒåŠ å¼º Swift 4 çš„å†…å­˜å®‰å…¨ç‰¹æ€§ã€‚</p>
<p>Nate Cook ç»™æ–°çš„ Swift 4 çš„ stdlib <a href="https://github.com/apple/swift/pull/10229" target="_blank" rel="external">è¡¥å……å’Œä¿®æ”¹äº†ä¸€å¤§å †æ–‡æ¡£å†…å®¹</a>ã€‚</p>
<p>Dave Abrahams å¼€äº†ä¸€ä¸ªæ–°çš„ PR ä»¥ä¾¿<a href="https://github.com/apple/swift/pull/10223" target="_blank" rel="external">æ”¹è¿› String çš„æ€§èƒ½</a>ã€‚</p>
<p>Roman Levenstein å‡å°‘äº†æ ‡å‡†åº“çš„ä»£ç ä½“ç§¯ï¼Œå¤§æ¦‚ 5-6% å·¦å³ï¼Œç„¶åä»ä¸»åˆ†æ”¯ <a href="https://github.com/apple/swift/pull/10263" target="_blank" rel="external">cherry-pick äº†ä¸€ä¸ª patch</a> åˆ° Swift 4 åˆ†æ”¯ã€‚</p>
<h2 id="ææ¡ˆ"><a href="#ææ¡ˆ" class="headerlink" title="ææ¡ˆ"></a>ææ¡ˆ</h2><p>è¿™å‘¨æ²¡æœ‰ææ¡ˆçš„æ›´æ–°ï¼å…·ä½“çš„å¯ä»¥åˆ°<a href="[Swift Evolution]https://apple.github.io/swift-evolution/">è¿™é‡Œ</a>æŸ¥çœ‹ã€‚</p>
<h2 id="é‚®ä»¶åˆ—è¡¨"><a href="#é‚®ä»¶åˆ—è¡¨" class="headerlink" title="é‚®ä»¶åˆ—è¡¨"></a>é‚®ä»¶åˆ—è¡¨</h2><p>æœ¬å‘¨çš„è®¨è®ºå›´ç»• Swift-Evolution é‚®ä»¶åˆ—è¡¨åº”è¯¥æ‰®æ¼”ä»€ä¹ˆè§’è‰²çš„è¯é¢˜å±•å¼€ï¼Œå› ä¸ºé‚®ä»¶åˆ—è¡¨çš„è´£ä»»æ˜¯å±•ç¤ºä¸€äº›æœ‰å¸®åŠ©çš„è®¨è®ºå†…å®¹ä»¥åŠææ¡ˆçš„å®¡æ ¸ç»“æœï¼Œé‰´äºé‚®ä»¶ä¸»é¢˜æ˜¯ç”± Swift å‘å¸ƒå‘¨æœŸ/é˜¶æ®µå¼•å¯¼çš„ï¼Œä»€ä¹ˆæ—¶å€™æ‰åº”è¯¥æŠŠä¸€ä¸ªæƒ³æ³•å¸¦å…¥ä¸¥è‚ƒçš„è®¨è®ºä¸­ï¼ˆä¹Ÿè®¸è¿™ä¸ªæƒ³æ³•è·Ÿå½“å‰å¼€å‘é˜¶æ®µçš„ä¸»é¢˜æ¯«æ— è”ç³»ï¼‰å¾ˆå€¼å¾—è®¨è®ºã€‚</p>
<p>Ted Kremenek è¿™ä¹ˆ<a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170612/037339.html" target="_blank" rel="external">å†™åˆ°</a>ï¼š</p>
<blockquote>
<p>å„ä½ï¼šè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è®¨è®ºï¼Œå¾ˆæ„Ÿè°¢å¤§å®¶å¯¹äºè¿™ä»¶äº‹æƒ…çš„æ€è€ƒã€‚è¿™å…¶å®æ˜¯ Ben Cohen å’Œæˆ‘ç§ä¸‹èŠå®Œä¹‹åï¼Œæˆ‘ä»¬æ‰“ç®—å¸¦ç€æ ¸å¿ƒå›¢é˜Ÿä¸€èµ·è®¨è®ºè¿™ä»¶äº‹ã€‚  </p>
<p>[â€¦]  </p>
<p>æ ¹æ® Xiaodi çš„è§‚å¯Ÿï¼Œevolution çš„åˆ—è¡¨å¯¹äºæ¨è¿›å½“å‰å¼€å‘ç›®æ ‡å†…çš„ææ¡ˆçš„ä½œç”¨æ˜¯æœ€å¤§çš„ã€‚æœ‰å¾ˆå¤šä¸åŒçš„ä¸»é¢˜å¤§å®¶æƒ³è®¨è®ºï¼Œè€Œä¸”å¾ˆæ˜æ˜¾æ‰€æœ‰äººéƒ½æœ‰ç‚¹ç„¦è™‘ï¼Œæƒ³è¦éƒ½å‚ä¸ä½†äººçš„ç²¾åŠ›æ˜¯æœ‰é™çš„ï¼Œå¾ˆéš¾æ¯ä¸€ä¸ªä¸»é¢˜éƒ½æ·±å…¥åœ°å‚ä¸è¿›å»ã€‚ä¹Ÿè®¸æŠŠè¿™äº›ç§»åˆ°ä¸€ä¸ªè®¨è®ºç‰ˆï¼ˆæˆ‘ä»¬ä¸€ç›´æƒ³åšï¼Œä½†ä¸€ç›´æ²¡æœ‰ç²¾åŠ›åšçš„ä¸€ä¸ªä¸œè¥¿ï¼‰ï¼Œæä¾›ä¸€ä¸ªéæ­£å¼çš„è®¨è®ºç¤¾åŒºï¼Œå°±åƒ Xiaodi æåˆ°çš„ Swift.org è®ºå›é‚£æ ·çš„ä¸œè¥¿ï¼Œä½†è¦æŠŠå¼€å‘ç›®æ ‡å†…å¤–ä¸»é¢˜æ˜ç¡®åˆ†å¼€ï¼Œè®©å¤§å®¶å¯ä»¥å»è®¨è®ºä»–ä»¬æ„Ÿå…´è¶£çš„ä¸»é¢˜ã€‚  </p>
<p>[â€¦]  </p>
</blockquote>
<p>å¦‚æœä½ å¯¹äº Swift Evolution çš„å‘å±•æ„Ÿå…´è¶£çš„è¯ï¼Œé‚£å¯ä»¥è€ƒè™‘æ·±å…¥é˜…è¯»ï¼Œçœ‹çœ‹è¿™ä¸ªè¿‡ç¨‹æ˜¯å¦‚ä½•å›´ç»•ç€â€œå¼€å‘ç›®æ ‡å†…â€å‘ˆç°æœ‰å»ºè®¾æ€§çš„è®¨è®ºï¼Œä»¥åŠè¯¥å¦‚ä½•å¤„ç†é‚£äº›ä¸åœ¨â€œå½“å‰å¼€å‘ç›®æ ‡å†…â€çš„æƒ³æ³•ã€‚</p>
<p>Chris Lattner åœ¨å›é¡¾ <a href="https://lists.swift.org/pipermail/swift-evolution//Week-of-Mon-20170612/037514.html" target="_blank" rel="external">SE-0110</a> çš„ä¸€ä¸ª<a href="https://lists.swift.org/pipermail/swift-evolution//Week-of-Mon-20170612/037514.html" target="_blank" rel="external">é•¿æœŸè®¨è®º</a>é‡Œåšäº†å›åº”ï¼š</p>
<blockquote>
<p>æ ¸å¿ƒå›¢é˜Ÿä»Šå¤©è®¨è®ºäº†è¿™ä»¶äº‹æƒ…ï¼Œå¤§å®¶ä¸€è‡´è®¤ä¸ºéœ€è¦ä¸ºäº†é‡æ–°è·å¾—è¯­æ³•çš„ä¾¿æ·æ€§è€Œåšå‡ºæ”¹å˜ã€‚ è®¨è®ºä¹‹åå¤§å®¶æ›´å€¾å‘äºï¼ˆè‡³å°‘ï¼‰ä¿ç•™é—­åŒ…é‡Œä½¿ç”¨æ‹¬å·å±•å¼€å…ƒç»„çš„å½¢å¼ï¼Œä½†è¿™ä»¶äº‹æƒ…è¿˜éœ€è¦æ›´å¤šçš„è®¨è®ºã€‚  </p>
<p>è¯´ä¸€ä¸ªé¢˜å¤–è¯ï¼Œç»™å…ƒç»„é‡Œé¢çš„å…ƒç´ å‘½åçš„å½¢å¼ä»¥åæŸä¸ªæ—¶é—´ç‚¹åº”è¯¥ä¼šè¢«å–æ¶ˆæ‰ã€‚ä¸ä»”ç»†çœ‹çš„è¯ï¼Œä½ èƒ½åˆ†æ¸…ä¸‹é¢å£°æ˜äº†å“ªä¸ªå˜é‡å—ï¼Ÿï¼š  </p>
<p><code>let (a : Int, b : Float) = foo()</code>  </p>
<p>?  </p>
</blockquote>
<p>æˆ‘ä»¬åœ¨è¿™é‡Œå›é¡¾ä¸€ä¸‹<a href="https://swiftweekly.github.io/issue-72/" target="_blank" rel="external">ç¬¬ 72 æœŸçš„å‘¨æŠ¥</a>ã€‚åœ¨ Swift 4 é‡Œï¼Œn ä¸ªå…ƒç´ çš„å…ƒç»„å·²ç»ä¸ä¼šåœ¨é—­åŒ…é‡Œæ‹“å±•ä¸º n ä¸ªå‚æ•°äº†ï¼ˆå…ƒç»„å±•å¹³è¡Œä¸ºï¼‰ã€‚è¿™æ„å‘³ç€é—­åŒ…å°†ä¼šæ¥æ”¶ä¸€ä¸ªå…ƒç»„ç±»å‹çš„å‚æ•°ï¼Œè€Œä½ éœ€è¦æ‰‹åŠ¨å»æŠŠå®ƒä»¬å±•å¼€ã€‚è¿™å¾ˆæ˜æ˜¾å°±ä¸ç¬¦åˆç›´è§‰ï¼Œå¼€å‘ä½“éªŒä¹Ÿå¾ˆå·®ã€‚å¾ˆé«˜å…´çœ‹åˆ°æ ¸å¿ƒå›¢é˜Ÿé‡æ–°è€ƒè™‘è¿™ä¸ªå†³å®šï¼è°è¯´ Swift-Evolution ä¸å¥½çš„ï¼ŸğŸ˜‰</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>æœ‰å…³ Swift 2 çš„<a href="https://twitter.com/jckarter/status/874397984712163331" target="_blank" rel="external">ä¸€äº›æ„Ÿæƒ³</a>ğŸºã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      Swift å‘¨æŠ¥
    
    </summary>
    
      <category term="Swift è¿›é˜¶" scheme="https://swift.gg/categories/Swift-%E8%BF%9B%E9%98%B6/"/>
    
    
      <category term="Jesse Squires" scheme="https://swift.gg/tags/Jesse-Squires/"/>
    
  </entry>
  
  <entry>
    <title>Swift 3.0 ä¸‹ Notifications ä¸ userInfo çš„ä½¿ç”¨</title>
    <link href="https://swift.gg/2017/06/13/notifications-and-userinfo-with-swift-3-0/"/>
    <id>https://swift.gg/2017/06/13/notifications-and-userinfo-with-swift-3-0/</id>
    <published>2017-06-12T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šJoeï¼Œ<a href="http://dev.iachieved.it/iachievedit/notifications-and-userinfo-with-swift-3-0/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016-09-17<br>è¯‘è€…ï¼š<a href="undefined">Tony Han</a>ï¼›æ ¡å¯¹ï¼š<a href="http://chengway.in/" target="_blank" rel="external">walkingway</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>Swift 3.0 ç‰ˆæœ¬ç»™ Swift è¯­è¨€å¸¦æ¥äº†ç›¸å½“å¤šçš„æ”¹å˜ï¼ŒåŒ…æ‹¬å»æ‰ Foundation æ¡†æ¶ä¸­ NS å‰ç¼€çš„ <a href="https://developer.apple.com/videos/play/wwdc2016/403/" target="_blank" rel="external">Great Renaming</a>ã€‚<code>NSThread</code> è¢«ç®€å†™ä½œ <code>Thread</code>ï¼Œ<code>NSData</code> è¢«ç®€å†™ä½œ <code>Data</code>ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€ã€‚</p>
<a id="more"></a>
<p>è¿™æ„å‘³ç€ï¼Œéœ€è¦æ›´æ–°é€šè¿‡ <code>userInfo</code> ä½¿ç”¨ <code>NSNotificationCenter</code>ï¼Œå“¦ä¸ï¼Œ<code>NotificationCenter</code> çš„ç”¨æ³•ã€‚è¿™æ˜¯ Swift 2 å’Œ Swift 3 ä¹‹é—´çš„å·¨å¤§å·®åˆ«ã€‚</p>
<p>ç°åœ¨è·å–é»˜è®¤çš„ <code>NotificationCenter</code> çš„æ–¹æ³•å·²ç»å˜æˆ <code>let nc = NotificationCenter.default</code>ã€‚å¦å¤–ï¼Œå½“æ¥æ”¶åˆ°é€šçŸ¥æ—¶ï¼Œä½¿ç”¨é€‰æ‹©å™¨çš„æ¨¡å‹å·²ç»æ”¹å˜ä¸ºæŒ‡å®šè¦æ‰§è¡Œçš„ä»£ç å—æˆ–å‡½æ•°ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨ Swift 2 ä¸­è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> nc = <span class="type">NSNotificationCenter</span>.defaultCenter()</div><div class="line">nc.addObserver(<span class="keyword">self</span>, </div><div class="line">               selector: #selector(<span class="type">ViewController</span>.catchNotification),</div><div class="line">               name: <span class="string">"MyNotification"</span>, </div><div class="line">               object: <span class="literal">nil</span>)</div></pre></td></tr></table></figure>
<p>è€Œ Swift 3 ä¸­è¦è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> nc = <span class="type">NotificationCenter</span>.<span class="keyword">default</span> <span class="comment">// æ³¨æ„ï¼šdefault æ˜¯å±æ€§ï¼Œä¸æ˜¯æ–¹æ³•è°ƒç”¨</span></div><div class="line">nc.addObserver(forName:<span class="type">Notification</span>.<span class="type">Name</span>(rawValue:<span class="string">"MyNotification"</span>),</div><div class="line">               object:<span class="literal">nil</span>, queue:<span class="literal">nil</span>,</div><div class="line">               using:catchNotification)</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­è®¾ç½®äº†é€šçŸ¥ä¸­å¿ƒå°† <code>MyNotification</code> é€šçŸ¥ä¼ é€’ç»™å…·æœ‰ <code>(Notification) -&gt; Void</code> æ–¹æ³•ç­¾åçš„ <code>catchNotification</code> å‡½æ•°ã€‚æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨é—­åŒ…è°ƒç”¨ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> nc = <span class="type">NotificationCenter</span>.<span class="keyword">default</span> <span class="comment">// æ³¨æ„ï¼šdefault æ˜¯å±æ€§ï¼Œä¸æ˜¯æ–¹æ³•è°ƒç”¨</span></div><div class="line">nc.addObserver(forName:<span class="type">Notification</span>.<span class="type">Name</span>(rawValue:<span class="string">"MyNotification"</span>),</div><div class="line">               object:<span class="literal">nil</span>, queue:<span class="literal">nil</span>) &#123;</div><div class="line">  notification <span class="keyword">in</span></div><div class="line">  <span class="comment">// å¤„ç†é€šçŸ¥</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="å‘é€é€šçŸ¥"><a href="#å‘é€é€šçŸ¥" class="headerlink" title="å‘é€é€šçŸ¥"></a>å‘é€é€šçŸ¥</h4><p>ä¸‹é¢çœ‹çœ‹å¦‚ä½•å‘é€é€šçŸ¥ã€‚Swift 2.0 ä¸­çš„ <code>postNotificationName</code> æ–¹æ³•åœ¨ Swift 3.0 ä¸­å·²ç»è¢«æ›¿æ¢ä¸º <code>post</code>ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> nc = <span class="type">NotificationCenter</span>.<span class="keyword">default</span></div><div class="line">nc.post(name:<span class="type">Notification</span>.<span class="type">Name</span>(rawValue:<span class="string">"MyNotification"</span>),</div><div class="line">        object: <span class="literal">nil</span>,</div><div class="line">        userInfo: [<span class="string">"message"</span>:<span class="string">"Hello there!"</span>, <span class="string">"date"</span>:<span class="type">Date</span>()])</div></pre></td></tr></table></figure>
<p><code>userInfo</code> ä½¿ç”¨ <code>[AnyHashableï¼šAny]?</code> ä½œä¸ºå‚æ•°ï¼Œè¿™åœ¨ Swift ä¸­è¢«ç§°ä½œå­—å…¸å­—é¢é‡ã€‚æ³¨æ„ï¼Œ<code>userInfo</code> çš„å€¼ä¸éœ€è¦ç»Ÿä¸€ç±»å‹ï¼ˆå³ <code>Any</code> æ‰€å ä½ç½®ï¼‰ï¼›è¿™é‡Œå‘é€äº†ä¸€ä¸ª <code>String</code> ç±»å‹å’Œä¸€ä¸ª <code>Date</code> ç±»å‹ã€‚</p>
<h4 id="å¤„ç†é€šçŸ¥"><a href="#å¤„ç†é€šçŸ¥" class="headerlink" title="å¤„ç†é€šçŸ¥"></a>å¤„ç†é€šçŸ¥</h4><p><code>guard</code> è¯­æ³•ç”¨æ¥ä» <code>userInfo</code> ä¸­è§£åŒ…å¹¶éªŒè¯æœŸæœ›æ•°æ®ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„æ–¹å¼ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">catchNotification</span><span class="params">(notification:Notification)</span></span> -&gt; <span class="type">Void</span> &#123;</div><div class="line">  <span class="built_in">print</span>(<span class="string">"Catch notification"</span>)</div><div class="line">  </div><div class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> userInfo = notification.userInfo,</div><div class="line">        <span class="keyword">let</span> message  = userInfo[<span class="string">"message"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</div><div class="line">        <span class="keyword">let</span> date     = userInfo[<span class="string">"date"</span>]    <span class="keyword">as</span>? <span class="type">Date</span> <span class="keyword">else</span> &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"No userInfo found in notification"</span>)</div><div class="line">    <span class="keyword">return</span></div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">let</span> alert = <span class="type">UIAlertController</span>(title: <span class="string">"Notification!"</span>,</div><div class="line">                                message:<span class="string">"<span class="subst">\(message)</span> received at <span class="subst">\(date)</span>"</span>,</div><div class="line">                                preferredStyle: <span class="type">UIAlertControllerStyle</span>.alert)</div><div class="line">  alert.addAction(<span class="type">UIAlertAction</span>(title: <span class="string">"OK"</span>, style: <span class="type">UIAlertActionStyle</span>.<span class="keyword">default</span>, handler: <span class="literal">nil</span>))</div><div class="line">  <span class="keyword">self</span>.present(alert, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¦éªŒè¯ <code>guard</code> çš„ä½œç”¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>String</code> ç±»å‹æˆ–å…¶ä»–çš„å¯¹è±¡ç±»å‹ä»£æ›¿ <code>Date()</code> æ¥è°ƒç”¨ <code>post</code> æ–¹æ³•ã€‚å¯ä»¥åœ¨æ§åˆ¶å°çš„è¾“å‡ºä¸­çœ‹åˆ° <code>No userInfo found in notification</code>ã€‚</p>
<h4 id="å®ä¾‹æºç "><a href="#å®ä¾‹æºç " class="headerlink" title="å®ä¾‹æºç "></a>å®ä¾‹æºç </h4><p>å¯ä»¥åœ¨ä¸€ä¸ªç®€å•çš„ iOS é¡¹ç›®ä¸­å°è¯•ä½¿ç”¨ä¸Šé¢çš„ä»£ç ã€‚åˆ›å»º <strong>Single View Application</strong> é¡¹ç›®ï¼Œå¹¶ä¸”ä½¿ç”¨ä»¥ä¸‹å†…å®¹æ›¿æ¢ <code>ViewController.swift</code> ä¸­çš„å†…å®¹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line">  </div><div class="line">  <span class="keyword">let</span> myNotification = <span class="type">Notification</span>.<span class="type">Name</span>(rawValue:<span class="string">"MyNotification"</span>)</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidLoad()</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> nc = <span class="type">NotificationCenter</span>.<span class="keyword">default</span></div><div class="line">    nc.addObserver(forName:myNotification, object:<span class="literal">nil</span>, queue:<span class="literal">nil</span>, using:catchNotification)</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidAppear</span><span class="params">(<span class="number">_</span> animated: Bool)</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidAppear(animated)</div><div class="line">    <span class="keyword">let</span> nc = <span class="type">NotificationCenter</span>.<span class="keyword">default</span></div><div class="line">    nc.post(name:myNotification,</div><div class="line">            object: <span class="literal">nil</span>,</div><div class="line">            userInfo:[<span class="string">"message"</span>:<span class="string">"Hello there!"</span>, <span class="string">"date"</span>:<span class="type">Date</span>()])</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">func</span> <span class="title">catchNotification</span><span class="params">(notification:Notification)</span></span> -&gt; <span class="type">Void</span> &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"Catch notification"</span>)</div><div class="line">    </div><div class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> userInfo = notification.userInfo,</div><div class="line">          <span class="keyword">let</span> message  = userInfo[<span class="string">"message"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</div><div class="line">          <span class="keyword">let</span> date     = userInfo[<span class="string">"date"</span>]    <span class="keyword">as</span>? <span class="type">Date</span> <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"No userInfo found in notification"</span>)</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> alert = <span class="type">UIAlertController</span>(title: <span class="string">"Notification!"</span>,</div><div class="line">                                  message:<span class="string">"<span class="subst">\(message)</span> received at <span class="subst">\(date)</span>"</span>,</div><div class="line">                                  preferredStyle: <span class="type">UIAlertControllerStyle</span>.alert)</div><div class="line">    alert.addAction(<span class="type">UIAlertAction</span>(title: <span class="string">"OK"</span>, style: <span class="type">UIAlertActionStyle</span>.<span class="keyword">default</span>, handler: <span class="literal">nil</span>))</div><div class="line">    <span class="keyword">self</span>.present(alert, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li><code>Notification</code> çš„â€œåå­—â€ä¸å†æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè€Œæ˜¯ <code>Notification.Name</code> ç±»å‹ï¼Œå› æ­¤åœ¨å£°æ˜é€šçŸ¥çš„æ—¶å€™ä½¿ç”¨ <code>let myNotification = Notification.Name(rawValue:&quot;MyNotification&quot;)</code>ã€‚è¿™æ ·å¯ä»¥å…è®¸æˆ‘ä»¬åœ¨ä»»ä½•éœ€è¦ä½¿ç”¨ <code>Notification.Name</code> çš„åœ°æ–¹æ¥ä½¿ç”¨ <code>myNotification</code>ï¼Œæ¯”å¦‚ï¼Œ<code>NotificationCenter.addObserver</code> å’Œ <code>NotificationCenter.post</code> æ–¹æ³•ã€‚</li>
<li>æ¨èä½¿ç”¨åˆ†å¼€çš„ <code>catchNotification</code> æ–¹æ³•è€Œä¸æ˜¯çº ç¼ åœ¨ä¸€èµ·çš„ä»£ç å—ã€‚</li>
</ul>
<p>å°±æ˜¯è¿™æ ·ï¼Œç®€æ´è€Œæœ‰æ•ˆï¼</p>
<h4 id="è¯„è®ºå†…å®¹"><a href="#è¯„è®ºå†…å®¹" class="headerlink" title="è¯„è®ºå†…å®¹"></a>è¯„è®ºå†…å®¹</h4><p>å£°æ˜å¹¶ä½¿ç”¨é€šçŸ¥çš„æ”¹è¿›ï¼š</p>
<p>1) é¦–å…ˆå£°æ˜é€šçŸ¥åç§°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">extension</span> <span class="title">Notification</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> </span>&#123;</div><div class="line">     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">let</span> <span class="type">MyNotification</span> = <span class="type">Notification</span>.<span class="type">Name</span>(<span class="string">"Notification.MyApp.MyNotification"</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2) ä½¿ç”¨é€šçŸ¥åç§°å‘é€é€šçŸ¥ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">NotificationCenter</span>.<span class="keyword">default</span>.post(name: <span class="type">Notification</span>.<span class="type">MyApp</span>.<span class="type">MyNotification</span>, object: <span class="keyword">self</span>)</div></pre></td></tr></table></figure>
<p>3) ç›‘å¬é€šçŸ¥ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(forName: <span class="type">Notification</span>.<span class="type">MyApp</span>.<span class="type">MyNotification</span>, object: <span class="literal">nil</span>, queue: <span class="type">OperationQueue</span>.main) &#123;</div><div class="line">      pNotification <span class="keyword">in</span></div><div class="line"> </div><div class="line">  <span class="comment">// Your code here</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šJoeï¼Œ&lt;a href=&quot;http://dev.iachieved.it/iachievedit/notifications-and-userinfo-with-swift-3-0/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016-09-17&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;undefined&quot;&gt;Tony Han&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://chengway.in/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;walkingway&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;Swift 3.0 ç‰ˆæœ¬ç»™ Swift è¯­è¨€å¸¦æ¥äº†ç›¸å½“å¤šçš„æ”¹å˜ï¼ŒåŒ…æ‹¬å»æ‰ Foundation æ¡†æ¶ä¸­ NS å‰ç¼€çš„ &lt;a href=&quot;https://developer.apple.com/videos/play/wwdc2016/403/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Great Renaming&lt;/a&gt;ã€‚&lt;code&gt;NSThread&lt;/code&gt; è¢«ç®€å†™ä½œ &lt;code&gt;Thread&lt;/code&gt;ï¼Œ&lt;code&gt;NSData&lt;/code&gt; è¢«ç®€å†™ä½œ &lt;code&gt;Data&lt;/code&gt;ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iAchieved.it" scheme="https://swift.gg/categories/iAchieved-it/"/>
    
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/tags/iOS-%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Swift å‘¨æŠ¥ #73</title>
    <link href="https://swift.gg/2017/06/10/issue-73/"/>
    <id>https://swift.gg/2017/06/10/issue-73/</id>
    <published>2017-06-09T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šJesse Squiresï¼Œ<a href="https://swiftweekly.github.io/issue-73/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-06-09<br>è¯‘è€…ï¼š<a href="https://kemchenj.github.io" target="_blank" rel="external">å››å¨˜</a>ï¼›æ ¡å¯¹ï¼š<a href="http://chengway.in/" target="_blank" rel="external">walkingway</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>è¿™å‘¨çš„äº‹æƒ…å¾ˆå¤šï¼ä»Šå¤©æ˜¯ <a href="https://developer.apple.com/videos/wwdc2017/" target="_blank" rel="external">WWDC 2017</a> çš„æœ€åä¸€å¤©ï¼ŒSwift 4 éšç€ <a href="https://developer.apple.com/xcode/" target="_blank" rel="external">Xcode 9</a>ï¼Œä¸€èµ·æ”¾å‡ºäº†å¼€å‘è€…å…¬æµ‹ç‰ˆã€‚Xcode å’Œ Swift éƒ½æœ‰å¥½å‡ ä¸ªé‡å¤§çš„æ”¹è¿›å’Œæ–°çš„åŠŸèƒ½ â€” è¿™ä¸ªç‰ˆæœ¬çœŸçš„å¾ˆæ£’ã€‚æ•´ä¸ª<a href="https://twitter.com/ericasadun/status/871819962888802304" target="_blank" rel="external">ç¤¾åŒº</a>çš„<a href="https://twitter.com/SmileyKeith/status/871852588844556288" target="_blank" rel="external">åå“</a><a href="https://twitter.com/fpillet/status/871987276187828224" target="_blank" rel="external">éƒ½</a><a href="https://twitter.com/chriseidhof/status/873066951739703296" target="_blank" rel="external">å¾ˆ</a><a href="https://twitter.com/tonyarnold/status/873017116298846208" target="_blank" rel="external">æ­£</a><a href="https://twitter.com/ayanonagon/status/871850052498489344" target="_blank" rel="external">é¢</a>ã€‚æ­å–œ Apple çš„ Xcode, Swift å’Œå¼€å‘å·¥å…·ç»„ï¼</p>
<a id="more"></a>
<blockquote>
<p>æƒ³è¦èµåŠ© Swift Weekly Brief å—ï¼Ÿ<a href="https://swiftweekly.github.io/sponsorship/" target="_blank" rel="external">ç‚¹å‡»æ­¤å¤„äº†è§£æ›´å¤š</a>  </p>
</blockquote>
<h2 id="Swift-è§£åŒ…"><a href="#Swift-è§£åŒ…" class="headerlink" title="Swift è§£åŒ…"></a>Swift è§£åŒ…</h2><p>ç¬¬ 14 é›†ï¼š<a href="https://spec.fm/podcasts/swift-unwrapped/70808" target="_blank" rel="external">Swift æ›´æ–°å†…å®¹ï¼ŒPart 1</a></p>
<p>æˆ‘ä»¬è®¨è®ºäº† Swift 4 é‡Œçš„ä¸€äº›æ–°åŠŸèƒ½å’Œæ”¹è¿›ã€‚</p>
<h2 id="èµ„è®¯åŠç¤¾åŒº"><a href="#èµ„è®¯åŠç¤¾åŒº" class="headerlink" title="èµ„è®¯åŠç¤¾åŒº"></a>èµ„è®¯åŠç¤¾åŒº</h2><p>Apple <a href="https://www.apple.com/newsroom/2017/06/swift-playgrounds-expands-coding-education-to-robots-drones-and-musical-instruments/" target="_blank" rel="external">å®£å¸ƒ</a> Swift Playgrounds å·²ç»æ”¯æŒå¯¹ç©å…·æœºå™¨äººå’Œæ— äººæœºçš„ç¼–ç¨‹äº†ã€‚ä»–ä»¬æ­£ä¸å¤šå®¶å…¬å¸åˆä½œï¼ŒåŒ…æ‹¬ Lego, Sphero ç­‰ä¸€ä¼—å…¬å¸ã€‚ è¿™ä»¶äº‹æƒ…å¾ˆæ£’å¾ˆå¥½ç©ï¼Œä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹<a href="https://www.youtube.com/watch?v=v7926MzvXOQ" target="_blank" rel="external">ç›¸å…³è§†é¢‘</a>ã€‚</p>
<p>Erica Sadun çš„æ–°ä¹¦ <a href="http://ericasadun.com/2017/06/01/swift-style-wwdc-sale/" target="_blank" rel="external">Swift Style</a> è¿™å‘¨æ­£å¼å¼€å§‹é”€å”®ã€‚</p>
<p>objc.io å·²ç»æ”¾å‡ºäº†ä»–ä»¬çš„æ–°ä¹¦ï¼Œ<a href="https://www.objc.io/blog/2017/06/02/optimizing-collections/" target="_blank" rel="external">Optimizing Collections</a>ã€‚ä½œè€… <a href="https://twitter.com/lorentey" target="_blank" rel="external">KÃ¡roly LÅ‘rentey</a> åœ¨è¿™æœ¬ä¹¦é‡Œä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Swift ç¼–å†™é«˜æ•ˆçš„è‡ªå®šä¹‰é›†åˆç±»å‹ã€‚</p>
<p><a href="https://developer.apple.com/news/?id=06052017d" target="_blank" rel="external">Xcode 9 beta ä»¥åŠæ–°çš„ SDK</a> å…¨éƒ½æ”¾å‡ºæ¥å•¦ï¼</p>
<h2 id="WWDC-é‡Œå…³äº-Swift-çš„è§†é¢‘"><a href="#WWDC-é‡Œå…³äº-Swift-çš„è§†é¢‘" class="headerlink" title="WWDC é‡Œå…³äº Swift çš„è§†é¢‘"></a>WWDC é‡Œå…³äº Swift çš„è§†é¢‘</h2><ul>
<li><a href="https://developer.apple.com/videos/play/wwdc2017/402/" target="_blank" rel="external">Whatâ€™s new in Swift</a></li>
<li><a href="https://developer.apple.com/videos/play/wwdc2017/408/" target="_blank" rel="external">Whatâ€™s new in Swift Playgrounds</a></li>
<li><a href="https://developer.apple.com/videos/play/wwdc2017/416/" target="_blank" rel="external">Teaching with Swift Playgrounds</a></li>
<li><a href="https://developer.apple.com/videos/play/wwdc2017/212/" target="_blank" rel="external">Whatâ€™s new in Foundation</a></li>
<li><a href="https://developer.apple.com/videos/play/wwdc2017/407/" target="_blank" rel="external">Understanding undefined behavior</a></li>
</ul>
<h2 id="æäº¤å’Œåˆå¹¶çš„è¯·æ±‚"><a href="#æäº¤å’Œåˆå¹¶çš„è¯·æ±‚" class="headerlink" title="æäº¤å’Œåˆå¹¶çš„è¯·æ±‚"></a>æäº¤å’Œåˆå¹¶çš„è¯·æ±‚</h2><p>Rober Widmann <a href="https://github.com/apple/swift/pull/10175" target="_blank" rel="external">åˆå¹¶äº†ä¿®æ”¹</a>ï¼Œä½¿ç”¨äº† Xcode æ–°çš„æœªå®šä¹‰è¡Œä¸ºæ£€æµ‹å™¨ï¼Œæ¥ä¿®å¤äº†ä¸€äº›æœªå®šä¹‰çš„è¡Œä¸ºã€‚</p>
<p>Roman Levenstein <a href="https://github.com/apple/swift/pull/10096" target="_blank" rel="external">åšäº†ä¸€äº›å°è°ƒæ•´</a>ï¼Œè®©æ ‡å‡†åº“çš„ä»£ç ä½“ç§¯å‡å°‘äº† 1.5% ï¼ï¼ï¼</p>
<p>Swift æœåŠ¡ç«¯ API å·¥ä½œç»„å‘å¸ƒäº†ä¸€ä¸ª<a href="https://github.com/swift-server/http" target="_blank" rel="external">æ–°çš„ repo</a>ï¼Œä¸»è¦æ˜¯å…³äºè·¨å¹³å° HTTP API çš„å¼€å‘ã€‚</p>
<p>Ben Cohen å‘ <code>swift-4.0 åˆ†æ”¯</code><a href="https://github.com/apple/swift/pull/10161" target="_blank" rel="external">å‘èµ·äº†ä¸€ä¸ªåˆå¹¶çš„è¯·æ±‚</a>ï¼Œç”¨äºæé«˜ substring æ¯”è¾ƒçš„æ€§èƒ½ã€‚Nate Cook <a href="https://github.com/apple/swift/pull/10156" target="_blank" rel="external">ä¹Ÿå‘èµ·äº†ä¸€ä¸ªæé«˜å­—å…¸æ•ˆç‡çš„åˆå¹¶è¯·æ±‚</a>ï¼Œç°åœ¨å·²ç»æœ‰<a href="https://github.com/apple/swift/pulls?utf8=âœ“&amp;q=is%3Apr%20%5B4.0%5D%20in%3Atitle" target="_blank" rel="external">å¥½å‡ ä¸ª Swift 4 çš„åˆå¹¶è¯·æ±‚</a> äº†ï¼Œå¸Œæœ›é‚£äº›å·²ç»è¯·æ±‚å®Œæˆçš„åˆå¹¶è¯·æ±‚å¯ä»¥å°½å¿«é€šè¿‡ã€‚æˆ‘ä»¬åº”è¯¥å¯ä»¥åœ¨æ¥ä¸‹æ¥çš„ beta ç‰ˆé‡Œçœ‹åˆ°è¿™äº›æ”¹è¿›ã€‚</p>
<p>Slava Pestov <a href="https://github.com/apple/swift/pull/10162" target="_blank" rel="external">ä¿®å¤</a>äº†å‡ ä¸ª Bugã€‚ğŸ‘</p>
<h2 id="æ­£åœ¨-review-çš„ææ¡ˆ"><a href="#æ­£åœ¨-review-çš„ææ¡ˆ" class="headerlink" title="æ­£åœ¨ review çš„ææ¡ˆ"></a>æ­£åœ¨ review çš„ææ¡ˆ</h2><p><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0180-string-index-overhaul.md" target="_blank" rel="external">SE-0180</a>ï¼šå­—ç¬¦ä¸²ç´¢å¼•ç±»å‹ç»Ÿä¸€ï¼ŒDave Abrahamsï¼Œ<a href="https://lists.swift.org/pipermail/swift-evolution-announce/2017-June/000384.html" target="_blank" rel="external">æ­£åœ¨ review</a></p>
<blockquote>
<p>ç°åœ¨ <code>String</code> è·Ÿå®ƒçš„ <code>CharacterView</code> å…±ç”¨ä¸€ä¸ª <code>Index</code> ç±»å‹ï¼Œä½† <code>UTF8View</code>ï¼Œ  <code>UTF16View</code> ä»¥åŠ <code>UnicodeScalarView</code> å°±ä¸æ˜¯äº†ã€‚è¿™ä¸ªææ¡ˆé‡æ–°å®šä¹‰äº†è¿™å‡ ä¸ªç±»å‹çš„ <code>Index</code> ç±»å‹ï¼Œè®©å®ƒä»¬è·Ÿ <code>String</code> ä¿æŒä¸€è‡´ã€‚å¹¶ä¸”æš´éœ²ä¸€ä¸ªå…¬å¼€çš„ <code>encodedOffset</code> å±æ€§å’Œæ„é€ å™¨ï¼Œç”¨äºåºåˆ—åŒ–å’Œååºåˆ—åŒ– <code>String</code> å’Œ <code>Substring</code> çš„ç´¢å¼•å€¼ã€‚  </p>
<p>[â€¦]</p>
<p>è¿™æ ·çš„ç»“æœå°±æ˜¯å¾ˆå¤š API éƒ½æ— æ³•ä»åŸæœ¬çš„è®¾è®¡ä¸­è·ç›Šï¼Œé€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ª view çš„ç´¢å¼•å¦‚æœå¯ä»¥åœ¨å¦ä¸€ä¸ª view æœ‰å¯¹åº”çš„ç´¢å¼•å€¼çš„è¯ï¼Œè¿™äº›ç´¢å¼•å€¼çš„è½¬æ¢éƒ½åº”è¯¥åœ¨å†…éƒ¨å®Œæˆï¼Œè€Œä¸æ˜¯åƒç°åœ¨è¿™æ ·éœ€è¦å†™å¾ˆå¤šä¸å¿…è¦çš„ä»£ç ã€‚ </p>
<p>[â€¦]  </p>
<p>æ‰€æœ‰ String çš„ view éƒ½ä¼šä½¿ç”¨åŒä¸€ç§ Index ç±»å‹ (<code>String.Index</code>)ï¼Œè¿™æ ·ç´¢å¼•å€¼å°±å¯ä»¥åœ¨å†…éƒ¨è¿›è¡Œè½¬æ¢ï¼Œè€Œä¸ç”¨æ˜¾å¼åœ°å»å®Œæˆã€‚  </p>
<p><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0180-string-index-overhaul.md" target="_blank" rel="external">æŸ¥çœ‹åŸæ–‡â€¦</a>  </p>
</blockquote>
<h2 id="é‚®ä»¶åˆ—è¡¨"><a href="#é‚®ä»¶åˆ—è¡¨" class="headerlink" title="é‚®ä»¶åˆ—è¡¨"></a>é‚®ä»¶åˆ—è¡¨</h2><p>Ted Kremenek å‘å¸ƒäº†<a href="https://lists.swift.org/pipermail/swift-dev/Week-of-Mon-20170605/004751.html" target="_blank" rel="external">ä¸€ä¸ªå…¬å‘Š</a>ï¼Œå…³äºå³å°†å¼€æºçš„é‡æ„å·¥å…·ï¼Œä»¥åŠå…¶å®ƒåœ¨ WWDC å…¬å¸ƒçš„äº‹æƒ…ï¼š</p>
<blockquote>
<p>ä»Šå¤©ä¸‹åˆåœ¨ WWDC ä¸Šï¼Œæˆ‘ä»¬å‘å¸ƒäº† Xcode 9 é‡Œæ–°çš„é‡æ„åŠŸèƒ½(æ”¯æŒ Swiftï¼ŒCï¼ŒObjective-C å’Œ C++)ã€‚æˆ‘ä»¬åŒæ—¶å®£å¸ƒå°†ä¼šæŠŠè¿™ä¸ªå¼•æ“çš„æ ¸å¿ƒä»£ç å¼€æºå‡ºæ¥ï¼ŒåŒ…æ‹¬ Xcode ç¼–è¯‘æ—¶æ‰ä¼šç´¢å¼•çš„æ–°åŠŸèƒ½ã€‚ </p>
<p>å¤§æ¦‚ä¼šåœ¨æ¥ä¸‹æ¥çš„å‡ ä¸ªæ˜ŸæœŸé‡Œ, æˆ‘ä»¬å°†ä¼šåˆ†é˜¶æ®µæŠŠè¿™äº›ä»£ç å‘å¸ƒå‡ºæ¥ï¼š </p>
<ul>
<li><p>å…³äº Swift çš„é‡æ„åŠŸèƒ½ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åšä¸€äº›æ”¶å°¾å·¥ä½œï¼Œä¾‹å¦‚æ–‡æ¡£çš„ç¼–å†™ï¼Œæˆ‘ä»¬æƒ³åœ¨å‘å¸ƒä¹‹å‰å®Œæˆã€‚ Argyrios Kyrtzidis å’Œä»–çš„å›¢é˜Ÿè´Ÿè´£å¤„ç†è¿™ä¸ªè®¡åˆ’ã€‚  </p>
</li>
<li><p>å…³äº C/C++/Objective-C çš„é‡æ„åŠŸèƒ½ï¼Œæˆ‘ä»¬æƒ³å’Œ LLVM ç¤¾åŒºä¸€èµ·å®Œæˆç„¶åå¹¶å…¥ LLVMã€‚ç¬¬ä¸€é˜¶æ®µåº”è¯¥ä¼šåœ¨ swift-clang çš„ repo é‡Œå®Œæˆï¼Œä½†æ˜¯ä»–ä»¬æƒ³åšçš„ä¸åªæ˜¯è¿™äº›ã€‚Duncan Exon Smith å’Œä»–çš„å›¢é˜Ÿè´Ÿè´£è¿™ä¸ªè®¡åˆ’ã€‚  </p>
</li>
<li><p>æˆ‘ä»¬ä¹Ÿä¼šå¼€æºç¼–è¯‘å™¨å¯¹äºç¼–è¯‘æ—¶ç´¢å¼•çš„æ”¯æŒï¼ŒåŒ…æ‹¬äº† Clang å’Œ Swiftã€‚Argyrios å’Œä»–çš„å›¢é˜Ÿè´Ÿè´£æ¨è¿›è¿™ä»¶äº‹ã€‚å…³äº Clang çš„æ”¹å˜ä»–ä»¬åº”è¯¥ä¼šåœ¨ä¹Ÿä¼šåœ¨ swift-clang ä¸Šå®Œæˆï¼Œç„¶åè·Ÿ LLVM ç¤¾åŒºè®¨è®ºå¦‚ä½•å°†ä»–ä»¬å¹¶å…¥ Clang é‡Œã€‚  </p>
</li>
<li><p>æœ€åï¼Œæˆ‘ä»¬å°†ä¼šæŠŠ Swift è¿ç§»å·¥å…·å‰©ä½™çš„éƒ¨åˆ†å¼€æºå‡ºæ¥ã€‚Argyrios å’Œä»–çš„å›¢é˜Ÿè´Ÿè´£æ¨è¿›è¿™ä»¶äº‹æƒ…ï¼Œè¿™äº›ä¿®æ”¹åªä¼šåœ¨ Swift ä»“åº“é‡Œå®Œæˆã€‚  </p>
</li>
</ul>
<p>å’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®Œæˆ Swift ä¸ Apple æœ€æ–°çš„ SDK çš„æ¡¥æ¥å·¥ä½œã€‚å¸Œæœ›å¯ä»¥åœ¨ä¸‹å‘¨ä¹‹å‰å®Œæˆï¼Œä¹‹åæˆ‘ä»¬å°±ä¼šæš‚æ—¶å…³é—­ä»“åº“çš„ commit æƒé™ã€‚ç›¸å…³çš„ç»†èŠ‚ä¹‹åä¼šé€šè¿‡é‚®ä»¶å…¬å¸ƒã€‚åœ¨æ­¤ä¹‹å‰ï¼Œ Swift.org çš„å¯ä¸‹è½½çš„å·¥å…·é“¾éƒ½å¯ä»¥è·Ÿ Xcode 8.3.2 äº¤äº’ã€‚åœ¨è¿™ä¹‹å, æˆ‘ä»¬å¯ä¸‹è½½çš„å·¥å…·é“¾å°±ä¸»è¦ä¼šé¢å‘ Xcode 9 betaã€‚è¿™ä»¶äº‹æƒ…å¾ˆå¿…è¦ï¼Œå› ä¸ºä¹‹åæœ€ä¸Šå±‚çš„ API ä¼šä¾èµ–äºæœ€æ–°çš„ SDKã€‚  </p>
</blockquote>
<p>Rick Ballard å‘äº†ä¸€ä¸ªå…³äº Swift 4 åŒ…ç®¡ç†å™¨çš„<a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170605/037002.html" target="_blank" rel="external">å…¬å‘Š</a>:</p>
<blockquote>
<p>Hello, Swift Pacakage Manager çš„ç¤¾åŒºã€‚  </p>
<p>æˆ‘æƒ³è¦æ±‡æŠ¥ä¸€ä¸‹ Swift 4 é‡Œ SwiftPM çš„å¼€å‘è¿›åº¦ã€‚æˆ‘ä»¬å·²ç»åœ¨è¿™ä¸ªæ˜¥å­£å®ç°äº†ä¸€ç³»åˆ—çš„ evolution ææ¡ˆï¼š </p>
<ul>
<li><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0152-package-manager-tools-version.md" target="_blank" rel="external">SE-0152</a> [â€¦]  </li>
<li><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0158-package-manager-manifest-api-redesign.md" target="_blank" rel="external">SE-0158</a> [â€¦]  </li>
<li><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0151-package-manager-swift-language-compatibility-version.md" target="_blank" rel="external">SE-0151</a> [â€¦]  </li>
<li><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0146-package-manager-product-definitions.md" target="_blank" rel="external">SE-0146</a> [â€¦]  </li>
<li><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0175-package-manager-revised-dependency-resolution.md" target="_blank" rel="external">SE-0175</a> [â€¦]  </li>
<li><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0150-package-manager-branch-support.md" target="_blank" rel="external">SE-0150</a> [â€¦]  </li>
<li><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0162-package-manager-custom-target-layouts.md" target="_blank" rel="external">SE-0162</a> [â€¦]  </li>
<li><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0149-package-manager-top-of-tree.md" target="_blank" rel="external">SE-0149</a> [â€¦]  </li>
</ul>
<p>é™¤äº†è¿™äº›ææ¡ˆï¼Œæˆ‘ä»¬è¿˜å®ç°äº†ä¸€äº›é‡å¤§çš„æ”¹è¿›ï¼š </p>
<ul>
<li><p>åœ¨ macOS ä¸Šï¼ŒåŒ…çš„äº¤äº’å’ŒåŒ…çš„ç¼–è¯‘ç°åœ¨éƒ½æ²™ç›’åŒ–äº†ï¼Œèƒ½å¤Ÿå‡è½»æ¶æ„è½¯ä»¶å¸¦æ¥çš„æŸè€—ã€‚ </p>
</li>
<li><p>è®¸å¤šé”™è¯¯ä¿¡æ¯å’Œè¯Šæ–­éƒ½åŠ å¼ºäº†ï¼ŒåŒ…æ‹¬ä¾èµ–ç®¡ç†æ—¶å‡ºç°çš„å†²çªã€‚</p>
</li>
<li><p>Xcode å·¥ç¨‹æ–‡ä»¶ç”Ÿæˆå™¨ä¹Ÿæ”¹è¿›äº†ï¼Œç°åœ¨å…è®¸åœ¨é‡æ–°ç”Ÿæˆå·¥ç¨‹æ–‡ä»¶æ—¶è®© scheme å¼•ç”¨åŒ…é‡Œçš„ targetã€‚  </p>
</li>
<li><p>å¹¶ä¸”åšäº†å¤§é‡çš„å°æ”¹è¿›å’Œ bug ä¿®å¤ã€‚  </p>
</li>
</ul>
<p>Xcode 9 åœ¨æ–°çš„ç¼–è¯‘ç³»ç»Ÿé‡Œä¸º Swift åŒ…ç®¡ç†æä¾›äº†åŸç”Ÿçš„æ”¯æŒã€‚è¿™ä¸ªç¼–è¯‘ç³»ç»Ÿæä¾›äº†çµæ´»æ€§å’Œæ‹“å±•æ€§ï¼Œè®© Xcode å¯ä»¥æ”¯æŒæ–°çš„ç¼–è¯‘æ¨¡å‹ï¼Œä¾‹å¦‚ Swift åŒ…ç®¡ç†ã€‚æ­¤å¤–, SwiftPM ä¸º SwiftPM çš„åº“åšäº†å¤§é‡çš„å·¥ä½œï¼Œè®© Swift åŒ…ç®¡ç†çš„å·¥å…·å¯ä»¥è½»æ¾åµŒå…¥è¯¸å¦‚ Xcode çš„è½¯ä»¶é‡Œã€‚</p>
<p>é‚£ SwiftPM 4 è¿˜æœ‰ä»€ä¹ˆï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬å°†ä¼šå®ç° <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0179-swift-run-command.md" target="_blank" rel="external">SE-0179</a>ï¼Œæ”¯æŒ <code>swift package run</code> å‘½ä»¤ã€‚å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›å¼€å§‹æ”¾ä¸‹ç°åœ¨çš„ç‰ˆæœ¬ï¼Œç„¶åå¼€å§‹è®¡åˆ’åé¢ï¼Œè™½ç„¶æˆ‘ä»¬è¿˜æ˜¯åœ¨æ¥æ”¶å»ºè®®å’Œ evolution çš„ææ¡ˆ   </p>
<p>[â€¦]  </p>
<p>å…¶å®ƒåŠŸèƒ½æˆ‘ä»¬åº”è¯¥ä¼šè€ƒè™‘åœ¨ä¸‹ä¸ªç‰ˆæœ¬è¿›è¡Œæ”¯æŒï¼Œä¾‹å¦‚åŒ…èµ„æº(ä¾‹å¦‚å›¾ç‰‡)ï¼Œè®¸å¯è¯å’Œå…ƒæ•°æ®æ”¯æŒï¼Œç”¨äºå¤„ç†æºä»£ç æ§åˆ¶åˆ†æ”¯çš„æ˜¾å¼æ”¯æŒï¼Œä»¥åŠä¸€ä¸ªæ³›ç”¨çš„æœºåˆ¶å»å¤„ç†ç¼–è¯‘å·¥å…·ä¸æ”¯æŒåŒ…ç®¡ç†çš„æƒ…å†µã€‚æœ€å, æˆ‘ä»¬ç¡®å®è€ƒè™‘äº†ä¹‹åå»ºç«‹ä¸€ä¸ªä¸­å¿ƒåŒ–çš„åŒ…ç´¢å¼•æœºåˆ¶ï¼Œæˆ‘ä»¬ä¹Ÿè®¸ä¼šåœ¨æ¥ä¸‹æ¥ä¸€å¹´ä¸ºè¿™ä»¶äº‹æƒ…åšä¸€äº›åŸºç¡€å·¥ä½œã€‚ </p>
<p><a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170605/037002.html" target="_blank" rel="external">æŸ¥çœ‹åŸæ–‡â€¦</a>  </p>
</blockquote>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>æœ€å â€“ <a href="https://twitter.com/NeoNacho/status/871143591258734594" target="_blank" rel="external">self storage</a></p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šJesse Squiresï¼Œ&lt;a href=&quot;https://swiftweekly.github.io/issue-73/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-06-09&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://kemchenj.github.io&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;å››å¨˜&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://chengway.in/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;walkingway&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;è¿™å‘¨çš„äº‹æƒ…å¾ˆå¤šï¼ä»Šå¤©æ˜¯ &lt;a href=&quot;https://developer.apple.com/videos/wwdc2017/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;WWDC 2017&lt;/a&gt; çš„æœ€åä¸€å¤©ï¼ŒSwift 4 éšç€ &lt;a href=&quot;https://developer.apple.com/xcode/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Xcode 9&lt;/a&gt;ï¼Œä¸€èµ·æ”¾å‡ºäº†å¼€å‘è€…å…¬æµ‹ç‰ˆã€‚Xcode å’Œ Swift éƒ½æœ‰å¥½å‡ ä¸ªé‡å¤§çš„æ”¹è¿›å’Œæ–°çš„åŠŸèƒ½ â€” è¿™ä¸ªç‰ˆæœ¬çœŸçš„å¾ˆæ£’ã€‚æ•´ä¸ª&lt;a href=&quot;https://twitter.com/ericasadun/status/871819962888802304&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ç¤¾åŒº&lt;/a&gt;çš„&lt;a href=&quot;https://twitter.com/SmileyKeith/status/871852588844556288&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åå“&lt;/a&gt;&lt;a href=&quot;https://twitter.com/fpillet/status/871987276187828224&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;éƒ½&lt;/a&gt;&lt;a href=&quot;https://twitter.com/chriseidhof/status/873066951739703296&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;å¾ˆ&lt;/a&gt;&lt;a href=&quot;https://twitter.com/tonyarnold/status/873017116298846208&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;æ­£&lt;/a&gt;&lt;a href=&quot;https://twitter.com/ayanonagon/status/871850052498489344&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;é¢&lt;/a&gt;ã€‚æ­å–œ Apple çš„ Xcode, Swift å’Œå¼€å‘å·¥å…·ç»„ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="Jesse Squires" scheme="https://swift.gg/categories/Jesse-Squires/"/>
    
    
      <category term="Swift å‘¨æŠ¥" scheme="https://swift.gg/tags/Swift-%E5%91%A8%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>Table View ä¸­å¼€å¯æ–‡æœ¬èœå•åŠŸèƒ½</title>
    <link href="https://swift.gg/2017/06/09/use-context-menu-with-table-view-tutorial-ios10/"/>
    <id>https://swift.gg/2017/06/09/use-context-menu-with-table-view-tutorial-ios10/</id>
    <published>2017-06-08T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šArthur Knopperï¼Œ<a href="https://www.ioscreator.com/tutorials/use-context-menu-with-table-view-tutorial-ios10" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-01-09</p>
<h2 id="è¯‘è€…ï¼šCrystal-Sunï¼›æ ¡å¯¹ï¼šwalkingwayï¼›å®šç¨¿ï¼šCMB"><a href="#è¯‘è€…ï¼šCrystal-Sunï¼›æ ¡å¯¹ï¼šwalkingwayï¼›å®šç¨¿ï¼šCMB" class="headerlink" title="è¯‘è€…ï¼šCrystal Sunï¼›æ ¡å¯¹ï¼šwalkingwayï¼›å®šç¨¿ï¼šCMB"></a>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›æ ¡å¯¹ï¼š<a href="http://chengway.in/" target="_blank" rel="external">walkingway</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></h2></blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>é•¿æŒ‰æ‰€é€‰çš„å¯¹è±¡åï¼Œå¼¹å‡ºæ–‡æœ¬èœå•ï¼ˆContext Menuï¼‰ï¼Œå…è®¸ç”¨æˆ·è¿›è¡Œå‰ªåˆ‡ã€å¤åˆ¶ã€ç²˜è´´æ“ä½œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡æœ¬èœå•åŠŸèƒ½åœ¨ Table View ä¸­æ˜¯å…³é—­çŠ¶æ€ã€‚åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œå°†å­¦ä¹ å¦‚ä½•åœ¨ Table View Cell ä¸­å¼€å¯æ–‡æœ¬èœå•åŠŸèƒ½ï¼Œå°†æ‰€é€‰çš„æ–‡æœ¬å¤åˆ¶åˆ° Text Filedï¼ˆæ–‡æœ¬è¾“å…¥æ¡†ï¼‰ä¸­ã€‚æœ¬èŠ‚æ•™ç¨‹ä½¿ç”¨çš„æ˜¯ Xcode 8.1 å’Œ iOS 10ã€‚</p>
<a id="more"></a>
<h3 id="è®¾ç½®å·¥ç¨‹"><a href="#è®¾ç½®å·¥ç¨‹" class="headerlink" title="è®¾ç½®å·¥ç¨‹"></a>è®¾ç½®å·¥ç¨‹</h3><p>æ‰“å¼€ Xcodeï¼Œåˆ›å»ºä¸€ä¸ª Single View Applicationã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/58ff88928419c2b2a27d0754/1493141675229/single-view-xcode-template?format=1500w" alt=""></p>
<p>ç‚¹å‡» Nextã€‚Product Name ä½¿ç”¨ <strong>IOS10ContextMenuTableViewTutorial</strong>ï¼Œå¡«å†™è‡ªå·±çš„ Organization Name å’Œ Organization Identifierï¼ŒLanguage ä¸€æ é€‰æ‹© Swiftï¼ŒDevices ä¸€æ é€‰æ‹© iPhoneã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/587284518419c2902d0b4038/1483899997903/?format=1500w" alt=""></p>
<p>æ‰“å¼€ <strong>Main.storyboard</strong> æ–‡ä»¶ï¼Œä» Object Library ä¸­æ‹–æ‹½ä¸€ä¸ª Table View åˆ°ä¸»ç•Œé¢ï¼Œç„¶åé€‰ä¸­ Table Viewï¼Œæ‰¾åˆ° Attribute Inspectorï¼Œåœ¨ Table View éƒ¨åˆ†ï¼Œå°† Prototype Cells çš„å€¼æ”¹ä¸º1ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/58728478414fb539f1673cc0/1483900034219/?format=500w" alt=""></p>
<p>é€‰ä¸­ Table View Cellï¼Œæ‰¾åˆ° Attribute Inspector ï¼Œåœ¨ Table View Cell åŒºåŸŸï¼Œå°† Indentifier çš„å€¼è®¾ç½®ä¸º â€œcellâ€ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/58728493bf629afa514967a5/1483900060894/?format=750w" alt=""></p>
<p>é€‰ä¸­ Table Viewï¼Œç‚¹å‡»å³ä¸‹è§’çš„ Pin æŒ‰é’®ï¼Œç‚¹å‡»ä¸Šæ–¹ã€å·¦ã€å³ä¸‰æ¡çº¿ï¼Œé€‰æ‹© Heightï¼Œè®¾ç½®æˆå›ºå®šé«˜åº¦ã€‚åœ¨ Update Frames çš„ä¸‹æ‹‰èœå•ä¸­é€‰æ‹© Items of New Contraintsï¼Œæ¥ä¸‹æ¥ç‚¹å‡» â€œAdd 4 Constraintsâ€ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/587284b5725e2549f7b0a58c/1483900094417/?format=750w" alt=""></p>
<p>ä» Object Library ä¸­æ‹–æ‹½ä¸€ä¸ª Text Field æ§ä»¶ï¼Œæ”¾åˆ° Table View çš„ä¸‹æ–¹ã€‚æŒ‰ä½ Control é”®ï¼Œå°†å…¶æ‹–æ‹½åˆ° Table View ä¸Šï¼Œæ¾å¼€ Control é”®ï¼Œé€‰æ‹© â€œVertical Spacingâ€ å’Œ â€œCenter Horizontallyâ€ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/587285ead1758edd735361d8/1483900403738/Autolayout-Pinleftandright.png?format=500w" alt=""></p>
<p>é€‰ä¸­ Text Fieldï¼Œç‚¹å‡»å³ä¸‹è§’çš„ Pin æŒ‰é’®ï¼Œé€‰ä¸­å·¦ã€å³ä¸¤æ¡çº¿ã€‚å¦‚ä¸‹å›¾æ·»åŠ çº¦æŸã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/587286031e5b6c9fdaadb7b3/1483900432899/?format=750w" alt=""></p>
<p>View Controller éœ€è¦æˆä¸º Table View çš„ä»£ç†ï¼ˆdelegateï¼‰ã€‚é€‰ä¸­ TableViewï¼ŒæŒ‰ä½ Control é”®ï¼Œå°†å…¶æ‹–æ‹½åˆ° View Controller é¡¶éƒ¨çš„é»„è‰²å›¾æ ‡ä¸Šï¼Œç‚¹å‡» dataSourceï¼Œé‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç‚¹å‡» delegateã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/58728664bebafb08e6a84d26/1483900526787/?format=300w" alt=""></p>
<p>å¯¹ Text Field æ§ä»¶ä¹Ÿé‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œä½¿ View Controller æˆä¸º Text Field çš„ä»£ç†ï¼ˆdelegateï¼‰ã€‚ç„¶åæ‰“å¼€ <strong>ViewController.swift</strong> æ–‡ä»¶ï¼Œå°†ç±»çš„å£°æ˜æ”¹æˆå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span>, <span class="title">UITableViewDelegate</span>, <span class="title">UITableViewDataSource</span>, <span class="title">UITextFieldDelegate</span> </span>&#123;</div></pre></td></tr></table></figure>
<p>æ¥ç€æ·»åŠ ä¸‹åˆ—å±æ€§ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> pasteBoard = <span class="type">UIPasteboard</span>.generalPasteboard()</div><div class="line"><span class="keyword">var</span> tableData: [<span class="type">String</span>] = [<span class="string">"dog"</span>,<span class="string">"cat"</span>,<span class="string">"fish"</span>]</div></pre></td></tr></table></figure>
<p>pasteBoard å±æ€§å°†ç”¨äºå¤åˆ¶ç²˜è´´æ“ä½œï¼ŒtableData å­˜å‚¨å±•ç¤ºåœ¨ Table View Cell ä¸Šçš„æ•°æ®ã€‚æ¥ä¸‹æ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºä¿®æ”¹ Table View çš„ delegate æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">numberOfSections</span><span class="params">(<span class="keyword">in</span> tableView: UITableView)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span></div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    <span class="keyword">return</span> tableData.<span class="built_in">count</span></div><div class="line">&#125;</div><div class="line">    </div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span> &#123;</div><div class="line">    <span class="keyword">let</span> cell = tableView.dequeueReusableCell(withIdentifier: <span class="string">"cell"</span>, <span class="keyword">for</span>: indexPath)</div><div class="line">        </div><div class="line">    cell.textLabel?.text = tableData[indexPath.row]</div><div class="line">        </div><div class="line">    <span class="keyword">return</span> cell</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Table View ç°åœ¨ä¼šå±•ç¤º tableData æ•°ç»„ä¸­çš„å€¼ï¼Œæƒ³è¦å¼€å¯æ–‡æœ¬èœå•åŠŸèƒ½ï¼Œéœ€è¦å®ç°ä»¥ä¸‹ä¸‰ä¸ª delegate æ–¹æ³•ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, shouldShowMenuForRowAt indexPath: IndexPath)</span></span> -&gt; <span class="type">Bool</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, canPerformAction action: Selector, forRowAt indexPath: IndexPath, withSender sender: Any?)</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">    <span class="keyword">if</span> (action == #selector(<span class="type">UIResponderStandardEditActions</span>.copy(<span class="number">_</span>:))) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, performAction action: Selector, forRowAt indexPath: IndexPath, withSender sender: Any?)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> cell = tableView.cellForRow(at: indexPath)</div><div class="line">    pasteBoard.string = cell!.textLabel?.text</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>tableView:shouldShowMenuForRowAt</strong> æ–¹æ³•å¿…é¡»è¿”å› trueï¼Œæ‰èƒ½é•¿æŒ‰æ˜¾ç¤ºæ–‡æœ¬èœå•ã€‚<strong>tableView:canPerformAction:forRowAt</strong> æ–¹æ³•ï¼Œè®©æ–‡æœ¬èœå•åªæ˜¾ç¤º copyï¼ˆå¤åˆ¶ï¼‰ä¸€ä¸ªé€‰é¡¹ã€‚<strong>tableView:performAction:forRowAt:withSender</strong> æ–¹æ³•å°†é€‰ä¸­çš„æ–‡æœ¬å¤åˆ¶åˆ° pasteBoard å˜é‡ä¸­ã€‚</p>
<p>æœ€åï¼Œé€šè¿‡ <strong>textFieldShouldReturn</strong> æ–¹æ³•ï¼Œåœ¨ç‚¹å‡» Text Field åè®©é”®ç›˜æ¶ˆå¤±ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">textFieldShouldReturn</span><span class="params">(<span class="number">_</span> textField: UITextField)</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">    <span class="keyword">self</span>.view.endEditing(<span class="literal">true</span>)</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>è¿è¡Œ</strong>å·¥ç¨‹ï¼Œé•¿æŒ‰ä¸€è¡Œ Table View Cellï¼Œç„¶åé€‰æ‹© copyï¼ˆå¤åˆ¶ï¼‰ é€‰é¡¹ï¼Œç²˜è´´åˆ° Text Fieldï¼ˆæ–‡æœ¬æ¡†ï¼‰é‡Œã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/58728d2c1b631b6a2299ad67/1483902262012/?format=750w" alt=""></p>
<p>å¯ä»¥ä» <a href="https://github.com/ioscreator/ioscreator" target="_blank" rel="external">github</a> ä¸Šä¸‹è½½ <strong>IOS10ContextMenuTableViewTutorial</strong> æ•™ç¨‹çš„æºä»£ç ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šArthur Knopperï¼Œ&lt;a href=&quot;https://www.ioscreator.com/tutorials/use-context-menu-with-table-view-tutorial-ios10&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-01-09&lt;/p&gt;
&lt;h2 id=&quot;è¯‘è€…ï¼šCrystal-Sunï¼›æ ¡å¯¹ï¼šwalkingwayï¼›å®šç¨¿ï¼šCMB&quot;&gt;&lt;a href=&quot;#è¯‘è€…ï¼šCrystal-Sunï¼›æ ¡å¯¹ï¼šwalkingwayï¼›å®šç¨¿ï¼šCMB&quot; class=&quot;headerlink&quot; title=&quot;è¯‘è€…ï¼šCrystal Sunï¼›æ ¡å¯¹ï¼šwalkingwayï¼›å®šç¨¿ï¼šCMB&quot;&gt;&lt;/a&gt;è¯‘è€…ï¼š&lt;a href=&quot;http://www.jianshu.com/users/7a2d2cc38444/latest_articles&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Crystal Sun&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://chengway.in/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;walkingway&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/h2&gt;&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;é•¿æŒ‰æ‰€é€‰çš„å¯¹è±¡åï¼Œå¼¹å‡ºæ–‡æœ¬èœå•ï¼ˆContext Menuï¼‰ï¼Œå…è®¸ç”¨æˆ·è¿›è¡Œå‰ªåˆ‡ã€å¤åˆ¶ã€ç²˜è´´æ“ä½œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡æœ¬èœå•åŠŸèƒ½åœ¨ Table View ä¸­æ˜¯å…³é—­çŠ¶æ€ã€‚åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œå°†å­¦ä¹ å¦‚ä½•åœ¨ Table View Cell ä¸­å¼€å¯æ–‡æœ¬èœå•åŠŸèƒ½ï¼Œå°†æ‰€é€‰çš„æ–‡æœ¬å¤åˆ¶åˆ° Text Filedï¼ˆæ–‡æœ¬è¾“å…¥æ¡†ï¼‰ä¸­ã€‚æœ¬èŠ‚æ•™ç¨‹ä½¿ç”¨çš„æ˜¯ Xcode 8.1 å’Œ iOS 10ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="IOSCREATOR" scheme="https://swift.gg/categories/IOSCREATOR/"/>
    
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/tags/iOS-%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>æŠŠä»£ç è¿ç§»åˆ°åè°ƒå™¨ä¸Š</title>
    <link href="https://swift.gg/2017/06/09/migrating-to-coordinators/"/>
    <id>https://swift.gg/2017/06/09/migrating-to-coordinators/</id>
    <published>2017-06-08T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šSoroush Khanlouï¼Œ<a href="http://khanlou.com/2017/04/migrating-to-coordinators/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-4-25<br>è¯‘è€…ï¼š<a href="http://weibo.com/277195544" target="_blank" rel="external">Cwift</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>è¿™ç¯‡æ–‡ç« æ˜¯ <a href="http://khanlou.com/tag/advanced-coordinators/" target="_blank" rel="external">Coordinatorsï¼ˆåè°ƒå™¨ï¼‰è¿›é˜¶æ•™ç¨‹ç³»åˆ—</a>çš„ç¬¬ä¸€ç¯‡ã€‚å¦‚æœä½ æ²¡æœ‰é˜…è¯»è¿‡<a href="http://khanlou.com/2015/01/the-coordinator/" target="_blank" rel="external">åŸå§‹çš„å¸–å­</a>åŠå…¶<a href="http://khanlou.com/2015/10/coordinators-redux/" target="_blank" rel="external">åç»­</a>ï¼Œè¯·åŠ¡å¿…é¦–å…ˆæŸ¥é˜…è¿™äº›æ–‡ç« ã€‚è¯¥ç³»åˆ—å°†æ¶µç›–å‡ é¡¹è¿›é˜¶çš„ Coordinator ä½¿ç”¨æŠ€å·§ã€ç–‘ç‚¹ã€å¸¸è§é—®é¢˜ä»¥åŠå…¶ä»–ç»†ç¢çš„å†…å®¹ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ã€‚</p>
<a id="more"></a>
<p>å¸¸æœ‰äººé—®æˆ‘ï¼Œå¦‚ä½•æŠŠä¸€ä¸ªä½¿ç”¨ Storyboard æ„å»ºæˆ–è€…æ˜¯ä½¿ç”¨çº¯ä»£ç ç¼–å†™ ViewController æ„å»ºçš„åº”ç”¨é‡æ„æˆä½¿ç”¨ Coordinators çš„åº”ç”¨ã€‚åªè¦æ–¹æ³•æ­£ç¡®ï¼Œé‡æ„å¯ä»¥é€æ­¥å®Œæˆã€‚å³ä½¿é‡æ„æœªå®Œæˆï¼Œä½ çš„åº”ç”¨ä»æ—§å¯ä»¥éƒ¨ç½²ã€‚</p>
<p>è¦å®ç°è¿™ä¸ªç›®æ ‡ï¼Œæœ€å¥½çš„åšæ³•æ˜¯ä»æ ¹è·¯å¾„å‡ºå‘ï¼Œåœ¨ Coordinators ä¸­ç§°ä¹‹ä¸º â€œAppCoordinatorâ€ã€‚AppDelegate æŒæœ‰è¯¥ AppCoordinatorï¼ŒAppCoordinator è°ƒåº¦ App å¯ä»¥åŠ è½½çš„æ‰€æœ‰ ViewControllerã€‚</p>
<p>æƒ³è¦ç†è§£ä¸ºä»€ä¹ˆä» App çš„æ ¹è·¯å¾„å¼€å§‹ï¼Œå¯ä»¥ä»åé¢æ¥æ€è€ƒã€‚å¦‚æœä»ä¸€äº›å¶å­æµç¨‹å¼€å§‹ï¼ˆæ¯”å¦‚ï¼Œä¸€ä¸ª <code>CheckoutCoordinator</code>ï¼‰ï¼Œé‚£ä¹ˆéœ€è¦ä¿æŒå¯¹è¯¥ Coordinator çš„å¼ºå¼•ç”¨ï¼Œä»¥é˜²å®ƒè¢«é‡Šæ”¾ã€‚å¦‚æœ Coordinator è¢«é‡Šæ”¾ï¼Œå®ƒå†…éƒ¨çš„ä»£ç å°±éƒ½ä¸èƒ½æ‰§è¡Œäº†ã€‚æ‰€ä»¥ï¼Œæ·±å…¥ä¸€ä¸ª App ä¸­å»ï¼Œå¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Coordinatorï¼Œå¿…é¡»è®©æŸä¸ªå¯¹è±¡é•¿ä¹…åœ°æŒæœ‰å®ƒã€‚</p>
<p>æœ‰ä¸¤ç§æ–¹æ¡ˆå¯ä»¥é˜²æ­¢å¯¹è±¡è¢«é‡Šæ”¾ã€‚ç¬¬ä¸€ç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨é™æ€å¼•ç”¨ã€‚å› ä¸ºç³»ç»Ÿé‡Œå¯èƒ½åªæœ‰ä¸€ä¸ª <code>CheckoutCoordinator</code>ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å°†å…¶å¡«å……åˆ°ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ã€‚è™½ç„¶è¿™ç§æ–¹æ¡ˆæœ‰æ•ˆæœï¼Œä½†æ˜¯ä¸æ˜¯ä¸€ä¸ªç†æƒ³çš„é€‰æ‹©ï¼Œå› ä¸ºå…¨å±€å˜é‡é˜»ç¢äº†å¯æµ‹è¯•æ€§å’Œçµæ´»æ€§ã€‚ç¬¬äºŒç§æ–¹æ¡ˆæ˜¯è®©å½“å‰å±•ç¤ºçš„ ViewController æŒæœ‰ Coordinatorã€‚è¿™å°†è¿«ä½¿å½“å‰çš„ ViewController å˜å¾—å¤æ‚ä¸€äº›ï¼Œä½†æ˜¯å¯ä»¥é™ä½ Coordinator æ‰€ç®¡ç†çš„æ‰€æœ‰ ViewController çš„å¤æ‚æ€§ã€‚ç„¶è€Œï¼Œè¿™ç§å…³ç³»æœ¬è´¨ä¸Šæ˜¯æœ‰ç¼ºé™·çš„ã€‚ViewController æ˜¯ Coordinator çš„â€œå­©å­â€ï¼Œç¼–ç¨‹æ—¶ï¼Œå­©å­ä»¬ä¸åº”è¯¥ä¸çŸ¥é“ä»–ä»¬çš„çˆ¶æ¯æ˜¯è°ã€‚ç±»ä¼¼äºä¸€ä¸ª <code>UIView</code> æŒæœ‰äº†ä¸€ä¸ª <code>UIViewController</code> çš„å¼•ç”¨ï¼šè¿™ç§äº‹æ˜¯ä¸è¯¥å‘ç”Ÿçš„ã€‚</p>
<p>å¦‚æœä½ é‡åˆ°äº†å¿…é¡»ä»å­æµç¨‹å¼€å§‹çš„æƒ…å†µï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸Šè¿°ä¸¤ç§æ–¹æ³•ä¹‹ä¸€ã€‚ä½†æ˜¯ï¼Œå¦‚æœå¯ä»¥é€‰æ‹©ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä»æ ¹è·¯å¾„å¼€å§‹ã€‚</p>
<p>ä»æ ¹è·¯å¾„å¼€å§‹çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯è®¤è¯æµç¨‹é€šå¸¸æ›´é è¿‘ App çš„æ ¹è·¯å¾„ã€‚èº«ä»½è®¤è¯æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æµç¨‹ï¼Œå¯ä»¥æŠ½è±¡æˆå•ç‹¬çš„å¯¹è±¡ï¼Œå¾ˆé€‚åˆç”¨æ¥éªŒè¯ App ä¸­çš„ Coordinatorã€‚</p>
<p>å°† App çš„ RootViewController äº¤ä»˜ç»™ <code>AppCoordinator</code> ä¹‹åï¼Œä½ å¯ä»¥å¯¹ä»£ç è¿›è¡Œ Commit/Pull Request/Code Reviewã€‚å› ä¸ºå…¶ä»–çš„ ViewController ä»åœ¨æ­£å¸¸è¿è½¬ï¼Œæ‰€ä»¥ App å¯ä»¥åœ¨è¿™ä¸ªæœªå®Œå·¥çš„çŠ¶æ€ä¸‹ç»§ç»­å·¥ä½œã€‚åŸºäºè¿™ç‚¹ï¼Œé€æ­¥æ”¹é€ ï¼Œä½ å¯ä»¥å°†æ›´å¤šçš„ ViewController äº¤ä»˜ç»™ Coordinatorã€‚å°†æ¯ä¸ªâ€œæµç¨‹â€éƒ½äº¤ä»˜ç»™ Coordinator ä¹‹åï¼Œä½ å¯ä»¥æäº¤ä»£ç æˆ–è€…åˆ›å»ºä¸€ä¸ª prï¼Œä¸ä¼šå½±å“ App çš„æ­£å¸¸å·¥ä½œã€‚æ­£å¦‚æœ€ä½³é‡æ„ä¸€æ ·ï¼Œè¿™äº›æ­¥éª¤åªæ˜¯ç§»åŠ¨ä»£ç ï¼Œæœ‰æ—¶æ ¹æ®éœ€è¦åˆ›å»ºæ–°çš„ Coordinatorã€‚</p>
<p>ä¸€æ—¦æ‰€æœ‰çš„åœºæ™¯åˆ‡æ¢éƒ½è½¬ç§»åˆ°äº† Coordinator ä¸­ï¼Œä½ å°±å¯ä»¥å¼€å§‹ä¸‹ä¸€æ­¥çš„é‡æ„äº†ï¼Œä¾‹å¦‚å°† iPhone å’Œ iPad çš„ Coordinator å°è£…åˆ°å•ç‹¬çš„å¯¹è±¡ï¼ˆè€Œä¸æ˜¯ä¸€ä¸ªåˆ‡æ¢çŠ¶æ€çš„ Coordinatorï¼‰ï¼Œè®©å­æµç¨‹å¯å¤ç”¨ï¼Œæ›´å¥½åœ°ä¾èµ–æ³¨å…¥ï¼Œè¿™äº›éƒ½å¯ä»¥åº”ç”¨åˆ°ä½ çš„æ–°æ¶æ„ä¸­ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šSoroush Khanlouï¼Œ&lt;a href=&quot;http://khanlou.com/2017/04/migrating-to-coordinators/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-4-25&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;http://weibo.com/277195544&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cwift&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://www.jianshu.com/users/7a2d2cc38444/latest_articles&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Crystal Sun&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« æ˜¯ &lt;a href=&quot;http://khanlou.com/tag/advanced-coordinators/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Coordinatorsï¼ˆåè°ƒå™¨ï¼‰è¿›é˜¶æ•™ç¨‹ç³»åˆ—&lt;/a&gt;çš„ç¬¬ä¸€ç¯‡ã€‚å¦‚æœä½ æ²¡æœ‰é˜…è¯»è¿‡&lt;a href=&quot;http://khanlou.com/2015/01/the-coordinator/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸå§‹çš„å¸–å­&lt;/a&gt;åŠå…¶&lt;a href=&quot;http://khanlou.com/2015/10/coordinators-redux/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åç»­&lt;/a&gt;ï¼Œè¯·åŠ¡å¿…é¦–å…ˆæŸ¥é˜…è¿™äº›æ–‡ç« ã€‚è¯¥ç³»åˆ—å°†æ¶µç›–å‡ é¡¹è¿›é˜¶çš„ Coordinator ä½¿ç”¨æŠ€å·§ã€ç–‘ç‚¹ã€å¸¸è§é—®é¢˜ä»¥åŠå…¶ä»–ç»†ç¢çš„å†…å®¹ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="KHANLOU" scheme="https://swift.gg/categories/KHANLOU/"/>
    
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/tags/iOS-%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Swift ä¸­çš„å®‰å…¨æ€§</title>
    <link href="https://swift.gg/2017/06/06/safety-in-swift/"/>
    <id>https://swift.gg/2017/06/06/safety-in-swift/</id>
    <published>2017-06-05T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šSoroush Khanlouï¼Œ<a href="http://khanlou.com/2017/04/safety-in-swift/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-04-05<br>è¯‘è€…ï¼š<a href="undefined">Doye</a>ï¼›æ ¡å¯¹ï¼š<a href="http://chengway.in/" target="_blank" rel="external">walkingway</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>Swift æ˜¯ä¸€é—¨æ³¨é‡å®‰å…¨æ€§çš„è¯­è¨€ï¼Œå¦‚<a href="https://Swift.org/" target="_blank" rel="external">Swiftå®˜ç½‘</a>çš„<a href="https://Swift.org/about/" target="_blank" rel="external">å…³äºé¡µé¢</a>ä¸­æ‰€è¨€</p>
<blockquote>
<p>Swift æ˜¯ä¸€é—¨é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼Œé‡‡ç”¨ç°ä»£åŒ–çš„æ–¹æ³•æ¥ä¿è¯å®‰å…¨æ€§ä¸æ€§èƒ½ï¼Œå¥—ç”¨è½¯ä»¶è®¾è®¡æ¨¡å¼ã€‚</p>
</blockquote>
<a id="more"></a>
<p>è¿˜æœ‰å®ƒçš„è¯´æ˜</p>
<ul>
<li><p><strong>å®‰å…¨æ€§</strong>ï¼šé‚£äº›æ˜¾è€Œæ˜“è§è€Œåˆä¾¿æ·çš„ç¼–ç¨‹æ–¹æ³•åº”è¯¥ä¿è¯æ˜¯å®‰å…¨çš„ã€‚æœªå®šä¹‰çš„è¡Œä¸ºä¼šç ´åè½¯ä»¶çš„å®‰å…¨æ€§ã€‚åœ¨è½¯ä»¶å‘å¸ƒä¹‹å‰å°±è¦æŠŠå¼€å‘è€…çš„é”™è¯¯æ‰¼æ€åœ¨èŒèŠ½ä¹‹ä¸­ã€‚å¼ºè°ƒå®‰å…¨æ€§æœ‰æ—¶ä¼šè®©ä½ è§‰å¾— Swift è¯­æ³•è¿‡äºä¸¥è‹›ï¼Œä½†æ˜¯å®ƒå¸¦æ¥çš„ä»£ç çš„æ˜æ™°ä»é•¿è¿œæ¥çœ‹è¿˜æ˜¯åˆ©å¤§äºå¼Šçš„ã€‚</p>
</li>
<li><p><strong>é«˜æ€§èƒ½</strong>: Swiftæ—¨åœ¨æ›¿ä»£ C ç³»è¯­è¨€ï¼ˆCï¼ŒC ++å’ŒObjective-Cï¼‰ï¼Œå› æ­¤ Swift å¿…é¡»åœ¨ç»å¤§å¤šæ•°ä»»åŠ¡ä¸­ä¸è¿™äº›è¯­è¨€æœ‰ç€æ¥è¿‘çš„æ€§èƒ½æŒ‡æ•°ï¼Œè€Œä¸”æ€§èƒ½éœ€è¦å…·æœ‰å¯é¢„æµ‹æ€§ã€‚è€Œä¸”è¿™ç§æŒ‡æ•°éœ€è¦æ˜¯ä¸€ç§æ™®éçš„æ€§èƒ½æŒ‡æ•°ï¼Œè€Œä¸æ˜¯æ˜™èŠ±ä¸€ç°çš„ä»…ä»…å‡ ç§ä»»åŠ¡ç±»å‹çš„é«˜æ€§èƒ½ã€‚å…·æœ‰å„ç§ç‰¹æ€§çš„è¯­è¨€æœ‰å¾ˆå¤šï¼Œä½†ä»ä¿æŒç€å¦‚æ­¤é«˜æ€§èƒ½å´å®å±ç½•è§ã€‚</p>
</li>
<li><p><strong>è¡¨ç°åŠ›</strong>:  Swift å—ç›Šäºè®¡ç®—æœºç§‘å­¦çš„å‡ åå¹´å‘å±•ï¼Œæä¾›äº†å¼€å‘äººå‘˜æœŸæœ›çš„ç°ä»£åŠŸèƒ½å¹¶å…·æœ‰æœ‰è¶£çš„è¯­æ³•ã€‚è€Œä¸” Swift å¹¶ä¸æ­¢æ­¥äºæ­¤ï¼ŒSwift ç¤¾ç¾¤ä¼šå…³æ³¨ç¼–ç¨‹è¯­è¨€çš„å‘å±•å¹¶å–å…¶ç²¾åï¼Œä½¿å¾— Swift ä¸€ç›´ä¿æŒè¿›åŒ–ï¼Œå˜å¾—æ›´å¥½ã€‚</p>
</li>
</ul>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œç±»ä¼¼ <strong>Optional</strong> è¿™ç§ç±»å‹å°±æ˜¯ Swift è€ƒè™‘å®‰å…¨æ€§çš„ä¸€ä¸ªä½“ç°ï¼Œåœ¨å…¶ä»–çš„ç¼–ç¨‹è¯­è¨€å½“ä¸­ï¼Œä½ å¹¶ä¸èƒ½çŸ¥é“å“ªä¸ªå˜é‡å¯ä»¥ä¸ºç©º(null)å“ªä¸ªä¸èƒ½ï¼Œè€Œ <strong>Optional</strong> æºå¸¦ç€æ”¹å˜é‡å¯èƒ½ä¸ºç©ºçš„ä¿¡æ¯ï¼Œè¿™å°±å¼ºåˆ¶å¼€å‘è€…å»è€ƒè™‘å¯èƒ½ä¸ºç©ºçš„æƒ…å†µã€‚å¯¹äºâ€å¯ç©ºâ€ï¼ˆnullableï¼‰çš„ç±»å‹ï¼Œå¦‚æœä½ ç”¨å¼ºè§£åŒ…ç¬¦å·ï¼ˆ<strong>!</strong>ï¼‰æ¥å¤„ç†è¯¥ç±»å‹ï¼Œæœ‰äº›æ—¶å€™å®ƒä¼šç›´æ¥ crashã€‚Swift çš„å®‰å…¨æ€§ç›¸å½“äºä¸€æ¡å®‰å…¨å¸¦ï¼Œä½ å¯ä»¥è‡ªè¡Œè§£å¼€å®ƒï¼Œä½†æ˜¯é£é™©ä¹Ÿè¦è‡ªå·±æ¥æ‰¿æ‹…ã€‚</p>
<p>ç„¶è€Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®‰å…¨æ€§çœ‹èµ·æ¥å¹¶ä¸è¶³å¤Ÿã€‚æ¯”å¦‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå­—å…¸ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€äº› key æ¥æå–åˆ°è¿”å›å€¼ç±»å‹ä¸º optional çš„ value</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> person: [<span class="type">String</span>: <span class="type">String</span>] = <span class="comment">//...</span></div><div class="line">type(of: person[<span class="string">"name"</span>]) <span class="comment">// =&gt; Optional&lt;String&gt;</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬å¯¹æ•°ç»„è¿›è¡Œç±»ä¼¼çš„æ“ä½œï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šå¾—åˆ°ä¸€ä¸ª optional:</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> users: [<span class="type">User</span>] = <span class="comment">//...</span></div><div class="line">type(of: users[<span class="number">0</span>]) <span class="comment">// =&gt; User</span></div></pre></td></tr></table></figure>
<p>åŸå› æ˜¯æ•°ç»„å¯èƒ½æ²¡æœ‰å…ƒç´ ï¼Œå¦‚æœ <strong>users</strong> çš„æ•°ç»„ä¸ºç©ºçš„è¯ï¼Œè¿™æ®µç¨‹åºå°†ä¼šç›´æ¥crashï¼Œä»è¿™æ–¹é¢æ¥çœ‹ï¼Œå¥½åƒSwiftå¹¶æ²¡æœ‰åšåˆ°è¶³å¤Ÿå®‰å…¨ã€‚</p>
<p>Swiftä»ç„¶åœ¨å¼€æ”¾çš„æ¼”è¿›ä¸­ï¼Œä½ å¯èƒ½å°±æ­¤é—®é¢˜æäº›å»ºè®®åˆ° <a href="http://khanlou.com/2017/04/safety-in-swift/" target="_blank" rel="external">Swift evolutioné‚®ä»¶ç»„</a><br>ä¸ï¼Œé‚£ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆæ”¹å˜ï¼Œåœ¨ <strong>Swift evolution</strong> çš„ github åº“é‡Œ <a href="https://github.com/apple/swift-evolution/blob/master/commonly_proposed.md" target="_blank" rel="external">â€å¸¸è§é©³å›â€æè®®é¡µ</a> å½“ä¸­æè¿°äº†ä¸ä¼šæ¥å—è¿™é¡¹æè®®ï¼š</p>
<ul>
<li>Array&lt; T &gt; çš„ä¸‹æ ‡è·å–æ“ä½œä¸è¿”å›ä¸€ä¸ª <strong>T</strong> è€Œæ˜¯è¿”å›ä¸€ä¸ª <strong>T?</strong> æˆ–è€… <strong>T!</strong>ï¼Œå½“å‰çš„æ•°ç»„çš„é€»è¾‘æ˜¯<a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20151214/002446.html" target="_blank" rel="external">æ•…æ„ä¸ºä¹‹</a>ï¼Œå®ƒå‡†ç¡®åæ˜ äº†è®¿é—®è¶Šç•Œçš„æ•°ç»„ä¸‹æ ‡æ˜¯ä¸€ä¸ªé€»è¾‘é”™è¯¯ã€‚å¦‚æœæ”¹å˜ç›®å‰çš„é€»è¾‘ä¼šé™ä½æ•°ç»„çš„è¯»å–åˆ°ä¸€ä¸ªæ— æ³•æ¥å—çš„ç¨‹åº¦ï¼Œè¿™é¡¹æè®®<a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20151214/002425.html" target="_blank" rel="external">æå‡ºå¤šæ¬¡</a>å¹¶ä¸ä¼šè¢«ç¤¾åŒºé‡‡çº³ã€‚</li>
</ul>
<p>è¿™é‡ŒæŒ‡å‡ºçš„åŸå› æ˜¯åœ¨è¿™ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæ€§èƒ½è‡³å…³é‡è¦ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹ä¸Šé¢å¼•ç”¨çš„å…³äºé¡µå½“ä¸­çš„ä¿¡æ¯ï¼Œâ€å®‰å…¨æ€§â€çš„åœ°ä½åº”è¯¥æ˜¯é«˜äºâ€é€Ÿåº¦â€çš„ï¼Œéš¾é“å®‰å…¨æ€§ä¸åº”è¯¥æ¯”é€Ÿåº¦æ›´ä¸ºé‡è¦ä¹ˆï¼Ÿ</p>
<p>è¿™é‡Œå­˜åœ¨ç€ä¸€ä¸ªæ ¹æœ¬çš„äº‰è®®ç‚¹ï¼Œåœ¨äºâ€å®‰å…¨æ€§â€ä¸€è¯çš„å®šä¹‰ã€‚å¯¹äºâ€å®‰å…¨æ€§â€ä¸€ä¸ªæ™®éçš„ç†è§£æ˜¯ä¸ crashï¼Œè€Œ Swift æ ¸å¿ƒæˆå‘˜çš„å®šä¹‰æ˜¯â€æ°¸è¿œä¸ä¼šåœ¨æ— æ„ä¸­è®¿é—®é”™è¯¯çš„å†…å­˜â€ã€‚</p>
<p>ä»è¿™ç‚¹æ¥çœ‹ï¼ŒSwift çš„ä¸‹æ ‡æ“ä½œæ˜¯â€å®‰å…¨çš„â€ï¼Œå®ƒæ°¸è¿œéƒ½ä¸ä¼šå»è®¿é—®åœ¨æ•°ç»„è‡ªèº«åˆ†é…ä¹‹å¤–çš„å†…å­˜ï¼Œå½“ä½ æƒ³è®¿é—®æ•°ç»„è¶Šç•Œçš„å†…å­˜æ—¶å®ƒä¼šç«‹å³ crashï¼Œå¦‚ Optional ç±»å‹é¿å…äº†å½“å‰å­˜åœ¨çš„å„ç§ç©ºæŒ‡é’ˆå¼•ç”¨çš„ bug ä¸€æ ·ï¼Œæ•°ç»„è¿™é‡Œçš„è€ƒè™‘é¿å…äº†ç¼“å†²åŒºæº¢å‡ºçš„ bugã€‚</p>
<p>Chris Lattnerï¼ˆSwift ä½œè€…ï¼‰åœ¨<a href="https://overcast.fm/+CdTE-_oY/24:37" target="_blank" rel="external">è¿™æ®µé‡‡è®¿</a>çš„24.39å¤„æœ‰æ®µè¯´æ˜</p>
<blockquote>
<p>æˆ‘ä»¬é‡‡ç”¨çš„å®‰å…¨æ€§ç­–ç•¥æ˜¯åœ¨ç»¼åˆçš„ä¸€ç§å¦¥åã€‚æˆ‘ä»¬æƒ³ä½¿Swiftæˆä¸ºä¸€é—¨å®‰å…¨çš„ç¼–ç¨‹è¯­è¨€ï¼Œä½†è¿™ç§å®‰å…¨å¹¶ä¸æ˜¯æ²¡æœ‰bugï¼Œè€Œæ˜¯æˆ‘ä»¬ä¿éšœå†…å­˜å®‰å…¨çš„çš„åŸºç¡€ä¸ŠåŒæ—¶æä¾›é«˜æ€§èƒ½è€Œä¸”é‡‡ç”¨ä¸€ç›´å‰è¿›çš„ç¼–ç¨‹è¯­è¨€èŒƒå¼ã€‚</p>
</blockquote>
<p>æˆ–è®¸ï¼Œå†…å­˜å®‰å…¨ç›¸å¯¹äºå®‰å…¨æ˜¯ä¸€ä¸ªæ›´å¥½çš„åè¯ï¼Œæœ‰äº›å¼€å‘è€…å¯èƒ½æ›´åå‘äºå¾—åˆ°ä¸€ä¸ª optional çš„è¿”å›å€¼ï¼Œè€Œä¸æ˜¯åœ¨æ•°ç»„è¶Šç•Œè®¿é—®çš„é—®é¢˜é‡Œçº ç»“ï¼Œæ¯ä¸ªäººéƒ½åŒæ„ç›´æ¥è®©ç¨‹åºcrashä¼šå¥½è¿‡è®©ç¨‹åºæºå¸¦ç€éæ³•çš„æ•°æ®ç»§ç»­è¿è¡Œä¸‹å»ï¼Œè€Œè¿™ç§æƒ…å†µè¿˜å¯èƒ½ä¼šè¢«æ ˆæº¢å‡ºçš„æ”»å‡»æ‰€åˆ©ç”¨ã€‚</p>
<p>ç¬¬äºŒç§æƒè¡¡ï¼ˆç›´æ¥ crash è€Œä¸æ˜¯å…è®¸è¶Šç•Œè®¿é—®ï¼‰çš„å†³å®šçœ‹èµ·æ¥æ˜¾è€Œæ˜“è§ï¼Œä½†æ˜¯æœ‰äº›è¯­è¨€ä¸ä¼šåšè¿™ç§ä¿è¯ï¼Œåœ¨ C ä¸­ï¼Œè®¿é—®è¶Šç•Œçš„æ•°ç»„å°†ä¼šå¯¼è‡´æœªçŸ¥çš„è¡Œä¸ºï¼ˆå…·ä½“å–å†³äºä½¿ç”¨çš„ç¼–è¯‘å™¨å¯¹è¿™ç§è¡Œä¸ºçš„å®ç°ï¼‰ï¼Œåœ¨ Swift ä¸­å¼€å‘è€…ä¼šå¿«é€Ÿçš„æ„è¯†åˆ°è‡ªå·±çŠ¯äº†ç±»ä¼¼æ•°ç»„è¶Šç•Œçš„é”™è¯¯ï¼ŒSwiftå›¢é˜Ÿè§‰å¾—è¿™æ˜¯ä¸€ä¸ªåˆé€‚çš„ crash æ—¶æœºï¼Œæ‰€ä»¥å¹¶ä¸ä¼šè¿”å›ä¸€ä¸ª optional ç”šè‡³æ˜¯è¿”å›ä¸€æ®µæœªçŸ¥çš„æ•°æ®ã€‚</p>
<p>ä½¿ç”¨è¿™é‡Œâ€å®‰å…¨â€çš„å®šä¹‰ä¹Ÿæ˜ç¡®äº†â€ä¸å®‰å…¨â€çš„ API çš„å®šä¹‰ï¼Œå› ä¸ºå®ƒä»¬ç›´æ¥è®¿é—®å†…å­˜è¿›è¡Œç¼–ç¨‹ï¼Œç¨‹åºå‘˜ä»¬è‡ªå·±å¿…é¡»ååˆ†å°å¿ƒä¿è¯è‡ªå·±ä¸ä¼šè®¿é—®åˆ°æ— æ•ˆçš„å†…å­˜ï¼Œè¿™ç‚¹å°¤ä¸ºå›°éš¾ï¼Œå³ä½¿ä¸“å®¶åœ¨è¿™ç§æƒ…æ™¯ä¹Ÿä¼šçŠ¯é”™ï¼Œå¦‚æœå¯¹è¿™ä¸ªä¸»é¢˜æ„Ÿå…´è¶£å»æŸ¥é˜… <a href="https://www.cocoawithlove.com/blog/2016/02/16/use_it_or_lose_it_why_safe_c_is_sometimes_unsafe_swift.html" target="_blank" rel="external">Matt Gallagherçš„åšå®¢</a>ä¸­ä»¥å®‰å…¨çš„æ–¹å¼æ¡¥æ¥ C åˆ° Swift çš„ç›¸å…³è®¨è®ºã€‚</p>
<p>Swift çš„å›¢é˜Ÿå¯¹äºå®‰å…¨çš„å®šä¹‰å¯èƒ½ä¸ä½ é¢„æƒ³çš„å¹¶ä¸å®Œå…¨ä¸€è‡´ï¼Œä½†æ˜¯å®ƒä»¬çš„ç§ç§ç­–ç•¥ç¡®å®å¯ä»¥é¿å…å¤§å¤šæ•°çš„ç¨‹åºå‘˜å»è€ƒè™‘å„ç§å¸¸è§çš„ bugï¼Œå°†â€œå®‰å…¨â€çš„å®šä¹‰ç»†åŒ–ä¸ºâ€œå†…å­˜å®‰å…¨â€å¯ä»¥è®©æˆ‘æ›´å¥½çš„ç†è§£ Swift å›¢é˜Ÿå¯¹äºå®‰å…¨çš„å®šä¹‰ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šSoroush Khanlouï¼Œ&lt;a href=&quot;http://khanlou.com/2017/04/safety-in-swift/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-04-05&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;undefined&quot;&gt;Doye&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://chengway.in/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;walkingway&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;Swift æ˜¯ä¸€é—¨æ³¨é‡å®‰å…¨æ€§çš„è¯­è¨€ï¼Œå¦‚&lt;a href=&quot;https://Swift.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Swiftå®˜ç½‘&lt;/a&gt;çš„&lt;a href=&quot;https://Swift.org/about/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;å…³äºé¡µé¢&lt;/a&gt;ä¸­æ‰€è¨€&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Swift æ˜¯ä¸€é—¨é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼Œé‡‡ç”¨ç°ä»£åŒ–çš„æ–¹æ³•æ¥ä¿è¯å®‰å…¨æ€§ä¸æ€§èƒ½ï¼Œå¥—ç”¨è½¯ä»¶è®¾è®¡æ¨¡å¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="khanlou.com" scheme="https://swift.gg/categories/khanlou-com/"/>
    
    
      <category term="Swift è¿›é˜¶" scheme="https://swift.gg/tags/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>[Jinkey åŸåˆ›]éœ‡æƒŠï¼iOS ç³»ç»Ÿå±…ç„¶è‡ªå¸¦æ‚¬æµ®çª—å£è°ƒè¯•å·¥å…·</title>
    <link href="https://swift.gg/2017/05/27/ui-debugging-information-overlay/"/>
    <id>https://swift.gg/2017/05/27/ui-debugging-information-overlay/</id>
    <published>2017-05-26T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ul>
<li>åŸæ–‡é“¾æ¥ : <a href="http://www.jianshu.com/p/736353b5cfaf?utm_campaign=hugo&amp;utm_medium=reader_share&amp;utm_content=note&amp;utm_source=weixin-friends&amp;from=singlemessage&amp;isappinstalled=1" target="_blank" rel="external">éœ‡æƒŠï¼iOS ç³»ç»Ÿå±…ç„¶è‡ªå¸¦æ‚¬æµ®çª—å£è°ƒè¯•å·¥å…· â€”â€” Jinkey åŸåˆ›</a></li>
<li>åŸæ–‡ä½œè€… : <a href="http://www.jianshu.com/u/8354f5625fe4" target="_blank" rel="external">Jinkey</a></li>
</ul>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<h2 id="1-èƒŒæ™¯"><a href="#1-èƒŒæ™¯" class="headerlink" title="1 èƒŒæ™¯"></a>1 èƒŒæ™¯</h2><blockquote>
<p>è‹±æ–‡åŸæ–‡ï¼š<br><a href="http://ryanipete.com/blog/ios/swift/objective-c/uidebugginginformationoverlay/" target="_blank" rel="external">http://ryanipete.com/blog/ios/swift/objective-c/uidebugginginformationoverlay/</a></p>
<p>æˆ‘å†™å¾—è¿™ä¸ªå¹¶ä¸æ˜¯ç¿»è¯‘è€Œæ˜¯ç”¨è‡ªå·±çš„ç†è§£é‡æ–°è¡¨è¿°è¿™ä¸ªåŠŸèƒ½ï¼Œå’ŒåŸæ–‡å†…å®¹æœ‰å‡ºå…¥ï¼Œæœ‰èƒ½åŠ›çš„å¯ä»¥æŸ¥çœ‹è‹±æ–‡åŸæ–‡ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬ç»å¸¸ä½¿ç”¨å„ç§è°ƒè¯•å·¥å…·ï¼Œæˆ–è€…å¼€æºåº“æ¥æ”¯æŒæ‚¬æµ®çª—è°ƒè¯•ä¿¡æ¯ï¼Œä½†è‹¹æœçš„ç§æœ‰æ–¹æ³•å°±æä¾›äº† <code>UIDebuggingInformationOverlay</code> ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/854231-2ef0080f4eea8935.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<a id="more"></a>
<h2 id="2-å¦‚ä½•ä½¿ç”¨"><a href="#2-å¦‚ä½•ä½¿ç”¨" class="headerlink" title="2 å¦‚ä½•ä½¿ç”¨"></a>2 å¦‚ä½•ä½¿ç”¨</h2><p>åœ¨ <code>AppDelegate</code> çš„ <code>didFinishLaunchingWithOptions</code> æ–¹æ³•ä¸­åŠ å…¥ä¸¤è¡Œä»£ç å³å¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> overlayClass = <span class="type">NSClassFromString</span>(<span class="string">"UIDebuggingInformationOverlay"</span>) <span class="keyword">as</span>? <span class="type">UIWindow</span>.<span class="type">Type</span></div><div class="line"><span class="number">_</span> = overlayClass?.perform(<span class="type">NSSelectorFromString</span>(<span class="string">"prepareDebuggingOverlay"</span>))</div></pre></td></tr></table></figure>
<p>è¿è¡Œç¨‹åºåï¼Œä¸¤æ ¹æ‰‹æŒ‡ç‚¹å‡»çŠ¶æ€æ å³å¯è°ƒèµ·è¿™ä¸ªè°ƒè¯•çš„æ‚¬æµ®å±‚ã€‚</p>
<h2 id="3-èƒ½åšä»€ä¹ˆ"><a href="#3-èƒ½åšä»€ä¹ˆ" class="headerlink" title="3 èƒ½åšä»€ä¹ˆ"></a>3 èƒ½åšä»€ä¹ˆ</h2><h3 id="3-1-æŸ¥çœ‹æ•´ä¸ª-window-çš„-View-åµŒå¥—å…³ç³»"><a href="#3-1-æŸ¥çœ‹æ•´ä¸ª-window-çš„-View-åµŒå¥—å…³ç³»" class="headerlink" title="3.1 æŸ¥çœ‹æ•´ä¸ª window çš„ View åµŒå¥—å…³ç³»"></a>3.1 æŸ¥çœ‹æ•´ä¸ª <code>window</code> çš„ <code>View</code> åµŒå¥—å…³ç³»</h3><blockquote>
<p>View Hierarchy</p>
</blockquote>
<p>è¿™ä¸ªåŠŸèƒ½å¯ä»¥æŸ¥çœ‹é¡µé¢å±‚çº§çš„ç»“æ„æ ‘ï¼Œç‚¹å‡»æ„Ÿå¹å·è¿›å…¥è¯¦æƒ…é¡µï¼ˆç‚¹ <code>cell</code>  æ˜¯æ²¡ååº”çš„ï¼‰ï¼Œä¼šå±•ç¤ºé‚£ä¸ª <code>view</code> çš„ <code>frame</code> ã€ <code>bounds</code> å’Œå…¶ä»–ä¸€äº›å®ä¾‹å˜é‡ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/854231-66b7d3e56dd27cff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="3-2-æŸ¥çœ‹å½“å‰-ViewController-çš„å±æ€§"><a href="#3-2-æŸ¥çœ‹å½“å‰-ViewController-çš„å±æ€§" class="headerlink" title="3.2 æŸ¥çœ‹å½“å‰ ViewController çš„å±æ€§"></a>3.2 æŸ¥çœ‹å½“å‰ <code>ViewController</code> çš„å±æ€§</h3><blockquote>
<p>VC Hierarchy</p>
</blockquote>
<p>æŸ¥çœ‹æ¿€æ´»çš„ <code>ViewController</code> çš„ <code>childrenViewCotroller</code> çš„ç»“æ„æ ‘å’Œç›¸å…³å±æ€§ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/854231-bbae2392b4a80173.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="3-3-æŸ¥çœ‹-UIApplication-çš„æˆå‘˜å±æ€§"><a href="#3-3-æŸ¥çœ‹-UIApplication-çš„æˆå‘˜å±æ€§" class="headerlink" title="3.3 æŸ¥çœ‹ UIApplication çš„æˆå‘˜å±æ€§"></a>3.3 æŸ¥çœ‹ <code>UIApplication</code> çš„æˆå‘˜å±æ€§</h3><blockquote>
<p>Ivar Explorer</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/854231-04044fb28c7d6910.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="3-4-æµ‹é‡ç»„ä»¶å¤§å°"><a href="#3-4-æµ‹é‡ç»„ä»¶å¤§å°" class="headerlink" title="3.4 æµ‹é‡ç»„ä»¶å¤§å°"></a>3.4 æµ‹é‡ç»„ä»¶å¤§å°</h3><blockquote>
<p>Measure</p>
</blockquote>
<p>ä¸€å¼€å§‹è¿˜æŒºæ‡µé€¼ä¸çŸ¥é“è¦æ€ä¹ˆç”¨ï¼Œåæ¥å‘ç°æ‰‹æŒ‡æ˜¯ç›´æ¥åœ¨æ‚¬æµ®çª—çš„å¤–éƒ¨è¿›è¡Œè¿›è¡Œæ‹–åŠ¨å°±å¯ä»¥äº†ï¼Œå¦‚æœä½ çš„ç»„ä»¶è¢«æ‚¬æµ®çª—æŒ¡ä½äº†å¥½åƒå°±æ²¡åŠæ³•äº†ã€‚<br><br>é€‰æ‹© Vertical ï¼Œæ‰‹æŒ‡åœ¨å±å¹•æ‹–åŠ¨å³å¯æ˜¾ç¤ºæŸä¸ªç»„ä»¶çš„é«˜åº¦ï¼›<br><br>é€‰æ‹© Horizontal ï¼Œæ‰‹æŒ‡åœ¨å±å¹•æ‹–åŠ¨å³å¯æ˜¾ç¤ºæŸä¸ªç»„ä»¶çš„ å®½åº¦ï¼›</p>
<p><img src="http://upload-images.jianshu.io/upload_images/854231-7f0f0d183cc50196.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="3-5-æ•ˆæœå¯¹æ¯”"><a href="#3-5-æ•ˆæœå¯¹æ¯”" class="headerlink" title="3.5 æ•ˆæœå¯¹æ¯”"></a>3.5 æ•ˆæœå¯¹æ¯”</h3><blockquote>
<p>Spec Compare</p>
</blockquote>
<p>ä»ç›¸å†Œè¯»å–ä¸€ä¸ªå›¾ç‰‡ï¼ˆä½ å¿…é¡»åœ¨info.plist å…ˆé…ç½®ç›¸å†Œæƒé™NSPhotoLibraryUsageDescriptionï¼‰å’Œå½“å‰ç•Œé¢å¯¹æ¯”ã€‚</p>
<p>ç‚¹å‡» Add -&gt; ä»ç›¸å†Œé€‰æ‹©ä¸€ä¸ªç•Œé¢æˆªå›¾ -&gt; ç‚¹å‡»åˆšæ·»åŠ çš„æˆªå›¾ -&gt; æ‰‹æŒ‡åœ¨å±å¹•ï¼ˆæ‚¬æµ®çª—å¤–éƒ¨ï¼‰ä¸Šä¸‹æ»‘åŠ¨ -&gt; å³å¯åŠ¨æ€æ”¹å˜æˆªå›¾çš„é€æ˜åº¦æ¥å¯¹æ¯”æˆªå›¾å’Œå½“å‰ç•Œé¢çš„å·®å¼‚ -&gt; åŒå‡»é€€å‡ºã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/854231-d8eae18f88927c88.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>æˆ‘çš„å¾®ä¿¡å…¬ä¼—å· <code>jinkey-love</code> æ¬¢è¿äº¤æµ</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;åŸæ–‡é“¾æ¥ : &lt;a href=&quot;http://www.jianshu.com/p/736353b5cfaf?utm_campaign=hugo&amp;amp;utm_medium=reader_share&amp;amp;utm_content=note&amp;amp;utm_source=weixin-friends&amp;amp;from=singlemessage&amp;amp;isappinstalled=1&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;éœ‡æƒŠï¼iOS ç³»ç»Ÿå±…ç„¶è‡ªå¸¦æ‚¬æµ®çª—å£è°ƒè¯•å·¥å…· â€”â€” Jinkey åŸåˆ›&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;åŸæ–‡ä½œè€… : &lt;a href=&quot;http://www.jianshu.com/u/8354f5625fe4&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Jinkey&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;h2 id=&quot;1-èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#1-èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;1 èƒŒæ™¯&quot;&gt;&lt;/a&gt;1 èƒŒæ™¯&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;è‹±æ–‡åŸæ–‡ï¼š&lt;br&gt;&lt;a href=&quot;http://ryanipete.com/blog/ios/swift/objective-c/uidebugginginformationoverlay/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://ryanipete.com/blog/ios/swift/objective-c/uidebugginginformationoverlay/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘å†™å¾—è¿™ä¸ªå¹¶ä¸æ˜¯ç¿»è¯‘è€Œæ˜¯ç”¨è‡ªå·±çš„ç†è§£é‡æ–°è¡¨è¿°è¿™ä¸ªåŠŸèƒ½ï¼Œå’ŒåŸæ–‡å†…å®¹æœ‰å‡ºå…¥ï¼Œæœ‰èƒ½åŠ›çš„å¯ä»¥æŸ¥çœ‹è‹±æ–‡åŸæ–‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬ç»å¸¸ä½¿ç”¨å„ç§è°ƒè¯•å·¥å…·ï¼Œæˆ–è€…å¼€æºåº“æ¥æ”¯æŒæ‚¬æµ®çª—è°ƒè¯•ä¿¡æ¯ï¼Œä½†è‹¹æœçš„ç§æœ‰æ–¹æ³•å°±æä¾›äº† &lt;code&gt;UIDebuggingInformationOverlay&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/854231-2ef0080f4eea8935.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ•ç¨¿" scheme="https://swift.gg/categories/%E6%8A%95%E7%A8%BF/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>ç»™æ¯ä¸€ä¸ª Swift ç‰ˆæœ¬è®¾å®šå¼€å‘ä¸»é¢˜</title>
    <link href="https://swift.gg/2017/05/26/swift-themed-releases/"/>
    <id>https://swift.gg/2017/05/26/swift-themed-releases/</id>
    <published>2017-05-25T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šOle Begemannï¼Œ<a href="https://oleb.net/blog/2017/03/swift-themed-releases/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-03-20<br>è¯‘è€…ï¼š<a href="https://kemchenj.github.io" target="_blank" rel="external">å››å¨˜</a>ï¼›æ ¡å¯¹ï¼š<a href="http://weibo.com/277195544" target="_blank" rel="external">Cwift</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>å¤§æ¦‚ä¸€ä¸ªæ˜ŸæœŸä¹‹å‰ï¼Œ<a href="https://swift.org/community/#core-team" target="_blank" rel="external">Swift æ ¸å¿ƒå›¢é˜Ÿ</a>æˆå‘˜ Ben Cohen åœ¨ <a href="https://swift.org/community/#swift-evolution" target="_blank" rel="external">Swift-Evolution</a> å‘äº†<a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170306/033699.html" target="_blank" rel="external">ä¸€æ¡çš„å¾ˆå€¼å¾—æ€è€ƒçš„ä¿¡æ¯</a>ï¼Œå›ç­”äº†ä¸€ä¸ª<a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170220/033092.html" target="_blank" rel="external">é—®é¢˜</a> â€” å†ç»™ <a href="https://github.com/apple/swift/blob/master/CHANGELOG.md#swift-40" target="_blank" rel="external">Swift 4</a> æä¸€ä¸ªæ–°ææ¡ˆ, è¢«é€šè¿‡çš„å‡ ç‡æœ‰å¤šå¤§ã€‚</p>
<p>Ben é˜è¿°äº†æ ¸å¿ƒå›¢é˜Ÿå†³å®šææ¡ˆæ˜¯å¦è¦æ¨è¿Ÿçš„ä¸»è¦ä¾æ®ã€‚ä¸»æ—¨å°±æ˜¯ Swift æ¯ä¸€ä¸ªç‰ˆæœ¬éƒ½åº”è¯¥ä¸“æ³¨äºä¸€å°éƒ¨åˆ†ä¸»é¢˜ï¼Œç¬¦åˆä¸»é¢˜çš„ææ¡ˆç»™äºˆæ›´é«˜çš„ä¼˜å…ˆçº§ã€‚</p>
<a id="more"></a>
<p>æˆ‘è®¤ä¸º <a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170306/033699.html" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a> å¹¶æ²¡æœ‰å¼•èµ·è¶³å¤Ÿçš„é‡è§†ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘æŠŠå®ƒå®Œå…¨å¼•ç”¨è¿‡æ¥çš„åŸå› (é“¾æ¥å’Œæ³¨è§£æ˜¯æˆ‘è‡ªå·±åŠ çš„)ï¼š</p>
<blockquote>
<p><a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20160725/025676.html" target="_blank" rel="external">Swift 4 çš„ä¸»é¢˜</a>è®¾å®šå¥½ä¹‹åï¼Œä¸€äº›ä¸ç¬¦åˆä¸»é¢˜çš„ææ¡ˆè¿˜æ˜¯è¿›å…¥äº†æˆ‘ä»¬çš„è®¨è®ºï¼Œè¿™æ˜¾å¾—ä¸€ç‚¹æ„ä¹‰ä¹Ÿæ²¡æœ‰ã€‚ä¾‹å¦‚ä¸€äº›å…³äº <a href="https://developer.apple.com/reference/swift/string" target="_blank" rel="external">String</a> ï¼Œ <a href="https://developer.apple.com/reference/swift/dictionary" target="_blank" rel="external">Dictionary</a> å’Œ <a href="https://developer.apple.com/reference/swift/sequence" target="_blank" rel="external">Sequence</a> / <a href="https://developer.apple.com/reference/swift/collection" target="_blank" rel="external">Collection</a> çš„ææ¡ˆè¢«é‡‡çº³ã€‚åœ¨ Swift æ¥ä¸‹æ¥çš„ç‰ˆæœ¬é‡Œï¼Œå¾ˆå¯èƒ½è¿™äº›ä¸ç›®æ ‡ä¸ç¬¦åˆçš„ææ¡ˆï¼Œä¾‹å¦‚ String è¿›ä¸€æ­¥çš„å®Œå–„(åŸç”Ÿçš„æ­£åˆ™è¡¨è¾¾å¼)ï¼Œmove-only ç±»å‹ï¼Œå¼‚æ­¥ï¼Œåå°„ï¼Œæˆ–è€…æ˜¯æ³›å‹çš„åŠ å¼ºï¼Œéƒ½ä¼šè¿›å…¥è®¨è®ºã€‚<strong>æˆ‘ä»¬è§‰å¾—ä¸“æ³¨äºç‰¹å®šçš„ä¸»é¢˜å¯¹äºä¸€é—¨è¯­è¨€çš„æ¼”å˜ç‰¹åˆ«é‡è¦ï¼Œè¿™äº›æ•£ä¹±çš„ï¼Œä¸å½“å‰å¼€å‘ä¸»é¢˜æ— å…³çš„ææ¡ˆï¼Œåº”è¯¥è¦è®¾ç½®æ›´é«˜çš„é‡‡çº³é—¨æ§›ã€‚</strong></p>
<p>å…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯æ ¸å¿ƒå›¢é˜Ÿå’Œç¤¾åŒºçš„ç²¾åŠ›æœ‰é™ã€‚ä¸“æ³¨ä¸€éƒ¨åˆ†ç›®æ ‡è¿›è¡Œè®¨è®ºï¼Œå¯ä»¥è®©åˆ«çš„ç¤¾åŒºæ›´å®¹æ˜“å‚ä¸åˆ°æˆ‘ä»¬çš„è®¨è®ºé‡Œ(å°½ç®¡<a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170206/031657.html" target="_blank" rel="external">åŠ å…¥ææ¡ˆæ¨¡æ¿</a>ä¹Ÿä¼šæœ‰å¸®åŠ©)ã€‚è€Œä¸”å¦‚æœä¿è¯æ¯ä¸€ä¸ªææ¡ˆéƒ½èƒ½å¤Ÿä¸ºè¿™ä¸ªé˜¶æ®µçš„ç›®æ ‡æœåŠ¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥é¿å…ä¸€äº›ææ¡ˆè™½ç„¶è¢«é‡‡çº³ï¼Œä½†ä»æœªæœ‰æœºä¼šå®ç°çš„æƒ…å†µå‡ºç°ã€‚  </p>
<p>æ­¤å¤–ï¼Œä¸“æ³¨äºæŸä¸ªç›®æ ‡è¿›è¡Œè®¨è®ºæ—¶ï¼Œé’ˆå¯¹è¿™ä¸ªç›®æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰å®Œæˆåº¦æ›´é«˜ï¼Œæ›´åŠ å…·æœ‰ä¸€è‡´æ€§çš„åŠŸèƒ½è®¾è®¡ã€‚å¯ä»¥æ¢è®¨å¦‚ä½•åœ¨ Swift 4 é‡ŒæŠŠ<a href="https://github.com/apple/swift/blob/master/CHANGELOG.md#swift-40" target="_blank" rel="external">æ‰€æœ‰æ–°çš„æ³›å‹åŠŸèƒ½</a>åˆç†åœ°ç»„åˆåˆ°ä¸€èµ·ï¼Œæ„å»ºä¸€ä¸ªå®Œå–„ï¼Œé«˜åº¦ä¸€è‡´çš„ä½“ç³»ï¼Œè®©æˆ‘ä»¬æ›´å®¹æ˜“ä½¿ç”¨å’Œç†è§£ã€‚æˆ–è€…æ˜¯æ–°çš„å­—ç¬¦ä¸²åŠŸèƒ½å¦‚ä½•<a href="https://github.com/apple/swift/blob/master/docs/StringManifesto.md" target="_blank" rel="external">æ›´åŠ ä¾¿æ·åœ°å¤„ç†å­—ç¬¦ä¸²</a>ã€‚<strong>ä¸€æ–¹é¢æ˜¯å‘å¤§å®¶ä¼ é€’ Swift 4 æƒ³è¦å®Œæˆçš„ç›®æ ‡ï¼Œä¸€æ–¹é¢æ›´åˆ©äºæˆ‘ä»¬å»å®Œæˆä¸€ä¸ªæ¡ç†æ¸…æ™°ï¼Œè¿è´¯çš„è®¾è®¡ã€‚</strong></p>
<p>ä¸€ä¸ªæ¡ç†æ¸…æ™°çš„è®¾è®¡ä¸æ­¢å¯¹äºç‰ˆæœ¬çš„è¿­ä»£å¾ˆé‡è¦ â€” å› ä¸ºè¿™å¯ä»¥è®©å¼€å‘è€…æ›´å®¹æ˜“å­¦ä¹ ä½¿ç”¨æ–°åŠŸèƒ½ï¼Œ<strong>è€Œä¸”å¯¹äºè¯­è¨€çš„é•¿æœŸå‘å±•ä¹Ÿæ˜¯ä¸€æ ·é‡è¦ã€‚</strong>æ²¡æœ‰æ˜ç¡®ç›®æ ‡çš„ææ¡ˆï¼Œä¼šè®©æˆ‘ä»¬éå¸¸éš¾ç†è§£å•ä¸ªææ¡ˆæ€ä¹ˆèå…¥åˆ° Swift æ•´ä½“çš„å‘å±•æ–¹å‘é‡Œã€‚æˆ‘ä»¬æƒ³è¦é¿å…è¿›è¡Œäº†ä¸€äº›å±€éƒ¨çš„æ”¹è¿›è¿‡åï¼Œåç»­å†æ¬¡è§¦åŠç›¸å…³çš„éƒ¨åˆ†æ—¶ï¼Œå´å‘ç°å½“æ—¶çš„æ”¹è¿›å¹¶ä¸ç¬¦åˆæ•´ä½“è®¾è®¡ã€‚åŒæ—¶è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯ï¼Œæˆ‘ä»¬è€ƒè™‘äº†å¤ªå¤šåˆ†å¼€çœ‹èµ·æ¥å¾ˆåˆç†çš„åŠŸèƒ½ï¼Œä½†å°†å®ƒä»¬æ‹¼å‡‘åˆ°ä¸€èµ·æ—¶å´å¹¶ä¸åˆé€‚ã€‚  </p>
<p>ä¾‹å¦‚ï¼Œæœ€è¿‘çš„ä¸€äº›ææ¡ˆå›´ç»•ç€<a href="https://github.com/DevAndArtist/swift-evolution/blob/refactor_existential_metatypes/proposals/0126-refactor-metatypes.md" target="_blank" rel="external">é‡æ„ meta types</a> ï¼Œä½†è¿™å¿…é¡»åœ¨åå°„è¿™ä¸ªå¤§æ¡†æ¶ä¸‹è®¨è®ºæ‰å¯ä»¥ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥ç­‰åˆ°è¿™ä¸ªä¸»é¢˜è¢«æä¸Šè®®ç¨‹å†å»è®¨è®ºã€‚å¦å¤–ä¸€ä¸ªä¾‹å­: æœ€è¿‘çš„ææ¡ˆ <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0154-dictionary-key-and-value-collections.md" target="_blank" rel="external">SE-154</a> æè®®å¯ä»¥è‡ªå®šä¹‰å­˜å‚¨å­—å…¸é”®å€¼å¯¹çš„é›†åˆï¼Œè¿™ç§åšæ³•å¹¶æ²¡æœ‰é™ä½è€¦åˆåº¦ï¼Œå®ƒåªæ˜¯æä¾›äº†ä¸€ç§ç•¥å¾®ç¬¨é‡çš„æ–¹å¼å»è§£å†³é—®é¢˜ â€” ç»™å­—å…¸æä¾›ä¸€ä¸ªåˆå§‹å€¼ï¼Œç„¶åå»æ›´æ–°è¿™ä¸ªå€¼ã€‚ä½†å®ƒéœ€è¦ä½œä¸º<a href="https://github.com/apple/swift/blob/master/docs/ABIStabilityManifesto.md" target="_blank" rel="external">ABI ç¨³å®š</a>çš„ä¸€éƒ¨åˆ†å»æ€è€ƒã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å†³å®šåœ¨ <a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170213/032116.html" target="_blank" rel="external">ç¬¬äºŒé˜¶æ®µ</a> <a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170213/032118.html" target="_blank" rel="external">å±•å¼€å…³äºå­—å…¸çš„è®¨è®º</a>çš„åŸå› ã€‚  </p>
<p>å¯¹äº <a href="https://github.com/apple/swift-evolution/blob/master/releases/swift-3_0.md" target="_blank" rel="external">Swift 3</a> å’Œ <a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20160725/025676.html" target="_blank" rel="external">Swift 4</a> ï¼Œæ ¸å¿ƒå›¢é˜Ÿç»™æ¯ä¸€ä¸ªç‰ˆæœ¬éƒ½è®¾å®šäº†ä¸»é¢˜ã€‚<strong>æ ¸å¿ƒå›¢é˜Ÿæƒ³è¦åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè®©ç¤¾åŒºæ›´æ—©åŠ å…¥åˆ°è®¨è®ºä¸­ï¼Œå¸®åŠ©æ ¸å¿ƒå›¢é˜Ÿå†³å®šæ¥ä¸‹æ¥çš„ç›®æ ‡ï¼Œä½†ä¹Ÿä¼šåŒæ—¶æ€è€ƒæ›´å¥½çš„æ–¹å¼ã€‚</strong></p>
</blockquote>
<p>Swift 4.0 çš„å¼€å‘å‘¨æœŸå·²ç»è¿‡åŠï¼Œä½†è¿˜ä¸èƒ½å¤ªæ—©å†³å®šæ¥ä¸‹æ¥ Swift 5 çš„ç›®æ ‡ã€‚ <a href="https://github.com/apple/swift/blob/master/docs/ABIStabilityManifesto.md" target="_blank" rel="external">ABI ç¨³å®š</a> è‚¯å®šä¼˜å…ˆï¼Œä½†é™¤æ­¤ä¹‹å¤–å‘¢ï¼Ÿå­—ç¬¦ä¸²å†è¿›ä¸€æ­¥çš„æ”¹è¿›ï¼Ÿå¼‚æ­¥ï¼Ÿåå°„?</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šOle Begemannï¼Œ&lt;a href=&quot;https://oleb.net/blog/2017/03/swift-themed-releases/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-03-20&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://kemchenj.github.io&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;å››å¨˜&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://weibo.com/277195544&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cwift&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;å¤§æ¦‚ä¸€ä¸ªæ˜ŸæœŸä¹‹å‰ï¼Œ&lt;a href=&quot;https://swift.org/community/#core-team&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Swift æ ¸å¿ƒå›¢é˜Ÿ&lt;/a&gt;æˆå‘˜ Ben Cohen åœ¨ &lt;a href=&quot;https://swift.org/community/#swift-evolution&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Swift-Evolution&lt;/a&gt; å‘äº†&lt;a href=&quot;https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170306/033699.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ä¸€æ¡çš„å¾ˆå€¼å¾—æ€è€ƒçš„ä¿¡æ¯&lt;/a&gt;ï¼Œå›ç­”äº†ä¸€ä¸ª&lt;a href=&quot;https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20170220/033092.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;é—®é¢˜&lt;/a&gt; â€” å†ç»™ &lt;a href=&quot;https://github.com/apple/swift/blob/master/CHANGELOG.md#swift-40&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Swift 4&lt;/a&gt; æä¸€ä¸ªæ–°ææ¡ˆ, è¢«é€šè¿‡çš„å‡ ç‡æœ‰å¤šå¤§ã€‚&lt;/p&gt;
&lt;p&gt;Ben é˜è¿°äº†æ ¸å¿ƒå›¢é˜Ÿå†³å®šææ¡ˆæ˜¯å¦è¦æ¨è¿Ÿçš„ä¸»è¦ä¾æ®ã€‚ä¸»æ—¨å°±æ˜¯ Swift æ¯ä¸€ä¸ªç‰ˆæœ¬éƒ½åº”è¯¥ä¸“æ³¨äºä¸€å°éƒ¨åˆ†ä¸»é¢˜ï¼Œç¬¦åˆä¸»é¢˜çš„ææ¡ˆç»™äºˆæ›´é«˜çš„ä¼˜å…ˆçº§ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Ole Begemann" scheme="https://swift.gg/categories/Ole-Begemann/"/>
    
    
      <category term="Swift è¿›é˜¶" scheme="https://swift.gg/tags/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>SpriteKit æŠ€å·§ä¹‹æ·»åŠ èƒŒæ™¯å›¾ç‰‡</title>
    <link href="https://swift.gg/2017/05/19/display-background-with-spritekit-ios-tutorial-ios10/"/>
    <id>https://swift.gg/2017/05/19/display-background-with-spritekit-ios-tutorial-ios10/</id>
    <published>2017-05-18T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šArthur Knopperï¼Œ<a href="https://www.ioscreator.com/tutorials/display-background-with-spritekit-ios-tutorial-ios10" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017/01/17<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›æ ¡å¯¹ï¼š<a href="http://chengway.in/" target="_blank" rel="external">walkingway</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>Sprite Kit æ˜¯ç¡¬ä»¶åŠ é€Ÿçš„åŠ¨ç”»ç³»ç»Ÿï¼Œä¸ºåˆ›å»º 2D æ¸¸æˆè¿›è¡Œäº†ä¸“é—¨çš„ä¼˜åŒ–ã€‚åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œå°†ä½¿ç”¨ Game æ¨¡æ¿æ¥æ·»åŠ ä¸€å¼ èƒŒæ™¯å›¾ç‰‡ã€‚æœ¬èŠ‚æ•™ç¨‹ä½¿ç”¨çš„æ˜¯ Xcode 8.2.1 å’Œ iOS 10.2ã€‚</p>
<a id="more"></a>
<p>æ‰“å¼€ Xcodeï¼Œé€‰æ‹© iOS -&gt; Application -&gt; Game æ¨¡æ¿ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/587dfce23a04118eabdf7d95/1484651758293/?format=1500w" alt=""></p>
<p>Product Name ä½¿ç”¨ <strong>SpriteKitBackgroundTutorial</strong>ï¼Œå¡«å†™è‡ªå·±çš„ Organization Name å’Œ Organization Identifierï¼ŒLanguage ä¸€æ é€‰æ‹© Swiftï¼ŒGame Technology ä¸€æ é€‰æ‹© SpriteKitï¼ŒDevices ä¸€æ é€‰æ‹© iPhoneã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/58ff88c71b10e3c8c1dc6a0d/1493141718478/facebook-project?format=1500w" alt=""></p>
<p>æœ¬èŠ‚æ•™ç¨‹éœ€è¦ä¸€å¼ å›¾ç‰‡ä½œä¸ºèƒŒæ™¯å›¾ï¼Œä»è¿™é‡Œ<a href="https://www.ioscreator.com/s/background.jpg" target="_blank" rel="external">ä¸‹è½½</a>å›¾ç‰‡ï¼Œæ·»åŠ åˆ°å·¥ç¨‹ä¸­ï¼Œç¡®ä¿åœ¨æ·»åŠ æ—¶é€‰æ‹© â€œCopy items if neededâ€ é€‰é¡¹ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/587dff5d46c3c46130f0a478/1484652392518/?format=1500w" alt=""></p>
<p>åœ¨ Xcode çš„ Game æ¨¡æ¿ä¸­ï¼Œå·²ç»åšäº†å¾ˆå¤šåˆå§‹åŒ–çš„å·¥ä½œã€‚åœ¨ Sprite Kit æ¡†æ¶ä¸­ï¼Œæ¯ä¸ªåœºæ™¯ï¼ˆsceneï¼‰æ§åˆ¶ App çš„ä¸€å±ï¼ˆscreenï¼‰ã€‚æ‰¾åˆ° <strong>GameViewController.swift</strong> æ–‡ä»¶ï¼Œåœ¨ GameViewController ç±»é‡Œï¼Œå·²ç»å®šä¹‰å¥½äº† <strong>viewDidLoad</strong> æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œåˆ›å»ºåœºæ™¯ï¼Œå‘ˆç° GameScene å¯¹è±¡ã€‚å°† viewDidLoad æ–¹æ³•ä»£ç æ›´æ”¹æˆå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        </div><div class="line">    <span class="keyword">let</span> scene = <span class="type">GameScene</span>(size:<span class="type">CGSize</span>(width: <span class="number">1080</span>, height: <span class="number">1920</span>))</div><div class="line">        </div><div class="line">    <span class="keyword">let</span> skView = <span class="keyword">self</span>.view <span class="keyword">as</span>! <span class="type">SKView</span></div><div class="line">    scene.scaleMode = .aspectFill</div><div class="line">    skView.presentScene(scene)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰¾åˆ° <strong>GameScene.swift</strong> æ–¹æ³•ï¼Œå·²ç»å®šä¹‰å¥½äº† GameScene ç±»ï¼Œåœ¨ <strong>didMove</strong> æ–¹æ³•ä¸­ï¼Œå®ç°è‡ªå®šä¹‰çš„ä»£ç ã€‚åˆ é™¤ GameScene ç±»é‡Œé¢æ‰€æœ‰çš„ä»£ç ï¼Œç„¶åæ·»åŠ  didMove æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">GameScene</span>: <span class="title">SKScene</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">didMove</span><span class="params">(to view: SKView)</span></span> &#123;</div><div class="line">        <span class="keyword">let</span> background = <span class="type">SKSpriteNode</span>(imageNamed: <span class="string">"background.jpg"</span>)</div><div class="line">        background.position = <span class="type">CGPoint</span>(x: size.width/<span class="number">2</span>, y: size.height/<span class="number">2</span>)</div><div class="line">        addChild(background)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Sprite Kit æ¡†æ¶æœ‰ä¸ªæŒ‡å®šçš„ç±»æ¥åˆ›å»ºæ§åˆ¶ spriteï¼ˆç²¾çµï¼‰ï¼ˆè¯‘è€…æ³¨ï¼šsprite æ˜¯è®¡ç®—æœºå›¾å½¢å­¦çš„ä¸“æœ‰åè¯ï¼Œæ„ä¸ºåŒ…å«äºåœºæ™¯ä¸­çš„äºŒç»´å›¾åƒæˆ–åŠ¨ç”»ï¼‰ï¼Œå°±æ˜¯ SKSpriteNode ç±»ã€‚åœ¨è¯¥èŠ‚ç‚¹ï¼ˆnodeï¼‰ä¸‹ï¼Œå›¾ç‰‡åŠ è½½å®Œæˆã€‚æ¥ä¸‹æ¥ï¼Œå°†å›¾ç‰‡æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚æœ€åï¼Œåˆ é™¤ GameScene.sks å’Œ Action.sks æ–‡ä»¶ï¼Œç›®å‰ä¸éœ€è¦è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚</p>
<p><strong>è¿è¡Œ</strong>å·¥ç¨‹ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/587e00d546c3c46130f0ae45/1484652772003/?format=750w" alt=""></p>
<p>å¯ä»¥ä» <a href="https://github.com/ioscreator/ioscreator" target="_blank" rel="external">github</a> ä¸Šä¸‹è½½ <strong>SpriteKitBackgroundTutorial</strong> æ•™ç¨‹çš„æºä»£ç ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šArthur Knopperï¼Œ&lt;a href=&quot;https://www.ioscreator.com/tutorials/display-background-with-spritekit-ios-tutorial-ios10&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017/01/17&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;http://www.jianshu.com/users/7a2d2cc38444/latest_articles&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Crystal Sun&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://chengway.in/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;walkingway&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;Sprite Kit æ˜¯ç¡¬ä»¶åŠ é€Ÿçš„åŠ¨ç”»ç³»ç»Ÿï¼Œä¸ºåˆ›å»º 2D æ¸¸æˆè¿›è¡Œäº†ä¸“é—¨çš„ä¼˜åŒ–ã€‚åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œå°†ä½¿ç”¨ Game æ¨¡æ¿æ¥æ·»åŠ ä¸€å¼ èƒŒæ™¯å›¾ç‰‡ã€‚æœ¬èŠ‚æ•™ç¨‹ä½¿ç”¨çš„æ˜¯ Xcode 8.2.1 å’Œ iOS 10.2ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="IOSCREATOR" scheme="https://swift.gg/categories/IOSCREATOR/"/>
    
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/tags/iOS-%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>æ”¹å˜çŠ¶æ€æ çš„é¢œè‰²</title>
    <link href="https://swift.gg/2017/05/18/change-color-status-bar-tutorial/"/>
    <id>https://swift.gg/2017/05/18/change-color-status-bar-tutorial/</id>
    <published>2017-05-17T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šArthur Knopperï¼Œ<a href="https://www.ioscreator.com/tutorials/change-color-status-bar-tutorial" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016/12/29<br>è¯‘è€…ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›æ ¡å¯¹ï¼š<a href="http://chengway.in/" target="_blank" rel="external">walkingway</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>çŠ¶æ€æ å¯ä»¥æœ‰ä¸¤ç§å¤–è§‚ï¼šdarkï¼ˆé»‘è‰²ï¼‰ å’Œ lightï¼ˆç™½è‰²ï¼‰ã€‚åœ¨æœ¬ç« æ•™ç¨‹ä¸­ï¼Œå°†å­¦ä¹ å¦‚ä½•æ”¹å˜çŠ¶æ€æ çš„å¤–è§‚ã€‚æœ¬èŠ‚æ•™ç¨‹ä½¿ç”¨çš„æ˜¯ Xcode 8.0 å’Œ iOS 10ã€‚</p>
<a id="more"></a>
<p>æ‰“å¼€ Xcodeï¼Œåˆ›å»ºä¸€ä¸ª Single View Applicationã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/58ff88928419c2b2a27d0754/1493141675229/single-view-xcode-template?format=1500w" alt=""></p>
<p>Product Name ä½¿ç”¨ <strong>IOS10StatusBarColorTutorial</strong>ï¼Œå¡«å†™è‡ªå·±çš„ Organization Name å’Œ Organization Identifierï¼ŒLanguage ä¸€æ é€‰æ‹© Swiftï¼ŒDevices ä¸€æ é€‰æ‹© iPhoneã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/57ea5a84e58c62718aa3048b/1474976400272/?format=1500w" alt=""></p>
<p>æ‰“å¼€ Storyboardï¼Œé€‰ä¸­ Viewï¼Œåœ¨ Attributes Inspetor é‡Œå°† Background Color æ”¹æˆ Light Grayã€‚è¿è¡Œå·¥ç¨‹ï¼Œé»˜è®¤çš„çŠ¶æ€æ é¢œè‰²æ˜¯é»‘è‰²ï¼ˆdarkï¼‰ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/57ea5aa5e58c62718aa30530/1474976432868/?format=750w" alt=""></p>
<p>è€Œæˆ‘ä»¬æƒ³è¦å®ç°çš„æ•ˆæœæ˜¯ç™½è‰²çš„çŠ¶æ€æ ã€‚æ‰“å¼€ ViewController.swift æ–‡ä»¶ï¼Œæ·»åŠ ä¸‹åˆ—ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="keyword">var</span> preferredStatusBarStyle: <span class="type">UIStatusBarStyle</span> &#123;</div><div class="line">    <span class="keyword">return</span> .lightContent</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä»£ç å°† UIStatusBarStyle æšä¸¾é¡¹è®¾ä¸º lightContentã€‚è¿è¡Œå·¥ç¨‹ï¼Œè¿™æ—¶çŠ¶æ€æ çš„é¢œè‰²å˜æˆäº†ç™½è‰²ï¼ˆlightï¼‰ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/57ea5ad8e58c62718aa3063d/1474976482842/?format=750w" alt=""></p>
<p>æ¥ä¸‹æ¥å›åˆ° Storyboardï¼Œé€‰ä¸­ View Controllerï¼Œåœ¨ Editor èœå•ä¸­é€‰æ‹© Embed in Navigation Controllerã€‚é€‰ä¸­ Navigation Barï¼Œåœ¨ Attribute Inspector é‡Œå°† Bar Tint color è®¾ç½®ä¸º redã€‚storyboard åº”è¯¥å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/57eaaf88893fc08c39f02235/1474998157337/?format=1500w" alt=""></p>
<p>è¿è¡Œå·¥ç¨‹ï¼ŒçŠ¶æ€æ åˆå˜æˆäº†é»‘è‰²ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤çŠ¶æ€ã€‚äº§ç”Ÿè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ï¼ŒiOS è¯·æ±‚çš„æ˜¯ navigation controller çŠ¶æ€æ é£æ ¼ï¼Œä¸æ˜¯ navigation controller æ‰€åŒ…å«çš„ controller é£æ ¼ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/57eab046bebafbd7890070a9/1474998347300/?format=750w" alt=""></p>
<p>ä¸ºäº†æ”¹å˜ Navigation controller çš„é£æ ¼ï¼ˆstyleï¼‰ï¼Œéœ€è¦åœ¨ <strong>AppDelegate.swift</strong> æ–‡ä»¶é‡Œå¦‚ä¸‹ä¿®æ”¹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(<span class="number">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?)</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">    <span class="comment">// Override point for customization after application launch.</span></div><div class="line">        </div><div class="line">    <span class="type">UINavigationBar</span>.appearance().barStyle = .blackOpaque</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿è¡Œå·¥ç¨‹ï¼Œè¿™æ—¶çŠ¶æ€æ çš„é¢œè‰²å˜æˆäº†ç™½è‰²ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/57eab0ce37c581c584f0a3a9/1474998487766/?format=750w" alt=""></p>
<p>å¯ä»¥ä» <a href="https://github.com/ioscreator/ioscreator" target="_blank" rel="external">github</a> ä¸Šä¸‹è½½ <strong>IOS10StatusBarColorTutorial</strong> æ•™ç¨‹çš„æºä»£ç ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      iOS å¼€å‘ä¸­å¦‚ä½•æ”¹å˜çŠ¶æ€æ çš„é¢œè‰²
    
    </summary>
    
      <category term="IOSCREATOR" scheme="https://swift.gg/categories/IOSCREATOR/"/>
    
    
      <category term="iOS å…¥é—¨" scheme="https://swift.gg/tags/iOS-%E5%85%A5%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>Unowned è¿˜æ˜¯ Weakï¼Ÿç”Ÿå‘½å‘¨æœŸå’Œæ€§èƒ½å¯¹æ¯”</title>
    <link href="https://swift.gg/2017/05/16/unowned-or-weak-lifetime-and-performance/"/>
    <id>https://swift.gg/2017/05/16/unowned-or-weak-lifetime-and-performance/</id>
    <published>2017-05-15T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šUmberto Raimondiï¼Œ<a href="https://www.uraimo.com/2016/10/27/unowned-or-weak-lifetime-and-performance/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016-10-27<br>è¯‘è€…ï¼š<a href="http://codebuild.me/" target="_blank" rel="external">shanks</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>æ¯å½“å¤„ç†å¾ªç¯å¼•ç”¨ï¼ˆretain cyclesï¼‰æ—¶ï¼Œéœ€è¦è€ƒé‡å¯¹è±¡ç”Ÿå‘½å‘¨æœŸæ¥é€‰æ‹©<code>unowned</code>æˆ–è€…<code>weak</code>æ ‡è¯†ç¬¦ï¼Œè¿™å·²ç»æˆä¸ºäº†ä¸€ä¸ªå…±è¯†ã€‚ä½†æ˜¯æœ‰æ—¶ä»ç„¶ä¼šå¿ƒå­˜ç–‘é—®ï¼Œåœ¨å…·ä½“çš„ä½¿ç”¨ä¸­åº”è¯¥é€‰æ‹©å“ªä¸€ä¸ªï¼Œæˆ–è€…é€€ä¸€æ­¥è®²ï¼Œä¿å®ˆçš„åªä½¿ç”¨ weak æ˜¯ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©å‘¢ï¼Ÿ</p>
<p>æœ¬æ–‡é¦–å…ˆå¯¹å¾ªç¯å¼•ç”¨çš„åŸºç¡€çŸ¥è¯†åšä¸€ä¸ªç®€è¦ä»‹ç»ï¼Œç„¶åä¼šåˆ†æ Swift æºä»£ç çš„ä¸€äº›ç‰‡æ®µï¼Œè®²è§£ <code>unowned</code> å’Œ <code>weak</code>  åœ¨ç”Ÿå‘½å‘¨æœŸå’Œæ€§èƒ½ä¸Šçš„å·®å¼‚ç‚¹ï¼Œå¸Œæœ›çœ‹å®Œæœ¬æ–‡ä»¥åï¼Œåœ¨çš„ä½¿ç”¨åœºæ™¯ä¸­ï¼Œèƒ½ä½¿ç”¨æ­£ç¡®çš„å¼±å¼•ç”¨ç±»å‹ã€‚</p>
<a id="more"></a>
<p><strong>ç›®å½•:</strong></p>
<ul>
<li><a href="#the_basic">åŸºç¡€çŸ¥è¯†</a></li>
<li><a href="#the_question_unowned_or_weak">é—®é¢˜æ¥äº†: unowened è¿˜æ˜¯ weak?</a></li>
<li><a href="#performance_a_look_under_the_hood">æ€§èƒ½ï¼šæ·±åº¦æ¢ç´¢</a></li>
<li><a href="#deconstructing_capture_lists_handling">æ•è·åˆ—è¡¨å¤„ç†è§£æ</a></li>
<li><a href="#conclusion">ç»“è®º</a></li>
<li><a href="#footnotes">è„šæ³¨</a></li>
</ul>
<blockquote>
<p>ä» <a href="https://github.com/uraimo/Swift-Playgrounds" target="_blank" rel="external">GitHub</a> æˆ–è€… <a href="https://www.uraimo.com/archives/2016-10-27-UnownedWeakPlayground.playground.zip" target="_blank" rel="external">zipped</a> è·å–æœ¬æ–‡ç›¸å…³çš„ Playground ä»£ç ã€‚ç„¶åä»<a href="https://www.uraimo.com/archives/closure.zip" target="_blank" rel="external">è¿™é‡Œ</a>è·å–é—­åŒ…æ¡ˆä¾‹å’Œ SILï¼ŒSILGen ä»¥åŠ LLVM IR çš„è¾“å‡ºã€‚</p>
</blockquote>
<p><a name="the_basic"></a></p>
<h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œ<code>Swift</code> åˆ©ç”¨å¤è€å¹¶ä¸”æœ‰æ•ˆçš„è‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼ˆARC, Automatic Reference Countingï¼‰æ¥ç®¡ç†å†…å­˜ï¼Œå¸¦æ¥çš„åæœå’Œåœ¨ Objective-C ä¸­ä½¿ç”¨çš„æƒ…å†µç±»ä¼¼ï¼Œéœ€è¦æ‰‹åŠ¨ä½¿ç”¨å¼±å¼•ç”¨æ¥è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</p>
<p>å¦‚æœå¯¹ <code>ARC</code> ä¸äº†è§£ï¼Œåªéœ€è¦çŸ¥é“çš„æ˜¯ï¼Œæ¯ä¸€ä¸ª<em>å¼•ç”¨ç±»å‹</em>å®ä¾‹éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°ä¸ä¹‹å…³è”ï¼Œè¿™ä¸ªå¼•ç”¨è®¡æ•°ç”¨æ¥è®°å½•è¿™ä¸ªå¯¹è±¡å®ä¾‹æ­£åœ¨è¢«å˜é‡æˆ–å¸¸é‡å¼•ç”¨çš„æ€»æ¬¡æ•°ã€‚å½“å¼•ç”¨è®¡æ•°å˜ä¸º <code>0</code> æ—¶ï¼Œå®ä¾‹å°†ä¼šè¢«ææ„ï¼Œå®ä¾‹å æœ‰çš„å†…å­˜å’Œèµ„æºéƒ½å°†å˜å¾—é‡æ–°å¯ç”¨ã€‚</p>
<p>å½“æœ‰ä¸¤ä¸ªå®ä¾‹é€šè¿‡æŸç§å½¢å¼äº’ç›¸å¼•ç”¨æ—¶ï¼Œå°±ä¼šå½¢æˆå¾ªç¯å¼•ç”¨ï¼ˆæ¯”å¦‚ï¼šä¸¤ä¸ªç±»å®ä¾‹éƒ½æœ‰ä¸€ä¸ªå±æ€§æŒ‡å‘å¯¹æ–¹çš„ç±»å®ä¾‹ï¼›åŒå‘é“¾è¡¨ä¸­ä¸¤ä¸ªç›¸é‚»çš„èŠ‚ç‚¹å®ä¾‹ç­‰â€¦ï¼‰, ç”±äºä¸¤ä¸ªå®ä¾‹çš„å¼•ç”¨è®¡æ•°éƒ½ä¸€ç›´å¤§äº <code>0</code>ï¼Œ å¾ªç¯å¼•ç”¨å°†ä¼šé˜»æ­¢è¿™äº›å®ä¾‹çš„ææ„ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå’Œå…¶ä»–ä¸€äº›æœ‰ç±»ä¼¼é—®é¢˜çš„è¯­è¨€ä¸€æ ·ï¼Œ åœ¨ <code>Swift</code> ä¸­ï¼Œ<em>å¼±å¼•ç”¨</em> çš„æ¦‚å¿µè¢«æäº†å‡ºæ¥ï¼Œå¼±å¼•ç”¨ä¸ä¼šè¢« <code>ARC</code> è®¡ç®—ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸€ä¸ªå¼±å¼•ç”¨æŒ‡å‘ä¸€ä¸ªå¼•ç”¨ç±»å‹å®ä¾‹æ—¶ï¼Œå¼•ç”¨è®¡æ•°ä¸ä¼šå¢åŠ ã€‚</p>
<p>å¼±å¼•ç”¨ä¸ä¼šé˜»æ­¢å®ä¾‹çš„ææ„, åªéœ€è¦è®°ä½çš„æ˜¯ï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå¼±å¼•ç”¨éƒ½ä¸ä¼šæ‹¥æœ‰å®ƒæŒ‡å‘çš„å¯¹è±¡ã€‚åœ¨æ­£å¼çš„åœºæ™¯ä¸­ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬å¤„ç†è¿™ç±»å¼•ç”¨çš„æ—¶å€™ï¼Œéœ€è¦æ„è¯†åˆ°è¿™ä¸€ç‚¹ã€‚</p>
<p>åœ¨ Swift ä¸­æœ‰ 2 ç§ <em>å¼±</em> å¼•ç”¨å½¢å¼ï¼Œ<code>unowned</code> å’Œ <code>weak</code>ã€‚</p>
<p>è™½ç„¶å®ƒä»¬çš„ä½œç”¨ç±»ä¼¼ï¼Œä½†ä¸å®ƒä»¬ç›¸å…³å®ä¾‹ç”Ÿå‘½å‘¨æœŸçš„å‡è®¾ä¼šç•¥æœ‰ä¸åŒï¼Œå¹¶ä¸”å…·æœ‰ä¸åŒçš„æ€§èƒ½ç‰¹å¾ã€‚</p>
<p>ä¸ºäº†ä¸¾ä¾‹è¯´æ˜å¾ªç¯å¼•ç”¨ï¼Œè¿™é‡Œä¸ä½¿ç”¨å¤§å®¶æœŸæœ›çœ‹åˆ°çš„ç±»ä¹‹é—´çš„å¾ªç¯å¼•ç”¨ï¼Œè€Œä½¿ç”¨é—­åŒ…çš„ä¸Šä¸‹æ–‡æ¡ˆä¾‹ï¼Œè¿™åœ¨ <code>Objective-C</code> æ—¥å¸¸å¼€å‘ä¸­å¤„ç†å¾ªç¯å¼•ç”¨æ—¶ç»å¸¸ä¼šé‡åˆ°çš„æƒ…å†µã€‚å’Œç±»çš„å¾ªç¯å¼•ç”¨ç±»ä¼¼ï¼Œé€šè¿‡åˆ›å»ºä¸€ä¸ªå¼ºå¼•ç”¨æŒ‡å‘å¤–éƒ¨å®ä¾‹ï¼Œæˆ–æ•è·å®ƒï¼Œé˜»æ­¢å®ƒææ„ã€‚</p>
<p>åœ¨ <code>Objective-C</code> ï¼ŒæŒ‰ç…§æ ‡å‡†çš„åšæ³•ï¼Œå®šä¹‰ä¸€ä¸ªå¼±å¼•ç”¨æŒ‡å‘é—­åŒ…å¤–éƒ¨çš„å®ä¾‹ï¼Œç„¶ååœ¨é—­åŒ…å†…éƒ¨å®šä¹‰å¼ºå¼•ç”¨æŒ‡å‘è¿™ä¸ªå®ä¾‹ï¼Œåœ¨é—­åŒ…æ‰§è¡ŒæœŸé—´ä½¿ç”¨å®ƒã€‚å½“ç„¶ï¼Œæœ‰å¿…è¦åœ¨ä½¿ç”¨å‰æ£€æŸ¥å¼•ç”¨çš„æœ‰æ•ˆæ€§ã€‚</p>
<p>ä¸ºäº†æ›´æ–¹ä¾¿çš„å¤„ç†å¾ªç¯å¼•ç”¨ï¼Œ<code>Swift</code> å¼•å…¥äº†ä¸€ä¸ªæ–°çš„æ¦‚å¿µï¼Œç”¨äºç®€åŒ–å’Œæ›´åŠ æ˜æ˜¾åœ°è¡¨è¾¾åœ¨é—­åŒ…å†…éƒ¨å¤–éƒ¨å˜é‡çš„æ•è·ï¼š<em>æ•è·åˆ—è¡¨ï¼ˆcapture listï¼‰</em>ã€‚ä½¿ç”¨æ•è·åˆ—è¡¨ï¼Œå¯ä»¥åœ¨å‡½æ•°çš„å¤´éƒ¨å®šä¹‰å’ŒæŒ‡å®šé‚£äº›éœ€è¦ç”¨åœ¨å†…éƒ¨çš„å¤–éƒ¨å˜é‡ï¼Œå¹¶ä¸”æŒ‡å®šå¼•ç”¨ç±»å‹(è¯‘è€…æ³¨ï¼šè¿™é‡Œæ˜¯æŒ‡ <code>unowned</code> å’Œ <code>weak</code>ï¼‰ã€‚</p>
<p>æ¥ä¸‹æ¥ä¸¾ä¸€äº›ä¾‹å­ï¼Œåœ¨å„ç§æƒ…å†µä¸‹æ•è·å˜é‡çš„è¡¨ç°ã€‚</p>
<p>å½“ä¸ä½¿ç”¨æ•è·åˆ—è¡¨æ—¶ï¼Œé—­åŒ…å°†ä¼šåˆ›å»ºä¸€ä¸ªå¤–éƒ¨å˜é‡çš„å¼ºå¼•ç”¨ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> i1 = <span class="number">1</span>, i2 = <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> fStrong = &#123;</div><div class="line">    i1 += <span class="number">1</span></div><div class="line">    i2 += <span class="number">2</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">fStrong()</div><div class="line"><span class="built_in">print</span>(i1,i2) <span class="comment">//Prints 2 and 3</span></div></pre></td></tr></table></figure>
<p>é—­åŒ…å†…éƒ¨å¯¹å˜é‡çš„ä¿®æ”¹å°†ä¼šæ”¹å˜å¤–éƒ¨åŸå§‹å˜é‡çš„å€¼ï¼Œè¿™ä¸é¢„æœŸæ˜¯ä¸€è‡´çš„ã€‚</p>
<p>ä½¿ç”¨æ•è·åˆ—è¡¨ï¼Œé—­åŒ…å†…éƒ¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯ç”¨å¸¸é‡ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šå¸¸é‡ä¿®é¥°ç¬¦ï¼Œé—­åŒ…å°†ä¼šç®€å•åœ°æ‹·è´åŸå§‹å€¼åˆ°æ–°çš„å˜é‡ä¸­ï¼Œå¯¹äºå€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> fCopy = &#123; [i1] <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(i1,i2)</div><div class="line">&#125;</div><div class="line"></div><div class="line">fStrong()</div><div class="line"><span class="built_in">print</span>(i1,i2) <span class="comment">//æ‰“å°ç»“æœæ˜¯ 2 å’Œ 3  </span></div><div class="line"></div><div class="line">fCopy()  <span class="comment">//æ‰“å°ç»“æœæ˜¯ 1 å’Œ 3</span></div></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œåœ¨è°ƒç”¨ <code>fStrong</code> ä¹‹å‰å®šä¹‰å‡½æ•° <code>fCopy</code> ,åœ¨è¯¥å‡½æ•°å®šä¹‰çš„æ—¶å€™ï¼Œç§æœ‰å¸¸é‡å·²ç»è¢«åˆ›å»ºäº†ã€‚æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œå½“è°ƒç”¨ç¬¬äºŒä¸ªå‡½æ•°æ—¶å€™ï¼Œä»ç„¶æ‰“å° <code>i1</code> çš„åŸå§‹å€¼ã€‚</p>
<p>å¯¹äºå¤–éƒ¨å¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œåœ¨æ•è·åˆ—è¡¨ä¸­æŒ‡å®š <code>weak</code> æˆ– <code>unowned</code>ï¼Œè¿™ä¸ªå¸¸é‡å°†ä¼šè¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªå¼±å¼•ç”¨ï¼ŒæŒ‡å‘åŸå§‹å€¼ï¼Œè¿™ç§æŒ‡å®šçš„æ•è·æ–¹å¼å°±æ˜¯ç”¨æ¥å¤„ç†å¾ªç¯å¼•ç”¨çš„æ–¹å¼ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">aClass</span></span>&#123;</div><div class="line">    <span class="keyword">var</span> value = <span class="number">1</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> c1 = aClass()</div><div class="line"><span class="keyword">var</span> c2 = aClass()</div><div class="line"></div><div class="line"><span class="keyword">var</span> fSpec = &#123; [<span class="keyword">unowned</span> c1, <span class="keyword">weak</span> c2] <span class="keyword">in</span></div><div class="line">    c1.value += <span class="number">1</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> c2 = c2 &#123;</div><div class="line">        c2.value += <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">fSpec()</div><div class="line"><span class="built_in">print</span>(c1.value,c2.value) <span class="comment">//Prints 2 and 2</span></div></pre></td></tr></table></figure>
<p>ä¸¤ä¸ª <code>aClass</code> æ•è·å®ä¾‹çš„ä¸åŒçš„å®šä¹‰æ–¹å¼ï¼Œå†³å®šäº†å®ƒä»¬åœ¨é—­åŒ…ä¸­ä¸åŒçš„ä½¿ç”¨æ–¹å¼ã€‚</p>
<p>unowned å¼•ç”¨ä½¿ç”¨çš„åœºæ™¯æ˜¯ï¼ŒåŸå§‹å®ä¾‹æ°¸è¿œä¸ä¼šä¸º <em>nil</em>ï¼Œé—­åŒ…å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒï¼Œå¹¶ä¸”ç›´æ¥å®šä¹‰ä¸ºæ˜¾å¼è§£åŒ…å¯é€‰å€¼ã€‚å½“åŸå§‹å®ä¾‹è¢«ææ„åï¼Œåœ¨é—­åŒ…ä¸­ä½¿ç”¨è¿™ä¸ªæ•è·å€¼å°†å¯¼è‡´å´©æºƒã€‚</p>
<p>å¦‚æœæ•è·åŸå§‹å®ä¾‹åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å¯èƒ½ä¸º <em>nil</em> ï¼Œå¿…é¡»å°†å¼•ç”¨å£°æ˜ä¸º <code>weak</code>ï¼Œ å¹¶ä¸”åœ¨ä½¿ç”¨ä¹‹å‰éªŒè¯è¿™ä¸ªå¼•ç”¨çš„æœ‰æ•ˆæ€§ã€‚</p>
<p><a name="the_question_unowned_or_weak"></a></p>
<h3 id="é—®é¢˜æ¥äº†-unowened-è¿˜æ˜¯-weak"><a href="#é—®é¢˜æ¥äº†-unowened-è¿˜æ˜¯-weak" class="headerlink" title="é—®é¢˜æ¥äº†: unowened è¿˜æ˜¯ weak?"></a>é—®é¢˜æ¥äº†: unowened è¿˜æ˜¯ weak?</h3><p>åœ¨å®é™…ä½¿ç”¨ä¸­å¦‚ä½•é€‰æ‹©è¿™ä¸¤ç§å¼±å¼•ç”¨ç±»å‹å‘¢ï¼Ÿ</p>
<p>è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå¯ä»¥ç®€å•ç”±åŸå§‹å¯¹è±¡å’Œå¼•ç”¨å®ƒçš„é—­åŒ…çš„<strong>ç”Ÿå‘½å‘¨æœŸæ¥è§£é‡Š</strong>ã€‚</p>
<p><img src="https://www.uraimo.com/imgs/unownedbig.png" alt=""></p>
<p>æœ‰ä¸¤ä¸ªå¯èƒ½å‡ºç°çš„åœºæ™¯ï¼š</p>
<ul>
<li><p>é—­åŒ…å’Œæ•è·å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç›¸åŒï¼Œæ‰€ä»¥å¯¹è±¡å¯ä»¥è¢«è®¿é—®ï¼Œä¹Ÿå°±æ„å‘³ç€é—­åŒ…ä¹Ÿå¯ä»¥è¢«è®¿é—®ã€‚å¤–éƒ¨å¯¹è±¡å’Œé—­åŒ…æœ‰ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸ(æ¯”å¦‚ï¼šå¯¹è±¡å’Œå®ƒçš„çˆ¶å¯¹è±¡çš„ç®€å•è¿”å›å¼•ç”¨ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥æŠŠå¼•ç”¨å®šä¹‰ä¸º <strong>unowned</strong>ã€‚</p>
<p>ä¸€ä¸ªç»å…¸çš„æ¡ˆä¾‹æ˜¯: <code>[unowned self]</code>, ä¸»è¦ç”¨åœ¨é—­åŒ…ä¸­ï¼Œè¿™ç§é—­åŒ…ä¸»è¦åœ¨ä»–ä»¬çš„çˆ¶èŠ‚ç‚¹ä¸Šä¸‹æ–‡ä¸­åšä¸€äº›äº‹æƒ…ï¼Œæ²¡æœ‰åœ¨å…¶ä»–åœ°æ–¹è¢«å¼•ç”¨æˆ–ä¼ é€’ï¼Œä¸èƒ½ä½œç”¨åœ¨çˆ¶èŠ‚ç‚¹ä¹‹å¤–ã€‚</p>
</li>
</ul>
<ul>
<li><p>é—­åŒ…çš„ç”Ÿå‘½å‘¨æœŸå’Œæ•è·å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç›¸äº’ç‹¬ç«‹ï¼Œå½“å¯¹è±¡ä¸èƒ½å†ä½¿ç”¨æ—¶ï¼Œé—­åŒ…ä¾ç„¶èƒ½å¤Ÿè¢«å¼•ç”¨ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥æŠŠå¼•ç”¨å®šä¹‰ä¸º <code>weak</code>ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨å®ƒä¹‹å‰éªŒè¯ä¸€ä¸‹å®ƒæ˜¯å¦ä¸º <code>nil</code>ï¼ˆè¯·ä¸è¦å¯¹å®ƒè¿›è¡Œå¼ºåˆ¶è§£åŒ…).</p>
<p>ä¸€ä¸ªç»å…¸çš„æ¡ˆä¾‹æ˜¯: <code>[weak delegate = self.delegate!]</code>ï¼Œå¯ä»¥åœ¨æŸäº›ä½¿ç”¨é—­åŒ…çš„åœºæ™¯ä¸­çœ‹åˆ°ï¼Œé—­åŒ…ä½¿ç”¨çš„æ˜¯å®Œå…¨æ— å…³ï¼ˆç”Ÿå‘½å‘¨æœŸç‹¬ç«‹ï¼‰çš„ä»£ç†å¯¹è±¡ã€‚</p>
</li>
</ul>
<p>å½“æ— æ³•ç¡®è®¤ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ç”Ÿå‘½å‘¨æœŸçš„å…³ç³»æ—¶ï¼Œæ˜¯å¦ä¸åº”è¯¥å»å†’é™©é€‰æ‹©ä¸€ä¸ªæ— æ•ˆ <code>unowned</code> å¼•ç”¨ï¼Ÿè€Œæ˜¯ä¿å®ˆé€‰æ‹© <code>weak</code> å¼•ç”¨æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œä¸ä»…ä»…æ˜¯å› ä¸ºå¯¹è±¡ç”Ÿå‘½å‘¨æœŸäº†è§£æ˜¯ä¸€ä»¶å¿…è¦çš„äº‹æƒ…ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªä¿®é¥°ç¬¦åœ¨æ€§èƒ½ç‰¹æ€§ä¸Šä¹Ÿæœ‰å¾ˆå¤§çš„ä¸åŒã€‚</p>
<p>å¼±å¼•ç”¨æœ€å¸¸è§çš„å®ç°æ˜¯ï¼Œæ¯æ¬¡ä¸€ä¸ªæ–°çš„å¼•ç”¨ç”Ÿæˆæ—¶ï¼Œéƒ½ä¼šæŠŠæ¯ä¸ªå¼±å¼•ç”¨å’Œå®ƒæŒ‡å‘çš„å¯¹è±¡ä¿¡æ¯å­˜å‚¨åˆ°ä¸€ä¸ªé™„åŠ è¡¨ä¸­ã€‚</p>
<p>å½“æ²¡æœ‰ä»»ä½•å¼ºå¼•ç”¨æŒ‡å‘ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ<code>Swift</code> è¿è¡Œæ—¶ä¼šå¯åŠ¨ææ„è¿‡ç¨‹ï¼Œä½†æ˜¯åœ¨è¿™ä¹‹å‰ï¼Œè¿è¡Œæ—¶ä¼šæŠŠæ‰€æœ‰ç›¸å…³çš„å¼±å¼•ç”¨ç½®ä¸º <em>nil</em> ã€‚å¼±å¼•ç”¨çš„è¿™ç§å®ç°æ–¹å¼æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€é›¶å’Œå¼±å¼•ç”¨â€ã€‚</p>
<p>è¿™ç§å®ç°æœ‰å®é™…çš„å¼€é”€ï¼Œè€ƒè™‘åˆ°éœ€è¦é¢å¤–å®ç°çš„æ•°æ®ç»“æ„ï¼Œéœ€è¦ç¡®ä¿åœ¨å¹¶å‘è®¿é—®æƒ…å†µä¸‹ï¼Œå¯¹è¿™ä¸ªå…¨å±€å¼•ç”¨ç»“æ„æ‰€æœ‰æ“ä½œçš„æ­£ç¡®æ€§ã€‚ä¸€æ—¦ææ„è¿‡ç¨‹å¼€å§‹äº†ï¼Œåœ¨ä»»ä½•ç¯å¢ƒä¸­ï¼Œéƒ½ä¸å…è®¸è®¿é—®å¼±å¼•ç”¨æ‰€æŒ‡å‘çš„å¯¹è±¡äº†ã€‚</p>
<p>å¼±å¼•ç”¨ï¼ˆåŒ…æ‹¬ <code>unowned</code> å’Œä¸€äº›å˜ä½“çš„ <code>weak</code>)åœ¨ Swift ä½¿ç”¨äº†æ›´ç®€å•å’Œå¿«é€Ÿçš„å®ç°æœºåˆ¶ã€‚</p>
<p><code>Swift</code> ä¸­çš„æ¯ä¸ªå¯¹è±¡ä¿æŒäº†ä¸¤ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œä¸€ä¸ªæ˜¯å¼ºå¼•ç”¨è®¡æ•°å™¨ï¼Œç”¨æ¥å†³å®š <code>ARC</code> ä»€ä¹ˆæ—¶å€™å¯ä»¥å®‰å…¨åœ°ææ„è¿™ä¸ªå¯¹è±¡ï¼Œå¦å¤–ä¸€ä¸ªé™„åŠ çš„å¼±å¼•ç”¨è®¡æ•°å™¨ï¼Œç”¨æ¥è®¡ç®—åˆ›å»ºäº†å¤šå°‘ä¸ªæŒ‡å‘è¿™ä¸ªå¯¹è±¡çš„ <code>unowned</code> æˆ–è€… <code>weak</code> å¼•ç”¨ï¼Œå½“è¿™ä¸ªè®¡æ•°å™¨ä¸ºé›¶æ—¶ï¼Œè¿™ä¸ªå¯¹è±¡å°†è¢« <em>ææ„</em> ã€‚</p>
<p>éœ€è¦é‡ç‚¹ç†è§£çš„æ˜¯ï¼Œåªæœ‰ç­‰åˆ°æ‰€æœ‰ <code>unowned</code> å¼•ç”¨è¢«é‡Šæ”¾åï¼Œè¿™ä¸ªå¯¹è±¡æ‰ä¼šè¢«çœŸæ­£åœ°ææ„ï¼Œç„¶åå¯¹è±¡å°†ä¼šä¿æŒæœªè§£æå¯è®¿é—®çŠ¶æ€ï¼Œå½“ææ„å‘ç”Ÿåï¼Œå¯¹è±¡çš„å†…å®¹æ‰ä¼šè¢«å›æ”¶ã€‚</p>
<p>æ¯å½“ <code>unowned</code> å¼•ç”¨è¢«å®šä¹‰æ—¶ï¼Œå¯¹åº”çš„ <code>unowned</code> å¼•ç”¨è®¡æ•°ä¼šè¿›è¡ŒåŸå­çº§åˆ«åœ°å¢åŠ (ä½¿ç”¨<a href="http://llvm.org/docs/Atomics.html#libcalls-atomic" target="_blank" rel="external">åŸå­gcc/llvmæ“ä½œ</a>ï¼Œè¿›è¡Œä¸€ç³»åˆ—å¿«é€Ÿä¸”çº¿ç¨‹å®‰å…¨çš„åŸºæœ¬æ“ä½œï¼Œä¾‹å¦‚ï¼šå¢åŠ ï¼Œå‡å°‘ï¼Œæ¯”è¾ƒï¼Œäº¤æ¢ç­‰)ï¼Œä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚åœ¨å¢åŠ è®¡æ•°ä¹‹å‰ï¼Œä¼šæ£€æŸ¥å¼ºå¼•ç”¨è®¡æ•°ä»¥ç¡®ä¿å¯¹è±¡æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<p>è¯•å›¾è®¿é—®ä¸€ä¸ªæ— æ•ˆçš„å¯¹è±¡ï¼Œå°†ä¼šå¯¼è‡´é”™è¯¯çš„æ–­è¨€ï¼Œä½ çš„åº”ç”¨åœ¨è¿è¡Œæ—¶ä¸­ä¼šæŠ¥é”™(è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™é‡Œçš„ <code>unownd</code> å®ç°æ–¹å¼å«åš <code>unowned(safe)</code> å®ç°)</p>
<p>ä¸ºäº†æ›´å¥½çš„ä¼˜åŒ–ï¼Œåº”ç”¨ç¼–è¯‘æ—¶å¸¦æœ‰ <code>-OFast</code>ï¼Œ<code>unowned</code> å¼•ç”¨ä¸ä¼šå»éªŒè¯å¼•ç”¨å¯¹è±¡çš„æœ‰æ•ˆæ€§ï¼Œ<code>unowned</code> å¼•ç”¨çš„è¡Œä¸ºå°±ä¼šåƒ <code>Objective-C</code> ä¸­çš„ <code>__unsafe_unretained</code> ä¸€æ ·ã€‚å¦‚æœå¼•ç”¨å¯¹è±¡æ— æ•ˆï¼Œ<code>unowned</code> å¼•ç”¨å°†ä¼šæŒ‡å‘å·²ç»é‡Šæ”¾åƒåœ¾å†…å­˜ï¼ˆè¿™ç§å®ç°ç§°ä¹‹ <code>unowned(unsafe)</code>ï¼‰ã€‚</p>
<p>å½“ä¸€ä¸ª <code>unowned</code> å¼•ç”¨è¢«é‡Šæ”¾åï¼Œå¦‚æœè¿™æ—¶æ²¡æœ‰å…¶ä»–å¼ºå¼•ç”¨æˆ– <code>unowned</code> å¼•ç”¨æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆæœ€ç»ˆè¿™ä¸ªå¯¹è±¡å°†è¢«ææ„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸€ä¸ªå¼•ç”¨å¯¹è±¡ä¸èƒ½åœ¨å¼ºå¼•ç”¨è®¡æ•°å™¨ç­‰äºé›¶çš„æƒ…å†µä¸‹ï¼Œè¢«ææ„çš„åŸå› ï¼Œæ‰€æœ‰çš„å¼•ç”¨è®¡æ•°å™¨å¿…é¡»èƒ½å¤Ÿè¢«è®¿é—®ç”¨æ¥éªŒè¯ <code>unowned</code> å¼•ç”¨å’Œå¼ºå¼•ç”¨æ•°é‡ã€‚</p>
<p>Swift çš„ <code>weak</code> å¼•ç”¨æ·»åŠ äº†é™„åŠ å±‚ï¼Œé—´æ¥åœ°æŠŠ <code>unowned</code> å¼•ç”¨åŒ…è£¹åˆ°äº†ä¸€ä¸ªå¯é€‰å®¹å™¨é‡Œé¢ï¼Œåœ¨æŒ‡å‘çš„å¯¹è±¡ææ„ä¹‹åå˜æˆç©ºçš„æƒ…å†µä¸‹ï¼Œè¿™æ ·å¤„ç†ä¼šæ›´åŠ çš„æ¸…æ™°ã€‚ä½†æ˜¯éœ€è¦ä»˜å‡ºçš„ä»£ä»·æ˜¯ï¼Œé™„åŠ çš„æœºåˆ¶éœ€è¦æ­£ç¡®åœ°å¤„ç†å¯é€‰å€¼ã€‚</p>
<p>è€ƒè™‘åˆ°ä»¥ä¸Šå› ç´ ï¼Œåœ¨å¯¹è±¡å…³ç³»ç”Ÿå‘½å‘¨æœŸå…è®¸çš„æƒ…å†µä¸‹ï¼Œ<strong>ä¼˜å…ˆé€‰æ‹©</strong>ä½¿ç”¨ <code>unowned</code> å¼•ç”¨ã€‚ä½†æ˜¯è¿™ä¸æ˜¯æ­¤æ•…äº‹çš„ç»“å±€ï¼Œæ¥ä¸‹æ¥æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…æ€§èƒ½<sup><a href="#1">1</a></sup>ä¸Šçš„å·®åˆ«ã€‚</p>
<p><a name="performance_a_look_under_the_hood"></a></p>
<h3 id="æ€§èƒ½ï¼šæ·±åº¦æ¢ç´¢"><a href="#æ€§èƒ½ï¼šæ·±åº¦æ¢ç´¢" class="headerlink" title="æ€§èƒ½ï¼šæ·±åº¦æ¢ç´¢"></a>æ€§èƒ½ï¼šæ·±åº¦æ¢ç´¢</h3><p>åœ¨æŸ¥çœ‹ <code>Swift</code> é¡¹ç›®æºç éªŒè¯ä¹‹å‰ï¼Œéœ€è¦ç†è§£ <code>ARC</code> å¦‚ä½•ç®¡ç†è¿™ä¸¤ç§å¼•ç”¨ç±»å‹ï¼Œå¹¶ä¸”è¿˜éœ€è¦è§£é‡Š <code>swiftc</code>ï¼Œ<code>LLVM</code> å’Œ <code>SIL</code> çš„ç›¸å…³çŸ¥è¯†ã€‚</p>
<p>æ¥ä¸‹æ¥è¯•ç€ç®€è¦ä»‹ç»æœ¬æ–‡æ‰€éœ€è¦çš„å¿…å¤‡çŸ¥è¯†ç‚¹ï¼Œå¦‚æœæƒ³äº†è§£æ›´å¤šï¼Œå°†åœ¨æœ€åçš„è„šæ³¨ä¸­æ‰¾åˆ°ä¸€äº›æœ‰ç”¨çš„é“¾æ¥ã€‚</p>
<p>ä½¿ç”¨ä¸€ä¸ªå›¾æ¥è§£é‡Š <em>swiftc</em> æ•´ä¸ªç¼–è¯‘è¿‡ç¨‹çš„åŒ…å«çš„æ¨¡å—ï¼š</p>
<p><img src="https://www.uraimo.com/imgs/swiftc.png" alt=""></p>
<p><code>Swiftc</code> å’Œ <em>clang</em> ä¸€æ ·æ„å»ºåœ¨ LLVM ä¸Šï¼Œéµå¾ª <em>clang</em> ç¼–è¯‘å™¨ç›¸ä¼¼çš„ç¼–è¯‘æµç¨‹ã€‚</p>
<p>åœ¨ç¼–è¯‘è¿‡ç¨‹çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨ä¸€ä¸ªç‰¹å®šè¯­è¨€å‰ç«¯è¿›è¡Œç®¡ç†ï¼Œ<code>swift</code> æºä»£ç è¢«è§£é‡Šç”Ÿæˆä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘(AST)è¡¨è¾¾<sup><a href="#2">2</a></sup>ï¼Œç„¶åæŠ½è±¡è¯­æ³•æ ‘çš„ç»“æœä»è¯­ä¹‰è§’åº¦è¿›è¡Œåˆ†æï¼Œæ‰¾å‡ºè¯­ä¹‰é”™è¯¯ã€‚</p>
<p>åœ¨è¿™ä¸ªç‚¹ä¸Šï¼Œå¯¹äºå…¶ä»–çš„åŸºäº LLVM çš„ç¼–è¯‘å™¨æ¥è®²ï¼Œåœ¨é€šè¿‡ä¸€ä¸ªé™„åŠ æ­¥éª¤å¯¹æºä»£ç è¿›è¡Œé™æ€åˆ†æåï¼ˆå¿…è¦æ—¶å¯ä»¥æ˜¾ç¤ºé”™è¯¯å’Œè­¦å‘Šï¼‰ï¼Œæ¥ç€ <em>IRGen</em> æ¨¡å— ä¼šæŠŠ <code>AST</code> çš„å†…å®¹ä¼šè½¬æ¢æˆä¸€ä¸ªè½»é‡çš„å’Œåº•å±‚çš„æœºå™¨æ— å…³çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º <a href="http://llvm.org/docs/LangRef.html" target="_blank" rel="external">LLVM IR</a>(<code>LLVM</code> ä¸­é—´è¡¨ç¤º)ã€‚</p>
<p>å°½ç®¡ä¸¤ä¸ªæ¨¡å—éƒ½éœ€è¦åšä¸€äº›ç›¸åŒæ£€æŸ¥ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ¨¡å—æ˜¯åŒºåˆ†å¼€çš„ï¼Œåœ¨ä¸¤ä¸ªæ¨¡å—ä¹‹é—´ä¹Ÿå­˜åœ¨è®¸å¤šé‡å¤çš„ä»£ç ã€‚</p>
<p><code>IR</code> æ˜¯ä¸€ç§<a href="https://en.wikipedia.org/wiki/Static_single_assignment_form" target="_blank" rel="external">é™æ€å•èµ‹å€¼å½¢å¼</a>ï¼ˆ<code>SSA-form</code>ï¼‰ä¸€è‡´è¯­è¨€ï¼Œå¯ä»¥çœ‹åšæ³¨å…¥äº† <code>LLVM</code> çš„è™šæ‹Ÿæœºä¸‹çš„ <code>RISC</code> ç±»å‹<a href="https://idea.popcount.org/2013-07-24-ir-is-better-than-assembly/" target="_blank" rel="external">æ±‡ç¼–è¯­è¨€</a>ã€‚åŸºäº <code>SSA</code> å°†ç®€åŒ–æ¥ä¸‹æ¥çš„ç¼–è¯‘è¿‡ç¨‹ï¼Œä»è¯­è¨€å‰ç«¯æä¾›çš„ä¸­é—´è¡¨è¾¾ä¼šåœ¨ <code>IR</code> è¿›è¡Œå¤šé‡ä¼˜åŒ–ã€‚</p>
<p>éœ€è¦é‡ç‚¹æ³¨æ„çš„æ˜¯ï¼Œ<code>IR</code> å…¶ä¸­ä¸€ä¸ªç‰¹ç‚¹æ˜¯ï¼Œå®ƒå…·æœ‰ä¸‰ç§ä¸åŒçš„å½¢å¼ï¼šå†…å­˜è¡¨è¾¾ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰ï¼Œåºåˆ—åŒ–ä½ä»£ç å½¢å¼ï¼ˆä½ å·²ç»çŸ¥é“çš„<a href="https://developer.apple.com/library/tvos/documentation/IDEs/Conceptual/AppDistributionGuide/AppThinning/AppThinning.html" target="_blank" rel="external">ä½ä»£ç å½¢å¼</a>ï¼‰å’Œå¯è¯»å½¢å¼ã€‚</p>
<p>æœ€åä¸€ç§å½¢å¼éå¸¸æœ‰ç”¨ï¼Œç”¨æ¥éªŒè¯ <code>IR</code> ä»£ç çš„æœ€ç»ˆç»“æ„ï¼Œè¿™ä¸ªç»“æ„å°†ä¼šä¼ å…¥åˆ°æ•´ä¸ªè¿‡ç¨‹ä¸­çš„æœ€åä¸€æ­¥ï¼Œå°†ä¼šä»æœºå™¨ç‹¬ç«‹çš„ <code>IR</code> ä»£ç è½¬æ¢æˆå¹³å°ç›¸å…³çš„è¡¨è¾¾(æ¯”å¦‚ï¼šx86ï¼ŒARM ç­‰ç­‰)ã€‚æœ€åä¸€æ­¥å°†è¢« <code>LLVM</code> å¹³å°åç«¯æ‰§è¡Œã€‚</p>
<p>é‚£ä¹ˆ <code>swiftc</code> å’Œå…¶ä»–åŸºäº <code>LLVM</code> çš„ç¼–è¯‘å™¨æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ</p>
<p><code>swiftc</code> å’Œå…¶ä»–ç¼–è¯‘å™¨ä»ç»“æ„å½¢å¼ä¸Šçš„å·®åˆ«ä¸»è¦ä½“ç°åœ¨ä¸€ä¸ªé™„åŠ ç»„ä»¶ï¼Œè¿™ä¸ªé™„åŠ ç»„ä»¶æ˜¯ <em>SILGen</em> ï¼Œåœ¨ <em>IRGen</em> ä¹‹å‰ï¼Œæ‰§è¡Œä»£ç çš„ç›‘æµ‹å’Œä¼˜åŒ–ï¼Œç”Ÿæˆä¸€ä¸ªé«˜çº§çš„ä¸­é—´è¡¨è¾¾ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º <em>SIL</em> ï¼ˆSwift Intermediate Languageï¼ŒSwift ä¸­é—´è¯­è¨€ï¼‰ï¼Œæœ€å SIL å°†ä¼šè½¬æ¢æˆ LLVM IRã€‚è¿™ä¸€æ­¥åŠ å¼ºäº†åœ¨å•ä¸ªè½¯ä»¶æ¨¡å—ä¸Šæ‰€æœ‰å…·ä½“è¯­è¨€çš„æ£€æŸ¥ï¼Œå¹¶ä¸”ç®€åŒ–äº† <em>IRGen</em>ã€‚</p>
<p>ä» <code>AST</code> åˆ° <code>IR</code> çš„è½¬æ¢åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ã€‚<em>SILGen</em> æŠŠ <code>AST</code> æºä»£ç è½¬æ¢ä¸ºåŸå§‹ <code>SIL</code> ï¼Œç„¶åç¼–è¯‘å™¨è¿›è¡Œ <code>Swift</code> è¯­æ³•æ£€æŸ¥ï¼ˆéœ€è¦æ—¶æ‰“å°é”™è¯¯æˆ–è€…è­¦å‘Šä¿¡æ¯ï¼‰ï¼Œä¼˜åŒ–æœ‰æ•ˆçš„åŸå§‹ <code>SIL</code> ï¼Œé€šè¿‡ä¸€äº›æ­¥éª¤æœ€åç”Ÿæˆæ ‡å‡†åŒ– <code>SIL</code> ã€‚å¦‚ä¸Šé¢çš„ç¤ºæ„å›¾æ˜¾ç¤ºé‚£æ ·ï¼Œæ ‡å‡†åŒ– <code>SIL</code> çš„æœ€åè½¬åŒ–ä¸º <code>LLVM IR</code>ã€‚</p>
<p>å†æ¬¡å¼ºè°ƒï¼Œ<code>SIL</code> æ˜¯ä¸€ä¸ª <code>SSA</code> ç±»å‹è¯­è¨€ï¼Œä½¿ç”¨é™„åŠ çš„ç»“æ„æ‰©å±•äº† <code>Swift</code> çš„è¯­æ³•ã€‚å®ƒä¾èµ– <code>Swift</code> çš„ç±»å‹ç³»ç»Ÿï¼Œå¹¶ä¸”èƒ½ç†è§£ <code>Swift</code> çš„å®šä¹‰ï¼Œä½†æ˜¯éœ€è¦é‡ç‚¹è®°ä½çš„æ˜¯ï¼Œå½“ç¼–è¯‘ä¸€ä¸ªæ‰‹å†™çš„ <code>SIL</code> æºç ï¼ˆæ˜¯çš„ï¼Œå¯ä»¥æ‰‹åŠ¨å†™ <code>SIL</code> ç„¶åç¼–è¯‘å®ƒï¼‰æ—¶ï¼Œé«˜é˜¶çš„ <code>Swift</code> ä»£ç æˆ–è€…å‡½æ•°å†…å®¹å°†è¢«ç¼–è¯‘å™¨å¿½ç•¥ã€‚</p>
<p>åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ï¼Œæˆ‘ä»¬å°†åˆ†æä¸€ä¸ªæ ‡å‡†åŒ– <code>SIL</code> çš„æ¡ˆä¾‹ï¼Œæ¥ç†è§£ <code>unowned</code> å’Œ <code>weak</code> å¼•ç”¨å¦‚ä½•è¢«ç¼–è¯‘å™¨å¤„ç†ã€‚ä¸€ä¸ªåŒ…å«æ•è·åˆ—è¡¨çš„åŸºæœ¬é—­åŒ…çš„ä¾‹å­ï¼ŒæŸ¥çœ‹è¿™ä¸ªä¾‹å­ç”Ÿæˆçš„ <code>SIL</code> ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°è¢«ç¼–è¯‘å™¨æ·»åŠ çš„æ‰€æœ‰ <code>ARC</code> ç›¸å…³çš„å‡½æ•°è°ƒç”¨ã€‚</p>
<blockquote>
<p>ä» <a href="https://github.com/uraimo/Swift-Playgrounds" target="_blank" rel="external">GitHub</a> æˆ–è€… <a href="https://www.uraimo.com/archives/2016-10-27-UnownedWeakPlayground.playground.zip" target="_blank" rel="external">zipped</a> è·å–æœ¬æ–‡ç›¸å…³çš„ Playground ä»£ç ã€‚ç„¶åä»<a href="https://www.uraimo.com/archives/closure.zip" target="_blank" rel="external">è¿™é‡Œ</a>è·å–é—­åŒ…æ¡ˆä¾‹å’Œ <code>SIL</code> ï¼Œ<code>SILGen</code> ä»¥åŠ <code>LLVM IR</code> çš„è¾“å‡ºã€‚</p>
</blockquote>
<p><a name="deconstructing_capture_lists_handling"></a></p>
<h4 id="æ•è·åˆ—è¡¨å¤„ç†è§£æ"><a href="#æ•è·åˆ—è¡¨å¤„ç†è§£æ" class="headerlink" title="æ•è·åˆ—è¡¨å¤„ç†è§£æ"></a>æ•è·åˆ—è¡¨å¤„ç†è§£æ</h4><p>æ¥ä¸‹æ¥çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ <code>Swift</code> çš„ä¾‹å­ï¼Œå®šä¹‰ä¸¤ä¸ªç±»å˜é‡ï¼Œç„¶ååœ¨ä¸€ä¸ªé—­åŒ…ä¸­å¯¹ä»–ä»¬è¿›è¡Œå¼±å¼•ç”¨çš„æ•è·ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">aClass</span></span>&#123;</div><div class="line">    <span class="keyword">var</span> value = <span class="number">1</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> c1 = aClass()</div><div class="line"><span class="keyword">var</span> c2 = aClass()</div><div class="line"></div><div class="line"><span class="keyword">var</span> fSpec = &#123; </div><div class="line">    [<span class="keyword">unowned</span> c1, <span class="keyword">weak</span> c2] <span class="keyword">in</span></div><div class="line">    c1.value = <span class="number">42</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> c2o = c2 &#123;</div><div class="line">        c2o.value = <span class="number">42</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">fSpec()</div></pre></td></tr></table></figure>
<p>é€šè¿‡ <code>xcrun swiftc -emit-sil sample.swift</code> ç¼–è¯‘ swift æºä»£ç ï¼Œç”Ÿæˆæ ‡å‡†åŒ– SIL ä»£ç ã€‚åŸå§‹SIL å¯ä»¥ä½¿ç”¨ <code>-emit-silgen</code> é€‰é¡¹æ¥ç”Ÿæˆã€‚</p>
<p>è¿è¡Œä»¥ä¸Šå‘½ä»¤ä»¥åï¼Œä¼šå‘ç° swiftc äº§ç”Ÿäº†è®¸å¤šä»£ç ã€‚é€šè¿‡æŸ¥çœ‹ swiftc è¾“å‡ºä»£ç çš„ç‰‡æ®µï¼Œå­¦ä¹ ä¸€ä¸‹åŸºæœ¬çš„ SIL æŒ‡ä»¤ï¼Œç†è§£æ•´ä¸ªç»“æ„ã€‚</p>
<p>åœ¨ä¸‹é¢ä»£ç ä¸­éœ€è¦çš„åœ°æ–¹æ·»åŠ äº†ä¸€äº›å¤šè¡Œæ³¨é‡Šï¼ˆç¼–è¯‘å™¨ä¹Ÿç”Ÿæˆäº†ä¸€äº›å•è¡Œæ³¨é‡Šï¼‰ï¼Œå¸Œæœ›è¿™äº›æ³¨é‡Šå·²ç»è¶³å¤Ÿè¯´æ¸…æ¥šå‘ç”Ÿäº†ä»€ä¹ˆï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">  æ­¤æ–‡ä»¶åŒ…å«å…¸å‹ SIL ä»£ç </div><div class="line">*/</div><div class="line">sil_stage canonical             </div><div class="line"></div><div class="line"><span class="comment">/* </span></div><div class="line">  åªæœ‰åœ¨ SIL å†…éƒ¨ä½¿ç”¨çš„ç‰¹æ®Šçš„å¯¼å…¥</div><div class="line">*/</div><div class="line"><span class="keyword">import</span> Builtin                  </div><div class="line"><span class="keyword">import</span> Swift</div><div class="line"><span class="keyword">import</span> SwiftShims</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">	ä¸‰ä¸ªå…¨å±€å˜é‡çš„å®šä¹‰ï¼ŒåŒ…æ‹¬ c1ï¼Œc2 å’Œ é—­åŒ… fSpecã€‚</div><div class="line">  	@_Tv4clos2c1CS_6aClassæ˜¯å˜é‡çš„ç¬¦å·ï¼Œ$aClass æ˜¯å®ƒçš„ç±»å‹ï¼ˆç±»å‹å‰ç¼€ä¸º$)ã€‚</div><div class="line">  	å˜é‡ååœ¨è¿™é‡Œçœ‹èµ·æ¥å¾ˆä¹±ï¼Œä½†æ˜¯åœ¨åé¢çš„ä»£ç ä¸­å°†å˜å¾—æ›´åŠ å¯è¯»ã€‚</div><div class="line">*/</div><div class="line"><span class="comment">// c1</span></div><div class="line">sil_global hidden @_Tv4sample2c1CS_6aClass : $aClass</div><div class="line"></div><div class="line"><span class="comment">// c2</span></div><div class="line">sil_global hidden @_Tv4sample2c2CS_6aClass : $aClass</div><div class="line"></div><div class="line"><span class="comment">// fSpec</span></div><div class="line">sil_global hidden @_Tv4sample5fSpecFT_T_ : $@callee_owned () -&gt; ()</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">  å±‚æ¬¡ä½œç”¨åŸŸå®šä¹‰è¡¨ç¤ºåŸå§‹ä»£ç çš„ä½ç½®ã€‚</div><div class="line">  æ¯ä¸ª SIL æŒ‡ç¤ºå°†ä¼šæŒ‡å‘å®ƒç”Ÿæˆçš„ `sil_scope`ã€‚</div><div class="line">*/</div><div class="line">sil_scope <span class="number">1</span> &#123;  parent @main : $<span class="meta">@convention</span>(<span class="built_in">c</span>) (<span class="type">Int32</span>, <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Optional</span>&lt;<span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Int8</span>&gt;&gt;&gt;) -&gt; <span class="type">Int32</span> &#125;</div><div class="line">sil_scope <span class="number">2</span> &#123; loc <span class="string">"sample.swift"</span>:<span class="number">14</span>:<span class="number">1</span> parent <span class="number">1</span> &#125;</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">	è‡ªåŠ¨ç”Ÿæˆçš„ @main å‡½æ•°åŒ…å«äº†æˆ‘ä»¬åŸå§‹å…¨éƒ¨ä½œç”¨åŸŸçš„ä»£ç ã€‚</div><div class="line"> 	è¿™é‡Œæ²¿ç”¨äº†ç†Ÿæ‚‰çš„ c main() å‡½æ•°ç»“æ„ï¼Œæ¥æ”¶å‚æ•°ä¸ªæ•°å’Œå‚æ•°æ•°ç»„ä¸¤ä¸ªè¾“å…¥ï¼Œè¿™ä¸ªå‡½æ•°éµå¾ª c è°ƒç”¨çº¦å®šã€‚</div><div class="line">  	è¿™ä¸ªå‡½æ•°åŒ…å«äº†éœ€è¦è°ƒç”¨é—­åŒ…çš„æŒ‡ä»¤ã€‚</div><div class="line">*/</div><div class="line"><span class="comment">// main</span></div><div class="line">sil @main : $<span class="meta">@convention</span>(<span class="built_in">c</span>) (<span class="type">Int32</span>, <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Optional</span>&lt;<span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Int8</span>&gt;&gt;&gt;) -&gt; <span class="type">Int32</span> &#123;</div><div class="line"><span class="comment">/*</span></div><div class="line">  å…¥å£å®šä¹‰å¤´éƒ¨ä¸º % ç¬¦å·ï¼Œåé¢è·Ÿéšä¸€ä¸ªæ•°å­— idã€‚</div><div class="line">  æ¯å½“ä¸€ä¸ªæ–°çš„å…¥å£å®šä¹‰æ—¶ï¼ˆæˆ–è€…å‡½æ•°å¼€å¤´å®šä¹‰å‡½æ•°å‚æ•°ï¼‰ï¼Œç¼–è¯‘å™¨åœ¨å…¥å£è¡Œå°¾æ ¹æ®å®ƒçš„å€¼ï¼ˆå«åš usersï¼‰æ·»åŠ ä¸€ä¸ªæ³¨é‡Šã€‚</div><div class="line">  å¯¹äºå…¶ä»–æŒ‡ä»¤ï¼Œéœ€è¦æä¾› id å·ã€‚</div><div class="line">  åœ¨è¿™é‡Œï¼Œå…¥å£ 0 å°†è¢«ç”¨æ¥è®¡ç®—å…¥å£ 4 çš„å†…å®¹ï¼Œå…¥å£ 1 å°†è¢«ç”¨æ¥åˆ›å»ºå…¥å£ 10 çš„å€¼ã€‚</div><div class="line">*/</div><div class="line"><span class="comment">// %0                                             // user: %4</span></div><div class="line"><span class="comment">// %1                                             // user: %10</span></div><div class="line"><span class="comment">/*</span></div><div class="line">  æ¯ä¸€ä¸ªå‡½æ•°è¢«åˆ†è§£æˆä¸€ç³»åˆ—çš„åŸºæœ¬æŒ‡ä»¤å—ï¼Œæ¯ä¸€ä¸ªæŒ‡ä»¤å—ç»“æŸäºä¸€ä¸ªç»ˆæ­¢æŒ‡ä»¤ï¼ˆä¸€ä¸ªåˆ†æ”¯æˆ–è€…ä¸€ä¸ªè¿”å›ï¼‰ã€‚</div><div class="line">  è¿™ä¸€ç³»åˆ—çš„æŒ‡ä»¤å—è¡¨ç¤ºå‡½æ•°æ‰€æœ‰å¯èƒ½çš„æ‰§è¡Œè·¯å¾„ã€‚</div><div class="line">*/</div><div class="line">bb0(%<span class="number">0</span> : $<span class="type">Int32</span>, %<span class="number">1</span> : $<span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Optional</span>&lt;<span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Int8</span>&gt;&gt;&gt;):</div><div class="line">...</div><div class="line">  <span class="comment">/*</span></div><div class="line">    æ¯ä¸€ä¸ª SIL æŒ‡ä»¤éƒ½åŒ…å«ä¸€ä¸ªå¼•ç”¨ï¼ŒæŒ‡å‘æºä»£ç çš„ä½ç½®ï¼ŒåŒ…æ‹¬æŒ‡ä»¤å…·ä½“ä»æºä»£ç ä¸­å“ªä¸ªåœ°æ–¹æ¥ï¼Œå±äºå“ªä¸€ä¸ªä½œç”¨åŸŸã€‚</div><div class="line">    åœ¨åé¢åˆ†æå…·ä½“çš„æ–¹æ³•ä¼šçœ‹åˆ°è¿™äº›å†…å®¹ã€‚</div><div class="line">  */</div><div class="line">  unowned_retain %<span class="number">27</span> : $@sil_unowned aClass, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">14</span>, scope <span class="number">2</span> <span class="comment">// id: %28</span></div><div class="line">  store %<span class="number">27</span> to %<span class="number">2</span> : $*@sil_unowned aClass, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">14</span>, scope <span class="number">2</span> <span class="comment">// id: %29</span></div><div class="line">  %<span class="number">30</span> = alloc_box $@sil_weak <span class="type">Optional</span>&lt;aClass&gt;, <span class="keyword">var</span>, name <span class="string">"c2"</span>, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">23</span>, scope <span class="number">2</span> <span class="comment">// users: %46, %44, %43, %31</span></div><div class="line">  %<span class="number">31</span> = project_box %<span class="number">30</span> : $@box @sil_weak <span class="type">Optional</span>&lt;aClass&gt;, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">23</span>, scope <span class="number">2</span> <span class="comment">// user: %35</span></div><div class="line">  %<span class="number">32</span> = load %<span class="number">19</span> : $*aClass, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">23</span>, scope <span class="number">2</span> <span class="comment">// users: %34, %33</span></div><div class="line">  ...</div><div class="line">&#125;</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment">/* </span></div><div class="line">  ä¸‹é¢æ˜¯ä¸€ç³»åˆ—è‡ªåŠ¨ç”Ÿæˆçš„`aClass`çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼š init/deinit, setter/getter å’Œå…¶ä»–ä¸€äº›å·¥å…·æ–¹æ³•ã€‚</div><div class="line">  æ¯ä¸ªæ–¹æ³•å‰çš„æ³¨é‡Šæ˜¯ç¼–è¯‘å™¨æ·»åŠ çš„ï¼Œç”¨æ¥è¯´æ˜ä»£ç çš„å…·ä½“ä½œç”¨ã€‚</div><div class="line">*/</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">  éšè—æ–¹æ³•åªåœ¨å®ƒä»¬æ¨¡å—ä¸­å¯è§ã€‚</div><div class="line">  @convention(æ–¹æ³•å)æ˜¯ Swift ä¸­æ–¹æ³•è°ƒç”¨é»˜è®¤çš„çº¦å®šï¼Œåœ¨å°¾éƒ¨æœ‰ä¸€ä¸ªé™„åŠ çš„å‚æ•°æŒ‡å‘å®ƒè‡ªå·±ã€‚</div><div class="line">*/</div><div class="line"><span class="comment">// aClass.__deallocating_deinit</span></div><div class="line">sil hidden @_TFC4clos6aClassD : $<span class="meta">@convention</span>(method) (@owned aClass) -&gt; () &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">  @guaranteed å‚æ•°è¡¨ç¤ºä¿è¯åœ¨æ•´ä¸ªå‘¨æœŸå†…è°ƒç”¨æ­¤æ–¹æ³•éƒ½æœ‰æ•ˆã€‚</div><div class="line">*/</div><div class="line"><span class="comment">// aClass.deinit</span></div><div class="line">sil hidden @_TFC4clos6aClassd : $<span class="meta">@convention</span>(method) (@guaranteed aClass) -&gt; @owned <span class="type">Builtin</span>.<span class="type">NativeObject</span> &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">  [transparent] ä¿®é¥°çš„æ–¹æ³•æ˜¯å†…è”çš„å°æ–¹æ³•</div><div class="line">*/</div><div class="line"><span class="comment">// aClass.value.getter</span></div><div class="line">sil hidden [transparent] @_TFC4clos6aClassg5valueSi : $<span class="meta">@convention</span>(method) (@guaranteed aClass) -&gt; <span class="type">Int</span> &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// aClass.value.setter</span></div><div class="line">sil hidden [transparent] @_TFC4clos6aClasss5valueSi : $<span class="meta">@convention</span>(method) (<span class="type">Int</span>, @guaranteed aClass) -&gt; () &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"><span class="comment">// aClass.value.materializeForSet</span></div><div class="line">sil hidden [transparent] @_TFC4clos6aClassm5valueSi : $<span class="meta">@convention</span>(method) (<span class="type">Builtin</span>.<span class="type">RawPointer</span>, @<span class="keyword">inout</span> <span class="type">Builtin</span>.<span class="type">UnsafeValueBuffer</span>, @guaranteed aClass) -&gt; (<span class="type">Builtin</span>.<span class="type">RawPointer</span>, <span class="type">Optional</span>&lt;<span class="type">Builtin</span>.<span class="type">RawPointer</span>&gt;) &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">  @owned ä¿®é¥°ç¬¦è¡¨ç¤ºè¿™ä¸ªå¯¹è±¡å°†è¢«è°ƒç”¨è€…æ‹¥æœ‰ã€‚</div><div class="line">*/</div><div class="line"><span class="comment">// aClass.init() -&gt; aClass</span></div><div class="line">sil hidden @_TFC4clos6aClasscfT_S0_ : $<span class="meta">@convention</span>(method) (@owned aClass) -&gt; @owned aClass &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// aClass.__allocating_init() -&gt; aClass</span></div><div class="line">sil hidden @_TFC4clos6aClassCfT_S0_ : $<span class="meta">@convention</span>(method) (@thick aClass.<span class="type">Type</span>) -&gt; @owned aClass &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* </span></div><div class="line">  æ¥ä¸‹é¢æ˜¯é—­åŒ…ä»£ç æ®µ</div><div class="line">*/</div><div class="line"><span class="comment">// (closure #1)</span></div><div class="line">sil shared @_TF4closU_FT_T_ : $<span class="meta">@convention</span>(thin) (@owned @sil_unowned aClass, @owned @box @sil_weak <span class="type">Optional</span>&lt;aClass&gt;) -&gt; () &#123;</div><div class="line">    ...</div><div class="line">    <span class="comment">/* å…³äºé—­åŒ…çš„ SIL ä»£ç ï¼Œ è§ä¸‹æ–‡ */</span></div><div class="line"></div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line">...</div><div class="line"><span class="comment">/* </span></div><div class="line">  sil_vtable å®šä¹‰æ‰€æœ‰å…³äº aClass ç±»çš„è™šå‡½æ•°è¡¨ã€‚</div><div class="line">  sil_vtable åŒ…å«äº†æœŸæœ›çš„æ‰€æœ‰è‡ªåŠ¨ç”Ÿæˆçš„æ–¹æ³•ã€‚</div><div class="line">*/</div><div class="line">sil_vtable aClass &#123;</div><div class="line">  #aClass.<span class="keyword">deinit</span>!deallocator: _TFC4clos6aClassD	<span class="comment">// aClass.__deallocating_deinit</span></div><div class="line">  #aClass.value!getter.<span class="number">1</span>: _TFC4clos6aClassg5valueSi	<span class="comment">// aClass.value.getter</span></div><div class="line">  #aClass.value!setter.<span class="number">1</span>: _TFC4clos6aClasss5valueSi	<span class="comment">// aClass.value.setter</span></div><div class="line">  #aClass.value!materializeForSet.<span class="number">1</span>: _TFC4clos6aClassm5valueSi	<span class="comment">// aClass.value.materializeForSet</span></div><div class="line">  #aClass.<span class="keyword">init</span>!initializer.<span class="number">1</span>: _TFC4clos6aClasscfT_S0_	<span class="comment">// aClass.init() -&gt; aClass</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨å›åˆ°ä¸»å‡½æ•°ï¼Œçœ‹çœ‹ä¸¤ä¸ªç±»å®ä¾‹å¦‚ä½•è¢«è·å–åˆ°ï¼Œå¹¶å¦‚ä½•ä¼ é€’ç»™è°ƒç”¨ä»–ä»¬çš„é—­åŒ…ã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œæ‰€æœ‰æ ‡è¯†éƒ½è¢«é‡æ–°æ•´ç†ï¼Œä½¿å¾—ä»£ç ç‰‡æ®µæ›´åŠ å¯è¯»ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">// main</span></div><div class="line">sil @main : $<span class="meta">@convention</span>(<span class="built_in">c</span>) (<span class="type">Int32</span>, <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Optional</span>&lt;<span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Int8</span>&gt;&gt;&gt;) -&gt; <span class="type">Int32</span> &#123;</div><div class="line"><span class="comment">// %0                                             // user: %4</span></div><div class="line"><span class="comment">// %1                                             // user: %10</span></div><div class="line">bb0(%<span class="number">0</span> : $<span class="type">Int32</span>, %<span class="number">1</span> : $<span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Optional</span>&lt;<span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Int8</span>&gt;&gt;&gt;):</div><div class="line">  ...</div><div class="line">  <span class="comment">/*</span></div><div class="line">    å…¨å±€å˜é‡çš„å¼•ç”¨ä½¿ç”¨ä¸‰ä¸ªå…¥å£æ¥æ”¾ç½®ã€‚</div><div class="line">  */</div><div class="line">  %<span class="number">13</span> = global_addr @clos.c1 : $*aClass, loc <span class="string">"sample.swift"</span>:<span class="number">5</span>:<span class="number">5</span>, scope <span class="number">1</span> <span class="comment">// users: %26, %17</span></div><div class="line">  ...</div><div class="line">  %<span class="number">19</span> = global_addr @clos.c2 : $*aClass, loc <span class="string">"sample.swift"</span>:<span class="number">6</span>:<span class="number">5</span>, scope <span class="number">1</span> <span class="comment">// users: %32, %23</span></div><div class="line">  ...</div><div class="line">  %<span class="number">25</span> = global_addr @clos.fSpec : $*@callee_owned () -&gt; (), loc <span class="string">"sample.swift"</span>:<span class="number">8</span>:<span class="number">5</span>, scope <span class="number">1</span> <span class="comment">// users: %48, %45</span></div><div class="line">  <span class="comment">/*</span></div><div class="line">    c1 æ˜¯ unowned_retained çš„ã€‚</div><div class="line">    ä¸‹é¢çš„æŒ‡ä»¤å¢åŠ å˜é‡çš„ unowned å¼•ç”¨è®¡æ•°ã€‚</div><div class="line">  */</div><div class="line">  %<span class="number">26</span> = load %<span class="number">13</span> : $*aClass, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">14</span>, scope <span class="number">2</span> <span class="comment">// user: %27</span></div><div class="line">  %<span class="number">27</span> = ref_to_unowned %<span class="number">26</span> : $aClass to $@sil_unowned aClass, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">14</span>, scope <span class="number">2</span> <span class="comment">// users: %47, %38, %39, %29, %28</span></div><div class="line">  unowned_retain %<span class="number">27</span> : $@sil_unowned aClass, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">14</span>, scope <span class="number">2</span> <span class="comment">// id: %28</span></div><div class="line">  store %<span class="number">27</span> to %<span class="number">2</span> : $*@sil_unowned aClass, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">14</span>, scope <span class="number">2</span> <span class="comment">// id: %29</span></div><div class="line">  <span class="comment">/*</span></div><div class="line">    å¯¹ c2 çš„å¤„ç†ä¼šæ›´åŠ å¤æ‚ä¸€äº›ã€‚</div><div class="line">	alloc_box åˆ›å»ºäº†ä¸€ä¸ªè¿™ä¸ªå˜é‡çš„å¼•ç”¨æ•°å®¹å™¨ï¼Œå˜é‡å°†ä¼šå­˜åœ¨è¿™ä¸ªå®¹å™¨çš„å †ä¸­ã€‚</div><div class="line">    å®¹å™¨åˆ›å»ºä»¥åï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ªå¯é€‰å˜é‡ï¼ŒæŒ‡å‘ c2ï¼Œå¹¶ä¸”å¯é€‰å˜é‡ä¼šå­˜å‚¨åœ¨å®¹å™¨é‡Œã€‚å®¹å™¨ä¼šå¢åŠ æ‰€åŒ…å«å€¼çš„æŠ€æœ¯ï¼Œæ­£å¦‚ä¸‹é¢çœ‹åˆ°çš„ä¸€æ ·ï¼Œä¸€æ—¦å®¹å™¨è¢«è¿ç§»ï¼Œå¯é€‰å€¼å°±ä¼šè¢«é‡Šæ”¾ã€‚</div><div class="line">    åœ¨è¿™é‡Œï¼Œc2 çš„å€¼å°†è¢«å­˜å‚¨åœ¨è¿™ä¸ªå¯é€‰å€¼ä¸­ï¼Œå¯¹è±¡å°†æš‚æ—¶strong_retained ç„¶åé‡Šæ”¾ã€‚</div><div class="line">  */</div><div class="line">  %<span class="number">30</span> = alloc_box $@sil_weak <span class="type">Optional</span>&lt;aClass&gt;, <span class="keyword">var</span>, name <span class="string">"c2"</span>, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">23</span>, scope <span class="number">2</span> <span class="comment">// users: %46, %44, %43, %31</span></div><div class="line">  %<span class="number">31</span> = project_box %<span class="number">30</span> : $@box @sil_weak <span class="type">Optional</span>&lt;aClass&gt;, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">23</span>, scope <span class="number">2</span> <span class="comment">// user: %35</span></div><div class="line">  %<span class="number">32</span> = load %<span class="number">19</span> : $*aClass, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">23</span>, scope <span class="number">2</span> <span class="comment">// users: %34, %33</span></div><div class="line">  strong_retain %<span class="number">32</span> : $aClass, loc <span class="string">"sample.swift"</span>:<span class="number">9</span>:<span class="number">23</span>, scope <span class="number">2</span> <span class="comment">// id: %33</span></div><div class="line">  %<span class="number">34</span> = <span class="class"><span class="keyword">enum</span> <span class="title">$Optional</span>&lt;<span class="title">aClass</span>&gt;, #<span class="title">Optional</span>.<span class="title">some</span>!<span class="title">enumelt</span>.1, %32 : <span class="title">$aClass</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":9:23, <span class="title">scope</span> 2 // <span class="title">users</span>: %36, %35</span></div><div class="line">  <span class="title">store_weak</span> %34 <span class="title">to</span> [<span class="title">initialization</span>] %31 : <span class="title">$</span>*@<span class="title">sil_weak</span> <span class="title">Optional</span>&lt;<span class="title">aClass</span>&gt;, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":9:23, <span class="title">scope</span> 2 // <span class="title">id</span>: %35</div><div class="line">  <span class="title">release_value</span> %34 : <span class="title">$Optional</span>&lt;<span class="title">aClass</span>&gt;, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":9:23, <span class="title">scope</span> 2 // <span class="title">id</span>: %36</div><div class="line">  /*</div><div class="line">    è·å–åˆ°é—­åŒ…çš„å¼•ç”¨ã€‚</div><div class="line">  */</div><div class="line">  // <span class="title">function_ref</span> (<span class="title">closure</span> #1)</div><div class="line">  %37 = <span class="title">function_ref</span> @<span class="title">sample</span>.(<span class="title">closure</span> #1) : <span class="title">$</span>@<span class="title">convention</span>(<span class="title">thin</span>) (@<span class="title">owned</span> @<span class="title">sil_unowned</span> <span class="title">aClass</span>, @<span class="title">owned</span> @<span class="title">box</span> @<span class="title">sil_weak</span> <span class="title">Optional</span>&lt;<span class="title">aClass</span>&gt;) -&gt; (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":8:13, <span class="title">scope</span> 2 // <span class="title">user</span>: %44</div><div class="line">  /*</div><div class="line">    <span class="title">c1</span> å°†è¢«æ ‡è®°ä¸º <span class="title">tagged</span>ï¼Œå¹¶ä¸”å˜é‡å˜ä¸º <span class="title">unowned_retained</span>ã€‚</div><div class="line">  */</div><div class="line">  <span class="title">strong_retain_unowned</span> %27 : <span class="title">$</span>@<span class="title">sil_unowned</span> <span class="title">aClass</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":8:13, <span class="title">scope</span> 2 // <span class="title">id</span>: %38</div><div class="line">  %39 = <span class="title">unowned_to_ref</span> %27 : <span class="title">$</span>@<span class="title">sil_unowned</span> <span class="title">aClass</span> <span class="title">to</span> <span class="title">$aClass</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":8:13, <span class="title">scope</span> 2 // <span class="title">users</span>: %42, %40</div><div class="line">  %40 = <span class="title">ref_to_unowned</span> %39 : <span class="title">$aClass</span> <span class="title">to</span> <span class="title">$</span>@<span class="title">sil_unowned</span> <span class="title">aClass</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":8:13, <span class="title">scope</span> 2 // <span class="title">users</span>: %44, %41</div><div class="line">  <span class="title">unowned_retain</span> %40 : <span class="title">$</span>@<span class="title">sil_unowned</span> <span class="title">aClass</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":8:13, <span class="title">scope</span> 2 // <span class="title">id</span>: %41</div><div class="line">  <span class="title">strong_release</span> %39 : <span class="title">$aClass</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":8:13, <span class="title">scope</span> 2 // <span class="title">id</span>: %42</div><div class="line">  /*</div><div class="line">    åŒ…å« <span class="title">c2</span> çš„å¯é€‰å€¼å®¹å™¨æ˜¯ <span class="title">strong_retained</span> çš„ã€‚</div><div class="line">  */</div><div class="line">  <span class="title">strong_retain</span> %30 : <span class="title">$</span>@<span class="title">box</span> @<span class="title">sil_weak</span> <span class="title">Optional</span>&lt;<span class="title">aClass</span>&gt;, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":8:13, <span class="title">scope</span> 2 // <span class="title">id</span>: %43</div><div class="line">  /*</div><div class="line">    åˆ›å»ºä¸€ä¸ªé—­åŒ…å¯¹è±¡ï¼Œç»‘å®šæ–¹æ³•åˆ°å‚æ•°ä¸­ã€‚</div><div class="line">  */</div><div class="line">  %44 = <span class="title">partial_apply</span> %37(%40, %30) : <span class="title">$</span>@<span class="title">convention</span>(<span class="title">thin</span>) (@<span class="title">owned</span> @<span class="title">sil_unowned</span> <span class="title">aClass</span>, @<span class="title">owned</span> @<span class="title">box</span> @<span class="title">sil_weak</span> <span class="title">Optional</span>&lt;<span class="title">aClass</span>&gt;) -&gt; (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":8:13, <span class="title">scope</span> 2 // <span class="title">user</span>: %45</div><div class="line">  <span class="title">store</span> %44 <span class="title">to</span> %25 : <span class="title">$</span>*@<span class="title">callee_owned</span> () -&gt; (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":8:13, <span class="title">scope</span> 2 // <span class="title">id</span>: %45</div><div class="line">  /*</div><div class="line">    </div><div class="line">    å¯¹ <span class="title">c1</span> å’Œ <span class="title">c2</span> çš„å®¹å™¨å˜é‡è¿›è¡Œé‡Šæ”¾ï¼ˆä½¿ç”¨ å¯¹åº”åŒ¹é…çš„ *<span class="title">_release</span> æ–¹æ³•ï¼‰ã€‚</div><div class="line">  */</div><div class="line">  <span class="title">strong_release</span> %30 : <span class="title">$</span>@<span class="title">box</span> @<span class="title">sil_weak</span> <span class="title">Optional</span>&lt;<span class="title">aClass</span>&gt;, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":14:1, <span class="title">scope</span> 2 // <span class="title">id</span>: %46</div><div class="line">  <span class="title">unowned_release</span> %27 : <span class="title">$</span>@<span class="title">sil_unowned</span> <span class="title">aClass</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":9:14, <span class="title">scope</span> 2 // <span class="title">id</span>: %47</div><div class="line">  /*</div><div class="line">     åŠ è½½åŸå…ˆå­˜å‚¨çš„é—­åŒ…å¯¹è±¡ï¼Œå¢åŠ å¼ºå¼•ç”¨ç„¶åè°ƒç”¨å®ƒã€‚</div><div class="line">  */</div><div class="line">   %48 = <span class="title">load</span> %25 : <span class="title">$</span>*@<span class="title">callee_owned</span> () -&gt; (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":17:1, <span class="title">scope</span> 2 // <span class="title">users</span>: %50, %49</div><div class="line">  <span class="title">strong_retain</span> %48 : <span class="title">$</span>@<span class="title">callee_owned</span> () -&gt; (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":17:1, <span class="title">scope</span> 2 // <span class="title">id</span>: %49</div><div class="line">  %50 = <span class="title">apply</span> %48() : <span class="title">$</span>@<span class="title">callee_owned</span> () -&gt; (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":17:7, <span class="title">scope</span> 2</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é—­åŒ…æœ‰ä¸€ä¸ªæ›´åŠ å¤æ‚çš„ç»“æ„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">  é—­åŒ…å‚æ•°è¢«æ ‡è®°ä¸º @sil, æŒ‡å®šå‚æ•°å¦‚ä½•è¢«è®¡æ•°ï¼Œæœ‰ä¸€ä¸ª unowned çš„ aClass ç±»å˜é‡ c2, å’Œå¦å¤–ä¸€ä¸ªåŒ…å« c2 çš„å¯é€‰å€¼å®¹å™¨ã€‚</div><div class="line">*/</div><div class="line"><span class="comment">// (closure #1)</span></div><div class="line">sil shared @clos.fSpec: $<span class="meta">@convention</span>(thin) (@owned @sil_unowned aClass, @owned @box @sil_weak <span class="type">Optional</span>&lt;aClass&gt;) -&gt; () &#123;</div><div class="line"><span class="comment">// %0                                             // users: %24, %6, %5, %2</span></div><div class="line"><span class="comment">// %1                                             // users: %23, %3</span></div><div class="line"><span class="comment">/*</span></div><div class="line">  ä¸‹é¢çš„å‡½æ•°åŒ…å«ä¸‰å—ï¼Œåé¢ä¸¤å—çš„æ‰§è¡Œä¾èµ–å¯é€‰å€¼ c2 å…·ä½“çš„å€¼ã€‚</div><div class="line">*/</div><div class="line">bb0(%<span class="number">0</span> : $@sil_unowned aClass, %<span class="number">1</span> : $@box @sil_weak <span class="type">Optional</span>&lt;aClass&gt;):</div><div class="line">...</div><div class="line">  <span class="comment">/*</span></div><div class="line">    c1 è¢«å¼ºè®¡æ•°ã€‚</div><div class="line">  */</div><div class="line">  strong_retain_unowned %<span class="number">0</span> : $@sil_unowned aClass, loc <span class="string">"sample.swift"</span>:<span class="number">10</span>:<span class="number">5</span>, scope <span class="number">17</span> <span class="comment">// id: %5</span></div><div class="line">  %<span class="number">6</span> = unowned_to_ref %<span class="number">0</span> : $@sil_unowned aClass to $aClass, loc <span class="string">"sample.swift"</span>:<span class="number">10</span>:<span class="number">5</span>, scope <span class="number">17</span> <span class="comment">// users: %11, %10, %9</span></div><div class="line">  <span class="comment">/*</span></div><div class="line">    ä½¿ç”¨å†…éƒ¨è‡ªå¸¦åŒ…ï¼Œä¼ å…¥ä¸€ä¸ªæ•´å‹å­—é¢é‡åˆ°æ•´å‹ç»“æ„ä¸­ï¼Œåˆå§‹åŒ–äº†ä¸€ä¸ªå€¼ä¸º 42 çš„æ•´å‹å€¼ã€‚</div><div class="line">    è¿™ä¸ªå€¼å°†è¢«è®¾ç½®ä¸º c1 çš„æ–°å€¼ï¼Œå®Œæˆä»¥åè¿™ä¸ªå˜é‡å°†ä¼šè¢«é‡Šæ”¾ã€‚</div><div class="line">    åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç¬¬ä¸€æ¬¡çœ‹åˆ° class_method æŒ‡ä»¤ï¼Œç”¨äºè·å– vtable ä¸­çš„å‡½æ•°å¼•ç”¨ã€‚</div><div class="line">  */</div><div class="line">  %<span class="number">7</span> = integer_literal $<span class="type">Builtin</span>.<span class="type">Int64</span>, <span class="number">42</span>, loc <span class="string">"sample.swift"</span>:<span class="number">10</span>:<span class="number">16</span>, scope <span class="number">17</span> <span class="comment">// user: %8</span></div><div class="line">  %<span class="number">8</span> = <span class="class"><span class="keyword">struct</span> <span class="title">$Int</span> (%7 : <span class="title">$Builtin</span>.<span class="title">Int64</span>), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":10:16, <span class="title">scope</span> 17 // <span class="title">user</span>: %10</span></div><div class="line">  %9 = <span class="title">class_method</span> %6 : <span class="title">$aClass</span>, #<span class="title">aClass</span>.<span class="title">value</span>!<span class="title">setter</span>.1 : (<span class="title">aClass</span>) -&gt; (<span class="title">Int</span>) -&gt; () , <span class="title">$</span>@<span class="title">convention</span>(<span class="title">method</span>) (<span class="title">Int</span>, @<span class="title">guaranteed</span> <span class="title">aClass</span>) -&gt; (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":10:14, <span class="title">scope</span> 17 // <span class="title">user</span>: %10</div><div class="line">  %10 = <span class="title">apply</span> %9(%8, %6) : <span class="title">$</span>@<span class="title">convention</span>(<span class="title">method</span>) (<span class="title">Int</span>, @<span class="title">guaranteed</span> <span class="title">aClass</span>) -&gt; (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":10:14, <span class="title">scope</span> 17</div><div class="line">  <span class="title">strong_release</span> %6 : <span class="title">$aClass</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":10:16, <span class="title">scope</span> 17 // <span class="title">id</span>: %11</div><div class="line">  /*</div><div class="line">    æ¥ä¸‹æ¥è®¨è®º <span class="title">c2</span>ã€‚</div><div class="line">    è·å–å¯é€‰å€¼ï¼Œç„¶åæ ¹æ®å®ƒçš„å†…å®¹æ‰§è¡Œæ¥ä¸‹æ¥çš„åˆ†æ”¯è¯­å¥ã€‚</div><div class="line"></div><div class="line">    <span class="title">If</span> <span class="title">the</span> <span class="title">optional</span> <span class="title">has</span> <span class="title">a</span> <span class="title">value</span> <span class="title">the</span> <span class="title">bb2</span> <span class="title">block</span> <span class="title">will</span> <span class="title">be</span> <span class="title">executed</span> <span class="title">before</span> <span class="title">jumping</span> </div><div class="line">    <span class="title">to</span> <span class="title">bb3</span>, <span class="title">if</span> <span class="title">it</span> <span class="title">doesn</span>'<span class="title">t</span> <span class="title">after</span> <span class="title">a</span> <span class="title">brief</span> <span class="title">jump</span> <span class="title">to</span> <span class="title">bb1</span>, <span class="title">the</span> <span class="title">function</span> <span class="title">will</span> <span class="title">proceed</span> <span class="title">to</span> <span class="title">bb3</span> <span class="title">releasing</span></div><div class="line">    <span class="title">the</span> <span class="title">retained</span> <span class="title">parameters</span>.</div><div class="line">    </div><div class="line">  */</div><div class="line">  %12 = <span class="title">load_weak</span> %3 : <span class="title">$</span>*@<span class="title">sil_weak</span> <span class="title">Optional</span>&lt;<span class="title">aClass</span>&gt;, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":11:18, <span class="title">scope</span> 18 // <span class="title">user</span>: %13</div><div class="line">  <span class="title">switch_enum</span> %12 : <span class="title">$Optional</span>&lt;<span class="title">aClass</span>&gt;, <span class="title">case</span> #<span class="title">Optional</span>.<span class="title">some</span>!<span class="title">enumelt</span>.1: <span class="title">bb2</span>, <span class="title">default</span> <span class="title">bb1</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":11:18, <span class="title">scope</span> 18 // <span class="title">id</span>: %13</div><div class="line">  <span class="title">bb1</span>:                                              // <span class="title">Preds</span>: <span class="title">bb0</span></div><div class="line">  /*</div><div class="line">    è·³è½¬åˆ°é—­åŒ…çš„ç»“å°¾ã€‚</div><div class="line">  */</div><div class="line">  <span class="title">br</span> <span class="title">bb3</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":11:18, <span class="title">scope</span> 16        // <span class="title">id</span>: %14</div><div class="line"></div><div class="line">// %15                                            // <span class="title">users</span>: %21, %20, %19, %16</div><div class="line"><span class="title">bb2</span>(%15 : <span class="title">$aClass</span>):                               // <span class="title">Preds</span>: <span class="title">bb0</span></div><div class="line">  /*</div><div class="line">    è°ƒç”¨ <span class="title">aClass</span> çš„ <span class="title">setter</span>ï¼Œè®¾ç½®å®ƒçš„å€¼ä¸º 42.</div><div class="line">  */</div><div class="line">  ...</div><div class="line">  %17 = <span class="title">integer_literal</span> <span class="title">$Builtin</span>.<span class="title">Int64</span>, 42, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":12:21, <span class="title">scope</span> 19 // <span class="title">user</span>: %18</div><div class="line">  %18 = <span class="title">struct</span> <span class="title">$Int</span> (%17 : <span class="title">$Builtin</span>.<span class="title">Int64</span>), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":12:21, <span class="title">scope</span> 19 // <span class="title">user</span>: %20</div><div class="line">  %19 = <span class="title">class_method</span> %15 : <span class="title">$aClass</span>, #<span class="title">aClass</span>.<span class="title">value</span>!<span class="title">setter</span>.1 : (<span class="title">aClass</span>) -&gt; (<span class="title">Int</span>) -&gt; () , <span class="title">$</span>@<span class="title">convention</span>(<span class="title">method</span>) (<span class="title">Int</span>, @<span class="title">guaranteed</span> <span class="title">aClass</span>) -&gt; (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":12:19, <span class="title">scope</span> 19 // <span class="title">user</span>: %20</div><div class="line">  %20 = <span class="title">apply</span> %19(%18, %15) : <span class="title">$</span>@<span class="title">convention</span>(<span class="title">method</span>) (<span class="title">Int</span>, @<span class="title">guaranteed</span> <span class="title">aClass</span>) -&gt; (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":12:19, <span class="title">scope</span> 19</div><div class="line">  <span class="title">strong_release</span> %15 : <span class="title">$aClass</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":13:5, <span class="title">scope</span> 18 // <span class="title">id</span>: %21</div><div class="line">  <span class="title">br</span> <span class="title">bb3</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":13:5, <span class="title">scope</span> 18         // <span class="title">id</span>: %22</div><div class="line"></div><div class="line"><span class="title">bb3</span>:                                              // <span class="title">Preds</span>: <span class="title">bb1</span> <span class="title">bb2</span></div><div class="line">  /*</div><div class="line">    é‡Šæ”¾æ‰€æœ‰è·å–çš„å˜é‡ç„¶åè¿”å›ã€‚</div><div class="line">  */</div><div class="line">  <span class="title">strong_release</span> %1 : <span class="title">$</span>@<span class="title">box</span> @<span class="title">sil_weak</span> <span class="title">Optional</span>&lt;<span class="title">aClass</span>&gt;, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":14:1, <span class="title">scope</span> 17 // <span class="title">id</span>: %23</div><div class="line">  <span class="title">unowned_release</span> %0 : <span class="title">$</span>@<span class="title">sil_unowned</span> <span class="title">aClass</span>, <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":14:1, <span class="title">scope</span> 17 // <span class="title">id</span>: %24</div><div class="line">  %25 = <span class="title">tuple</span> (), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":14:1, <span class="title">scope</span> 17 // <span class="title">user</span>: %26</div><div class="line">  <span class="title">return</span> %25 : <span class="title">$</span>(), <span class="title">loc</span> "<span class="title">sample</span>.<span class="title">swift</span>":14:1, <span class="title">scope</span> 17 // <span class="title">id</span>: %26</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œï¼Œå¿½ç•¥æ‰ä¸åŒçš„ <code>ARC</code> æŒ‡ä»¤å¸¦æ¥çš„æ€§èƒ½çš„å·®å¼‚ç‚¹ï¼Œå¯¹ä¸åŒé˜¶æ®µæ¯ç§ç±»å‹çš„æ•è·å˜é‡åšä¸€ä¸ªå¿«é€Ÿçš„å¯¹æ¯”ï¼š</p>
<table>
<thead>
<tr>
<th>åŠ¨ä½œ</th>
<th style="text-align:center">Unowned</th>
<th style="text-align:right">Weak</th>
</tr>
</thead>
<tbody>
<tr>
<td>é¢„å…ˆè°ƒç”¨ #1</td>
<td style="text-align:center">å¯¹è±¡è¿›è¡Œ unowned_retain æ“ä½œ</td>
<td style="text-align:right">åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œå¹¶ä¸”å¯¹è±¡è¿›è¡Œ strong_retain æ“ä½œã€‚åˆ›å»ºä¸€ä¸ªå¯é€‰å€¼ï¼Œå­˜å…¥åˆ°å®¹å™¨ä¸­ï¼Œç„¶åé‡Šæ”¾å¯é€‰å€¼</td>
</tr>
<tr>
<td>é¢„å…ˆè°ƒç”¨ #2</td>
<td style="text-align:center">strong_retain_unownedï¼Œunowned_retain å’Œ strong_release</td>
<td style="text-align:right">strong_retain</td>
</tr>
<tr>
<td>é—­åŒ…æ‰§è¡Œ</td>
<td style="text-align:center">strong_retain_unownedï¼Œunowned_release</td>
<td style="text-align:right">load_weak, æ‰“å¼€å¯é€‰å€¼, strong_release</td>
</tr>
<tr>
<td>è°ƒç”¨ä¹‹å</td>
<td style="text-align:center">unowned_release</td>
<td style="text-align:right">strong_release</td>
</tr>
</tbody>
</table>
<p>æ­£å¦‚ä¸Šé¢çœ‹åˆ°çš„ SIL ä»£ç æ®µé‚£æ ·ï¼Œå¤„ç† weak å¼•ç”¨ä¼šæ¶‰åŠåˆ°æ›´å¤šçš„å·¥ä½œï¼Œå› ä¸ºéœ€è¦å¤„ç†å¼•ç”¨éœ€è¦çš„å¯é€‰å€¼ã€‚</p>
<p>å‚ç…§<a href="https://github.com/apple/swift/blob/master/docs/SIL.rst%22" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>çš„æè¿°ï¼Œè¿™é‡Œå¯¹æ¶‰åŠåˆ°çš„æ‰€æœ‰ ARC æŒ‡ä»¤åšä¸€ä¸ªç®€è¦çš„è§£é‡Šï¼š</p>
<ul>
<li><strong>unowned_retain</strong>ï¼š<em>å¢åŠ å †å¯¹è±¡ä¸­çš„ unowned å¼•ç”¨è®¡æ•°ã€‚</em></li>
<li><strong>strong_retain_unowned</strong> ï¼š<em>æ–­è¨€å¯¹è±¡çš„å¼ºå¼•ç”¨è®¡æ•°å¤§äº 0ï¼Œç„¶åå¢åŠ è¿™ä¸ªå¼•ç”¨è®¡æ•°ã€‚</em></li>
<li><strong>strong_retain</strong>ï¼š<em>å¢åŠ å¯¹è±¡çš„å¼ºå¼•ç”¨è®¡æ•°ã€‚</em></li>
<li><strong>load_weak</strong>ï¼š<em>ä¸æ˜¯çœŸæ­£çš„ ARC è°ƒç”¨ï¼Œä½†æ˜¯å®ƒå°†å¢åŠ å¯é€‰å€¼æŒ‡å‘å¯¹è±¡çš„å¼ºå¼•ç”¨è®¡æ•°ã€‚</em></li>
<li><strong>strong_release</strong>ï¼š<em>å‡å°‘å¯¹è±¡çš„å¼ºå¼•ç”¨è®¡æ•°ã€‚å¦‚æœé‡Šæ”¾æ“ä½œæŠŠå¯¹è±¡å¼ºå¼•ç”¨è®¡æ•°å˜ä¸º0ï¼Œå¯¹è±¡å°†è¢«é”€æ¯ï¼Œç„¶åå¼±å¼•ç”¨å°†è¢«æ¸…é™¤ã€‚å½“æ•´ä¸ªå¼ºå¼•ç”¨è®¡æ•°å’Œ unowned å¼•ç”¨è®¡æ•°éƒ½ä¸º0æ—¶ï¼Œå¯¹è±¡çš„å†…å­˜æ‰ä¼šè¢«é‡Šæ”¾ã€‚</em></li>
<li><strong>unowned_release</strong>ï¼š<em>å‡å°‘å¯¹è±¡çš„ unowned å¼•ç”¨è®¡æ•°ã€‚å½“æ•´ä¸ªå¼ºå¼•ç”¨è®¡æ•°å’Œ unowned å¼•ç”¨è®¡æ•°éƒ½ä¸º 0 æ—¶ï¼Œå¯¹è±¡çš„å†…å­˜æ‰ä¼šè¢«é‡Šæ”¾ã€‚</em></li>
</ul>
<p>æ¥ä¸‹æ¥æ·±å…¥åˆ° <code>Swift</code> è¿è¡Œæ—¶çœ‹çœ‹ï¼Œè¿™äº›æŒ‡ä»¤éƒ½æ˜¯å¦‚ä½•è¢«å®ç°çš„ï¼Œç›¸å…³çš„ä»£ç æ–‡ä»¶æœ‰ï¼š<a href="https://github.com/apple/swift/blob/master/stdlib/public/runtime/HeapObject.cpp" target="_blank" rel="external">HeapObject.cpp</a>ï¼Œ<a href="https://github.com/apple/swift/blob/master/include/swift/Runtime/HeapObject.h" target="_blank" rel="external">HeapObject.h</a>ï¼Œ<a href="https://github.com/apple/swift/blob/master/stdlib/public/SwiftShims/RefCount.h" target="_blank" rel="external">RefCount.h</a> å’Œ <a href="https://github.com/apple/swift/blob/master/stdlib/public/runtime/Heap.cpp" target="_blank" rel="external">Heap.cpp</a>ã€ <a href="https://github.com/apple/swift/blob/master/stdlib/public/runtime/SwiftObject.mm" target="_blank" rel="external">SwiftObject.mm</a> ä¸­çš„å°‘é‡å®šä¹‰ã€‚å®¹å™¨å®ç°å¯ä»¥åœ¨ <a href="https://github.com/apple/swift/blob/master/stdlib/public/runtime/MetadataImpl.h" target="_blank" rel="external">MetadataImpl.h</a> æ‰¾åˆ°ï¼Œä½†æ˜¯æœ¬æ–‡ä¸å±•å¼€è®¨è®ºã€‚</p>
<p>è¿™äº›æ–‡ä»¶ä¸­å®šä¹‰å¤§å¤šæ•°çš„ <code>ARC</code> æ–¹æ³•éƒ½æœ‰ä¸‰ç§å˜ä½“ï¼Œä¸€ç§æ˜¯å¯¹ <code>Swift</code> å¯¹è±¡çš„åŸºç¡€å®ç°ï¼Œå¦å¤–ä¸¤ç§å®ç°æ˜¯é’ˆå¯¹éåŸç”Ÿ Swift å¯¹è±¡çš„ï¼šæ¡¥æ¥å¯¹è±¡å’ŒæœªçŸ¥å¯¹è±¡ã€‚åé¢ä¸¤ç§å˜ä½“è¿™é‡Œä¸äºˆè®¨è®ºã€‚</p>
<p>ç¬¬ä¸€ä¸ªè®¨è®ºæŒ‡ä»¤é›†å’Œ <code>unowned</code> å¼•ç”¨ç›¸å…³ã€‚</p>
<p>åœ¨ <a href="https://github.com/apple/swift/blob/master/stdlib/public/runtime/HeapObject.cpp" target="_blank" rel="external">HeapObject.cpp</a> æ–‡ä»¶ä¸­é—´å¯ä»¥çœ‹åˆ°å¯¹ <code>unowned_retain</code> å’Œ <code>unowned_release</code> çš„å®ç°æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">SWIFT_RT_ENTRY_VISIBILITY</span></div><div class="line">void swift::swift_unownedRetain(<span class="type">HeapObject</span> *object)</div><div class="line">    <span class="type">SWIFT_CC</span>(<span class="type">RegisterPreservingCC_IMPL</span>) &#123;</div><div class="line">  <span class="keyword">if</span> (!object)</div><div class="line">    <span class="keyword">return</span>;</div><div class="line"></div><div class="line">  object-&gt;weakRefCount.increment();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="type">SWIFT_RT_ENTRY_VISIBILITY</span></div><div class="line">void swift::swift_unownedRelease(<span class="type">HeapObject</span> *object)</div><div class="line">    <span class="type">SWIFT_CC</span>(<span class="type">RegisterPreservingCC_IMPL</span>) &#123;</div><div class="line">  <span class="keyword">if</span> (!object)</div><div class="line">    <span class="keyword">return</span>;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (object-&gt;weakRefCount.decrementShouldDeallocate()) &#123;</div><div class="line">    <span class="comment">// Only class objects can be weak-retained and weak-released.</span></div><div class="line">    auto metadata = object-&gt;metadata;</div><div class="line">    <span class="built_in">assert</span>(metadata-&gt;isClassObject());</div><div class="line">    auto classMetadata = static_cast&lt;const <span class="type">ClassMetadata</span>*&gt;(metadata);</div><div class="line">    <span class="built_in">assert</span>(classMetadata-&gt;isTypeMetadata());</div><div class="line">    <span class="type">SWIFT_RT_ENTRY_CALL</span>(swift_slowDealloc)</div><div class="line">        (object, classMetadata-&gt;getInstanceSize(),</div><div class="line">         classMetadata-&gt;getInstanceAlignMask());</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>swift_unownedRetain</code> æ˜¯ <code>unowned_retain</code> çš„å…·ä½“å®ç°ï¼Œç®€å•åœ°è¿›è¡Œ <code>unowned</code> å¼•ç”¨è®¡æ•°çš„åŸå­å¢åŠ æ“ä½œï¼ˆè¿™é‡Œå®šä¹‰ä¸º<code>weakRefCount</code>ï¼‰ï¼Œ<code>swift_unownedRelease</code> æ›´åŠ å¤æ‚ï¼ŒåŸå› ä¹‹å‰ä¹Ÿæè¿°è¿‡ï¼Œå½“æ²¡æœ‰å…¶ä»– unowned å¼•ç”¨å­˜åœ¨æ—¶ï¼Œå®ƒéœ€è¦æ‰§è¡Œå¯¹è±¡çš„ææ„æ“ä½œã€‚</p>
<p>ä½†æ˜¯æ•´ä½“æ¥è®²éƒ½ä¸å¤æ‚ï¼Œåœ¨<a href="https://github.com/apple/swift/blob/master/stdlib/public/SwiftShims/RefCount.h#L242" target="_blank" rel="external">è¿™é‡Œ</a>å¯ä»¥çœ‹åˆ° <code>doDecrementShouldDeallocate</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ä¸Šé¢ä»£ç ä¸­è¢«ä¸€ä¸ªå‘½åç±»ä¼¼çš„æ–¹æ³•è°ƒç”¨äº†ã€‚è¿™ä¸ªæ–¹æ³•æ²¡æœ‰åšå¤ªå¤šï¼Œ<code>swift_slowDealloc</code> åªæ˜¯é‡Šæ”¾ç»™å®šçš„æŒ‡é’ˆã€‚</p>
<p>åˆ°æ­¤å·²ç»æœ‰äº†ä¸€ä¸ªå¯¹è±¡çš„ unowned å¼•ç”¨ï¼Œå¦å¤–ä¸€ä¸ªæŒ‡ä»¤ï¼Œ<code>strong_retain_unowned</code> ç”¨æ¥åˆ›å»ºä¸€ä¸ªå¼ºå¼•ç”¨ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">SWIFT_RT_ENTRY_VISIBILITY</span></div><div class="line">void swift::swift_unownedRetainStrong(<span class="type">HeapObject</span> *object)</div><div class="line">    <span class="type">SWIFT_CC</span>(<span class="type">RegisterPreservingCC_IMPL</span>) &#123;</div><div class="line">  <span class="keyword">if</span> (!object)</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  <span class="built_in">assert</span>(object-&gt;weakRefCount.getCount() &amp;&amp;</div><div class="line">         <span class="string">"object is not currently weakly retained"</span>);</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (! object-&gt;refCount.tryIncrement())</div><div class="line">    _swift_abortRetainUnowned(object);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å› ä¸ºå¼±å¼•ç”¨åº”è¯¥æŒ‡å‘äº†è¿™ä¸ªå¯¹è±¡ï¼Œè¦ä½¿ç”¨æ–­è¨€æ¥éªŒè¯å¯¹è±¡æ˜¯å¦è¢«å¼±å¼•ç”¨ï¼Œä¸€æ—¦æ–­è¨€é€šè¿‡ï¼Œå°†å°è¯•è¿›è¡Œå¢åŠ å¼ºå¼•ç”¨è®¡æ•°çš„æ“ä½œã€‚ä¸€æ—¦å¯¹è±¡åœ¨è¿›ç¨‹ä¸­å·²ç»è¢«é‡Šæ”¾ï¼Œå°è¯•å°†ä¼šå¤±è´¥ã€‚</p>
<p>æ‰€æœ‰ç±»ä¼¼äº <code>tryIncrement</code> é€šè¿‡æŸç§å½¢å¼ä¿®æ”¹å¼•ç”¨è®¡æ•°çš„æ–¹æ³•éƒ½æ”¾åˆ° <a href="https://github.com/apple/swift/blob/master/stdlib/public/SwiftShims/RefCount.h" target="_blank" rel="external">RefCount.h</a> ä¸­ï¼Œéœ€è¦ä½¿ç”¨åŸå­æ“ä½œè¿›è¡Œè¿™äº›ä»»åŠ¡ã€‚</p>
<p>æ¥ä¸‹æ¥è®¨è®ºä¸‹ <code>weak</code> å¼•ç”¨çš„çš„å®ç°ï¼Œæ­£å¦‚ä¹‹å‰çœ‹åˆ°çš„é‚£æ ·ï¼Œ<code>swift_weakLoadStrong</code> ç”¨æ¥è·å–å®¹å™¨ä¸­å¯é€‰å€¼ä¸­å¼ºå¼•ç”¨çš„å¯¹è±¡ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">HeapObject</span> *swift::swift_weakLoadStrong(<span class="type">WeakReference</span> *ref) &#123;</div><div class="line">  <span class="keyword">if</span> (ref-&gt;<span class="type">Value</span> == (uintptr_t)nullptr) &#123;</div><div class="line">    <span class="keyword">return</span> nullptr;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// ref å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®</span></div><div class="line">  auto ptr = __atomic_fetch_or(&amp;ref-&gt;<span class="type">Value</span>, <span class="type">WR_READING</span>, __ATOMIC_RELAXED);</div><div class="line">  <span class="keyword">while</span> (ptr &amp; <span class="type">WR_READING</span>) &#123;</div><div class="line">    short <span class="built_in">c</span> = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (__atomic_load_n(&amp;ref-&gt;<span class="type">Value</span>, __ATOMIC_RELAXED) &amp; <span class="type">WR_READING</span>) &#123;</div><div class="line">      <span class="keyword">if</span> (++<span class="built_in">c</span> == <span class="type">WR_SPINLIMIT</span>) &#123;</div><div class="line">        std::this_thread::yield();</div><div class="line">        <span class="built_in">c</span> -= <span class="number">1</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    ptr = __atomic_fetch_or(&amp;ref-&gt;<span class="type">Value</span>, <span class="type">WR_READING</span>, __ATOMIC_RELAXED);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  auto object = (<span class="type">HeapObject</span>*)(ptr &amp; ~<span class="type">WR_NATIVE</span>);</div><div class="line">  <span class="keyword">if</span> (object == nullptr) &#123;</div><div class="line">    __atomic_store_n(&amp;ref-&gt;<span class="type">Value</span>, (uintptr_t)nullptr, __ATOMIC_RELAXED);</div><div class="line">    <span class="keyword">return</span> nullptr;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (object-&gt;refCount.isDeallocating()) &#123;</div><div class="line">    __atomic_store_n(&amp;ref-&gt;<span class="type">Value</span>, (uintptr_t)nullptr, __ATOMIC_RELAXED);</div><div class="line">    <span class="type">SWIFT_RT_ENTRY_CALL</span>(swift_unownedRelease)(object);</div><div class="line">    <span class="keyword">return</span> nullptr;</div><div class="line">  &#125;</div><div class="line">  auto result = swift_tryRetain(object);</div><div class="line">  __atomic_store_n(&amp;ref-&gt;<span class="type">Value</span>, ptr, __ATOMIC_RELAXED);</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œè·å–ä¸€ä¸ªå¼ºå¼•ç”¨éœ€è¦<a href="https://github.com/apple/swift/pull/1454" target="_blank" rel="external">æ›´å¤šå¤æ‚åŒæ­¥æ“ä½œ</a>ï¼Œåœ¨å¤šçº¿ç¨‹ç«äº‰ä¸¥é‡çš„æƒ…å†µä¸‹ï¼Œä¼šå¸¦æ¥æ€§èƒ½æŸè€—ã€‚</p>
<p>åœ¨è¿™é‡Œç¬¬ä¸€æ¬¡å‡ºç°çš„ <code>WeakReference</code> å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªç®€å•çš„ç»“æ„ä½“ï¼ŒåŒ…å«ä¸€ä¸ªæ•´å‹å€¼å­—æ®µæŒ‡å‘ç›®æ ‡å¯¹è±¡ï¼Œç›®æ ‡å¯¹è±¡æ˜¯ä½¿ç”¨ <code>HeapObject</code> ç±»æ¥æ‰¿è½½çš„æ¯ä¸€ä¸ªè¿è¡Œæ—¶çš„ Swift å¯¹è±¡ã€‚ </p>
<p>åœ¨ weak å¼•ç”¨è¯¢é—®å½“å‰çº¿ç¨‹è®¾ç½®çš„ <code>WR_READING</code> æ ‡è¯†ä¹‹åï¼Œä»  <code>WeakReference</code>  å®¹å™¨ä¸­è·å– Swift å¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡ä¸å†æœ‰æ•ˆï¼Œæˆ–è€…åœ¨ç­‰å¾…è·å–èµ„æºæ—¶ï¼Œå®ƒå˜æˆå¯ä»¥è¿›è¡Œææ„ï¼Œå½“å‰çš„å¼•ç”¨ä¼šè¢«è®¾ç½®ä¸º <em>null</em>ã€‚</p>
<p>å¦‚æœå¯¹è±¡ä¾ç„¶æœ‰æ•ˆï¼Œè·å–å¯¹è±¡çš„å°è¯•å°†ä¼šæˆåŠŸã€‚</p>
<p>å› æ­¤ï¼Œä»è¿™ä¸ªè§’åº¦æ¥è®²ï¼Œå¯¹ weak å¼•ç”¨çš„å¸¸è§„æ“ä½œæ€§èƒ½æ¯” unowned å¼•ç”¨çš„æ›´ä½ï¼ˆä½†æ˜¯ä¸»è¦çš„é—®é¢˜è¿˜æ˜¯åœ¨å¯é€‰å€¼æ“ä½œä¸Šé¢ï¼‰ã€‚</p>
<p><a name="conclusion"></a></p>
<h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><p>ä¿å®ˆçš„ä½¿ç”¨ weak å¼•ç”¨æ˜¯å¦æ˜æ™ºå‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œæ— è®ºæ˜¯ä»æ€§èƒ½çš„è§’åº¦è¿˜æ˜¯ä»£ç æ¸…æ™°çš„è§’åº¦è€Œè¨€ã€‚</p>
<p>ä½¿ç”¨æ­£ç¡®çš„æ•è·ä¿®é¥°ç¬¦ç±»å‹ï¼Œæ˜ç¡®çš„è¡¨æ˜ä»£ç ä¸­çš„ç”Ÿå‘½å‘¨æœŸç‰¹æ€§ï¼Œå½“å…¶ä»–äººæˆ–è€…ä½ è‡ªå·±åœ¨è¯»ä½ çš„ä»£ç æ—¶ä¸å®¹æ˜“è¯¯è§£ã€‚</p>
<p><a name="footnotes"></a></p>
<h3 id="è„šæ³¨"><a href="#è„šæ³¨" class="headerlink" title="è„šæ³¨"></a>è„šæ³¨</h3><p><a name="1"></a><br>1ã€<em>è‹¹æœç¬¬ä¸€æ¬¡è®¨è®º weak/unowned äº‰è®®å¯ä»¥æŸ¥çœ‹<a href="https://devforums.apple.com/message/987086#987086" target="_blank" rel="external">è¿™é‡Œ</a>ï¼Œä¹‹ååœ¨ twitter ä¸Š Joe Groff å¯¹æ­¤ä¹Ÿè¿›è¡Œäº†è®¨è®ºï¼Œå¹¶ä¸”è¢« Michael Tsai <a href="http://mjtsai.com/blog/2015/11/24/how-swift-implements-unowned-and-weak-references/" target="_blank" rel="external">æ€»ç»“æˆæ–‡</a>ã€‚<br>è¿™ç¯‡æ–‡ç« ä»æ„å›¾è§’åº¦å‡ºå‘ï¼Œæä¾›äº†å®Œæ•´å¹¶ä¸”å¯æ“ä½œçš„è§£é‡Šã€‚</em></p>
<p><a name="2"></a><br>2ã€<em>ä»<a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" target="_blank" rel="external">ç»´åŸºç™¾ç§‘</a>ä¸­å¯ä»¥æ‰¾åˆ°å…³äº AST çš„è§£é‡Šï¼Œè¿˜å¯ä»¥ä» Slava Pestov çš„<a href="https://medium.com/@slavapestov/the-secret-life-of-types-in-swift-ff83c3c000a5#.jyxx86n2x" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>ä¸­çœ‹åˆ°å…³äº Swift ç¼–è¯‘å™¨ä¸­å¦‚ä½•å®ç° AST çš„ä¸€äº›ç»†èŠ‚ã€‚</em></p>
<p><a name="3"></a><br>3ã€<em>å…³äº SIL çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹è¯¦å°½çš„<a href="https://github.com/apple/swift/blob/master/docs/SIL.rst" target="_blank" rel="external">å®˜æ–¹ SIL æŒ‡å—</a>ï¼Œè¿˜æœ‰ 2015 LLVM å¼€å‘è€…ä¼šè®®çš„<a href="https://www.youtube.com/watch?v=Ntj8ab-5cvE" target="_blank" rel="external">è§†é¢‘</a>ã€‚Lex Chou å†™çš„ SIL å¿«é€ŸæŒ‡å—å¯ä»¥ç‚¹å‡»è¿™é‡Œ<a href="https://github.com/lexchou/swallow/tree/master/docs/en/sil-3-instruction-references" target="_blank" rel="external">æŸ¥çœ‹</a>ã€‚ </em></p>
<p><a name="4"></a><br>4ã€<em>æŸ¥çœ‹åœ¨ Swift ä¸­å¦‚ä½•è¿›è¡Œåç§°ç²‰ç¢ï¼ˆname manglingï¼‰çš„ç»†èŠ‚ï¼Œè¯·æŸ¥çœ‹ Lex Chou çš„<a href="https://github.com/lexchou/swallow/tree/master/docs/en/sil-1-mangling" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>ã€‚</em></p>
<p><a name="5"></a><br>5ã€<em>Mike Ash åœ¨ä»–çš„ Friday Q&amp;A ä¸­çš„<a href="https://www.mikeash.com/pyblog/friday-qa-2015-12-11-swift-weak-references.html" target="_blank" rel="external">ä¸€ç¯‡æ–‡ç« </a>ä¸­è®¨è®ºäº†å¦‚ä½•å®ç° weak å¼•ç”¨çš„ä¸€ç§å®è·µæ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•ä¸ç›®å‰ Swift çš„æ–¹æ³•å¯¹æ¯”èµ·æ¥æœ‰ä¸€äº›è¿‡æ—¶ï¼Œä½†æ˜¯å…¶ä¸­çš„è§£é‡Šä¾ç„¶å€¼å¾—å‚è€ƒã€‚</em></p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šUmberto Raimondiï¼Œ&lt;a href=&quot;https://www.uraimo.com/2016/10/27/unowned-or-weak-lifetime-and-performance/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016-10-27&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;http://codebuild.me/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;shanks&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://www.jianshu.com/users/7a2d2cc38444/latest_articles&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Crystal Sun&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;æ¯å½“å¤„ç†å¾ªç¯å¼•ç”¨ï¼ˆretain cyclesï¼‰æ—¶ï¼Œéœ€è¦è€ƒé‡å¯¹è±¡ç”Ÿå‘½å‘¨æœŸæ¥é€‰æ‹©&lt;code&gt;unowned&lt;/code&gt;æˆ–è€…&lt;code&gt;weak&lt;/code&gt;æ ‡è¯†ç¬¦ï¼Œè¿™å·²ç»æˆä¸ºäº†ä¸€ä¸ªå…±è¯†ã€‚ä½†æ˜¯æœ‰æ—¶ä»ç„¶ä¼šå¿ƒå­˜ç–‘é—®ï¼Œåœ¨å…·ä½“çš„ä½¿ç”¨ä¸­åº”è¯¥é€‰æ‹©å“ªä¸€ä¸ªï¼Œæˆ–è€…é€€ä¸€æ­¥è®²ï¼Œä¿å®ˆçš„åªä½¿ç”¨ weak æ˜¯ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡é¦–å…ˆå¯¹å¾ªç¯å¼•ç”¨çš„åŸºç¡€çŸ¥è¯†åšä¸€ä¸ªç®€è¦ä»‹ç»ï¼Œç„¶åä¼šåˆ†æ Swift æºä»£ç çš„ä¸€äº›ç‰‡æ®µï¼Œè®²è§£ &lt;code&gt;unowned&lt;/code&gt; å’Œ &lt;code&gt;weak&lt;/code&gt;  åœ¨ç”Ÿå‘½å‘¨æœŸå’Œæ€§èƒ½ä¸Šçš„å·®å¼‚ç‚¹ï¼Œå¸Œæœ›çœ‹å®Œæœ¬æ–‡ä»¥åï¼Œåœ¨çš„ä½¿ç”¨åœºæ™¯ä¸­ï¼Œèƒ½ä½¿ç”¨æ­£ç¡®çš„å¼±å¼•ç”¨ç±»å‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="uraimo" scheme="https://swift.gg/categories/uraimo/"/>
    
    
      <category term="Swift è¿›é˜¶" scheme="https://swift.gg/tags/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ iOS ä¸Šç”¨ Core Image å®ç°äººè„¸æ£€æµ‹</title>
    <link href="https://swift.gg/2017/05/11/face-detection-core-image/"/>
    <id>https://swift.gg/2017/05/11/face-detection-core-image/</id>
    <published>2017-05-10T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šGregg Mojicaï¼Œ<a href="http://www.appcoda.com/face-detection-core-image/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016-09-06<br>è¯‘è€…ï¼š<a href="http://hulizhen.me" target="_blank" rel="external">æ™ºå¤šèŠ¯</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>Core Image æ˜¯ Cocoa Touch æ¡†æ¶æä¾›çš„åŠŸèƒ½å¼ºå¤§çš„ APIï¼Œæ˜¯ iOS SDK ä¸­å¸¸å¸¸è¢«å¿½è§†çš„å…³é”®éƒ¨ä»¶ã€‚æœ¬æ•™ç¨‹å°†å°è¯•æ¢ç´¢ Core Image æä¾›çš„äººè„¸è¯†åˆ«åŠŸèƒ½ï¼Œå¹¶å°†å…¶åº”ç”¨åˆ° iOS App ä¸­ã€‚</p>
<blockquote>
<p>æ³¨ï¼šè¿™æ˜¯ä¸­é«˜çº§ iOS æ•™ç¨‹ï¼Œæœ¬æ•™ç¨‹å‡è®¾ä½ å·²ç»ä½¿ç”¨è¿‡ç±»ä¼¼ UIImagePickerï¼ŒCore Image ç­‰æŠ€æœ¯ã€‚å¦‚æœä½ å¯¹è¿™äº›è¿˜ä¸ç†Ÿæ‚‰ï¼Œå…ˆçœ‹çœ‹<a href="http://www.appcoda.com/ios-programming-course" target="_blank" rel="external">æˆ‘ä»¬çš„ iOS æ•™ç¨‹ç³»åˆ—</a>ï¼Œç­‰ä½ å‡†å¤‡å¥½äº†å†çœ‹è¿™ç¯‡æ–‡ç« ã€‚</p>
</blockquote>
<a id="more"></a>
<h2 id="æ¥ä¸‹æ¥è¦åšçš„äº‹"><a href="#æ¥ä¸‹æ¥è¦åšçš„äº‹" class="headerlink" title="æ¥ä¸‹æ¥è¦åšçš„äº‹"></a>æ¥ä¸‹æ¥è¦åšçš„äº‹</h2><p>è‡ªä» iOS 5ï¼ˆå¤§æ¦‚åœ¨2011å¹´å·¦å³ï¼‰ä¹‹åï¼ŒiOS å¼€å§‹æ”¯æŒäººè„¸è¯†åˆ«ï¼Œåªæ˜¯ç”¨çš„äººä¸å¤šã€‚äººè„¸è¯†åˆ« API è®©å¼€å‘è€…ä¸ä»…å¯ä»¥è¿›è¡Œäººè„¸æ£€æµ‹ï¼Œè¿˜èƒ½è¯†åˆ«å¾®ç¬‘ã€çœ¨çœ¼ç­‰è¡¨æƒ…ã€‚</p>
<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼Œæ¢ç´¢ä¸€ä¸‹ Core Image æä¾›çš„äººè„¸è¯†åˆ«æŠ€æœ¯ï¼Œè¯¥åº”ç”¨å¯ä»¥è¯†åˆ«å‡ºç…§ç‰‡ä¸­çš„äººè„¸å¹¶ç”¨æ–¹æ¡†å°†äººè„¸æ¡†èµ·æ¥ã€‚åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œç”¨æˆ·å¯ä»¥æ‹ç…§å¹¶æ£€æµ‹ç…§ç‰‡ä¸Šæ˜¯å¦æœ‰äººè„¸å‡ºç°ï¼Œå¦‚æœæœ‰åˆ™æå–äººè„¸åæ ‡ã€‚é€šè¿‡è¿™ä¸¤ä¸ªä¾‹å­ï¼Œä½ å°†å­¦ä¼š iOS ä¸Šæ‰€æœ‰å…³äºäººè„¸è¯†åˆ«çš„æŠ€æœ¯ï¼Œå¹¶å……åˆ†åˆ©ç”¨å®ƒå¼ºå¤§å´ç»å¸¸è¢«å¿½è§†çš„åŠŸèƒ½ã€‚</p>
<p>ä¸‹é¢å¼€å§‹å§ï¼</p>
<h2 id="è®¾ç½®å·¥ç¨‹"><a href="#è®¾ç½®å·¥ç¨‹" class="headerlink" title="è®¾ç½®å·¥ç¨‹"></a>è®¾ç½®å·¥ç¨‹</h2><p><a href="https://github.com/appcoda/FaceDetector/raw/master/FaceDetectorStarter.zip" target="_blank" rel="external">ä¸‹è½½</a>å¹¶åœ¨ Xcode ä¸­æ‰“å¼€èµ·å§‹å·¥ç¨‹ã€‚è¯¥å·¥ç¨‹ä¸­çš„ Storyboard ä»…åŒ…å«ä¸€ä¸ªå·²è¿æ¥åˆ°ä»£ç çš„ IBOutlet å’Œ imageViewã€‚</p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/09/face-detection-storyboard.jpg" alt=""></p>
<blockquote>
<p><strong>æ³¨</strong>ï¼šé¡¹ç›®ä¸­çš„å›¾ç‰‡ç”± <a href="http://unsplash.com/" target="_blank" rel="external">unsplash.com</a> æä¾›ã€‚</p>
</blockquote>
<p>åœ¨å¼€å§‹ä½¿ç”¨ Core Image è¿›è¡Œäººè„¸è¯†åˆ«ä¹‹å‰ï¼Œéœ€è¦å°† Core Image åº“å¯¼å…¥é¡¹ç›®ä¸­ã€‚æ‰“å¼€ ViewController.swift æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€ä¸Šæ–¹æ’å…¥å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> CoreImage</div></pre></td></tr></table></figure>
<h2 id="ç”¨-Core-Image-å®ç°äººè„¸æ£€æµ‹"><a href="#ç”¨-Core-Image-å®ç°äººè„¸æ£€æµ‹" class="headerlink" title="ç”¨ Core Image å®ç°äººè„¸æ£€æµ‹"></a>ç”¨ Core Image å®ç°äººè„¸æ£€æµ‹</h2><p>åœ¨èµ·å§‹å·¥ç¨‹çš„ storyboard é‡ŒåŒ…å«ä¸€ä¸ªé€šè¿‡ IBOutlet è¿æ¥åˆ°ä»£ç ä¸­çš„ imageViewã€‚ä¸‹ä¸€æ­¥å°†å®ç°äººè„¸æ£€æµ‹çš„ä»£ç ã€‚å…ˆæŠŠä»¥ä¸‹ä»£ç åŠ å…¥ swift æ–‡ä»¶ä¸­ï¼Œåé¢å†è§£é‡Šï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">detect</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> personciImage = <span class="type">CIImage</span>(image: personPic.image!) <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> accuracy = [<span class="type">CIDetectorAccuracy</span>: <span class="type">CIDetectorAccuracyHigh</span>]</div><div class="line">    <span class="keyword">let</span> faceDetector = <span class="type">CIDetector</span>(ofType: <span class="type">CIDetectorTypeFace</span>, context: <span class="literal">nil</span>, options: accuracy)</div><div class="line">    <span class="keyword">let</span> faces = faceDetector?.features(<span class="keyword">in</span>: personciImage)</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> face <span class="keyword">in</span> faces <span class="keyword">as</span>! [<span class="type">CIFaceFeature</span>] &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Found bounds are <span class="subst">\(face.bounds)</span>"</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> faceBox = <span class="type">UIView</span>(frame: face.bounds)</div><div class="line">        faceBox.layer.borderWidth = <span class="number">3</span></div><div class="line">        faceBox.layer.borderColor = <span class="type">UIColor</span>.red.cgColor</div><div class="line">        faceBox.backgroundColor = <span class="type">UIColor</span>.clear</div><div class="line">        personPic.addSubview(faceBox)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> face.hasLeftEyePosition &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Left eye bounds are <span class="subst">\(face.leftEyePosition)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> face.hasRightEyePosition &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Right eye bounds are <span class="subst">\(face.rightEyePosition)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œè§£é‡Šä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼š</p>
<ul>
<li>ç¬¬ 3 è¡Œï¼šä» storyboard ä¸­çš„ UIImageView æå–å‡º UIImage å¹¶è½¬æ¢æˆ CIImageï¼Œå°†å…¶ä¿å­˜åœ¨æ–°åˆ›å»ºçš„ <code>personciImage</code> å˜é‡ä¸­ã€‚Core Image éœ€è¦ç”¨åˆ° CIImageã€‚</li>
<li>ç¬¬ 7 è¡Œï¼šåˆ›å»ºä¸€ä¸ª <code>accuracy</code> å˜é‡å¹¶è®¾ç½®ä¸º <code>CIDetectorAccuracyHigh</code>ã€‚ä½ å¯ä»¥é€‰æ‹© <code>CIDetectorAccuracyHigh</code> æˆ– <code>CIDetectorAccuracyLow</code>ã€‚æœ¬æ–‡å¸Œæœ›å¾—åˆ°é«˜ç²¾åº¦çš„ç»“æœï¼Œå› æ­¤é€‰æ‹©äº† <code>CIDetectorAccuracyHigh</code>ã€‚</li>
<li>ç¬¬ 8 è¡Œï¼šåˆ›å»ºä¸€ä¸ª <code>faceDetector</code> å˜é‡å¹¶è®¾ç½®ä¸º  <code>CIDetector</code>  çš„å®ä¾‹ã€‚å®ä¾‹åŒ– <code>CIDetector</code> æ—¶å°†å‰æ–‡åˆ›å»ºçš„ <code>accuracy</code> ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚</li>
<li>ç¬¬ 9 è¡Œï¼šé€šè¿‡è°ƒç”¨ <code>faceDetector</code> çš„ <code>features(in:)</code> æ–¹æ³•å¯æ£€æµ‹å‡ºç»™å®šå›¾åƒçš„æ‰€æœ‰äººè„¸ï¼Œæœ€ç»ˆä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ‰€æœ‰äººè„¸ã€‚</li>
<li>ç¬¬ 11 è¡Œï¼šéå†æ•°ç»„ä¸­æ‰€æœ‰çš„äººè„¸ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º <code>CIFaceFeature</code> ç±»å‹ã€‚</li>
<li>ç¬¬ 15 è¡Œï¼šåˆ›å»ºä¸€ä¸ª UIView å®ä¾‹å¹¶å‘½åä¸º <code>faceBox</code>ï¼Œç„¶åæ ¹æ® <code>faces.first</code> è®¾ç½®å…¶å¤§å°ã€‚è¿™å°†ç”»ä¸€ä¸ªæ–¹æ¡†ç”¨äºé«˜äº®æ£€æµ‹åˆ°çš„äººè„¸ã€‚</li>
<li>ç¬¬ 17 è¡Œï¼šå°† <code>faceBox</code> çš„è¾¹æ¡†å®½åº¦è®¾ä¸º 3ã€‚</li>
<li>ç¬¬ 18 è¡Œï¼šå°†è¾¹æ¡†é¢œè‰²è®¾ç½®ä¸ºçº¢è‰²ã€‚</li>
<li>ç¬¬ 19 è¡Œï¼šå°†èƒŒæ™¯è‰²è®¾ä¸ºé€æ˜ï¼Œè¡¨ç¤ºè¯¥è§†å›¾æ²¡æœ‰å¯è§çš„èƒŒæ™¯ã€‚</li>
<li>ç¬¬ 20 è¡Œï¼šæœ€åï¼Œå°†è¯¥è§†å›¾æ·»åŠ åˆ° <code>personPic</code> è§†å›¾ä¸­ã€‚</li>
<li>ç¬¬ 22-28 è¡Œï¼šè¿™äº› API ä¸ä»…å¯ä»¥æ£€æµ‹å‡ºäººè„¸ï¼Œè¿˜èƒ½æ£€æµ‹å‡ºäººè„¸çš„å·¦å³çœ¼ï¼Œä½†æœ¬æ–‡å°±ä¸åœ¨å›¾åƒä¸­é«˜äº®äººçœ¼äº†ã€‚æœ¬æ–‡åªæƒ³å±•ç¤ºä¸€äº› <code>CIFaceFeature</code> çš„ç›¸å…³å±æ€§ã€‚</li>
</ul>
<p>æ¥ç€è°ƒç”¨åœ¨ <code>viewDidLoad</code>ä¸­è°ƒç”¨  <code>detect</code> æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­å¢åŠ ä¸‹åˆ—ä¸€è¡Œä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">detect()</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘å¹¶è¿è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æ•ˆæœï¼š</p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/09/face-detection-2.png" alt=""></p>
<p>æ ¹æ®æ§åˆ¶å°çš„è¾“å‡ºç»“æœï¼Œä¼¼ä¹å¯ä»¥æ£€æµ‹å‡ºäººè„¸ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">Found</span> bounds are (<span class="number">177.0</span>, <span class="number">415.0</span>, <span class="number">380.0</span>, <span class="number">380.0</span>)</div></pre></td></tr></table></figure>
<p>è¿˜æœ‰å‡ ä¸ªé—®é¢˜æ²¡æœ‰å¤„ç†ï¼š</p>
<ul>
<li>äººè„¸è¯†åˆ«ç¨‹åºåº”ç”¨äºåŸå§‹å›¾åƒä¸Šï¼Œè€ŒåŸå§‹å›¾åƒæœ‰ç€æ¯” imageView æ›´é«˜çš„åˆ†è¾¨ç‡ã€‚å¦å¤–ï¼Œå·¥ç¨‹ä¸­ imageView çš„ content mode è¢«è®¾ç½®ä¸º aspect fitã€‚ä¸ºäº†æ­£ç¡®åœ°ç”»å‡ºæ£€æµ‹æ¡†ï¼Œè¿˜éœ€è¦è®¡ç®—å‡º imageView ä¸­è¯†åˆ«åˆ°çš„äººè„¸çš„å®é™…ä½ç½®å’Œå°ºå¯¸ã€‚</li>
<li>å†è€…ï¼ŒCore Image å’Œ UIViewï¼ˆæˆ–è€…UIKitï¼‰ä½¿ç”¨äº†ä¸åŒçš„åæ ‡ç³»ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œå› æ­¤è¿˜éœ€è¦å®ç° Core Image åæ ‡åˆ° UIView åæ ‡çš„è½¬æ¢ã€‚</li>
</ul>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/09/core-image-coordinate-1240x835.jpg" alt=""></p>
<p>ç°åœ¨ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢ <code>detect()</code> æ–¹æ³•ä¸­çš„ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">detect</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> personciImage = <span class="type">CIImage</span>(image: personPic.image!) <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> accuracy = [<span class="type">CIDetectorAccuracy</span>: <span class="type">CIDetectorAccuracyHigh</span>]</div><div class="line">    <span class="keyword">let</span> faceDetector = <span class="type">CIDetector</span>(ofType: <span class="type">CIDetectorTypeFace</span>, context: <span class="literal">nil</span>, options: accuracy)</div><div class="line">    <span class="keyword">let</span> faces = faceDetector?.features(<span class="keyword">in</span>: personciImage)</div><div class="line">    </div><div class="line">    <span class="comment">// å°† Core Image åæ ‡è½¬æ¢æˆ UIView åæ ‡</span></div><div class="line">    <span class="keyword">let</span> ciImageSize = personciImage.extent.size</div><div class="line">    <span class="keyword">var</span> transform = <span class="type">CGAffineTransform</span>(scaleX: <span class="number">1</span>, y: -<span class="number">1</span>)</div><div class="line">    transform = transform.translatedBy(x: <span class="number">0</span>, y: -ciImageSize.height)</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> face <span class="keyword">in</span> faces <span class="keyword">as</span>! [<span class="type">CIFaceFeature</span>] &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Found bounds are <span class="subst">\(face.bounds)</span>"</span>)</div><div class="line">        </div><div class="line">        <span class="comment">// å®ç°åæ ‡è½¬æ¢</span></div><div class="line">        <span class="keyword">var</span> faceViewBounds = face.bounds.applying(transform)</div><div class="line">        </div><div class="line">        <span class="comment">// è®¡ç®—å®é™…çš„ä½ç½®å’Œå¤§å°</span></div><div class="line">        <span class="keyword">let</span> viewSize = personPic.bounds.size</div><div class="line">        <span class="keyword">let</span> scale = <span class="built_in">min</span>(viewSize.width / ciImageSize.width,</div><div class="line">                        viewSize.height / ciImageSize.height)</div><div class="line">        <span class="keyword">let</span> offsetX = (viewSize.width - ciImageSize.width * scale) / <span class="number">2</span></div><div class="line">        <span class="keyword">let</span> offsetY = (viewSize.height - ciImageSize.height * scale) / <span class="number">2</span></div><div class="line">        </div><div class="line">        faceViewBounds = faceViewBounds.applying(<span class="type">CGAffineTransform</span>(scaleX: scale, y: scale))</div><div class="line">        faceViewBounds.origin.x += offsetX</div><div class="line">        faceViewBounds.origin.y += offsetY</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> faceBox = <span class="type">UIView</span>(frame: faceViewBounds)</div><div class="line">        </div><div class="line">        faceBox.layer.borderWidth = <span class="number">3</span></div><div class="line">        faceBox.layer.borderColor = <span class="type">UIColor</span>.red.cgColor</div><div class="line">        faceBox.backgroundColor = <span class="type">UIColor</span>.clear</div><div class="line">        personPic.addSubview(faceBox)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> face.hasLeftEyePosition &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Left eye bounds are <span class="subst">\(face.leftEyePosition)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> face.hasRightEyePosition &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Right eye bounds are <span class="subst">\(face.rightEyePosition)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œä¸Šé¢çš„ä»£ç ä½¿ç”¨æ”¾å°„å˜æ¢å°† Core Image åæ ‡è½¬æ¢æˆäº† UIKit åæ ‡ã€‚ç„¶åï¼Œæ·»åŠ äº†ä¸€äº›é¢å¤–çš„ä»£ç ç”¨äºè®¡ç®—æ¡†è§†å›¾çš„å®é™…ä½ç½®å’Œå°ºå¯¸ã€‚</p>
<p>ç°åœ¨å†ä¸€æ¬¡è¿è¡Œç¨‹åºï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°æ£€æµ‹æ¡†å°†è¯†åˆ«å‡ºçš„äººè„¸æ¡†èµ·æ¥äº†ï¼Œè¿™æ ·å°±æˆåŠŸåœ°ç”¨ Core Image æ£€æµ‹åˆ°äººè„¸äº†ã€‚</p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/09/face-detection-result-1240x809.jpg" alt=""></p>
<h2 id="å¼€å‘ä¸€ä¸ªæ”¯æŒäººè„¸è¯†åˆ«çš„æ‘„åƒåº”ç”¨"><a href="#å¼€å‘ä¸€ä¸ªæ”¯æŒäººè„¸è¯†åˆ«çš„æ‘„åƒåº”ç”¨" class="headerlink" title="å¼€å‘ä¸€ä¸ªæ”¯æŒäººè„¸è¯†åˆ«çš„æ‘„åƒåº”ç”¨"></a>å¼€å‘ä¸€ä¸ªæ”¯æŒäººè„¸è¯†åˆ«çš„æ‘„åƒåº”ç”¨</h2><p>å‡è®¾æœ‰ä¸€ä¸ªç”¨äºæ‘„åƒæˆ–æ‹ç…§çš„åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æ‹ç…§åæ£€æµ‹æ˜¯å¦æœ‰äººè„¸å‡ºç°ã€‚å¦‚æœå‡ºç°äº†äººè„¸ï¼Œå¯èƒ½æƒ³å°†è¿™å¼ ç…§ç‰‡æ‰“ä¸Šä¸€äº›æ ‡ç­¾å¹¶å¯¹å…¶åˆ†ç±»ã€‚ä¸‹é¢ç»“åˆ <code>UIImagePicker</code> ç±»ï¼Œæ‹ç…§å®Œæˆæ—¶ç«‹åˆ»è¿è¡Œä¸Šé¢çš„äººè„¸æ£€æµ‹ä»£ç ã€‚</p>
<p>ä¸Šé¢çš„èµ·å§‹å·¥ç¨‹ä¸­å·²ç»åˆ›å»ºäº†ä¸€ä¸ª <code>CameraViewController</code> ç±»ï¼Œå°†å…¶ä»£ç æ›´æ–°æˆä¸‹é¢è¿™æ ·ï¼Œç”¨ä»¥å®ç°æ‘„åƒåŠŸèƒ½ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CameraViewController</span>: <span class="title">UIViewController</span>, <span class="title">UIImagePickerControllerDelegate</span>, <span class="title">UINavigationControllerDelegate</span> </span>&#123;</div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">var</span> imageView: <span class="type">UIImageView</span>!</div><div class="line">    <span class="keyword">let</span> imagePicker = <span class="type">UIImagePickerController</span>()</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        </div><div class="line">        imagePicker.delegate = <span class="keyword">self</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">takePhoto</span><span class="params">(sender: AnyObject)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> !<span class="type">UIImagePickerController</span>.isSourceTypeAvailable(.camera) &#123;</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        imagePicker.allowsEditing = <span class="literal">false</span></div><div class="line">        imagePicker.sourceType = .camera</div><div class="line">        </div><div class="line">        present(imagePicker, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">imagePickerController</span><span class="params">(<span class="number">_</span> picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [String : Any])</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> pickedImage = info[<span class="type">UIImagePickerControllerOriginalImage</span>] <span class="keyword">as</span>? <span class="type">UIImage</span> &#123;</div><div class="line">            imageView.contentMode = .scaleAspectFit</div><div class="line">            imageView.image = pickedImage</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</div><div class="line">        <span class="keyword">self</span>.detect()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">imagePickerControllerDidCancel</span><span class="params">(<span class="number">_</span> picker: UIImagePickerController)</span></span> &#123;</div><div class="line">        dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¼€å§‹çš„å‡ è¡Œä»£ç è®¾ç½®äº† <code>UIImagePicker</code> ä»£ç†ã€‚åœ¨ <code>didFinishPickingMediaWithInfo</code> æ–¹æ³•ï¼ˆè¿™æ˜¯ä¸€ä¸ª <code>UIImagePicker</code> ä»£ç†æ–¹æ³•ï¼‰ä¸­ï¼Œå°†ä¼ å…¥çš„å›¾åƒè®¾ç½®åˆ° imageView ä¸Šï¼Œæœ€åå…³é—­æ‹¾å–å™¨å¹¶è°ƒç”¨ <code>detect</code> å‡½æ•°ã€‚</p>
<p>ä¸Šé¢çš„ä»£ç è¿˜æœªå®ç° <code>detect</code> å‡½æ•°ï¼Œå°†ä¸‹é¢çš„ä»£ç åŠ ä¸Šï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">detect</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> imageOptions = <span class="type">NSDictionary</span>(object: <span class="type">NSNumber</span>(value: <span class="number">5</span>) <span class="keyword">as</span> <span class="type">NSNumber</span>, forKey: <span class="type">CIDetectorImageOrientation</span> <span class="keyword">as</span> <span class="type">NSString</span>)</div><div class="line">    <span class="keyword">let</span> personciImage = <span class="type">CIImage</span>(cgImage: imageView.image!.cgImage!)</div><div class="line">    <span class="keyword">let</span> accuracy = [<span class="type">CIDetectorAccuracy</span>: <span class="type">CIDetectorAccuracyHigh</span>]</div><div class="line">    <span class="keyword">let</span> faceDetector = <span class="type">CIDetector</span>(ofType: <span class="type">CIDetectorTypeFace</span>, context: <span class="literal">nil</span>, options: accuracy)</div><div class="line">    <span class="keyword">let</span> faces = faceDetector?.features(<span class="keyword">in</span>: personciImage, options: imageOptions <span class="keyword">as</span>? [<span class="type">String</span> : <span class="type">AnyObject</span>])</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> face = faces?.first <span class="keyword">as</span>? <span class="type">CIFaceFeature</span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"found bounds are <span class="subst">\(face.bounds)</span>"</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> alert = <span class="type">UIAlertController</span>(title: <span class="string">"Say Cheese!"</span>, message: <span class="string">"We detected a face!"</span>, preferredStyle: <span class="type">UIAlertControllerStyle</span>.alert)</div><div class="line">        alert.addAction(<span class="type">UIAlertAction</span>(title: <span class="string">"OK"</span>, style: <span class="type">UIAlertActionStyle</span>.<span class="keyword">default</span>, handler: <span class="literal">nil</span>))</div><div class="line">        <span class="keyword">self</span>.present(alert, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> face.hasSmile &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"face is smiling"</span>);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> face.hasLeftEyePosition &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Left eye bounds are <span class="subst">\(face.leftEyePosition)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> face.hasRightEyePosition &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Right eye bounds are <span class="subst">\(face.rightEyePosition)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">let</span> alert = <span class="type">UIAlertController</span>(title: <span class="string">"No Face!"</span>, message: <span class="string">"No face was detected"</span>, preferredStyle: <span class="type">UIAlertControllerStyle</span>.alert)</div><div class="line">        alert.addAction(<span class="type">UIAlertAction</span>(title: <span class="string">"OK"</span>, style: <span class="type">UIAlertActionStyle</span>.<span class="keyword">default</span>, handler: <span class="literal">nil</span>))</div><div class="line">        <span class="keyword">self</span>.present(alert, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„ detect() å‡½æ•°å’Œä¹‹å‰çš„å®ç°éå¸¸ç›¸ä¼¼ï¼Œä¸è¿‡è¿™ä¸€æ¬¡æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ä¸´æ—¶æ‹åˆ°çš„å›¾åƒã€‚æ ¹æ®æ£€æµ‹ç»“æœä¼šæ˜¾ç¤ºä¸€ä¸ªæç¤ºæ¡†ï¼Œæç¤ºæ˜¯å¦æ£€æµ‹åˆ°äººè„¸ã€‚è¿è¡Œç¨‹åºæ¥å¿«é€Ÿæµ‹è¯•ä¸€ä¸‹ã€‚</p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/08/faces.png" alt=""></p>
<p>CIFaceFeature ä¸­çš„ä¸€äº›å±æ€§å’Œæ–¹æ³•å‰é¢å·²ç»å°è¯•è¿‡äº†ã€‚ä¾‹å¦‚ï¼Œè‹¥è¦åˆ¤æ–­ç…§ç‰‡ä¸­çš„äººæ˜¯å¦æ­£åœ¨å¾®ç¬‘ï¼Œå¯ä»¥é€šè¿‡ <code>hasSmile</code> å±æ€§åˆ¤æ–­ã€‚è¿˜å¯ä»¥é€šè¿‡ <code>hasLeftEyePosition</code>  ï¼ˆæˆ–<code>hasRightEyePosition</code>ï¼‰å±æ€§æ£€æŸ¥æ˜¯å¦æœ‰å·¦çœ¼ï¼ˆæˆ–å³çœ¼ï¼‰å‡ºç°ï¼ˆå¸Œæœ›æœ‰ï¼‰ã€‚</p>
<p>è¿˜å¯ä»¥é€šè¿‡ <code>hasMouthPosition</code> æ¥åˆ¤æ–­æ˜¯å¦å‡ºç°äº†å˜´å·´ã€‚å¦‚æœå‡ºç°äº†ï¼Œå¯ä»¥é€šè¿‡ <code>mouthPosition</code> å±æ€§å¾—åˆ°å…¶åæ ‡ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">if</span> (face.hasMouthPosition) &#123;</div><div class="line">     <span class="built_in">print</span>(<span class="string">"mouth detected"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚ä½ æ‰€è§ï¼Œé€šè¿‡ Core Image è¿›è¡Œäººè„¸è¯†åˆ«æå…¶ç®€å•ã€‚é™¤äº†æ£€æµ‹å˜´ã€å¾®ç¬‘ã€çœ¼ç›ä½ç½®ç­‰ï¼Œè¿˜å¯ä»¥é€šè¿‡ <code>leftEyeClosed</code> ï¼ˆæˆ–<code>rightEyeClosed</code>ï¼‰åˆ¤æ–­å·¦çœ¼ï¼ˆæˆ–å³çœ¼ï¼‰æ˜¯å¦çå¼€ã€‚</p>
<h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>æœ¬æ•™ç¨‹æ¢ç´¢äº† Core Image æä¾›çš„äººè„¸è¯†åˆ« APIï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•åœ¨æ‘„åƒæœºåº”ç”¨ä¸­ä½¿ç”¨è¯¥åŠŸèƒ½ã€‚æœ¬æ–‡é€šè¿‡ UIImagePicker æ‹æ‘„å›¾åƒï¼Œå¹¶æ£€æµ‹è¯¥å›¾åƒä¸­æ˜¯å¦æœ‰äººçš„å‡ºç°ã€‚</p>
<p>å¦‚ä½ æ‰€è§ï¼ŒCore Image çš„äººè„¸è¯†åˆ« API æœ‰ç€éå¸¸å¤šçš„ç”¨å¤„ï¼å¸Œæœ›ä½ èƒ½è§‰å¾—æœ¬æ•™ç¨‹æœ‰æ‰€å¸®åŠ©ï¼Œè®©ä½ äº†è§£åˆ°äº†è¿™ä¸€é²œä¸ºäººçŸ¥çš„ iOS APIï¼</p>
<blockquote>
<p> æ³¨ï¼šæ¬¢è¿ç»§ç»­å…³æ³¨è®©äººè„¸è¯†åˆ«æ›´åŠ å¼ºå¤§çš„<a href="https://www.appcoda.com/tag/neural-net/" target="_blank" rel="external">ç¥ç»ç½‘ç»œç³»åˆ—æ•™ç¨‹</a>ã€‚</p>
</blockquote>
<p>ä½ å¯ä»¥ä»<a href="https://github.com/appcoda/FaceDetector" target="_blank" rel="external">è¿™é‡Œ</a>ä¸‹è½½åˆ°æœ€ç»ˆçš„å·¥ç¨‹ä»£ç ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šGregg Mojicaï¼Œ&lt;a href=&quot;http://www.appcoda.com/face-detection-core-image/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016-09-06&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;http://hulizhen.me&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;æ™ºå¤šèŠ¯&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://www.jianshu.com/users/7a2d2cc38444/latest_articles&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Crystal Sun&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;Core Image æ˜¯ Cocoa Touch æ¡†æ¶æä¾›çš„åŠŸèƒ½å¼ºå¤§çš„ APIï¼Œæ˜¯ iOS SDK ä¸­å¸¸å¸¸è¢«å¿½è§†çš„å…³é”®éƒ¨ä»¶ã€‚æœ¬æ•™ç¨‹å°†å°è¯•æ¢ç´¢ Core Image æä¾›çš„äººè„¸è¯†åˆ«åŠŸèƒ½ï¼Œå¹¶å°†å…¶åº”ç”¨åˆ° iOS App ä¸­ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šè¿™æ˜¯ä¸­é«˜çº§ iOS æ•™ç¨‹ï¼Œæœ¬æ•™ç¨‹å‡è®¾ä½ å·²ç»ä½¿ç”¨è¿‡ç±»ä¼¼ UIImagePickerï¼ŒCore Image ç­‰æŠ€æœ¯ã€‚å¦‚æœä½ å¯¹è¿™äº›è¿˜ä¸ç†Ÿæ‚‰ï¼Œå…ˆçœ‹çœ‹&lt;a href=&quot;http://www.appcoda.com/ios-programming-course&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;æˆ‘ä»¬çš„ iOS æ•™ç¨‹ç³»åˆ—&lt;/a&gt;ï¼Œç­‰ä½ å‡†å¤‡å¥½äº†å†çœ‹è¿™ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="AppCoda" scheme="https://swift.gg/categories/AppCoda/"/>
    
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/tags/iOS-%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>åˆ›å»ºå¤šä¸ª Outlet æ•™ç¨‹</title>
    <link href="https://swift.gg/2017/05/10/multiple-outlets-tutorial/"/>
    <id>https://swift.gg/2017/05/10/multiple-outlets-tutorial/</id>
    <published>2017-05-09T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šIOSCREATERï¼Œ<a href="https://www.ioscreator.com/tutorials/multiple-outlets-tutorial" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016/02/08<br>è¯‘è€…ï¼š<a href="undefined">EyreFree</a>ï¼›æ ¡å¯¹ï¼š<a href="undefined">DianQK</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>ä¸ºå¤šä¸ªå¯¹è±¡åˆ›å»ºå¤šä¸ª Outlet æ˜¯æ¯”è¾ƒè´¹æ—¶è´¹åŠ›çš„ä¸€ä»¶äº‹æƒ…ã€‚è€Œä¸”å¤šä¸ªå¯¹è±¡ä¹Ÿå¯èƒ½å…±äº«åŒä¸€ä¸ªçš„ Outletã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šæ ¹æ®æŒ‰é’®çš„ tag å€¼æ¥åˆ›å»ºå¤šä¸ª Outletã€‚æœ¬æ•™ç¨‹ä½¿ç”¨ Xcode 7.2 ä½œä¸ºå¼€å‘å·¥å…·ï¼Œä½¿ç”¨ Swift 2.1 å’Œ iOS 9 è¿›è¡Œæ„å»ºã€‚</p>
<a id="more"></a>
<p>æ‰“å¼€ Xcode å¹¶æ–°å»ºä¸€ä¸ª Single View Applicationã€‚Product Name é¡¹å¡«å†™ <strong>IOS9MultipleOutletsTutorial</strong>ï¼Œç„¶åå¡«å†™ä½ çš„ Organization Name å’Œ Organization Identifierã€‚Language é¡¹é€‰æ‹© Swiftï¼Œå¹¶ä¸”ç¡®ä¿ Devices é¡¹åªé€‰æ‹©äº† iPhoneã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/56962b56a12f44ae28276e6e/1452682071748/?format=750w" alt=""></p>
<p>æ‰“å¼€ <strong>StoryBoard</strong> å¹¶ä» Object Library æ‹–ä¸€ä¸ªæŒ‰é’®åˆ°ä¸»è§†å›¾çš„å·¦ä¸Šæ–¹ã€‚æ‰“å¼€ Attribute Inspectorï¼ˆå±æ€§æ£€æŸ¥å™¨ï¼‰å¹¶å°† View çš„ Tag è®¾ä¸º 10ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/56967c4fb204d5edf92596e3/1452702801210/?format=300w" alt=""></p>
<p>å¤åˆ¶æ­¤æŒ‰é’®ï¼Œå¹¶å°†è¯¥æŒ‰é’®æ”¾ç½®äºå’Œç¬¬ä¸€ä¸ªæŒ‰é’®ç›¸åŒä¸€è¡Œçš„ä¸»è§†å›¾å³ä¸Šè§’ä½ç½®ï¼Œè¯¥æŒ‰é’®å’Œç¬¬ä¸€ä¸ªæŒ‰é’®å…·æœ‰ç›¸åŒçš„ Tagã€‚<br>æ¥ä¸‹æ¥ï¼Œä» Object Library ä¸­æ‹–å‡ºå¦ä¸€ä¸ªæŒ‰é’®åˆ°ä¸»è§†å›¾ä¸­ï¼Œå°†è¯¥æŒ‰é’®æ”¾åœ¨å·¦ä¸Šè§’æŒ‰é’®çš„ä¸‹é¢ã€‚é€‰ä¸­è¿™ä¸ªæŒ‰é’®å¹¶ä¸”æ‰“å¼€ Attribute Inspectorï¼Œå°† View ä¸­çš„ Tag è®¾ä¸º 20ã€‚ç„¶åå†æ¬¡å¤åˆ¶åˆšæ·»åŠ çš„è¿™ä¸ªæŒ‰é’®å¹¶å°†å¤åˆ¶çš„æŒ‰é’®æ”¾åœ¨åˆšæ·»åŠ çš„æŒ‰é’®çš„å³æ–¹ã€‚åˆ°è¿™é‡Œ Storyboard åº”è¯¥æ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ ·å­ï¼š</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/56b3af28746fb99c72839226/1454616374964/?format=750w" alt=""></p>
<p>é€‰ä¸­ä¸»è§†å›¾ç„¶åç‚¹å‡» Interface Builder å³ä¸‹è§’çš„ Resolve Auto Layout Issues æŒ‰é’®ã€‚é€‰æ‹© All Views ä¸­çš„ Reset to Suggested Constraint è¿™ä¸€é€‰é¡¹ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/56b50962746fb9a53ff4610c/1454705005083/?format=500w" alt=""></p>
<p>æ‰“å¼€æ–‡ä»¶ <strong>ViewController.swift</strong> å¹¶å°†æ–¹æ³• <strong>viewDidLoad</strong> æ”¹ä¸ºå¦‚ä¸‹ä»£ç å—æ‰€ç¤ºï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidLoad()</div><div class="line">    <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></div><div class="line"></div><div class="line">    <span class="keyword">for</span> subview <span class="keyword">in</span> view.subviews <span class="keyword">where</span> subview.tag == <span class="number">10</span> &#123;</div><div class="line">        <span class="keyword">let</span> button = subview <span class="keyword">as</span>! <span class="type">UIButton</span></div><div class="line">        button.addTarget(<span class="keyword">self</span>, action: <span class="string">"changeColorRed:"</span>, forControlEvents: .<span class="type">TouchUpInside</span>)</div><div class="line">    &#125;</div><div class="line">        </div><div class="line">    <span class="keyword">for</span> subview <span class="keyword">in</span> view.subviews <span class="keyword">where</span> subview.tag == <span class="number">20</span> &#123;</div><div class="line">        <span class="keyword">let</span> button = subview <span class="keyword">as</span>! <span class="type">UIButton</span></div><div class="line">        button.addTarget(<span class="keyword">self</span>, action: <span class="string">"changeColorGreen:"</span>, forControlEvents: .<span class="type">TouchUpInside</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„ subview å±æ€§å¯ä»¥ç”¨äºéå†ä¸»è§†å›¾çš„å­è§†å›¾ã€‚æ¯ä¸ªæŒ‰é’®éƒ½æ ¹æ® tag å€¼çš„ä¸åŒæ·»åŠ äº†ä¸€ä¸ªç›¸åº”çš„ targetã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å®ç° target æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">changeColorRed</span><span class="params">(sender: AnyObject)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> button: <span class="type">UIButton</span> = sender <span class="keyword">as</span>! <span class="type">UIButton</span></div><div class="line">    button.tintColor = <span class="type">UIColor</span>.redColor()</div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">changeColorGreen</span><span class="params">(sender: AnyObject)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> button: <span class="type">UIButton</span> = sender <span class="keyword">as</span>! <span class="type">UIButton</span></div><div class="line">    button.tintColor = <span class="type">UIColor</span>.greenColor()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“é€‰ä¸­æŒ‰é’®æ—¶ï¼ŒæŒ‰é’®çš„é¢œè‰²ä¼šéšä¹‹æ”¹å˜ã€‚<strong>æ„å»ºå¹¶è¿è¡Œ</strong>é¡¹ç›®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±ç‚¹å‡»æŒ‰é’®æ¥æ›´æ”¹è¿™äº›æŒ‰é’®çš„é¢œè‰²äº†ã€‚</p>
<p><img src="https://static1.squarespace.com/static/52428a0ae4b0c4a5c2a2cede/t/56b3afc662cd945febf7cbf7/1454616530586/?format=750w" alt=""></p>
<p>ä½ å¯ä»¥ä» ioscreator çš„ <a href="https://github.com/ioscreator/ioscreator" target="_blank" rel="external">GitHub</a> ä¸‹è½½ <strong>IOS9MultipleOutletsTutorial</strong> çš„æºç ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šIOSCREATERï¼Œ&lt;a href=&quot;https://www.ioscreator.com/tutorials/multiple-outlets-tutorial&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016/02/08&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;undefined&quot;&gt;EyreFree&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;undefined&quot;&gt;DianQK&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;ä¸ºå¤šä¸ªå¯¹è±¡åˆ›å»ºå¤šä¸ª Outlet æ˜¯æ¯”è¾ƒè´¹æ—¶è´¹åŠ›çš„ä¸€ä»¶äº‹æƒ…ã€‚è€Œä¸”å¤šä¸ªå¯¹è±¡ä¹Ÿå¯èƒ½å…±äº«åŒä¸€ä¸ªçš„ Outletã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šæ ¹æ®æŒ‰é’®çš„ tag å€¼æ¥åˆ›å»ºå¤šä¸ª Outletã€‚æœ¬æ•™ç¨‹ä½¿ç”¨ Xcode 7.2 ä½œä¸ºå¼€å‘å·¥å…·ï¼Œä½¿ç”¨ Swift 2.1 å’Œ iOS 9 è¿›è¡Œæ„å»ºã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="IOSCREATOR" scheme="https://swift.gg/categories/IOSCREATOR/"/>
    
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/tags/iOS-%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Swift ç®€æ´ä¹‹é“(ä¸‹)</title>
    <link href="https://swift.gg/2017/05/09/self-explained-swift-2/"/>
    <id>https://swift.gg/2017/05/09/self-explained-swift-2/</id>
    <published>2017-05-08T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šWeston Hannersï¼Œ<a href="https://www.alloc-init.com/blog/2017.01.19" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-01-19<br>è¯‘è€…ï¼š<a href="http://coderafi.github.io/" target="_blank" rel="external">CoderAFI</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>å·¥å…·è®©ä»£ç å®¹æ˜“ç®¡ç†å’Œé˜…è¯»</p>
<a id="more"></a>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">import UIKit</div><div class="line">import PlaygroundSupport</div><div class="line"></div><div class="line">// æ¬¢è¿é˜…è¯» Swift ç®€æ´ä¹‹é“çš„ç¬¬äºŒç¯‡æ–‡ç« . è¿™æ¬¡çš„ playground å°†ä¼šåœ¨ä¸Šæ¬¡çš„ä»£ç åŸºç¡€ä¸Šåšäº›ä¿®æ”¹å¹¶åˆ é™¤æ‰ä¸€äº›æ— ç”¨çš„æ³¨é‡Š.</div><div class="line">// å¦‚æœä½ æ„Ÿè§‰å¾ˆéš¾ç†è§£,å¯ä»¥å…ˆå»é˜…è¯»[Swift ç®€æ´ä¹‹é“(ä¸Š)](http://swift.gg/2017/04/24/self-explained-swift/)</div><div class="line"></div><div class="line">// è¿™ç¯‡æ–‡ç« æˆ‘è¦ä¼ è¾¾çš„æ€æƒ³æ˜¯ &quot;å·¥å…·å°è£…&quot;. ä½ å¯ä»¥åˆ›å»ºå¾ˆå¤šå¯ä»¥åœ¨å¤šä¸ª app ä¸­å¤ç”¨çš„å·¥å…·æ¥å¸®ä½ èŠ‚çœæ—¶é—´,æ¯”æ–¹è¯´ view çš„åˆ›å»ºå’Œç•Œé¢å¸ƒå±€éƒ½å¯ä»¥æŠ½è±¡æˆè¾…åŠ©å·¥å…·.</div><div class="line"></div><div class="line">// è¿™é‡Œæ‰€è°“çš„ &quot;å·¥å…·&quot; å°±æ˜¯ä¸€äº› Swift extensions. å…¶å® extensions èƒ½å¤Ÿåœ¨ Swift å·²æœ‰çš„ç±»å‹ä¸Šæ·»åŠ æ–°çš„å‡½æ•°.</div><div class="line">// ä¸‹é¢çš„ä»£ç ä¸­çš„å‡½æ•°å°±å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆå§‹åŒ–ä¸€äº›å…¬å…±UIæ§ä»¶å¹¶ä¸”èƒ½å¤Ÿç”Ÿæˆä¸€äº›å…±ç”¨çš„ç•Œé¢å¸ƒå±€.</div><div class="line"></div><div class="line">extension UIView &#123; // å¸ƒå±€æ‰©å±•</div><div class="line"></div><div class="line">		// è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿç¼©çŸ­è‡ªåŠ¨å¸ƒå±€çš„ä»£ç è¡Œæ•°ï¼Œè®©ä»£ç æ›´ç®€æ´</div><div class="line">    func constrainTo(view: UIView) &#123;</div><div class="line"></div><div class="line">				// æ‰“å¼€ autolayout é…ç½®</div><div class="line">        view.translatesAutoresizingMaskIntoConstraints = false</div><div class="line"></div><div class="line">				// æ ¹æ®å‡½æ•°åç§°, æˆ‘ä»¬å¯ä»¥åˆ¤æ–­å‚æ•° view æ˜¯å½“å‰ view çš„çˆ¶è§†å›¾</div><div class="line">				// åœ¨è¿™é‡Œå¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ª, ä½†æ˜¯å½“ä½ çœ‹åˆ°å¦‚ä½•ä½¿ç”¨æ—¶å°±ä¼šè±ç„¶å¼€æœ—äº†</div><div class="line">        view.addSubview(self)</div><div class="line"></div><div class="line">				// ä¸Šç¯‡æ–‡ç« ä¹‹åï¼Œæˆ‘å‘ç°äº† NSLayoutAnchor å¸ƒå±€ç³»ç»Ÿï¼Œå®ƒè®©è‡ªåŠ¨å¸ƒå±€çš„çº¦æŸæ„å»ºæ›´åŠ ç®€æ´æ˜äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä½¿ç”¨å®ƒ</div><div class="line">        view.topAnchor.constraint(equalTo: self.topAnchor).isActive = true</div><div class="line">        view.bottomAnchor.constraint(equalTo: self.bottomAnchor).isActive = true</div><div class="line">        view.leftAnchor.constraint(equalTo: self.leftAnchor).isActive = true</div><div class="line">        view.rightAnchor.constraint(equalTo: self.rightAnchor).isActive = true</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">extension UIStackView &#123;</div><div class="line"></div><div class="line">		// UIStackView æ§ä»¶æœ‰å¾ˆå¤šç»å¸¸ä¿®æ”¹çš„é…ç½®å±æ€§. ä¸‹é¢çš„ä¾¿åˆ©æ„é€ å‡½æ•°ï¼Œå¯ä»¥åšåˆ°åªç”¨ä¸€è¡Œä»£ç æ¥å®Œæˆè¿™äº›äº‹</div><div class="line">    convenience init(arrangedSubviews: [UIView],</div><div class="line">                     axis: UILayoutConstraintAxis,</div><div class="line">                     distribution: UIStackViewDistribution,</div><div class="line">                     alignment: UIStackViewAlignment) &#123;</div><div class="line"></div><div class="line">				// è°ƒç”¨åŸæ¥çš„æ„é€ å™¨</div><div class="line">        self.init(arrangedSubviews: arrangedSubviews)</div><div class="line"></div><div class="line">				// ç»™é…ç½®å±æ€§èµ‹å€¼</div><div class="line">        self.axis = axis</div><div class="line">        self.distribution = distribution</div><div class="line">        self.alignment = alignment</div><div class="line"></div><div class="line">				// ç”±äºè¯¥å±æ€§ç»å¸¸è®¾ç½®ï¼Œæ‰€ä»¥åœ¨è¿™æˆ‘ä»¬ç›´æ¥ç»™éšè”½çš„å°è£…è¿›å»</div><div class="line">        self.translatesAutoresizingMaskIntoConstraints = false</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">// ä¸‹é¢æˆ‘ä»¬æ¥åˆ›å»ºä¸€äº›ç±»å‡½æ•°æ¥å¸®åŠ©åˆ›å»º app çš„ &quot;ä¸»é¢˜&quot;</div><div class="line"></div><div class="line">// å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œè¿™é‡Œéƒ½æ˜¯æŠŠæˆ‘ä¸Šç¯‡æ–‡ç« çš„ä»£ç é‡æ„åˆ°ç±»å‡½æ•°é‡Œ. åŒæ—¶,æä¾›ä¸åŒçš„å‚æ•°æ¥ä¿è¯æ¯ä¸ªå®ä¾‹çš„å¤šæ€æ€§</div><div class="line"></div><div class="line">// åŒæ ·çš„ translatesAutoresizingMaskIntoConstraints å±æ€§ä¹Ÿè¦è®¾ç½®æ¥ä¿éšœ view controller ä¸­çš„ä»£ç ç®€æ´</div><div class="line"></div><div class="line">extension UIButton &#123;</div><div class="line"></div><div class="line">    class func standardAwesomeButton(title: String) -&gt; UIButton &#123;</div><div class="line"></div><div class="line">        let button = UIButton()</div><div class="line"></div><div class="line">        button.setTitle(title, for: .normal)</div><div class="line">        button.translatesAutoresizingMaskIntoConstraints = false</div><div class="line"></div><div class="line">        return button</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">extension UILabel &#123;</div><div class="line"></div><div class="line">    class func standardAwesomeLabel(title: String) -&gt; UILabel &#123;</div><div class="line"></div><div class="line">        let label = UILabel()</div><div class="line"></div><div class="line">        label.font = UIFont(name: &quot;Menlo&quot;, size: 14)</div><div class="line">        label.textColor = .white</div><div class="line">        label.text = title</div><div class="line">        label.textAlignment = .center</div><div class="line">        label.translatesAutoresizingMaskIntoConstraints = false</div><div class="line"></div><div class="line">        return label</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">class OurAwesomeViewController: UIViewController &#123;</div><div class="line"></div><div class="line">    lazy var titleLabel: UILabel = &#123;</div><div class="line">        return UILabel.standardAwesomeLabel(title: &quot;Awesome&quot;)</div><div class="line">    &#125;()</div><div class="line"></div><div class="line">    lazy var button: UIButton = &#123;</div><div class="line"></div><div class="line">        let button = UIButton.standardAwesomeButton(title: &quot;Press Me&quot;)</div><div class="line">        button.addTarget(self,</div><div class="line">                         action: #selector(OurAwesomeViewController.buttonTest),</div><div class="line">                         for: .touchUpInside)</div><div class="line"></div><div class="line">        return button</div><div class="line">    &#125;()</div><div class="line"></div><div class="line">    override func loadView() &#123;</div><div class="line"></div><div class="line">        super.loadView()</div><div class="line"></div><div class="line">        view.backgroundColor = .blue</div><div class="line"></div><div class="line">				// è¿™é‡Œç”¨åˆ°äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„ UIStackView çš„åˆå§‹åŒ–å‡½æ•°, è¿™æ ·ä¸ä»…å‡å°‘äº†é‡å¤çš„ä»£ç é‡è€Œä¸”è®©ä»£ç æ›´æ˜“è¯».</div><div class="line">        let verticalLayout = UIStackView(arrangedSubviews: [titleLabel, button],</div><div class="line">                                         axis: .vertical,</div><div class="line">                                         distribution: .fill,</div><div class="line">                                         alignment: .fill)</div><div class="line"></div><div class="line">        verticalLayout.isLayoutMarginsRelativeArrangement = true</div><div class="line">        verticalLayout.layoutMargins = UIEdgeInsets(top: 20, left: 20, bottom: 20, right: 20)</div><div class="line"></div><div class="line">				// è°ƒç”¨æˆ‘ä»¬æ–°çš„å¸ƒå±€å‡½æ•°ï¼Œè¿™è®©æ·»åŠ ç•Œé¢å’Œè®¾ç½®ç•Œé¢çº¦æŸæ›´åŠ å®¹æ˜“ã€ç®€æ´</div><div class="line">        verticalLayout.constrainTo(view: view)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    func buttonTest(sender: UIButton) &#123;</div><div class="line">        view.backgroundColor = .red</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">// å°†ä¸Šé¢çš„ view controller ç»‘å®šåˆ° playground ä¸Š.</div><div class="line">PlaygroundPage.current.liveView = OurAwesomeViewController()</div><div class="line">PlaygroundPage.current.needsIndefiniteExecution = true</div><div class="line"></div><div class="line">// æ­£å¦‚ä½ æ‰€è§, å¸ƒå±€ä»£ç æ¸…æ™°è€Œä¸”æ˜“ç®¡ç†. æ•´ä¸ª View Controller åªæœ‰ 43 è¡Œå·¦å³çš„ä»£ç é‡.</div><div class="line">// ä»¥å¾€ï¼Œå¾ˆå¤šæ—¶å€™ç”±äºå¿˜è®°è®¾ç½®å±æ€§æˆ–è€…è°ƒç”¨å‡½æ•°è€Œå¯¼è‡´ç•Œé¢ä¸æ˜¾ç¤ºï¼Œæœ‰äº†ä¸Šé¢è¿™äº›å°è£…å·¥å…·ä¹‹åï¼Œä»£ç ä¸ä»…å¯ä»¥å…±äº«è€Œä¸”å¾ˆå¤šå¥‡æ€ªçš„é—®é¢˜ä¹Ÿå¯ä»¥åšåˆ°è¿…é€Ÿå®šä½.</div><div class="line"></div><div class="line">// é‡‡ç”¨è¿™äº›æŠ€å·§ï¼Œä½¿å¾— view controllers æ›´åŠ ç®€å•å’Œä¸»é¢˜åŒ–. å¦‚æœä½ æ„¿æ„ï¼Œå½“ç„¶å¯ä»¥ä¸º buttonï¼Œlabel æˆ–è€…å…¶ä»– UI æ§ä»¶åˆ›å»ºå¾ˆå¤šä¸åŒçš„æ ·å¼æ‰©å±•.</div><div class="line">// ä¸€æ¬¡åˆ›å»º,ä¸€å¤„æ›´æ”¹,æ•´ä¸ª app éƒ½ä¼šç”Ÿæ•ˆ !!!</div><div class="line"></div><div class="line">// è¿™å°±æ˜¯æˆ‘ä»¬ç¬¬äºŒç¯‡æ–‡ç« çš„å…¨éƒ¨å†…å®¹ï¼Œä¸‹ç¯‡æ–‡ç« ï¼Œæˆ‘å°†ä¼šä»‹ç»å¦‚ä½•å°†ä¸šåŠ¡é€»è¾‘ä» ViewControllers ä¸­å‰¥ç¦»å‡ºæ¥, ä»¥ä¿éšœæ¶æ„çš„ç¨³å®šæ€§.</div></pre></td></tr></table></figure>
<p><a href="https://www.alloc-init.com/content/downloads/2-LayoutImproved.zip" target="_blank" rel="external">ä¸‹è½½ç¤ºä¾‹ä»£ç </a></p>
<blockquote>
<p>è¯‘è€…æ³¨ï¼šä¸Šé¢çš„è¿™äº›ç¿»è¯‘ï¼Œä¸ªäººè®¤ä¸ºåªæ˜¯ä½œè€…ä¸ºäº†é˜è¿°æ¸…æ¥šä»£ç çš„åŸç†(ä¹Ÿå°±æ˜¯è¯´ä¸ºä»€ä¹ˆè¿™æ ·åšèƒ½ä½¿ä»£ç ç®€æ´)ï¼Œè€Œå¹¶éæ˜¯æ¯è¡Œä»£ç éƒ½è¦åŠ æ³¨é‡Š.</p>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šWeston Hannersï¼Œ&lt;a href=&quot;https://www.alloc-init.com/blog/2017.01.19&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-01-19&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;http://coderafi.github.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CoderAFI&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://www.jianshu.com/users/7a2d2cc38444/latest_articles&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Crystal Sun&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;å·¥å…·è®©ä»£ç å®¹æ˜“ç®¡ç†å’Œé˜…è¯»&lt;/p&gt;
    
    </summary>
    
      <category term="alloc-init" scheme="https://swift.gg/categories/alloc-init/"/>
    
    
      <category term="Swift" scheme="https://swift.gg/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>ä½ éœ€è¦çš„å¤§æ¦‚ä¸æ˜¯ enumerated</title>
    <link href="https://swift.gg/2017/05/05/you-probably-don&#39;t-want-enumerated/"/>
    <id>https://swift.gg/2017/05/05/you-probably-don&#39;t-want-enumerated/</id>
    <published>2017-05-04T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šKHANLOUï¼Œ<a href="http://khanlou.com/2017/03/you-probably-don&#39;t-want-enumerated/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-03-28<br>è¯‘è€…ï¼š<a href="https://kemchenj.github.io" target="_blank" rel="external">å››å¨˜</a>ï¼›æ ¡å¯¹ï¼š<a href="http://weibo.com/277195544" target="_blank" rel="external">Cwift</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>Swift æ ‡å‡†åº“é‡Œæœ€å®¹æ˜“è¢«æ»¥ç”¨çš„å°±æ˜¯ Sequence çš„ <code>enumerated()</code> å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªæ–°çš„åºåˆ—ï¼ŒåŒ…å«äº†åˆå§‹åºåˆ—é‡Œçš„æ‰€æœ‰å…ƒç´ ï¼Œä»¥åŠä¸å…ƒç´ ç›¸å¯¹åº”çš„ç¼–å·ã€‚</p>
<p><code>enumerated()</code> å¾ˆå®¹æ˜“è¢«è¯¯è§£ã€‚å› ä¸ºå®ƒç»™æ¯ä¸€ä¸ªå…ƒç´ éƒ½æä¾›äº†ä¸€ä¸ªç¼–å·ï¼Œå¯¹äºå¾ˆå¤šé—®é¢˜æ¥è¯´è¿™æ˜¯ä¸€ä¸ªå¾ˆç®€ä¾¿çš„æ–¹æ¡ˆã€‚ç„¶è€Œï¼Œè¿™äº›é—®é¢˜å¤§å¤šæ•°éƒ½å¯ä»¥è¢«å¦ä¸€ç§æ–¹å¼æ›´å¥½çš„è§£å†³ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å…¶ä¸­çš„ä¸€äº›ä¾‹å­å§ï¼Œè¦æ³¨æ„ç†è§£å®ƒä»¬æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œç„¶åå¦‚ä½•ä½¿ç”¨æ›´å¥½çš„æŠ½è±¡å»è§£å†³å®ƒä»¬ã€‚</p>
<a id="more"></a>
<p>ä½¿ç”¨ <code>enumerated()</code> æœ€å…³é”®çš„é—®é¢˜åœ¨äºå¤§å®¶éƒ½è®¤ä¸ºå®ƒè¿”å›çš„æ˜¯æ¯ä¸€ä¸ªå…ƒç´ å’Œå…ƒç´ çš„ç´¢å¼•å€¼ï¼Œä½†å®é™…ä¸Šå¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚å› ä¸ºå®ƒå¯ä»¥é€‚ç”¨äºæ‰€æœ‰åºåˆ—ï¼Œè€Œåºåˆ—æ˜¯ä¸èƒ½ä¿è¯æœ‰ç´¢å¼•çš„ï¼Œç”±æ­¤å¯çŸ¥å®ƒè¿”å›çš„å¹¶ä¸æ˜¯ç´¢å¼•å€¼ã€‚ä¸‹é¢çš„ä»£ç é‡Œï¼Œè¿™ä¸ªå˜é‡çš„åå­—æ˜¯ <code>offset</code>ï¼Œè€Œä¸æ˜¯ <code>index</code>ï¼Œè¿™æ˜¯æ¥ä¸‹æ¥æ–‡ç« é‡Œä¼šé»˜è®¤ä½¿ç”¨çš„å‘½åæ–¹å¼ã€‚offset æ€»æ˜¯ä¸€ä¸ªæ•´å‹ï¼Œä» 0 å¼€å§‹ï¼Œé—´éš”ä¸º 1ï¼Œè·Ÿæ¯ä¸€ä¸ªå…ƒç´ é€ä¸€å¯¹åº”ã€‚å¯¹äº <code>Array</code>ï¼Œè¿™åˆšå¥½è·Ÿå®ƒçš„ç´¢å¼•å€¼å®Œå…¨ä¸€è‡´ï¼Œä½†é™¤æ­¤ä¹‹å¤–çš„å…¶ä»–æ‰€æœ‰ç±»å‹ï¼Œéƒ½ä¸ä¼šæœ‰è¿™ç§å·§åˆå‘ç”Ÿã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> array = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>]</div><div class="line"><span class="keyword">let</span> arraySlice = array[<span class="number">2</span>..&lt;<span class="number">5</span>]</div><div class="line">arraySlice[<span class="number">2</span>] <span class="comment">// =&gt; "c"</span></div><div class="line">arraySlice.enumerated().first <span class="comment">// =&gt; (0, "c")</span></div><div class="line">arraySlice[<span class="number">0</span>] <span class="comment">// fatalError</span></div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çš„å˜é‡ <code>arraySlice</code>ï¼Œæ¯«æ— ç–‘é—®æ˜¯ <code>ArraySlice</code> ç±»å‹ã€‚ç„¶è€Œï¼Œå®ƒçš„<code>startIndex</code> å¾ˆæ˜æ˜¾æ˜¯ 2ï¼Œè€Œä¸æ˜¯ 0ï¼Œä½†å½“æˆ‘ä»¬è°ƒç”¨ <code>enumerated()</code> å’Œ <code>first</code> çš„æ—¶å€™, å®ƒä¼šè¿”å›ä¸€ä¸ªå…ƒç»„ï¼ŒåŒ…å«äº†ä¸€ä¸ªoffsetï¼Œå€¼ä¸º 0ï¼Œä»¥åŠå®ƒçš„ç¬¬ä¸€ä¸ªå…ƒç´  â€œcâ€ã€‚</p>
<p>ä½ ä»¥ä¸ºï¼Œä½ ä¼šè·å¾—ä¸ä¸‹é¢ç­‰ä»·çš„ä»£ç </p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="built_in">zip</span>(array.<span class="built_in">indices</span>, array)</div></pre></td></tr></table></figure>
<p>ä½†å®é™…ä¸Šä½ è·å–åˆ°çš„æ˜¯è¿™ä¸ª</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="built_in">zip</span>((<span class="number">0</span>..&lt;array.<span class="built_in">count</span>), array)</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ ä¸æ˜¯åœ¨ä½¿ç”¨ <code>Array</code> çš„è¯ï¼Œéšæ—¶å¯èƒ½ä¼šäº§ç”Ÿé”™è¯¯çš„è¡Œä¸ºã€‚</p>
<p>è€Œä¸”å®é™…ä¸Šä½ è·å–åˆ°çš„æ˜¯ä¸€ä¸ª offsetï¼Œè€Œä¸æ˜¯ indexï¼Œä½¿ç”¨ <code>enumerated()</code> ä¹Ÿä¼šæœ‰åˆ«çš„é—®é¢˜ã€‚å¾ˆå¤šæ—¶å€™ä½ ä¹Ÿè®¸æƒ³ç”¨ <code>enumerated()</code>ï¼Œ ä½†æœ‰åˆ«çš„æ›´å¥½çš„æŠ½è±¡å¯ä»¥ä½¿ç”¨ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€äº›ä¾‹å­ã€‚</p>
<p>æˆ‘è§åˆ°  <code>enumerated()</code> æœ€å¸¸ç”¨çš„æ–¹å¼æ˜¯å¯¹ä¸€ä¸ªæ•°ç»„æ‰§è¡Œ enumeratedï¼Œä½¿ç”¨è¿”å›çš„ offset æ¥è·å–å¦ä¸€ä¸ªæ•°ç»„å¯¹åº”çš„å…ƒç´ ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> (offset, model) <span class="keyword">in</span> models.enumerated() &#123;</div><div class="line">	<span class="keyword">let</span> viewController = viewControllers[offset]</div><div class="line">	viewController.model = model</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è™½ç„¶è¿™æ®µä»£ç å¯ä»¥æ­£å¸¸è¿ä½œï¼Œä½†å‰ææ˜¯ <code>models</code> å’Œ <code>viewControllers</code> éƒ½æ˜¯ Array ç±»å‹ï¼Œä½¿ç”¨æ•´å‹æ¥ä½œä¸ºç´¢å¼•å€¼ç±»å‹ï¼Œä» 0 å¼€å§‹ã€‚å¦ä¸€ä¸ªå‰ææ˜¯è¿™ä¸¤ä¸ªæ•°ç»„æ‹¥æœ‰ç›¸åŒçš„é•¿åº¦ã€‚å¦‚æœ<code>models</code> çš„æ•°ç»„é•¿åº¦æ¯” <code>viewControllers</code> çŸ­çš„è¯ï¼Œå°±ä¼šå´©æºƒã€‚æˆ‘ä»¬è¿˜å¤šäº†ä¸€ä¸ªæ²¡æœ‰å®é™…æ„ä¹‰çš„å¤šä½™çš„å˜é‡ <code>offset</code>ã€‚ä¸€ä¸ªç®€æ´çš„ Swift å®ç°æ–¹å¼åº”è¯¥æ˜¯ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> (model, viewController) <span class="keyword">in</span> <span class="built_in">zip</span>(models, viewControllers) &#123;</div><div class="line">	viewController.model = model</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç æ›´åŠ ç®€æ´ï¼Œè€Œä¸”é€‚ç”¨äºæ‰€æœ‰ <code>Sequence</code> ç±»å‹ï¼Œè€Œä¸”å¯ä»¥å®‰å…¨åœ°å¤„ç†ä¸ç­‰é•¿çš„æ•°ç»„ã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹å¦ä¸€ä¸ªä¾‹å­ï¼Œè¿™æ®µä»£ç ç»™ç¬¬ä¸€ä¸ª <code>imageView</code> å’Œå®ƒçš„å®¹å™¨ä»¥åŠæ¯ä¸ª <code>imageView</code> ä¹‹é—´æ·»åŠ äº†ä¸€æ®µ autolayout çš„çº¦æŸ</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> (offset, imageView) <span class="keyword">in</span> imageViews.enumerated() &#123;</div><div class="line">	<span class="keyword">if</span> offset == <span class="number">0</span> &#123;</div><div class="line">		imageView.leadingAnchor.constraint(equalTo: containerView.leadingAnchor).isActive = <span class="literal">true</span></div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		<span class="keyword">let</span> imageToAnchor = imageView[offset - <span class="number">1</span>]</div><div class="line">		imageView.leadingAnchor.constraint(equalTo: imageToAnchor.trailingAnchor).isActive = <span class="literal">true</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ®µç¤ºä¾‹ä»£ç ä¹Ÿæœ‰åŒæ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬æƒ³è¦æˆå¯¹çš„å…ƒç´ ï¼Œä½†ä½¿ç”¨ <code>enumerated()</code> å»è·å–ç´¢å¼•ä»¥ä¾¿åç»­æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰‹åŠ¨å»å¤„ç†ç´¢å¼•ï¼Œè¿™å¹¶æ²¡æœ‰å¿…è¦ã€‚<code>zip</code> åœ¨è¿™ç§æƒ…å†µä¸‹ä¹Ÿé€‚ç”¨ã€‚</p>
<p>é¦–å…ˆï¼Œå¤„ç†å®¹å™¨å’Œç¬¬ä¸€ä¸ªå…ƒç´ çš„çº¦æŸï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">imageViews.first?.leadingAnchor.constraint(equalTo: containerView.leadingAnchor).isActive = <span class="literal">true</span></div></pre></td></tr></table></figure>
<p>æ¥ç€ï¼Œæˆ‘ä»¬æ¥æŠŠå…ƒç´ æ‹¼æˆä¸€å¯¹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">left</span>, <span class="keyword">right</span>) <span class="keyword">in</span> <span class="built_in">zip</span>(imageViews, imageViews.<span class="built_in">dropFirst</span>()) &#123;</div><div class="line">	<span class="keyword">left</span>.trailingAnchor.constraint(equalTo: <span class="keyword">right</span>.leadingAnchor).isActive = <span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æå®šï¼Œæ²¡æœ‰ç´¢å¼•å€¼ï¼Œä»»ä½• Sequence ç±»å‹éƒ½é€‚ç”¨ï¼Œè€Œä¸”æ›´åŠ ç®€æ´ã€‚</p>
<p>ï¼ˆä½ ä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªæ‹¼å¯¹çš„æ“ä½œå°è£…è¿› <a href="https://gist.github.com/khanlou/f27b34f28b21b4834a758913e06a5f3b" target="_blank" rel="external">extension</a> é‡Œï¼Œæˆ‘ä¼šè€ƒè™‘å‘½åä¸º <code>.eachPair()</code> ï¼‰</p>
<p>è¿™é‡Œä»‹ç»ä¸€ä¸‹ <code>enumerated()</code> çš„ä½¿ç”¨å§¿åŠ¿ã€‚å› ä¸ºä½ è·å–åˆ°çš„å¹¶éæ˜¯ç´¢å¼•å€¼ï¼Œè€Œæ˜¯ä¸€ä¸ªæ•´å‹ï¼Œæ‰€ä»¥å½“ä½ éœ€è¦ä¸€ä¸ªæ•°å­—å»å¯¹åº”åˆ°æ¯ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œå°±å¾ˆé€‚åˆä½¿ç”¨ <code>enumerated()</code>ã€‚ä¾‹å¦‚ï¼Œä½ éœ€è¦åœ¨å‚ç›´æ–¹å‘ç­‰è·æ‘†æ”¾å¤šä¸ª viewï¼Œæ¯ä¸€ä¸ª view éƒ½éœ€è¦ä¸€ä¸ª yï¼Œç­‰äºæŸä¸ªé«˜åº¦ä¹˜ä»¥ offsetï¼Œ<code>enumerated()</code> å°±å¾ˆé€‚åˆã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> (offset, view) <span class="keyword">in</span> views.enumerated() &#123;</div><div class="line">	view.frame.origin.y = offset * view.frame.height</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å› ä¸ºè¿™é‡Œçš„ offset æ˜¯ä½œä¸ºä¸€ä¸ªæ•°å­—å»ä½¿ç”¨ï¼Œ<code>enumerated()</code>å°±å¯ä»¥æ­£å¸¸è¿ä½œã€‚</p>
<p>ä½¿ç”¨çš„è§„åˆ™å¾ˆç®€å•ï¼šå¦‚æœä½ æ˜¯æƒ³ç”¨ <code>enumerated()</code> å»è·å–ç´¢å¼•ï¼Œé‚£ä¹Ÿè®¸ä¼šæœ‰æ›´å¥½çš„æ–¹å¼å»è§£å†³ä½ çš„é—®é¢˜ï¼Œå¦‚æœä½ æ˜¯æƒ³æŠŠå®ƒä½œä¸ºä¸€ä¸ªæ•°å­—å»ä½¿ç”¨ï¼Œé‚£å°±å¾ˆé€‚åˆğŸ‘ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šKHANLOUï¼Œ&lt;a href=&quot;http://khanlou.com/2017/03/you-probably-don&amp;#39;t-want-enumerated/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-03-28&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;https://kemchenj.github.io&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;å››å¨˜&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://weibo.com/277195544&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cwift&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;Swift æ ‡å‡†åº“é‡Œæœ€å®¹æ˜“è¢«æ»¥ç”¨çš„å°±æ˜¯ Sequence çš„ &lt;code&gt;enumerated()&lt;/code&gt; å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªæ–°çš„åºåˆ—ï¼ŒåŒ…å«äº†åˆå§‹åºåˆ—é‡Œçš„æ‰€æœ‰å…ƒç´ ï¼Œä»¥åŠä¸å…ƒç´ ç›¸å¯¹åº”çš„ç¼–å·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;enumerated()&lt;/code&gt; å¾ˆå®¹æ˜“è¢«è¯¯è§£ã€‚å› ä¸ºå®ƒç»™æ¯ä¸€ä¸ªå…ƒç´ éƒ½æä¾›äº†ä¸€ä¸ªç¼–å·ï¼Œå¯¹äºå¾ˆå¤šé—®é¢˜æ¥è¯´è¿™æ˜¯ä¸€ä¸ªå¾ˆç®€ä¾¿çš„æ–¹æ¡ˆã€‚ç„¶è€Œï¼Œè¿™äº›é—®é¢˜å¤§å¤šæ•°éƒ½å¯ä»¥è¢«å¦ä¸€ç§æ–¹å¼æ›´å¥½çš„è§£å†³ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å…¶ä¸­çš„ä¸€äº›ä¾‹å­å§ï¼Œè¦æ³¨æ„ç†è§£å®ƒä»¬æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œç„¶åå¦‚ä½•ä½¿ç”¨æ›´å¥½çš„æŠ½è±¡å»è§£å†³å®ƒä»¬ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="KHANLOU" scheme="https://swift.gg/categories/KHANLOU/"/>
    
    
      <category term="Swift è¿›é˜¶" scheme="https://swift.gg/tags/Swift-%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>Promise çš„å‡ ç§é€šç”¨æ¨¡å¼</title>
    <link href="https://swift.gg/2017/05/04/common-patterns-with-promises/"/>
    <id>https://swift.gg/2017/05/04/common-patterns-with-promises/</id>
    <published>2017-05-03T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šSoroush Khanlouï¼Œ<a href="http://khanlou.com/2016/08/common-patterns-with-promises/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016/8/8<br>è¯‘è€…ï¼š<a href="http://weibo.com/277195544" target="_blank" rel="external">Cwift</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<blockquote>
<p>è¯‘è€…æ³¨ï¼šè‹±æ–‡åŸæ–‡å‘å¸ƒæ—¶é—´è¾ƒæ—©ï¼Œæ•…åŸæ–‡ä»£ç ä¸­çš„ Swift ç‰ˆæœ¬è¾ƒæ—§ï¼Œä½†æ˜¯ä½œè€…å·²å°† GitHub ä¸Šçš„ <a href="https://github.com/khanlou/Promise" target="_blank" rel="external">Promise ç¤ºä¾‹ä»£ç </a>æ›´æ–°åˆ°äº†æœ€æ–° Swift ç‰ˆæœ¬ï¼Œæ‰€ä»¥è¯‘è€…åœ¨ç¿»è¯‘æœ¬æ–‡æ—¶ï¼Œå°†æ–‡ç« é‡Œçš„ä»£ç æŒ‰ç…§ GitHub ä¸Šçš„ç¤ºä¾‹ä»£ç è¿›è¡Œäº†æ›¿æ¢ï¼Œæ›´æ–°æˆäº†æœ€æ–°ç‰ˆæœ¬çš„ Swift ä»£ç ã€‚</p>
</blockquote>
<p>ä¸Šå‘¨ï¼Œæˆ‘å†™äº†ä¸€ç¯‡<a href="http://swift.gg/2017/03/27/promises-in-swift/">ä»‹ç» Promise çš„æ–‡ç« </a>ï¼ŒPromise æ˜¯å¤„ç†å¼‚æ­¥æ“ä½œçš„é«˜é˜¶æ¨¡å—ã€‚åªéœ€è¦ä½¿ç”¨ <code>fulfill()</code>ã€<code>reject()</code> å’Œ <code>then()</code> ç­‰å‡½æ•°ï¼Œå°±å¯ä»¥ç®€å•è‡ªç”±åœ°æ„å»ºå¤§é‡çš„åŠŸèƒ½ã€‚æœ¬æ–‡ä¼šå±•ç¤ºæˆ‘åœ¨ Promise æ–¹é¢çš„ä¸€äº›æ¢ç´¢ã€‚</p>
<a id="more"></a>
<h3 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all"></a>Promise.all</h3><p><code>Promise.all</code> æ˜¯å…¶ä¸­çš„å…¸å‹ï¼Œå®ƒä¿å­˜æ‰€æœ‰å¼‚æ­¥å›è°ƒçš„å€¼ã€‚è¿™ä¸ªé™æ€å‡½æ•°çš„ä½œç”¨æ˜¯ç­‰å¾…æ‰€æœ‰çš„ Promise æ‰§è¡Œ fulfillï¼ˆå±¥è¡Œï¼‰ ï¼Œä¸€æ—¦å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼Œ<code>Promise.all</code> ä¼šä½¿ç”¨æ‰€æœ‰å±¥è¡Œåçš„å€¼ç»„æˆçš„æ•°ç»„å¯¹è‡ªå·±æ‰§è¡Œ fulfillã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³åœ¨ä»£ç ä¸­å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ‰“ç‚¹ä»¥æ•è·æŸä¸ª API çš„å®ŒæˆçŠ¶æ€ã€‚ä½¿ç”¨ <code>map</code> å’Œ <code>Promise.all</code> å¾ˆå®¹æ˜“å®ç°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> userPromises = users.<span class="built_in">map</span>(&#123; user <span class="keyword">in</span></div><div class="line">	<span class="type">APIClient</span>.followUser(user)</div><div class="line">&#125;)</div><div class="line"><span class="type">Promise</span>.all(userPromises).then(&#123;</div><div class="line">	<span class="comment">//æ‰€æœ‰çš„ç”¨æˆ·éƒ½å·²ç»æ‰§è¡Œäº† followï¼</span></div><div class="line">&#125;).<span class="keyword">catch</span>(&#123; error <span class="keyword">in</span></div><div class="line">	<span class="comment">//å…¶ä¸­ä¸€ä¸ª API å¤±è´¥äº†ã€‚</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>è¦ä½¿ç”¨ <code>Promise.all</code>ï¼Œéœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„ Promiseï¼Œå®ƒä»£è¡¨æ‰€æœ‰ Promise çš„ç»„åˆçŠ¶æ€ï¼Œå¦‚æœå‚æ•°ä¸­çš„æ•°ç»„ä¸ºç©ºï¼Œå¯ä»¥ç«‹å³æ‰§è¡Œ fulfillã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">all</span>&lt;T&gt;<span class="params">(<span class="number">_</span> promises: [Promise&lt;T&gt;])</span></span> -&gt; <span class="type">Promise</span>&lt;[<span class="type">T</span>]&gt; &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">Promise</span>&lt;[<span class="type">T</span>]&gt;(work: &#123; fulfill, reject <span class="keyword">in</span></div><div class="line">        <span class="keyword">guard</span> !promises.isEmpty <span class="keyword">else</span> &#123; fulfill([]); <span class="keyword">return</span> &#125;</div><div class="line">			</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ª Promise å†…éƒ¨ï¼Œéå†æ¯ä¸ªå­ Promiseï¼Œå¹¶åˆ†åˆ«ä¸ºå®ƒä»¬æ·»åŠ æˆåŠŸå’Œå¤±è´¥çš„å¤„ç†æµç¨‹ã€‚ä¸€æ—¦æœ‰å­ Promise æ‰§è¡Œå¤±è´¥äº†ï¼Œå°±å¯ä»¥æ‹’ç»é«˜é˜¶çš„ Promiseã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> promise <span class="keyword">in</span> promises &#123;</div><div class="line">    promise.then(&#123; value <span class="keyword">in</span></div><div class="line"></div><div class="line">    &#125;).<span class="keyword">catch</span>(&#123; error <span class="keyword">in</span></div><div class="line">        reject(error)</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åªæœ‰å½“æ‰€æœ‰çš„ Promise éƒ½æ‰§è¡ŒæˆåŠŸï¼Œæ‰å¯ä»¥ <code>fulfill</code> é«˜é˜¶çš„ Promiseã€‚æ£€æŸ¥ä¸€ä¸‹ä»¥ç¡®ä¿æ²¡æœ‰ä¸€ä¸ª Promise è¢«æ‹’ç»æˆ–è€…æŒ‚èµ·ï¼Œä½¿ç”¨ä¸€ç‚¹ç‚¹ <code>flatMap</code> çš„é­”æ³•ï¼Œå°±å¯ä»¥å¯¹ Promise çš„ç»„åˆæ‰§è¡Œ fulfill æ“ä½œäº†ã€‚å®Œæ•´çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">all</span>&lt;T&gt;<span class="params">(<span class="number">_</span> promises: [Promise&lt;T&gt;])</span></span> -&gt; <span class="type">Promise</span>&lt;[<span class="type">T</span>]&gt; &#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">Promise</span>&lt;[<span class="type">T</span>]&gt;(work: &#123; fulfill, reject <span class="keyword">in</span></div><div class="line">            <span class="keyword">guard</span> !promises.isEmpty <span class="keyword">else</span> &#123; fulfill([]); <span class="keyword">return</span> &#125;</div><div class="line">            <span class="keyword">for</span> promise <span class="keyword">in</span> promises &#123;</div><div class="line">                promise.then(&#123; value <span class="keyword">in</span></div><div class="line">                    <span class="keyword">if</span> !promises.<span class="built_in">contains</span>(<span class="keyword">where</span>: &#123; $<span class="number">0</span>.isRejected || $<span class="number">0</span>.isPending &#125;) &#123;</div><div class="line">                        fulfill(promises.flatMap(&#123; $<span class="number">0</span>.value &#125;))</div><div class="line">                    &#125;</div><div class="line">                &#125;).<span class="keyword">catch</span>(&#123; error <span class="keyword">in</span></div><div class="line">                    reject(error)</div><div class="line">                &#125;)</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>è¯·æ³¨æ„ï¼ŒPromise åªèƒ½å±¥è¡Œæˆ–è€…æ‹’ç»ä¸€æ¬¡ã€‚å¦‚æœç¬¬äºŒæ¬¡è°ƒç”¨ <code>fulfill</code> æˆ–è€… <code>reject</code>ï¼Œä¸ä¼šå¯¹ Promise çš„çŠ¶æ€é€ æˆä»»ä½•å½±å“ã€‚</p>
<p>å› ä¸º Promise æ˜¯çŠ¶æ€æœºï¼Œå®ƒä¿å­˜äº†ä¸å®Œæˆåº¦æœ‰å…³çš„é‡è¦çŠ¶æ€ã€‚å®ƒæ˜¯ä¸€ç§ä¸åŒäº <code>NSOperation</code> çš„æ–¹æ³•ã€‚è™½ç„¶ <code>NSOperation</code> æ‹¥æœ‰ä¸€ä¸ªå®Œæˆå›è°ƒä»¥åŠæ“ä½œçš„çŠ¶æ€ï¼Œä½†å®ƒä¸èƒ½ä¿å­˜å¾—åˆ°çš„å€¼ï¼Œä½ éœ€è¦è‡ªå·±å»ç®¡ç†ã€‚</p>
<p><code>NSOperation</code> è¿˜æŒæœ‰çº¿ç¨‹æ¨¡å‹ä»¥åŠä¼˜å…ˆçº§é¡ºåºç›¸å…³çš„æ•°æ®ï¼Œè€Œ Promise å¯¹ä»£ç  <em>å¦‚ä½•</em> å®Œæˆä¸åšä»»ä½•ä¿è¯ï¼Œåªè®¾ç½® <em>å®Œæˆå</em>  éœ€è¦æ‰§è¡Œçš„ä»£ç ã€‚Promise ç±»çš„å®šä¹‰è¶³ä»¥è¯æ˜ã€‚å®ƒå”¯ä¸€çš„å®ä¾‹å˜é‡æ˜¯ <code>state</code>ï¼ŒçŠ¶æ€åŒ…æ‹¬æŒ‚èµ·ã€å±¥è¡Œæˆ–è€…æ‹’ç»ï¼ˆä»¥åŠå¯¹åº”çš„æ•°æ®ï¼‰ï¼Œæ­¤å¤–è¿˜æœ‰ä¸€ä¸ªå›è°ƒæ•°ç»„ã€‚ï¼ˆå®ƒè¿˜åŒ…å«äº†ä¸€ä¸ªéš”ç¦»é˜Ÿåˆ—ï¼Œä½†é‚£ä¸æ˜¯çœŸæ­£çš„çŠ¶æ€ã€‚ï¼‰</p>
<h3 id="delay"><a href="#delay" class="headerlink" title="delay"></a>delay</h3><p>æœ‰ä¸€ç§å¾ˆæœ‰ç”¨çš„ Promise å¯ä»¥å»¶è¿Ÿæ‰§è¡Œè‡ªå·±çš„æ“ä½œã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">delay</span><span class="params">(<span class="number">_</span> delay: TimeInterval)</span></span> -&gt; <span class="type">Promise</span>&lt;()&gt; &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">Promise</span>&lt;()&gt;(work: &#123; fulfill, reject <span class="keyword">in</span></div><div class="line">        <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() + delay, execute: &#123;</div><div class="line">            fulfill(())</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨æ–¹æ³•å†…éƒ¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>usleep</code> æˆ–è€…å…¶ä»–æ–¹æ³•æ¥å®ç°å»¶è¿Ÿï¼Œä¸è¿‡ <code>asyncAfter</code> æ–¹æ³•è¶³å¤Ÿç®€å•ã€‚å½“æ„å»ºå…¶ä»–æœ‰è¶£çš„ Promise æ—¶ï¼Œè¿™ä¸ªå»¶è¿Ÿ Promise ä¼šå¾ˆæœ‰ç”¨ã€‚</p>
<h3 id="timeout"><a href="#timeout" class="headerlink" title="timeout"></a>timeout</h3><p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ <code>delay</code> æ¥æ„å»º <code>timeout</code>ã€‚è¯¥ Promise å¦‚æœè¶…è¿‡ä¸€å®šæ—¶é—´å°±ä¼šè¢«æ‹’ç»ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">timeout</span>&lt;T&gt;<span class="params">(<span class="number">_</span> timeout: TimeInterval)</span></span> -&gt; <span class="type">Promise</span>&lt;<span class="type">T</span>&gt; &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">Promise</span>&lt;<span class="type">T</span>&gt;(work: &#123; fulfill, reject <span class="keyword">in</span></div><div class="line">        delay(timeout).then(&#123; <span class="number">_</span> <span class="keyword">in</span></div><div class="line">            reject(<span class="type">NSError</span>(domain: <span class="string">"com.khanlou.Promise"</span>, code: -<span class="number">1111</span>, userInfo: [ <span class="type">NSLocalizedDescriptionKey</span>: <span class="string">"Timed out"</span> ]))</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ª Promise è‡ªèº«æ²¡æœ‰å¤ªå¤šç”¨å¤„ï¼Œä½†å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ„å»ºä¸€äº›å…¶ä»–åŠŸèƒ½çš„ Promiseã€‚</p>
<h3 id="race"><a href="#race" class="headerlink" title="race"></a>race</h3><p><code>Promise.race</code> æ˜¯ <code>Promise.all</code> çš„å°ä¼™ä¼´ï¼Œå®ƒä¸éœ€è¦ç­‰å¾…æ‰€æœ‰çš„å­ Promise å®Œæˆï¼Œå®ƒåªå±¥è¡Œæˆ–è€…æ‹’ç»ç¬¬ä¸€ä¸ªå®Œæˆçš„ Promiseã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">race</span>&lt;T&gt;<span class="params">(<span class="number">_</span> promises: [Promise&lt;T&gt;])</span></span> -&gt; <span class="type">Promise</span>&lt;<span class="type">T</span>&gt; &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">Promise</span>&lt;<span class="type">T</span>&gt;(work: &#123; fulfill, reject <span class="keyword">in</span></div><div class="line">        <span class="keyword">guard</span> !promises.isEmpty <span class="keyword">else</span> &#123; <span class="built_in">fatalError</span>() &#125;</div><div class="line">        <span class="keyword">for</span> promise <span class="keyword">in</span> promises &#123;</div><div class="line">            promise.then(fulfill, reject)</div><div class="line">        &#125;</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å› ä¸º Promise åªèƒ½è¢«æ‰§è¡Œæˆ–æ‹’ç»ä¸€æ¬¡ï¼Œæ‰€ä»¥å½“ç§»é™¤äº† <code>.pending</code> çš„çŠ¶æ€åï¼Œåœ¨å¤–éƒ¨å¯¹ Promise è°ƒç”¨ <code>fulfill</code> æˆ–è€… <code>reject</code> ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚</p>
<p>æœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œä½¿ç”¨ <code>timeout</code> å’Œ <code>Promise.race</code> å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Promiseï¼Œé’ˆå¯¹æˆåŠŸã€å¤±è´¥æˆ–è€…è¶…è¿‡äº†è§„å®šæ—¶é—´ä¸‰ç§æƒ…å†µã€‚æŠŠå®ƒå®šä¹‰åœ¨ <code>Promise</code> çš„æ‰©å±•ä¸­ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">addTimeout</span><span class="params">(<span class="number">_</span> timeout: TimeInterval)</span></span> -&gt; <span class="type">Promise</span>&lt;<span class="type">Value</span>&gt; &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">Promise</span>.race(<span class="type">Array</span>([<span class="keyword">self</span>, <span class="type">Promise</span>&lt;<span class="type">Value</span>&gt;.timeout(timeout)]))</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥åœ¨æ­£å¸¸çš„ Promise é“¾ä¸­ä½¿ç”¨å®ƒï¼Œåƒä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">APIClient</span></div><div class="line">    .getUsers()</div><div class="line">    .addTimeout(<span class="number">0.5</span>)</div><div class="line">    .then(&#123;</div><div class="line">    	<span class="comment">//åœ¨ 0.5 ç§’å†…è·å–äº†ç”¨æˆ·æ•°æ®</span></div><div class="line">    &#125;)</div><div class="line">    .<span class="keyword">catch</span>(&#123; error <span class="keyword">in</span></div><div class="line">    	<span class="comment">//ä¹Ÿè®¸æ˜¯è¶…æ—¶å¼•å‘çš„é”™è¯¯ï¼Œä¹Ÿè®¸æ˜¯ç½‘ç»œé”™è¯¯</span></div><div class="line">    &#125;)</div></pre></td></tr></table></figure>
<p>è¿™æ˜¯æˆ‘å–œæ¬¢ Promise çš„åŸå› ä¹‹ä¸€ï¼Œå®ƒä»¬çš„å¯ç»„åˆæ€§ä½¿å¾—æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åˆ›å»ºå„ç§è¡Œä¸ºã€‚é€šå¸¸éœ€è¦ä¿è¯ Promise åœ¨ <em>æŸä¸ªæ—¶åˆ»</em> è¢«å±¥è¡Œæˆ–è€…æ‹’ç»ï¼Œä½†æ˜¯ timeout å‡½æ•°å…è®¸æˆ‘ä»¬ç”¨å¸¸è§„çš„æ–¹å¼æ¥ä¿®æ­£è¿™ç§è¡Œä¸ºã€‚</p>
<h3 id="recover"><a href="#recover" class="headerlink" title="recover"></a>recover</h3><p><code>recover</code> æ˜¯å¦ä¸€ä¸ªæœ‰ç”¨çš„å‡½æ•°ã€‚å®ƒå¯ä»¥æ•è·ä¸€ä¸ªé”™è¯¯ï¼Œç„¶åè½»æ¾åœ°æ¢å¤çŠ¶æ€ï¼ŒåŒæ—¶ä¸ä¼šå¼„ä¹±å…¶ä½™çš„ Promise é“¾ã€‚<br>æˆ‘ä»¬å¾ˆæ¸…æ¥šè¿™ä¸ªå‡½æ•°çš„å½¢å¼ï¼šå®ƒåº”è¯¥æ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¸­æ¥å—é”™è¯¯å¹¶è¿”å›æ–°çš„ Promiseã€‚recover æ–¹æ³•ä¹Ÿåº”è¯¥è¿”å›ä¸€ä¸ª Promise ä»¥ä¾¿ç»§ç»­é“¾æ¥ Promise é“¾ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Promise</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">recover</span><span class="params">(<span class="number">_</span> recovery: @escaping <span class="params">(Error)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Promise</span>&lt;<span class="type">Value</span>&gt;) -&gt; <span class="type">Promise</span>&lt;<span class="type">Value</span>&gt; &#123;</div><div class="line">    </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨æ–¹æ³•ä½“ä¸­ï¼Œéœ€è¦è¿”å›ä¸€ä¸ªæ–°çš„ Promiseï¼Œå¦‚æœå½“å‰çš„ Promiseï¼ˆ<code>self</code>ï¼‰æ‰§è¡ŒæˆåŠŸï¼Œéœ€è¦æŠŠæˆåŠŸçŠ¶æ€è½¬ç§»ç»™æ–°çš„ Promiseã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">recover</span><span class="params">(<span class="number">_</span> recovery: @escaping <span class="params">(Error)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Promise</span>&lt;<span class="type">Value</span>&gt;) -&gt; <span class="type">Promise</span>&lt;<span class="type">Value</span>&gt; &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">Promise</span>(work: &#123; fulfill, reject <span class="keyword">in</span></div><div class="line">        <span class="keyword">self</span>.then(fulfill).<span class="keyword">catch</span>(&#123; error <span class="keyword">in</span></div><div class="line">        </div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶è€Œï¼Œ<code>catch</code> æ˜¯å¦ä¸€å›äº‹äº†ã€‚å¦‚æœ Promise æ‰§è¡Œå¤±è´¥ï¼Œåº”è¯¥è°ƒç”¨æä¾›çš„ <code>recovery</code> å‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ Promiseã€‚æ— è®º recovery ä¸­çš„ Promise æ‰§è¡ŒæˆåŠŸä¸å¦ï¼Œéƒ½è¦æŠŠç»“æœè¿”å›ç»™æ–°çš„ Promiseã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//...</span></div><div class="line"><span class="keyword">do</span> &#123;</div><div class="line">    <span class="keyword">try</span> recovery(error).then(fulfill, reject)</div><div class="line">&#125; <span class="keyword">catch</span> (<span class="keyword">let</span> error) &#123;</div><div class="line">    reject(error)</div><div class="line">&#125;</div><div class="line"><span class="comment">//...</span></div></pre></td></tr></table></figure>
<p>å®Œæ•´çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">recover</span><span class="params">(<span class="number">_</span> recovery: @escaping <span class="params">(Error)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Promise</span>&lt;<span class="type">Value</span>&gt;) -&gt; <span class="type">Promise</span>&lt;<span class="type">Value</span>&gt; &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">Promise</span>(work: &#123; fulfill, reject <span class="keyword">in</span></div><div class="line">        <span class="keyword">self</span>.then(fulfill).<span class="keyword">catch</span>(&#123; error <span class="keyword">in</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">try</span> recovery(error).then(fulfill, reject)</div><div class="line">            &#125; <span class="keyword">catch</span> (<span class="keyword">let</span> error) &#123;</div><div class="line">                reject(error)</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ‰äº†è¿™ä¸ªæ–°çš„å‡½æ•°å°±å¯ä»¥ä»é”™è¯¯ä¸­æ¢å¤ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç½‘ç»œæ²¡æœ‰åŠ è½½æˆ‘ä»¬æœŸæœ›çš„æ•°æ®ï¼Œå¯ä»¥ä»ç¼“å­˜ä¸­åŠ è½½æ•°æ®ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">APIClient</span>.getUsers()</div><div class="line">    .recover(&#123; error <span class="keyword">in</span> </div><div class="line">        <span class="keyword">return</span> cache.getUsers()</div><div class="line">    &#125;).then(&#123; user <span class="keyword">in</span></div><div class="line">    	<span class="comment">//æ›´æ–° UI</span></div><div class="line">    &#125;).<span class="keyword">catch</span>(&#123; error <span class="keyword">in</span></div><div class="line">    	<span class="comment">//é”™è¯¯å¤„ç†</span></div><div class="line">    &#125;)</div></pre></td></tr></table></figure>
<h3 id="retry"><a href="#retry" class="headerlink" title="retry"></a>retry</h3><p>é‡è¯•æ˜¯æˆ‘ä»¬å¯ä»¥æ·»åŠ çš„å¦ä¸€ä¸ªåŠŸèƒ½ã€‚è‹¥è¦é‡è¯•ï¼Œéœ€è¦æŒ‡å®šé‡è¯•çš„æ¬¡æ•°ä»¥åŠä¸€ä¸ªèƒ½å¤Ÿåˆ›å»º Promise çš„å‡½æ•°ï¼Œè¯¥ Promise åŒ…å«äº†é‡è¯•è¦æ‰§è¡Œçš„æ“ä½œï¼ˆæ‰€ä»¥è¿™ä¸ª Promise ä¼šè¢«é‡å¤åˆ›å»ºå¾ˆå¤šæ¬¡ï¼‰ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">retry</span>&lt;T&gt;<span class="params">(<span class="built_in">count</span>: Int, delay: TimeInterval, generate: @escaping <span class="params">()</span></span></span> -&gt; <span class="type">Promise</span>&lt;<span class="type">T</span>&gt;) -&gt; <span class="type">Promise</span>&lt;<span class="type">T</span>&gt; &#123;</div><div class="line">    <span class="keyword">if</span> <span class="built_in">count</span> &lt;= <span class="number">0</span> &#123;</div><div class="line">        <span class="keyword">return</span> generate()</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="type">Promise</span>&lt;<span class="type">T</span>&gt;(work: &#123; fulfill, reject <span class="keyword">in</span></div><div class="line">        generate().recover(&#123; error <span class="keyword">in</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">self</span>.delay(delay).then(&#123;</div><div class="line">                <span class="keyword">return</span> retry(<span class="built_in">count</span>: <span class="built_in">count</span>-<span class="number">1</span>, delay: delay, generate: generate)</div><div class="line">            &#125;)</div><div class="line">        &#125;).then(fulfill).<span class="keyword">catch</span>(reject)</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>å¦‚æœæ•°é‡ä¸è¶³ 1ï¼Œç›´æ¥ç”Ÿæˆ Promise å¹¶è¿”å›ã€‚</li>
<li>å¦åˆ™ï¼Œåˆ›å»ºä¸€ä¸ªåŒ…å«äº†éœ€è¦é‡è¯•çš„ Promise çš„æ–°çš„ Promiseï¼Œå¦‚æœå¤±è´¥äº†ï¼Œåœ¨ <code>delay</code> æ—¶é—´ä¹‹åæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€å¹¶é‡è¯•ï¼Œä¸è¿‡æ­¤æ—¶çš„é‡è¯•æ¬¡æ•°å‡ä¸º <code>count - 1</code>ã€‚</li>
</ul>
<p>åŸºäºä¹‹å‰ç¼–å†™çš„ <code>delay</code> å’Œ <code>recover</code> å‡½æ•°æ„å»ºäº†é‡è¯•çš„å‡½æ•°ã€‚</p>
<p>åœ¨ä¸Šé¢çš„è¿™äº›ä¾‹å­ä¸­ï¼Œè½»é‡ä¸”å¯ç»„åˆçš„éƒ¨åˆ†ç»„åˆåœ¨ä¸€èµ·ï¼Œå°±å¾—åˆ°äº†ç®€å•ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚æ‰€æœ‰çš„è¿™äº›è¡Œä¸ºéƒ½æ˜¯å»ºç«‹åœ¨ Promise æ ¸å¿ƒä»£ç æ‰€æä¾›çš„ç®€å•çš„ <code>.then</code> å’Œ <code>catch</code> å‡½æ•°ä¸Šçš„ã€‚é€šè¿‡æ ¼å¼åŒ–å®Œæˆé—­åŒ…çš„æ ·å¼ï¼Œå¯ä»¥è§£å†³è¯¸å¦‚è¶…æ—¶ã€æ¢å¤ã€é‡è¯•ä»¥åŠå…¶ä»–å¯ä»¥é€šè¿‡ç®€å•å¯é‡ç”¨çš„æ–¹å¼è§£å†³çš„é—®é¢˜ã€‚è¿™äº›ä¾‹å­ä»ç„¶éœ€è¦ä¸€äº›æµ‹è¯•å’ŒéªŒè¯ï¼Œæˆ‘ä¼šåœ¨æœªæ¥ä¸€æ®µæ—¶é—´å†…æ…¢æ…¢åœ°æ·»åŠ åˆ° <a href="https://github.com/khanlou/Promise" target="_blank" rel="external">GitHub ä»“åº“</a> ä¸­ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šSoroush Khanlouï¼Œ&lt;a href=&quot;http://khanlou.com/2016/08/common-patterns-with-promises/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2016/8/8&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;http://weibo.com/277195544&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cwift&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://www.jianshu.com/users/7a2d2cc38444/latest_articles&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Crystal Sun&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šè‹±æ–‡åŸæ–‡å‘å¸ƒæ—¶é—´è¾ƒæ—©ï¼Œæ•…åŸæ–‡ä»£ç ä¸­çš„ Swift ç‰ˆæœ¬è¾ƒæ—§ï¼Œä½†æ˜¯ä½œè€…å·²å°† GitHub ä¸Šçš„ &lt;a href=&quot;https://github.com/khanlou/Promise&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Promise ç¤ºä¾‹ä»£ç &lt;/a&gt;æ›´æ–°åˆ°äº†æœ€æ–° Swift ç‰ˆæœ¬ï¼Œæ‰€ä»¥è¯‘è€…åœ¨ç¿»è¯‘æœ¬æ–‡æ—¶ï¼Œå°†æ–‡ç« é‡Œçš„ä»£ç æŒ‰ç…§ GitHub ä¸Šçš„ç¤ºä¾‹ä»£ç è¿›è¡Œäº†æ›¿æ¢ï¼Œæ›´æ–°æˆäº†æœ€æ–°ç‰ˆæœ¬çš„ Swift ä»£ç ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸Šå‘¨ï¼Œæˆ‘å†™äº†ä¸€ç¯‡&lt;a href=&quot;http://swift.gg/2017/03/27/promises-in-swift/&quot;&gt;ä»‹ç» Promise çš„æ–‡ç« &lt;/a&gt;ï¼ŒPromise æ˜¯å¤„ç†å¼‚æ­¥æ“ä½œçš„é«˜é˜¶æ¨¡å—ã€‚åªéœ€è¦ä½¿ç”¨ &lt;code&gt;fulfill()&lt;/code&gt;ã€&lt;code&gt;reject()&lt;/code&gt; å’Œ &lt;code&gt;then()&lt;/code&gt; ç­‰å‡½æ•°ï¼Œå°±å¯ä»¥ç®€å•è‡ªç”±åœ°æ„å»ºå¤§é‡çš„åŠŸèƒ½ã€‚æœ¬æ–‡ä¼šå±•ç¤ºæˆ‘åœ¨ Promise æ–¹é¢çš„ä¸€äº›æ¢ç´¢ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="KHANLOU" scheme="https://swift.gg/categories/KHANLOU/"/>
    
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/tags/iOS-%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Feature æ¡†æ¶è®¾è®¡</title>
    <link href="https://swift.gg/2017/05/03/architecting-for-features/"/>
    <id>https://swift.gg/2017/05/03/architecting-for-features/</id>
    <published>2017-05-02T16:00:00.000Z</published>
    <updated>2017-07-16T00:49:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½œè€…ï¼šNatasha The Robotï¼Œ<a href="https://www.natashatherobot.com/architecting-for-features/" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a>ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-03-12<br>è¯‘è€…ï¼š<a href="http://www.saitjr.com" target="_blank" rel="external">saitjr</a>ï¼›æ ¡å¯¹ï¼š<a href="http://www.jianshu.com/users/7a2d2cc38444/latest_articles" target="_blank" rel="external">Crystal Sun</a>ï¼›å®šç¨¿ï¼š<a href="https://github.com/chenmingbiao" target="_blank" rel="external">CMB</a></p>
</blockquote>
<!--æ­¤å¤„å¼€å§‹æ­£æ–‡-->
<p>å‡ ä¸ªæœˆå‰ï¼Œæˆ‘åœ¨ <a href="http://iosconf.sg/" target="_blank" rel="external">iOS Conf SG</a> ä¸Šåšäº†åä¸º <strong>åˆ›å»º Featureï¼Œè€Œä¸æ˜¯ App</strong> çš„åˆ†äº«ï¼ˆä½ å¯ä»¥åœ¨<a href="https://www.youtube.com/watch?v=lJlyR8chDwo" target="_blank" rel="external">è¿™é‡Œ</a>æŸ¥çœ‹å®Œæ•´åˆ†äº«ï¼‰ã€‚åœ¨ WWDC 2016 ä¹‹åï¼Œæˆ‘æ¸…æ™°åœ°è®¤è¯†åˆ°ä»Šåçš„å‘å±•ä¸æ˜¯ä¸€ä¸ªå¤§ä¸€ç»Ÿçš„ Appï¼Œè€Œåº”è¯¥æ‹¥æœ‰å„ç§å°åŠŸèƒ½çš„ Featureã€‚æƒ³æƒ³ Apple Watchï¼ŒWidgetï¼Œå¯äº¤äº’çš„ Notificationsï¼ŒApp Searchï¼ŒiMessage è´´çº¸ï¼Œåœ°å›¾è¿™äº›æ•°ä¸èƒœæ•°çš„åº”ç”¨ã€‚</p>
<a id="more"></a>
<p><img src="https://www.natashatherobot.com/wp-content/uploads/Screen-Shot-2017-03-12-at-5.15.38-PM-1024x721.png" alt=""></p>
<p>å¦‚æœå¤„ç†å¾—å½“ï¼Œè¿™é‡Œçš„æ¯ä¸ª extension éƒ½ä¼šæˆä¸ºä½ åº”ç”¨ä¸­çš„ featureã€‚æ¯”å¦‚ï¼ŒWidget ä¸­å¹¶ä¸éœ€è¦åŒ…å«ä½ åº”ç”¨çš„å…¨éƒ¨åŠŸèƒ½ï¼Œä»…æä¾›æœ€å®ç”¨çš„é‚£éƒ¨åˆ†ï¼Œèƒ½è®©ç”¨æˆ·å¿«é€ŸæŸ¥çœ‹å³å¯ï¼ˆå°±åƒã€Œå¤©æ°”ã€åº”ç”¨ä¸€æ ·ï¼‰ã€‚</p>
<p>ç»§ç»­æ·±å…¥ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå¦‚æœ extension çš„ç§ç±»è¶³å¤Ÿå¤šï¼Œé‚£ç”¨æˆ·å°±å¯ä»¥ä» app ä¸­è§£è„±äº†ã€‚ä»–ä»¬å®Œå…¨å¯ä»¥åœ¨ä¸æ‰“å¼€ app çš„æƒ…å†µä¸‹ï¼Œç›´æ¥æŸ¥çœ‹ç›¸å…³ä¿¡æ¯ï¼ˆæ¯”å¦‚ä¹‹å‰æåˆ°çš„ã€Œå¤©æ°”ã€ï¼‰ã€‚è™½ç„¶è¿˜æ˜¯åœ¨ä½¿ç”¨ä½ çš„æœåŠ¡ï¼Œä½†ä¸å†æ˜¯ä¼ ç»Ÿçš„ã€Œç‚¹å‡»æ‰“å¼€ appã€äº†ã€‚</p>
<p>è¿™å®Œå…¨é‡æ–°å®šä¹‰äº† app çš„å«ä¹‰ã€‚æ‰€ä»¥ï¼Œç°åœ¨ app ä¸å†æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„åº”ç”¨äº†ï¼Œå®ƒå˜æˆäº†åœ¨åˆé€‚æ—¶é—´ï¼Œç»™ç”¨æˆ·æä¾›ç›¸å…³ä¿¡æ¯çš„ä¸œè¥¿ã€‚è¿™ç§è®¤çŸ¥è½¬å˜ï¼ŒæˆåŠŸè§„é¿æ‰äº†é‚£äº›éœ€è¦ä¾èµ–äºã€Œæ‰“å¼€ã€çš„ appï¼ˆæ¯”å¦‚ï¼Œå†…ç½®å¹¿å‘Šï¼‰ï¼Œè€Œä¸”è¿˜æä¾›äº†è®¸å¤šå…¨æ–°çš„äº¤äº’æ–¹å¼ï¼Œæ ‘ç«‹æ›´ä¸ºå¼ºå¤§çš„å“ç‰Œæ„è¯†ã€‚ç°åœ¨ï¼Œapp èƒ½çœŸçš„è¢«ç§°ä¸ºã€Œæ— å¤„ä¸åœ¨ã€äº†ï¼ä¸å†æ˜¯é‚£ä¸ªè§’è½ä¸­æœŸå¾…è¢«ç‚¹å‡»çš„å›¾æ ‡äº†ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ <a href="https://www.tryswift.co/tokyo/en" target="_blank" rel="external">try! Swift Tokyo</a> å¤§ä¼šä¸Šï¼Œæˆ‘ä¸“æ³¨äºä¸º <a href="https://github.com/tryswift/trySwiftAppFinal" target="_blank" rel="external">try! Swift app</a> æ·»åŠ  feature è€Œä¸æ˜¯å¼€å‘æ–°åŠŸèƒ½ç‚¹çš„åŸå› ã€‚</p>
<p>å…¶ä¸­çš„å…³é”®æ˜¯å°†æ•°æ®å±‚ä¸ iOS app åˆ†ç¦»ï¼ŒåŒ…æ‹¬ Realmã€‚Watch appï¼ŒApple TV appï¼ˆè¯´ä¸å®šä¹‹åä¼šå¼€å‘ï¼‰ï¼ŒiOS appï¼ŒiOS extensionï¼ˆå¦‚ Widget å’Œå¯äº¤äº’çš„ Notificationï¼‰ å‡ä¼šå…±ç”¨æ•°æ®å±‚ã€‚</p>
<p>ä¸è¿‡ï¼Œåˆ†ç¦»è¦æ¯”æƒ³è±¡ä¸­å¤æ‚ã€‚æˆ‘æ¨èå…ˆä» Basem Emra çš„ã€Œ<a href="http://basememara.com/creating-cross-platform-swift-frameworks-ios-watchos-tvos-via-carthage-cocoapods/" target="_blank" rel="external">ç”¨ Carthage ä¸ CocoaPods æ‰“é€ è·¨ iOSï¼ŒwatchOSï¼ŒtvOS å¹³å°çš„ Swift æ¡†æ¶</a>ã€å…¥é—¨ã€‚</p>
<p>æˆ‘è‡ªå·±è¿˜æ²¡ç‹¬ç«‹åšè¿‡ CocoaPodsï¼Œæ›´åˆ«è¯´è¿˜æ˜¯è¦ä¾èµ– Realm çš„ï¼Œæ‰€ä»¥æˆ‘èŠ±äº†å¾ˆå¤šæ—¶é—´æ”¶é›†æ¢³ç†ã€‚æ„Ÿè°¢å¸¦æˆ‘å…¥é—¨çš„ <a href="https://twitter.com/aaalveee" target="_blank" rel="external">@aaalveee</a>ï¼Œè®© pod èƒ½åœ¨ extension ä¹‹é—´å·¥ä½œçš„ <a href="https://twitter.com/k_katsumi" target="_blank" rel="external">@k_katsumi</a>ï¼Œå¸®æˆ‘é›†æˆ <a href="https://realm.io/products/realm-mobile-platform/" target="_blank" rel="external">Realm Mobile Platform</a> çš„ <a href="https://twitter.com/TimOliverAU" target="_blank" rel="external">@TimOliverAU</a>ï¼ˆå½“ç„¶ï¼Œè¿˜æœ‰äº›åç»­å¤„ç†ï¼‰ã€‚</p>
<p>è™½ç„¶è¿‡ç¨‹å¾ˆå›°éš¾ï¼ˆåˆ°ç°åœ¨éƒ½è¿˜æœ‰äº›å·¥ä½œæ²¡åšï¼‰ï¼Œä½†æ˜¯èƒ½æœ‰è¿™æ ·çš„ç»“æœæˆ‘å·²ç»éå¸¸å¼€å¿ƒäº†ã€‚ä½ å¯ä»¥åœ¨ <a href="https://github.com/tryswift/trySwiftData" target="_blank" rel="external">GitHub</a> ä¸Šçœ‹åˆ° <strong>trySwiftData</strong> è¿™ä¸ªæ¡†æ¶ã€‚æ¡†æ¶ä¸­æœ€è®©æˆ‘æ»¡æ„çš„åœ°æ–¹ï¼Œæ˜¯æ ¼å¼åŒ–æ•°æ®çš„è¿™éƒ¨åˆ†ä»£ç ï¼Œæ¯”å¦‚ï¼Œæ¯ä¸ªè¯é¢˜çš„æ ‡é¢˜ä¸ºæ¼”è®²è€… + æè¿°ï¼Œä»¥å‰å¤„ç†è¿™ä¸ªçš„ä»£ç å°±é‡å¤æ•£è½åœ¨ iOS å’Œ watchOS ä¸Šã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ª pod æ·»åŠ æœ‰æ—¶é—´é™åˆ¶çš„ Widgetã€‚</p>
<p>æœŸå¾…ä¸‹ä¸€æ¬¡ try! Swift in NYC èƒ½æ”¯æŒæ›´å¤šçš„ featureï¼ŒåŒ…æ‹¬å¯äº¤äº’çš„ Notifications å’Œ App Search ğŸš€ã€‚</p>
<blockquote>
<p>æœ¬æ–‡ç”± SwiftGG ç¿»è¯‘ç»„ç¿»è¯‘ï¼Œå·²ç»è·å¾—ä½œè€…ç¿»è¯‘æˆæƒï¼Œæœ€æ–°æ–‡ç« è¯·è®¿é—® <a href="http://swift.gg">http://swift.gg</a>ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½œè€…ï¼šNatasha The Robotï¼Œ&lt;a href=&quot;https://www.natashatherobot.com/architecting-for-features/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;åŸæ–‡é“¾æ¥&lt;/a&gt;ï¼ŒåŸæ–‡æ—¥æœŸï¼š2017-03-12&lt;br&gt;è¯‘è€…ï¼š&lt;a href=&quot;http://www.saitjr.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;saitjr&lt;/a&gt;ï¼›æ ¡å¯¹ï¼š&lt;a href=&quot;http://www.jianshu.com/users/7a2d2cc38444/latest_articles&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Crystal Sun&lt;/a&gt;ï¼›å®šç¨¿ï¼š&lt;a href=&quot;https://github.com/chenmingbiao&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CMB&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--æ­¤å¤„å¼€å§‹æ­£æ–‡--&gt;
&lt;p&gt;å‡ ä¸ªæœˆå‰ï¼Œæˆ‘åœ¨ &lt;a href=&quot;http://iosconf.sg/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iOS Conf SG&lt;/a&gt; ä¸Šåšäº†åä¸º &lt;strong&gt;åˆ›å»º Featureï¼Œè€Œä¸æ˜¯ App&lt;/strong&gt; çš„åˆ†äº«ï¼ˆä½ å¯ä»¥åœ¨&lt;a href=&quot;https://www.youtube.com/watch?v=lJlyR8chDwo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;è¿™é‡Œ&lt;/a&gt;æŸ¥çœ‹å®Œæ•´åˆ†äº«ï¼‰ã€‚åœ¨ WWDC 2016 ä¹‹åï¼Œæˆ‘æ¸…æ™°åœ°è®¤è¯†åˆ°ä»Šåçš„å‘å±•ä¸æ˜¯ä¸€ä¸ªå¤§ä¸€ç»Ÿçš„ Appï¼Œè€Œåº”è¯¥æ‹¥æœ‰å„ç§å°åŠŸèƒ½çš„ Featureã€‚æƒ³æƒ³ Apple Watchï¼ŒWidgetï¼Œå¯äº¤äº’çš„ Notificationsï¼ŒApp Searchï¼ŒiMessage è´´çº¸ï¼Œåœ°å›¾è¿™äº›æ•°ä¸èƒœæ•°çš„åº”ç”¨ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Natasha The Robot" scheme="https://swift.gg/categories/Natasha-The-Robot/"/>
    
    
      <category term="iOS å¼€å‘" scheme="https://swift.gg/tags/iOS-%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
</feed>
