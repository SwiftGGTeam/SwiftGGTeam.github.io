
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="baidu-site-verification" content="vqJV77bZM6" />
  
    <title>Firebase 新手指南：使用 Swift 构建一款简单的社交应用 | Swift 教程 - Swift 语言学习 - Swift code - SwiftGG 翻译组 - 高质量的 Swift 译文网站</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="SwiftGG">
    

    <meta name="keywords" content="firebase教程,firebase ios,swift语言,swift翻译,swift学习">
    <meta name="applicable-device" content="pc,mobile">
    <meta name="description" content="Firebase 是最流行的 BaaS 服务，本文就来说下如何使用 Swift 在 Firebase 打造一款应用。">
<meta name="keywords" content="firebase教程,firebase ios">
<meta property="og:type" content="article">
<meta property="og:title" content="Firebase 新手指南：使用 Swift 构建一款简单的社交应用">
<meta property="og:url" content="https://swift.gg/2016/05/12/introduction-to-firebase-building-a-simple-social-app-in-swift/index.html">
<meta property="og:site_name" content="SwiftGG">
<meta property="og:description" content="Firebase 是最流行的 BaaS 服务，本文就来说下如何使用 Swift 在 Firebase 打造一款应用。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://www.appcoda.com/wp-content/uploads/2016/02/firebase_screenshots.png">
<meta property="og:image" content="http://www.appcoda.com/wp-content/uploads/2016/02/storyboard.png">
<meta property="og:image" content="http://www.appcoda.com/wp-content/uploads/2016/02/firebase.jpg">
<meta property="og:image" content="http://www.appcoda.com/wp-content/uploads/2016/02/create_new_app.png">
<meta property="og:image" content="http://www.appcoda.com/wp-content/uploads/2016/02/forge_data.png">
<meta property="og:image" content="http://www.appcoda.com/wp-content/uploads/2016/02/user_auth.png">
<meta property="og:image" content="http://www.appcoda.com/wp-content/uploads/2016/02/joke-firebase-data.png">
<meta property="og:updated_time" content="2018-08-15T03:27:23.861Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Firebase 新手指南：使用 Swift 构建一款简单的社交应用">
<meta name="twitter:description" content="Firebase 是最流行的 BaaS 服务，本文就来说下如何使用 Swift 在 Firebase 打造一款应用。">
<meta name="twitter:image" content="http://www.appcoda.com/wp-content/uploads/2016/02/firebase_screenshots.png">

    
    <link rel="alternative" href="/atom.xml" title="SwiftGG" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon_new.ico">
    
    
    <link rel="apple-touch-icon" href="/img/logo_new.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/logo_new.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/gitment.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo_new.png" alt="SwiftGG" title="SwiftGG"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="SwiftGG">SwiftGG</a></h1>
				<h2 class="blog-motto">走心的 Swift 翻译组</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
						<li><a href="/stat">统计</a></li>
					
					<li>
 					
						<form class="search" method="GET" action="http://search.swift.gg/cse/search" target="_blank">
							<label>搜索</label>
						<input name="s" type="hidden" value= 4873498141517765035 ><input type="search" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		
  <header class="article-info clearfix">
    <h1 itemprop="name">
      
        <a href="/2016/05/12/introduction-to-firebase-building-a-simple-social-app-in-swift/" target="_blank" title="Firebase 新手指南：使用 Swift 构建一款简单的社交应用" itemprop="url">Firebase 新手指南：使用 Swift 构建一款简单的社交应用</a>
    </h1>
    <p class="article-time">
      <time datetime="2016-05-12T00:00:00.000Z" itemprop="datePublished">2016-05-12</time>
      <span style="margin-left: 0.5em;"><i class="icon-eye-open"></i> <span class="viewcount"></span></span>
    </p>
  </header>

	<div class="article-content">
		
		<blockquote>
<p>作者：MATTHEW MAHER，<a href="http://www.appcoda.com/firebase/" target="_blank" rel="noopener">原文链接</a>，原文日期：2015-11-12<br>译者：<a href="http://coderafi.github.io/" target="_blank" rel="noopener">CoderAFI</a>；校对：<a href="https://github.com/Cee" target="_blank" rel="noopener">Cee</a>；定稿：<a href="http://www.jianshu.com/users/7a07113a6597/latest_articles" target="_blank" rel="noopener">Channe</a></p>
</blockquote>
<!--此处开始正文-->
<p>随着移动互联网快速发展，想要自己做一款用户喜欢的应用程序越来越困难。而且苹果提供的开发工具和资源也越发不能满足开发者在数据服务方面的需求。于是 BaaS 服务（Backend-as-a-Service）给开发者带来了新的选择。</p>
<p>谷歌的 <a href="https://www.firebase.com" target="_blank" rel="noopener">Firebase</a> 是目前最流行的 BaaS 服务。Firebase 在性能、易用性、可维护性方面做得都非常好。Firebase 的特色服务是实时同步的 JSON 结构数据库。这种数据库可以迅速感知数据变化并立马同步到其他的客户端和设备。换句话说，Firebase 同步功能快如闪电。</p>
<a id="more"></a>
<p>Firebase 同时提供了基于加密 SSL 链接的用户授权认证服务。在认证方面，你可以选择邮箱和密码、Facebook、Twitter、Github、Google 或者自定义这些组合来进行认证。</p>
<p>不仅仅是在 iOS 上，Firebase 还在 Android 和 JavaScript 平台上提供了 SDK。全平台共用一套实时数据库，Firebase 统一来管理数据，自动进行数据同步。</p>
<p>我们很难想象，拥有众多功能的 Firebase 会是一个经济实惠的选择。所以下面要揭露一下价格上不好的地方……</p>
<p>其实并没有。在写这篇教程的时候，Firebase 免费支持同时 100 个并发连接。这个并发数已经算比较大了。同时 100 个并发连接可以支持一个非常好的应用程序了。当然，如果每月付费 49 美元，就不会有上面的限制了。</p>
<h3 id="FirebaseJokes-简介"><a href="#FirebaseJokes-简介" class="headerlink" title="FirebaseJokes 简介"></a>FirebaseJokes 简介</h3><p>今天，我就带领大家用 Firebase 来做一款发布笑话的应用程序。这款应用允许用户用邮箱和密码进行注册和登录。登录成功之后就可以发布笑话，然后显示笑话的 tableview 会立刻更新。同样，如果其他人也发布了笑话，界面也会立马更新。为了增加应用程序的互动性，添加了点赞功能。如果笑话很有意思就会得到大家的赞誉。</p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/02/firebase_screenshots.png" alt="FirebaseJokes"></p>
<p>下面是我们即将在 FirebaseJokes 中实现的功能列表：</p>
<ul>
<li>创建帐号</li>
<li>邮箱密码登录</li>
<li>登出</li>
<li>对于登录用户跳过登录环节</li>
<li>发布新笑话</li>
<li>使用 UITableView 展示笑话、作者和点赞数</li>
<li>对好笑话进行点赞</li>
</ul>
<p>现在，让我们下载<a href="https://github.com/appcoda/FirebaseDemo/releases/download/v1.0/FirebaseJokesStarter.zip" target="_blank" rel="noopener">初始工程</a>。</p>
<p>首先打开 Main.Storyboard，App 的总体框架如下：</p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/02/storyboard.png" alt="Main.Storyboard"></p>
<p>在我们开发这款应用过程中，我们会逐步了解 Firebase 的相关的用法和概念。由于 Firebase 使用起来非常简单，所以我们只需要花时间来开发 FirebaseJokes 业务部分就可以。</p>
<h3 id="Firebase-概览"><a href="#Firebase-概览" class="headerlink" title="Firebase 概览"></a>Firebase 概览</h3><p>我们打开 <a href="https://www.firebase.com/" target="_blank" rel="noopener">Firebase</a> 主页并注册一个账号，或者如果你已经有账号了可以直接登录。当然也支持谷歌账号注册登录。注册成功后，我们直接跳过官方为 JavaScript 准备的五分钟简明教程。我们在这里只需要查看 iOS 的版本即可。</p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/02/firebase.jpg" alt="Firebase Homepage"></p>
<p>想了解 Firebase 究竟有哪些功能，我们只需要点击 My First App 中的 Manage App 按钮。这个新页面就是 Firebase 控制台（Firebase Forge）。它是一个非常酷的可视化调试工具，并且值得我们观看新手引导教程。教程会指引你如何创建键、值数据，甚至可以用加号按钮来创建子节点数据。这是不是很像 JSON 呢？通过点按左上角的 Dashboard 图标便可以退出新手引导教程。</p>
<h3 id="创建应用程序"><a href="#创建应用程序" class="headerlink" title="创建应用程序"></a>创建应用程序</h3><p><img src="http://www.appcoda.com/wp-content/uploads/2016/02/create_new_app.png" alt="Create New App"></p>
<p>现在，让开始创建 FirebaseJokes 吧。在 My First App 的左边，有个颜色较淡的框就是用来创建新应用的。在 APP NAME 的文本框中，输入「Jokes」；APP URL 的文本框中，输入「jokes-你的名字」。这样可以保证每个应用都有唯一的 url。最后点击 <strong>CREATE NEW APP</strong> 按钮，成功之后点击 <strong>Manage App</strong> 按钮。</p>
<p>接下来，我们就进入了这个应用的控制中心界面。在这里，我们可以看到当前应用程序数据的实时更新变化。我们也可以在控制中心直接修改数据。为了更好的理解应用程序的工作流程，我们造一些假数据来模拟下，步骤如下：</p>
<ol>
<li>在应用名称旁边点击小加号按钮；</li>
<li>在文本框中输入「jokes」；</li>
<li>在新建的「jokes」上再次点击加号来新创建一行；</li>
<li>在新的文本框中输入一些随机数；</li>
<li>在创建的随时数上点击加号再新创建一行；</li>
<li>输入「jokeText」作为键；</li>
<li>输入「What did one computer say to the other? 11001001010101」作为值。</li>
</ol>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/02/forge_data.png" alt="Forge Data"></p>
<p>上图就是在控制中心创建一条笑话后的样子。我们不仅仅需要创建「笑话」，也需要创建「用户」，但其实两者都非常类似。时不时的回来看下控制台上的应用程序的数据变化是一个非常好的习惯。</p>
<p>有一点我要指出的是 Firebase 上的数据都是以 JSON 对象的形式存储的。而 Parse 是采用表格的形式来存储的。当我们向 Firebase 的数据库中添加数据其实就是向现有 JSON 结构中添加一组键值对结构。刚刚我们创建的数据 JSON 结构如下：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"jokes"</span> : &#123;</span><br><span class="line">    <span class="attr">"e32e223r44"</span> : &#123;</span><br><span class="line">      <span class="attr">"jokeText"</span> : <span class="string">"What did one computer say to the other? 11001001010101"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在你已经基本了解了 Firebase 数据的存储方式，让我们继续吧。</p>
<p>记住在我们开始验证用户信息之前，先把之前创建的假数据删掉，因为接下来我们会在 app 中编写这些数据。</p>
<p>在 FirebaseJokes 中，我们将会用邮箱和密码注册登录来进行授权认证。点击控制中心左边的「Login &amp; Auth」面板来开启这个功能。在「Email &amp; Password」选项卡下，选择「Enable Email &amp; Password Authentication」复选框。选择完成后在复选框下面会出现密码重置的相关设置信息。同时，你也可以点击其他选项卡了解下其他登录授权方式。</p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/02/user_auth.png" alt="User Auth"></p>
<h3 id="安装-Firebase-SDK-并配置-Base-URL"><a href="#安装-Firebase-SDK-并配置-Base-URL" class="headerlink" title="安装 Firebase SDK 并配置 Base URL"></a>安装 Firebase SDK 并配置 Base URL</h3><p>我们返回到控制中心，就可以看到 Firebase 应用的 base url。这个 url 正是我们 app 中需要的那一个 url，所以我们打开 Xcode，将它复制并粘贴到 Constants.swift 中的 BASE_URL 处。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="type">BASE_URL</span> = <span class="string">"https://jokes-matt-maher.firebaseio.com"</span></span><br></pre></td></tr></table></figure>
<p>现在，我们终于可以在工程中集成 Firebase SDK 了。在此之前我们需要安装 CocoaPods。如果你没用过 CocoaPods，你可以去 <a href="https://guides.cocoapods.org/using/getting-started.html" target="_blank" rel="noopener">CocoaPods</a> 的官网上找到一些安装的指南。</p>
<p>CocoaPods 安装好后，打开终端，在你的工程目录下运行如下命令来初始化 Cocoapods 配置文件：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;your-xcode-project-directory&gt;</span><br><span class="line">pod init</span><br></pre></td></tr></table></figure>
<p>运行完后，会出现一个 Podfile 的文件。运行如下命令，在 Xcode 中打开 Podfile 文件：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">open -a Xcode Podfile</span><br></pre></td></tr></table></figure>
<p>接下来，像这样编辑 Podfile 文件：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">platform :ios, <span class="string">'8.0'</span></span><br><span class="line">use_frameworks!</span><br><span class="line"> </span><br><span class="line">pod <span class="string">'Firebase'</span>, <span class="string">'&gt;= 2.5.0'</span></span><br></pre></td></tr></table></figure>
<p>最后，在工程目录下运行如下命令，下载安装 Firebase SDK：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pod install</span><br></pre></td></tr></table></figure>
<p>跳转到工程目录，双击打开 <code>FirebaseJokes.xcworkspace</code> 就可以开始敲代码了。</p>
<h3 id="使用Firebase-SDK"><a href="#使用Firebase-SDK" class="headerlink" title="使用Firebase SDK"></a>使用Firebase SDK</h3><p>首先，我们在 <code>DataService.swift</code> 中做一些配置，为之后的所要做的事情铺路。最重要的就是定义一些引用。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> Firebase</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> dataService = <span class="type">DataService</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> _BASE_REF = <span class="type">Firebase</span>(url: <span class="string">"<span class="subst">\(BASE_URL)</span>"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> _USER_REF = <span class="type">Firebase</span>(url: <span class="string">"<span class="subst">\(BASE_URL)</span>/users"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> _JOKE_REF = <span class="type">Firebase</span>(url: <span class="string">"<span class="subst">\(BASE_URL)</span>/jokes"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> <span class="type">BASE_REF</span>: <span class="type">Firebase</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _BASE_REF</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> <span class="type">USER_REF</span>: <span class="type">Firebase</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _USER_REF</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> <span class="type">CURRENT_USER_REF</span>: <span class="type">Firebase</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> userID = <span class="type">NSUserDefaults</span>.standardUserDefaults().valueForKey(<span class="string">"uid"</span>) <span class="keyword">as</span>! <span class="type">String</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> currentUser = <span class="type">Firebase</span>(url: <span class="string">"<span class="subst">\(BASE_REF)</span>"</span>).childByAppendingPath(<span class="string">"users"</span>).childByAppendingPath(userID)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> currentUser!</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> <span class="type">JOKE_REF</span>: <span class="type">Firebase</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _JOKE_REF</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>导入 Firebase 框架后就可以使用 Firebase SDK 中的接口了。上面的 <code>DataService</code> 其实是一个和 Firebase 交互的服务类。为了能够读写数据，我们引用了 base url 来创建了一个 Firebase 的数据库。接下来，我们会将用户和笑话当做子节点来存储。获取这些子节点的内容，我们只要在 base url 后拼接上节点名称（例如 name）就可以访问了。为了让子节点操作更方便，我们也创建了对子节点的引用。</p>
<blockquote>
<p><strong>注意：</strong>创建一个数据库引用并不意味着就创建了一个 Firebase 服务的数据库连接。如果没有发起读和写的操作是无法获取数据的。</p>
</blockquote>
<h3 id="创建一个新账户"><a href="#创建一个新账户" class="headerlink" title="创建一个新账户"></a>创建一个新账户</h3><p>我们从创建 <code>CreateAccountViewController.swift</code> 文件来开始。对于要用 Firebase 的类，必须要在文件顶部导入 Firebase 框架。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> Firebase</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreateAccountViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br></pre></td></tr></table></figure>
<p>在 <code>createAccount()</code> 方法中，我们将用户输入的文本用来创建新的用户。该方法其实是调用了 Firebase 的 <code>createUser()</code> 方法，代码如下：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">createAccount</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> username = usernameField.text</span><br><span class="line">    <span class="keyword">let</span> email = emailField.text</span><br><span class="line">    <span class="keyword">let</span> password = passwordField.text</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> username != <span class="string">""</span> &amp;&amp; email != <span class="string">""</span> &amp;&amp; password != <span class="string">""</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Set Email and Password for the New User.</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">DataService</span>.dataService.<span class="type">BASE_REF</span>.createUser(email, password: password, withValueCompletionBlock: &#123; error, result <span class="keyword">in</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> error != <span class="literal">nil</span> &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// There was a problem.</span></span><br><span class="line">                <span class="keyword">self</span>.signupErrorAlert(<span class="string">"Oops!"</span>, message: <span class="string">"Having some trouble creating your account. Try again."</span>)</span><br><span class="line">                </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// Create and Login the New User with authUser</span></span><br><span class="line">                <span class="type">DataService</span>.dataService.<span class="type">BASE_REF</span>.authUser(email, password: password, withCompletionBlock: &#123;</span><br><span class="line">                    err, authData <span class="keyword">in</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">let</span> user = [<span class="string">"provider"</span>: authData.provider!, <span class="string">"email"</span>: email!, <span class="string">"username"</span>: username!]</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// Seal the deal in DataService.swift.</span></span><br><span class="line">                    <span class="type">DataService</span>.dataService.createNewAccount(authData.uid, user: user)</span><br><span class="line">                &#125;)</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// Store the uid for future access - handy!</span></span><br><span class="line">                <span class="type">NSUserDefaults</span>.standardUserDefaults().setValue(result [<span class="string">"uid"</span>], forKey: <span class="string">"uid"</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// Enter the app.</span></span><br><span class="line">                <span class="keyword">self</span>.performSegueWithIdentifier(<span class="string">"NewUserLoggedIn"</span>, sender: <span class="literal">nil</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        signupErrorAlert(<span class="string">"Oops!"</span>, message: <span class="string">"Don't forget to enter your email, password, and a username."</span>)</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果用户输入的信息无误，就可以注册并登录到 app 中。如果信息缺失，就会展示一些相应的提示信息。下面的代码来展示错误信息：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">signupErrorAlert</span><span class="params">(title: String, message: String)</span></span> &#123;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// Called upon signup error to let the user know signup didn't work.</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> alert = <span class="type">UIAlertController</span>(title: title, message: message, preferredStyle: <span class="type">UIAlertControllerStyle</span>.<span class="type">Alert</span>)</span><br><span class="line">    <span class="keyword">let</span> action = <span class="type">UIAlertAction</span>(title: <span class="string">"Ok"</span>, style: .<span class="type">Default</span>, handler: <span class="literal">nil</span>)</span><br><span class="line">    alert.addAction(action)</span><br><span class="line">    presentViewController(alert, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实际上，创建用户是在 DataService.swift 的 <code>createNewAccount()</code> 方法中：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createNewAccount</span><span class="params">(uid: String, user: Dictionary&lt;String, String&gt;)</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// A User is born.</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">USER_REF</span>.childByAppendingPath(uid).setValue(user)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要向 Firebase 数据库中保存数据，你只需要调用 <code>setValue</code> 方法。在上面的代码中，将会根据 <code>uid</code> 保存一个新的 user 对象到 <em>users</em> 中（例如 /users/1283834）。</p>
<p>除了将用户存储到 Firebase 数据库，我们还需要在本地用 NSUserDefaults 来存储用户的 <code>uid</code>。这样可以实时跟踪当前登录用户。</p>
<h3 id="用户登录"><a href="#用户登录" class="headerlink" title="用户登录"></a>用户登录</h3><p>在我们深入探讨之前，我们在 LoginViewController.swift 文件中引入 Firebase 框架。在这个类中我们将会判断用户是否登录过，如果没用登录则跳转到登录界面。</p>
<p>在 <code>viewDidAppear()</code> 方法中，我们会检查存储的 <code>uid</code> 是否为空，以此来验证用户是否登录。如果检查通过，则可以直接跳过登录；反之进行登录授权。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidAppear</span><span class="params">(animated: Bool)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidAppear(animated)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// If we have the uid stored, the user is already logger in - no need to sign in again!</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="type">NSUserDefaults</span>.standardUserDefaults().valueForKey(<span class="string">"uid"</span>) != <span class="literal">nil</span> &amp;&amp; <span class="type">DataService</span>.dataService.<span class="type">CURRENT_USER_REF</span>.authData != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.performSegueWithIdentifier(<span class="string">"CurrentlyLoggedIn"</span>, sender: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当用户点击 Login 按钮时，<code>tryLogin()</code> 方法就会执行。在该方法中加入如下代码并添加一个 <code>loginErrorAlert</code> 的辅助方法：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">tryLogin</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> email = emailField.text</span><br><span class="line">    <span class="keyword">let</span> password = passwordField.text</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> email != <span class="string">""</span> &amp;&amp; password != <span class="string">""</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Login with the Firebase's authUser method</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">DataService</span>.dataService.<span class="type">BASE_REF</span>.authUser(email, password: password, withCompletionBlock: &#123; error, authData <span class="keyword">in</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> error != <span class="literal">nil</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(error)</span><br><span class="line">                <span class="keyword">self</span>.loginErrorAlert(<span class="string">"Oops!"</span>, message: <span class="string">"Check your username and password."</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// Be sure the correct uid is stored.</span></span><br><span class="line">                </span><br><span class="line">                <span class="type">NSUserDefaults</span>.standardUserDefaults().setValue(authData.uid, forKey: <span class="string">"uid"</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// Enter the app!</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">self</span>.performSegueWithIdentifier(<span class="string">"CurrentlyLoggedIn"</span>, sender: <span class="literal">nil</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// There was a problem</span></span><br><span class="line">        </span><br><span class="line">        loginErrorAlert(<span class="string">"Oops!"</span>, message: <span class="string">"Don't forget to enter your email and password."</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">loginErrorAlert</span><span class="params">(title: String, message: String)</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Called upon login error to let the user know login didn't work.</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> alert = <span class="type">UIAlertController</span>(title: title, message: message, preferredStyle: <span class="type">UIAlertControllerStyle</span>.<span class="type">Alert</span>)</span><br><span class="line">    <span class="keyword">let</span> action = <span class="type">UIAlertAction</span>(title: <span class="string">"Ok"</span>, style: .<span class="type">Default</span>, handler: <span class="literal">nil</span>)</span><br><span class="line">    alert.addAction(action)</span><br><span class="line">    presentViewController(alert, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Firebase 默认支持用户邮箱和密码进行用户授权认证。<code>tryLogin()</code> 方法调用了 Firebase 的 <code>authUser()</code> 方法来检查当前邮箱和密码是否已经注册过。如果注册过，就能获取用户的 <code>uid</code> ，登录成功进入 app。如果没有，我们则给出一些其他尝试的提示。</p>
<p>既然现在 app 已经完成了用户注册和登录功能，接下来我们就来看看如何对笑话数据进行处理。</p>
<h3 id="笑话的数据模型"><a href="#笑话的数据模型" class="headerlink" title="笑话的数据模型"></a>笑话的数据模型</h3><p>什么是笑话？这个哲学问题我们可以以后再回答，或者看下 FirebaseJokes 上的一个笑话就会明白了。对我们而言，抽象出一个 Joke 数据模型更加重要。</p>
<p>我们在 <code>Joke.swift</code> 中导入 Firebase 框架。在我们的数据库中，一个 joke 对象映射一个唯一编号。这个自动生成的编号包含了 joke 中的如下属性：</p>
<ul>
<li>jokeText</li>
<li>jokeVotes</li>
<li>username（笑话的作者）</li>
</ul>
<p>我们将笑话的 id、key 和内容，以字典的形式作为参数，通过 init() 方法来新建一个笑话对象。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Joke</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> _jokeRef: <span class="type">Firebase</span>!</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> _jokeKey: <span class="type">String</span>!</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> _jokeText: <span class="type">String</span>!</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> _jokeVotes: <span class="type">Int</span>!</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> _username: <span class="type">String</span>!</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> jokeKey: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _jokeKey</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> jokeText: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _jokeText</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> jokeVotes: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _jokeVotes</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> username: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> _username</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Initialize the new Joke</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(key: <span class="type">String</span>, dictionary: <span class="type">Dictionary</span>&lt;<span class="type">String</span>, <span class="type">AnyObject</span>&gt;) &#123;</span><br><span class="line">        <span class="keyword">self</span>._jokeKey = key</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Within the Joke, or Key, the following properties are children</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> votes = dictionary[<span class="string">"votes"</span>] <span class="keyword">as</span>? <span class="type">Int</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>._jokeVotes = votes</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> joke = dictionary[<span class="string">"jokeText"</span>] <span class="keyword">as</span>? <span class="type">String</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>._jokeText = joke</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> user = dictionary[<span class="string">"author"</span>] <span class="keyword">as</span>? <span class="type">String</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>._username = user</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>._username = <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// The above properties are assigned to their key.</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">self</span>._jokeRef = <span class="type">DataService</span>.dataService.<span class="type">JOKE_REF</span>.childByAppendingPath(<span class="keyword">self</span>._jokeKey)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="添加新的笑话"><a href="#添加新的笑话" class="headerlink" title="添加新的笑话"></a>添加新的笑话</h3><p>在 <code>AddJokeViewController.swift</code> 文件中，是时候引入 Firebase 框架了。在这个类中，我们将完成让用户添加一个笑话，发送到 Firebase 服务上，然后立刻推送到各个设备上进行同步展示。</p>
<p>首先在 <code>viewDidLoad()</code> 方法中，我们首先获取当前用户的用户名，来当做新创建笑话的作者,代码如下：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Get username of the current user, and set it to currentUsername, so we can add it to the Joke.</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">DataService</span>.dataService.<span class="type">CURRENT_USER_REF</span>.observeEventType(<span class="type">FEventType</span>.<span class="type">Value</span>, withBlock: &#123; snapshot <span class="keyword">in</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> currentUser = snapshot.value.objectForKey(<span class="string">"username"</span>) <span class="keyword">as</span>! <span class="type">String</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Username: <span class="subst">\(currentUser)</span>"</span>)</span><br><span class="line">        <span class="keyword">self</span>.currentUsername = currentUser</span><br><span class="line">        &#125;, withCancelBlock: &#123; error <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(error.description)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当 <code>saveJoke()</code> 方法被调用时，将会创建一个新的笑话的字典对象。这个字典对象会包含由 jokeField 中的文字组成的笑话的内容、投票数（默认为 0）以及作者名（当前用户的用户名）。这些值将通过 DataSerivce 中的 <code>createNewJoke()</code> 方法发送到服务器来进行存储。</p>
<p>在 <code>AddJokeViewController</code> 类中声明如下变量：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> currentUsername = <span class="string">""</span></span><br></pre></td></tr></table></figure>
<p>更新 <code>saveJoke()</code> 方法：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">saveJoke</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> jokeText = jokeField.text</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> jokeText != <span class="string">""</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Build the new Joke. </span></span><br><span class="line">        <span class="comment">// AnyObject is needed because of the votes of type Int.</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> newJoke: <span class="type">Dictionary</span>&lt;<span class="type">String</span>, <span class="type">AnyObject</span>&gt; = [</span><br><span class="line">            <span class="string">"jokeText"</span>: jokeText!,</span><br><span class="line">            <span class="string">"votes"</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">"author"</span>: currentUsername</span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Send it over to DataService to seal the deal.</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">DataService</span>.dataService.createNewJoke(newJoke)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> navController = <span class="keyword">self</span>.navigationController &#123;</span><br><span class="line">            navController.popViewControllerAnimated(<span class="literal">true</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们用一个字典对象来临时存储笑话数据。并将该字典传递给 <code>DataService</code> 中的 <code>createNewJoke()</code> 方法来发送到服务器端进行存储。在 DataSerivce.swift 文件中，添加 <code>createNewJoke()</code> 方法：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createNewJoke</span><span class="params">(joke: Dictionary&lt;String, AnyObject&gt;)</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Save the Joke</span></span><br><span class="line">    <span class="comment">// JOKE_REF is the parent of the new Joke: "jokes".</span></span><br><span class="line">    <span class="comment">// childByAutoId() saves the joke and gives it its own ID.</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> firebaseNewJoke = <span class="type">JOKE_REF</span>.childByAutoId()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// setValue() saves to Firebase.</span></span><br><span class="line">    </span><br><span class="line">    firebaseNewJoke.setValue(joke)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们是通过 Firebase 的 setValue() 方法来存储的笑话对象。但是也不要忽略我们调用了 Joke 数据库引用对象的 <code>childByAutoId</code> 方法。通过调用此方法，Firebase 会为每一个笑话生成唯一的编号，来确保笑话存储的唯一性。</p>
<h3 id="用户登出"><a href="#用户登出" class="headerlink" title="用户登出"></a>用户登出</h3><p>这个功能通常会出现在设置和个人简介部分。但是我们就姑且把登出功能放在 <code>AddJokeViewController.swift</code> 类中吧。或者说，这就是一个最大的笑话。</p>
<p><code>logout()</code> 方法实际上是调用了 Firebase 的 <code>unauth()</code> 方法来让用户退出登录。在用户登出的同时，我们需要删除在 LoginViewController 中存储在本地的 <code>uid</code> 。</p>
<p>像这样更新 <code>logout</code> 部分的方法：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">logout</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// unauth() is the logout method for the current user.</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">DataService</span>.dataService.<span class="type">CURRENT_USER_REF</span>.unauth()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Remove the user's uid from storage.</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">NSUserDefaults</span>.standardUserDefaults().setValue(<span class="literal">nil</span>, forKey: <span class="string">"uid"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Head back to Login!</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> loginViewController = <span class="keyword">self</span>.storyboard!.instantiateViewControllerWithIdentifier(<span class="string">"Login"</span>)</span><br><span class="line">    <span class="type">UIApplication</span>.sharedApplication().keyWindow?.rootViewController = loginViewController</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果没有删除用户的 <code>uid</code>，可能会导致用户再次登录的时候出现问题，这里要注意一下。</p>
<h3 id="展示所有的笑话"><a href="#展示所有的笑话" class="headerlink" title="展示所有的笑话"></a>展示所有的笑话</h3><p>最后就是从 Firebase 上获取笑话数据展示出来。我们将会在 JokesFeedTableViewController.swift 文件中用一个 UITableView 来展示所有的笑话。在这里我们还是要先导入 Firebasde 框架。</p>
<p>在 <code>viewDidLoad()</code> 方法中，配置 <code>observeEventType()</code> 方法。Firebase 是通过数据库的引用对象来异步监听数据变化来获取更新数据的。这个方法是在导航到 <code>JokesFeedTableViewController.swift</code> 界面时，在 <code>viewDidLoad()</code> 方法中被调用的。当数据库有任何笑话数据变化时这个监听方法就会被调用，代码如下：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> jokes = [<span class="type">Joke</span>]()</span><br><span class="line">   </span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">   </span><br><span class="line">   <span class="comment">// observeEventType is called whenever anything changes in the Firebase - new Jokes or Votes.</span></span><br><span class="line">   <span class="comment">// It's also called here in viewDidLoad().</span></span><br><span class="line">   <span class="comment">// It's always listening.</span></span><br><span class="line">   </span><br><span class="line">   <span class="type">DataService</span>.dataService.<span class="type">JOKE_REF</span>.observeEventType(.<span class="type">Value</span>, withBlock: &#123; snapshot <span class="keyword">in</span></span><br><span class="line">       </span><br><span class="line">       <span class="comment">// The snapshot is a current look at our jokes data.</span></span><br><span class="line">       </span><br><span class="line">       <span class="built_in">print</span>(snapshot.value)</span><br><span class="line">       </span><br><span class="line">       <span class="keyword">self</span>.jokes = []</span><br><span class="line">       </span><br><span class="line">       <span class="keyword">if</span> <span class="keyword">let</span> snapshots = snapshot.children.allObjects <span class="keyword">as</span>? [<span class="type">FDataSnapshot</span>] &#123;</span><br><span class="line">           </span><br><span class="line">           <span class="keyword">for</span> snap <span class="keyword">in</span> snapshots &#123;</span><br><span class="line">               </span><br><span class="line">               <span class="comment">// Make our jokes array for the tableView.</span></span><br><span class="line">               </span><br><span class="line">               <span class="keyword">if</span> <span class="keyword">let</span> postDictionary = snap.value <span class="keyword">as</span>? <span class="type">Dictionary</span>&lt;<span class="type">String</span>, <span class="type">AnyObject</span>&gt; &#123;</span><br><span class="line">                   <span class="keyword">let</span> key = snap.key</span><br><span class="line">                   <span class="keyword">let</span> joke = <span class="type">Joke</span>(key: key, dictionary: postDictionary)</span><br><span class="line">                   </span><br><span class="line">                   <span class="comment">// Items are returned chronologically, but it's more fun with the newest jokes first.</span></span><br><span class="line">                   </span><br><span class="line">                   <span class="keyword">self</span>.jokes.insert(joke, atIndex: <span class="number">0</span>)</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           </span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       <span class="comment">// Be sure that the tableView updates when there is new data.</span></span><br><span class="line">       </span><br><span class="line">       <span class="keyword">self</span>.tableView.reloadData()</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在回调方法中返回了一些笑话对象。我们用一个数组来存储这些对象，并展示在 tableView 上。我们想让最新的笑话保持在顶部，但是 Firebase 返回的笑话数据是按照时间排序的，所以我们必须将数据反向插入。</p>
<p>每次当笑话更新的时候，我们别忘了调用 tableView 的 reloadData 方法，这样才能让新的数据展示出来。</p>
<p>我们剩下的工作就是在 <code>tableView:cellForRowAtIndexPath:</code> 方法中指定自定义 cell：JokeCellTableViewCell.swift。在 JokeCellTableViewCell.swift 文件中创建一个 <code>configureCell()</code> 方法，当执行 <code>tableView:cellForRowAtIndexPath:</code> 时调用该方法，代码如下：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">numberOfSectionsInTableView</span><span class="params">(tableView: UITableView)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> jokes.<span class="built_in">count</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> joke = jokes[indexPath.row]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// We are using a custom cell. </span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> cell = tableView.dequeueReusableCellWithIdentifier(<span class="string">"JokeCellTableViewCell"</span>) <span class="keyword">as</span>? <span class="type">JokeCellTableViewCell</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Send the single joke to configureCell() in JokeCellTableViewCell.</span></span><br><span class="line">        </span><br><span class="line">        cell.configureCell(joke)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> cell</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="type">JokeCellTableViewCell</span>()</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 JokeCellTableViewCell.swift 文件中的 <code>configureCell()</code> 方法里，我们需要设置 label 标签以及添加监听投票的点按逻辑。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">configureCell</span><span class="params">(joke: Joke)</span></span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.joke = joke</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Set the labels and textView.</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span>.jokeText.text = joke.jokeText</span><br><span class="line">    <span class="keyword">self</span>.totalVotesLabel.text = <span class="string">"Total Votes: <span class="subst">\(joke.jokeVotes)</span>"</span></span><br><span class="line">    <span class="keyword">self</span>.usernameLabel.text = joke.username</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Set "votes" as a child of the current user in Firebase and save the joke's key in votes as a boolean.</span></span><br><span class="line">    </span><br><span class="line">    voteRef = <span class="type">DataService</span>.dataService.<span class="type">CURRENT_USER_REF</span>.childByAppendingPath(<span class="string">"votes"</span>).childByAppendingPath(joke.jokeKey)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// observeSingleEventOfType() listens for the thumb to be tapped, by any user, on any device.</span></span><br><span class="line">    </span><br><span class="line">    voteRef.observeSingleEventOfType(.<span class="type">Value</span>, withBlock: &#123; snapshot <span class="keyword">in</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Set the thumb image.</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> thumbsUpDown = snapshot.value <span class="keyword">as</span>? <span class="type">NSNull</span> &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Current user hasn't voted for the joke... yet.</span></span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(thumbsUpDown)</span><br><span class="line">            <span class="keyword">self</span>.thumbVoteImage.image = <span class="type">UIImage</span>(named: <span class="string">"thumb-down"</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Current user voted for the joke!</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">self</span>.thumbVoteImage.image = <span class="type">UIImage</span>(named: <span class="string">"thumb-up"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>UITapGestureRecognizer 手势监听是在 <code>awakeFromNib()</code> 方法中添加的。在类的顶部，同时要加上 Firebase 和 Joke 对象的引用。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> joke: <span class="type">Joke</span>!</span><br><span class="line"><span class="keyword">var</span> voteRef: <span class="type">Firebase</span>!</span><br><span class="line">    </span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">awakeFromNib</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.awakeFromNib()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// UITapGestureRecognizer is set programatically.</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> tap = <span class="type">UITapGestureRecognizer</span>(target: <span class="keyword">self</span>, action: <span class="string">"voteTapped:"</span>)</span><br><span class="line">    tap.numberOfTapsRequired = <span class="number">1</span></span><br><span class="line">    thumbVoteImage.addGestureRecognizer(tap)</span><br><span class="line">    thumbVoteImage.userInteractionEnabled = <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 <code>voteTapped()</code> 方法中，有另外一个监听者在等待着用户点击后触发回调。在这个方法中，将会把投票数通过 <code>configureCell()</code> 方法中的 voteRef 对象存储到对应笑话下键为 votes 的字段值中。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">voteTapped</span><span class="params">(sender: UITapGestureRecognizer)</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// observeSingleEventOfType listens for a tap by the current user.</span></span><br><span class="line">    </span><br><span class="line">    voteRef.observeSingleEventOfType(.<span class="type">Value</span>, withBlock: &#123; snapshot <span class="keyword">in</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> thumbsUpDown = snapshot.value <span class="keyword">as</span>? <span class="type">NSNull</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(thumbsUpDown)</span><br><span class="line">            <span class="keyword">self</span>.thumbVoteImage.image = <span class="type">UIImage</span>(named: <span class="string">"thumb-down"</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// addSubtractVote(), in Joke.swift, handles the vote.</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">self</span>.joke.addSubtractVote(<span class="literal">true</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// setValue saves the vote as true for the current user.</span></span><br><span class="line">            <span class="comment">// voteRef is a reference to the user's "votes" path.</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">self</span>.voteRef.setValue(<span class="literal">true</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.thumbVoteImage.image = <span class="type">UIImage</span>(named: <span class="string">"thumb-up"</span>)</span><br><span class="line">            <span class="keyword">self</span>.joke.addSubtractVote(<span class="literal">false</span>)</span><br><span class="line">            <span class="keyword">self</span>.voteRef.removeValue()</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>voteTapped()</code> 方法也会通过一个布尔值调用 <code>addSubtractVote()</code> 函数来更新 Joke.swift 中的投票数。如果参数是 True，则代表用户给这个笑话投票了；反之，False 则代表没有投过票。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Add or Subtract a Vote from the Joke.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addSubtractVote</span><span class="params">(addVote: Bool)</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> addVote &#123;</span><br><span class="line">        _jokeVotes = _jokeVotes + <span class="number">1</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _jokeVotes = _jokeVotes - <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Save the new vote total.</span></span><br><span class="line">    </span><br><span class="line">    _jokeRef.childByAppendingPath(<span class="string">"votes"</span>).setValue(_jokeVotes)</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 Joke.swift 的文件中，<code>addSubtractVote()</code> 方法使用了这个布尔值完成对票数的加减。Firebase 所提供的 <code>setValue()</code> 方法用来更新当前笑话的投票数到远端数据库。</p>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>现在，可以对这个应用进行测试了。创建一个新用户并创建一些笑话。也可以对这些笑话进行投票点赞。然后回到 Firebase 的控制中心，就可以看到刚刚创建的用户和笑话，如下图：</p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/02/joke-firebase-data.png" alt="Joke Firebase Data"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>完成了！我们基于 Firebase 开发了一个用户体验不错的小应用。很有成就感吧！</p>
<p>这里是完成后的<a href="https://github.com/appcoda/FirebaseDemo" target="_blank" rel="noopener">代码</a>。</p>
<p>这个应用只是一个小的开始，基于 Firebase 服务来开发应用程序将会有无限可能。</p>
<p>尝试下为 FirebaseJokes 添加用户授权的功能；也可以添加聊天的功能；你会发现 Firebase 提供了无穷无尽的可能性。</p>
<p>关于图片存储的建议：Firebase 存储服务也有其局限性，像图片文件就不太适合用 Firebase 来存储，应该存储在单独的图片服务器上。像上面的纯文本存储型应用使用 Firebase 是没有问题的，但是如果应用要存储大型文件，最好做一套单独的文件服务。</p>
<p>好了，现在就是加入 Firebase 服务阵营的最好时机，行动起来吧。</p>
<blockquote>
<p>本文由 SwiftGG 翻译组翻译，已经获得作者翻译授权，最新文章请访问 <a href="http://swift.gg">http://swift.gg</a>。</p>
</blockquote>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/AppCoda/">AppCoda</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Swift-进阶/">Swift 进阶</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="https://swift.gg/2016/05/12/introduction-to-firebase-building-a-simple-social-app-in-swift/" data-title="Firebase 新手指南：使用 Swift 构建一款简单的社交应用 | SwiftGG" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2016/05/13/healthkit-introduction/" title="用 HealthKit 来开发一个健身 App">
  <strong>上一篇</strong><br/>
  <span>
  用 HealthKit 来开发一个健身 App</span>
</a>
</div>


<div class="next">
<a href="/2016/05/11/swift-qa-2016-05-11/"  title="每周 Swift 社区问答：@NSCopying">
 <strong>下一篇</strong><br/> 
 <span>每周 Swift 社区问答：@NSCopying
</span>
</a>
</div>

</nav>

	


<section id="comments" class="comment">
  <div id="gitcomment">
  </div>
  <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
  <script>
    var gitment = new Gitment({
      id: "2016/05/12/introduction-to-firebase-building-a-simple-social-app-in-swift/",
      owner: "SwiftGGBot",
      repo: "gg-comment",
      oauth: {
        client_id: "8ed6aa0071e9d92f7ffc",
        client_secret: "29cc2c70290fad40a967780e5b49d86501348ddf",
      },
    })
    gitment.render('gitcomment')
    </script>
</section>



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#FirebaseJokes-简介"><span class="toc-number">1.</span> <span class="toc-text">FirebaseJokes 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Firebase-概览"><span class="toc-number">2.</span> <span class="toc-text">Firebase 概览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建应用程序"><span class="toc-number">3.</span> <span class="toc-text">创建应用程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装-Firebase-SDK-并配置-Base-URL"><span class="toc-number">4.</span> <span class="toc-text">安装 Firebase SDK 并配置 Base URL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用Firebase-SDK"><span class="toc-number">5.</span> <span class="toc-text">使用Firebase SDK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建一个新账户"><span class="toc-number">6.</span> <span class="toc-text">创建一个新账户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用户登录"><span class="toc-number">7.</span> <span class="toc-text">用户登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#笑话的数据模型"><span class="toc-number">8.</span> <span class="toc-text">笑话的数据模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加新的笑话"><span class="toc-number">9.</span> <span class="toc-text">添加新的笑话</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用户登出"><span class="toc-number">10.</span> <span class="toc-text">用户登出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#展示所有的笑话"><span class="toc-number">11.</span> <span class="toc-text">展示所有的笑话</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试"><span class="toc-number">12.</span> <span class="toc-text">测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-number">13.</span> <span class="toc-text">总结</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/APPVENTURE/" title="APPVENTURE">APPVENTURE<sup>13</sup></a></li>
		  
		
		  
			<li><a href="/categories/Andyy-Hope/" title="Andyy Hope">Andyy Hope<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/AppCoda/" title="AppCoda">AppCoda<sup>40</sup></a></li>
		  
		
		  
			<li><a href="/categories/Arthur-Knopper/" title="Arthur Knopper">Arthur Knopper<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Big-O-Note-Taking/" title="Big O Note-Taking">Big O Note-Taking<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Coding-Explorer-Blog/" title="Coding Explorer Blog">Coding Explorer Blog<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Crunchy-Development/" title="Crunchy Development">Crunchy Development<sup>24</sup></a></li>
		  
		
		  
			<li><a href="/categories/Erica-Sadun/" title="Erica Sadun">Erica Sadun<sup>67</sup></a></li>
		  
		
		  
			<li><a href="/categories/IOSCREATOR/" title="IOSCREATOR">IOSCREATOR<sup>29</sup></a></li>
		  
		
		  
			<li><a href="/categories/Jacob-Bandes-Storch/" title="Jacob Bandes-Storch">Jacob Bandes-Storch<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Jameson-Quave/" title="Jameson Quave">Jameson Quave<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/JamesonQuave-com/" title="JamesonQuave.com">JamesonQuave.com<sup>18</sup></a></li>
		  
		
		  
			<li><a href="/categories/Jesse-Squires/" title="Jesse Squires">Jesse Squires<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/KHANLOU/" title="KHANLOU">KHANLOU<sup>20</sup></a></li>
		  
		
		  
			<li><a href="/categories/Mike-Ash/" title="Mike Ash">Mike Ash<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/Natasha-The-Robot/" title="Natasha The Robot">Natasha The Robot<sup>48</sup></a></li>
		  
		
		  
			<li><a href="/categories/Ole-Begemann/" title="Ole Begemann">Ole Begemann<sup>35</sup></a></li>
		  
		
		  
			<li><a href="/categories/Ole-Begemannh/" title="Ole Begemannh">Ole Begemannh<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Open-Source-Swift/" title="Open Source Swift">Open Source Swift<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/Raj-Kandathi/" title="Raj Kandathi">Raj Kandathi<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/Reinder-de-Vries/" title="Reinder de Vries">Reinder de Vries<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Russ-Bishop/" title="Russ Bishop">Russ Bishop<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/Soroush-Khanlou/" title="Soroush Khanlou">Soroush Khanlou<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Swift-and-Painless/" title="Swift and Painless">Swift and Painless<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/Swift-入门/" title="Swift 入门">Swift 入门<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Swift-进阶/" title="Swift 进阶">Swift 进阶<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Think-and-Build/" title="Think and Build">Think and Build<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Thomas-Hanning/" title="Thomas Hanning">Thomas Hanning<sup>21</sup></a></li>
		  
		
		  
			<li><a href="/categories/Thoughtbot/" title="Thoughtbot">Thoughtbot<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Tomasz-Szulc/" title="Tomasz Szulc">Tomasz Szulc<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/Wooji-Juice/" title="Wooji Juice">Wooji Juice<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/alisoftware/" title="alisoftware">alisoftware<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/alloc-init/" title="alloc-init">alloc-init<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/codingexplorer/" title="codingexplorer">codingexplorer<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/iAchieved-it/" title="iAchieved.it">iAchieved.it<sup>23</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/" title="iOS">iOS<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-开发/" title="iOS 开发">iOS 开发<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/khanlou-com/" title="khanlou.com">khanlou.com<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/machinethink/" title="machinethink">machinethink<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/medium-com/" title="medium.com">medium.com<sup>12</sup></a></li>
		  
		
		  
			<li><a href="/categories/mikeash-com/" title="mikeash.com">mikeash.com<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/radex-io/" title="radex.io">radex.io<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/swift-org/" title="swift.org">swift.org<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/swiftandpainless/" title="swiftandpainless">swiftandpainless<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/uraimo/" title="uraimo">uraimo<sup>15</sup></a></li>
		  
		
		  
			<li><a href="/categories/原创文章/" title="原创文章">原创文章<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/投稿/" title="投稿">投稿<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/直播资源/" title="直播资源">直播资源<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/社区问答/" title="社区问答">社区问答<sup>19</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Swift-进阶/" title="Swift 进阶">Swift 进阶<sup>169</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-入门/" title="Swift 入门">Swift 入门<sup>130</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-开发/" title="iOS 开发">iOS 开发<sup>81</sup></a></li>
			
		
			
				<li><a href="/tags/Swift/" title="Swift">Swift<sup>76</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-跨平台/" title="Swift 跨平台">Swift 跨平台<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-开源信息/" title="Swift 开源信息">Swift 开源信息<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/WatchOS-2/" title="WatchOS 2">WatchOS 2<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-3/" title="Swift 3">Swift 3<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-入门/" title="iOS 入门">iOS 入门<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Xcode/" title="Xcode">Xcode<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Apple-TV-开发/" title="Apple TV 开发">Apple TV 开发<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-9/" title="iOS 9">iOS 9<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/IOSCREATOR/" title="IOSCREATOR">IOSCREATOR<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/社区问答/" title="社区问答">社区问答<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Jesse-Squires/" title="Jesse Squires">Jesse Squires<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-2/" title="Swift 2">Swift 2<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/教程/" title="教程">教程<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-进化/" title="Swift 进化">Swift 进化<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Objective-C/" title="Objective-C">Objective-C<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-开源/" title="Swift 开源">Swift 开源<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://c4ios.swift.gg" target="_blank" title="C4iOS 教程">C4iOS 教程</a>
            
          </li>
        
          <li>
            
            	<a href="http://swift.gg/2016/03/14/live-video/" target="_blank" title="SwiftGG直播">SwiftGG直播</a>
            
          </li>
        
          <li>
            
            	<a href="http://t.swift.gg/" target="_blank" title="T 沙龙">T 沙龙</a>
            
          </li>
        
          <li>
            
            	<a href="http://codebuild.me" target="_blank" title="Code Build Me">Code Build Me</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.saitjr.com" target="_blank" title="//TODO:">//TODO:</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.5isjyx.com/" target="_blank" title="chiba">chiba</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.cee.moe" target="_blank" title="Perfect Freeze">Perfect Freeze</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.swiftyper.com" target="_blank" title="小锅的 swift 之路">小锅的 swift 之路</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.futantan.com/" target="_blank" title="Prayer 的博客">Prayer 的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.csdn.net/mmoaay" target="_blank" title="画渣程序猿 mmoaay">画渣程序猿 mmoaay</a>
            
          </li>
        
          <li>
            
            	<a href="http://linusling.com" target="_blank" title="小铁匠的 swift 之路">小铁匠的 swift 之路</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles" target="_blank" title="ppppppmst 的简书博客">ppppppmst 的简书博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://chenmingbiao.github.io/" target="_blank" title="CMB 的博客">CMB 的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://wxgbridgeq.github.io/" target="_blank" title="BridgeQ">BridgeQ</a>
            
          </li>
        
          <li>
            
            	<a href="http://chengway.in" target="_blank" title="walkingway 的博客">walkingway 的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.dianqk.org" target="_blank" title="靛青K">靛青K</a>
            
          </li>
        
          <li>
            
            	<a href="http://ijack.pw/" target="_blank" title="JackAlan">JackAlan</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.swiftconchina.com" target="_blank" title="SwiftConChina">SwiftConChina</a>
            
          </li>
        
          <li>
            
            	<a href="http://swiftcn.io" target="_blank" title="Swift 中国">Swift 中国</a>
            
          </li>
        
          <li>
            
            	<a href="https://boxueio.com/" target="_blank" title="泊学">泊学</a>
            
          </li>
        
          <li>
            
            	<a href="https://bearychat.com/" target="_blank" title="BearyChat">BearyChat</a>
            
          </li>
        
          <li>
            
            	<a href="http://bbs.php-z.com" target="_blank" title="PHP-Z 论坛">PHP-Z 论坛</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.swiftguide.cn" target="_blank" title="官方文档">官方文档</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.upyun.com/" target="_blank" title="又拍云赞助图床">又拍云赞助图床</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="wechatpart">
	<p class="asidetitle">微信公众号</p>
	<img src="/img/wechat.jpg" />
</div>

</aside>
</div>
    </div>
    <footer>


<div id="footer" >
	
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="SwiftGG">SwiftGG</a>
		
		 | 
		<a href="http://www.miitbeian.gov.cn" target="_blank">浙ICP备14022870号-3</a>
		</p>
</div>
<img src="/img/logo_new.jpg" style="position: fixed; top: -9999px;height: 500px;width: 500px;">
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>
<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script src="/js/mm.js"></script>
<script src="/js/subscribe.js"></script>

<div id="swiftweekly" style="display:none;">
  <img id="closeme" src="/img/close.png">
  <span id="sw_slogan">SwiftGG 专属 Reveal 优惠：<b><a style="color: white;text-decoration:underline;" target="_blank" href="https://j.youzan.com/XzKhGY">领取立减 30 元！</a></b>&nbsp;</span>
  <!-- <form id="content"> -->
    <!-- <input name="email" id="sw_email" placeholder="输入邮箱地址" type="email" /><a class="sw_sub">订阅</a> -->
  <!-- </form> -->
</div>

<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<script type="text/javascript">
$(document).ready(function(){

  

  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66150920-1', 'auto');
  ga('send', 'pageview');

</script>





<!-- Analytics End -->

<!-- Totop Begin -->
<!--
	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>
-->
<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
