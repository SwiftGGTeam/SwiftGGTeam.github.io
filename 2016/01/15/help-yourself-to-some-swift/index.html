
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="baidu-site-verification" content="vqJV77bZM6" />
  
    <title>要不要来点 Swift | Swift 教程 - Swift 语言学习 - Swift code - SwiftGG 翻译组 - 高质量的 Swift 译文网站</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="SwiftGG">
    

    <meta name="keywords" content="swift语言,swift翻译,swift学习">
    <meta name="applicable-device" content="pc,mobile">
    <meta name="description" content="作者：Jacob Bandes-Storch，原文链接，原文日期：2015-11-28译者：mmoaay；校对：千叶知风；定稿：shanks   做程序员有一点优势：如果工具不好用，你自己就可以对它进行优化。而 Swift 让这一点变得尤其简单，它包含的几个特性可以让你以一种自然的方式对这门语言进行扩展和自定义。 在本文中，我将分享 Swift 给我编程体验带来提升的几个例子。我希望在读了本文之">
<meta name="keywords" content="Swift 进阶">
<meta property="og:type" content="article">
<meta property="og:title" content="要不要来点 Swift">
<meta property="og:url" content="https://swift.gg/2016/01/15/help-yourself-to-some-swift/index.html">
<meta property="og:site_name" content="SwiftGG">
<meta property="og:description" content="作者：Jacob Bandes-Storch，原文链接，原文日期：2015-11-28译者：mmoaay；校对：千叶知风；定稿：shanks   做程序员有一点优势：如果工具不好用，你自己就可以对它进行优化。而 Swift 让这一点变得尤其简单，它包含的几个特性可以让你以一种自然的方式对这门语言进行扩展和自定义。 在本文中，我将分享 Swift 给我编程体验带来提升的几个例子。我希望在读了本文之">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://swift.gg/img/articles/help-yourself-to-some-swift/201512151428497511452821418.99237">
<meta property="og:updated_time" content="2019-01-14T16:49:24.533Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="要不要来点 Swift">
<meta name="twitter:description" content="作者：Jacob Bandes-Storch，原文链接，原文日期：2015-11-28译者：mmoaay；校对：千叶知风；定稿：shanks   做程序员有一点优势：如果工具不好用，你自己就可以对它进行优化。而 Swift 让这一点变得尤其简单，它包含的几个特性可以让你以一种自然的方式对这门语言进行扩展和自定义。 在本文中，我将分享 Swift 给我编程体验带来提升的几个例子。我希望在读了本文之">
<meta name="twitter:image" content="https://swift.gg/img/articles/help-yourself-to-some-swift/201512151428497511452821418.99237">

    
    <link rel="alternative" href="/atom.xml" title="SwiftGG" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon_new.ico">
    
    
    <link rel="apple-touch-icon" href="/img/logo_new.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/logo_new.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/gitment.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo_new.png" alt="SwiftGG" title="SwiftGG"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="SwiftGG">SwiftGG</a></h1>
				<h2 class="blog-motto">走心的 Swift 翻译组</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
						<li><a href="/stat">统计</a></li>
					
					<li>
 					
						<form class="search" method="GET" action="http://search.swift.gg/cse/search" target="_blank">
							<label>搜索</label>
						<input name="s" type="hidden" value= 4873498141517765035 ><input type="search" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		
  <header class="article-info clearfix">
    <h1 itemprop="name">
      
        <a href="/2016/01/15/help-yourself-to-some-swift/" target="_blank" title="要不要来点 Swift" itemprop="url">要不要来点 Swift</a>
    </h1>
    <p class="article-time">
      <time datetime="2016-01-15T00:00:00.000Z" itemprop="datePublished">2016-01-15</time>
      <span style="margin-left: 0.5em;"><i class="icon-eye-open"></i> <span class="viewcount"></span></span>
    </p>
  </header>

	<div class="article-content">
		
		<blockquote>
<p>作者：Jacob Bandes-Storch，<a href="http://bandes-stor.ch/blog/2015/11/28/help-yourself-to-some-swift/" target="_blank" rel="noopener">原文链接</a>，原文日期：2015-11-28<br>译者：<a href="http://mmoaay.photo/" target="_blank" rel="noopener">mmoaay</a>；校对：<a href="http://weibo.com/xiaoxxiao" target="_blank" rel="noopener">千叶知风</a>；定稿：<a href="http://codebuild.me/" target="_blank" rel="noopener">shanks</a></p>
</blockquote>
<!--此处开始正文-->
<p>做程序员有一点优势：如果工具不好用，你自己就可以对它进行优化。而 Swift 让这一点变得尤其简单，它包含的几个特性可以让你以一种自然的方式对这门语言进行扩展和自定义。</p>
<p>在本文中，我将分享 Swift 给我编程体验带来提升的几个例子。我希望在读了本文之后，你可以认识到使用这门语言时你自己的痛点在哪，并付诸实践。（当然需要先思考！）</p>
<a id="more"></a>
<h1 id="存在争议的重复标识符"><a href="#存在争议的重复标识符" class="headerlink" title="存在争议的重复标识符"></a>存在争议的重复标识符</h1><p>下面是你在 <code>Objective-C</code> 中很熟悉的一种情况：枚举值和字符串常量会有很长的描述详细的名字：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">label.textAlignment = NSTextAlignmentCenter;</span><br></pre></td></tr></table></figure>
<p>（这让我想起了中学科学课的格言：在作答时重复一下问题，或者 RQIA，<em>文字是怎么对齐的？文字是居中对齐的。</em> 这在作答方式在超出上下文环境的时候很有用，但是其他情况下就显得比较冗余了。）</p>
<p>Swift 减少了这种冗余，因为枚举值可以通过类型名＋点符号来访问，而且如果你省略了类型名，它仍然可以被自动推断出来：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">label.textAlignment = <span class="type">NSTextAlignment</span>.<span class="type">Center</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 更简明的:</span></span><br><span class="line">label.textAlignment = .<span class="type">Center</span></span><br></pre></td></tr></table></figure>
<p>但有时候你用的不是枚举，而是被一个又臭又长的构造器给困住了。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">animation.timingFunction = CAMediaTimingFunction(name: kCAMediaTimingFunctionEaseInEaseOut)</span><br></pre></td></tr></table></figure>
<p>有多少 “timingFunction” 呢？太多了好嘛。</p>
<p>一个不那么为人所知的事实是，缩写点符号对任何类型的<em>任何</em> <code>static</code> 成员都有效。结合在 <code>extension</code> 中添加自定义 <code>property</code> 的能力，我们得到如下代码…</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">extension CAMediaTimingFunction</span><br><span class="line">&#123;</span><br><span class="line">    // 这个属性会在第一次被访问时初始化。</span><br><span class="line">    // (需要添加 @nonobjc 来防止编译器</span><br><span class="line">    //  给 static（或者 final）属性生成动态存取器。)</span><br><span class="line">    @nonobjc static let EaseInEaseOut = CAMediaTimingFunction(name: kCAMediaTimingFunctionEaseInEaseOut)</span><br><span class="line"></span><br><span class="line">    // 另外一个选择就是使用计算属性, 它同样很有效,</span><br><span class="line">    // 但 *每次* 被访问时都会重新求值：</span><br><span class="line">    static var EaseInEaseOut: CAMediaTimingFunction &#123;</span><br><span class="line">        // .init 是 self.init 的简写</span><br><span class="line">        return .init(name: kCAMediaTimingFunctionEaseInEaseOut)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在我们得到了一个优雅的简写：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">animation.timingFunction = .<span class="type">EaseInEaseOut</span></span><br></pre></td></tr></table></figure>
<h2 id="Context-中的重复标识符"><a href="#Context-中的重复标识符" class="headerlink" title="Context 中的重复标识符"></a><code>Context</code> 中的重复标识符</h2><p>用来处理 <code>Core Graphics Context</code>、颜色空间等的代码往往也是冗长的。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CGContextSetFillColorWithColor(UIGraphicsGetCurrentContext(),</span><br><span class="line">    CGColorCreate(CGColorSpaceCreateWithName(kCGColorSpaceGenericRGB), [0.792, 0.792, 0.816, 1]))</span><br></pre></td></tr></table></figure>
<p>再次使用棒棒的 <code>extension</code>：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">CGContext</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">currentContext</span><span class="params">()</span></span> -&gt; <span class="type">CGContext</span>? &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIGraphicsGetCurrentContext</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">CGColorSpace</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> <span class="type">GenericRGB</span> = <span class="type">CGColorSpaceCreateWithName</span>(kCGColorSpaceGenericRGB)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">CGContextSetFillColorWithColor</span>(.currentContext(),</span><br><span class="line">    <span class="type">CGColorCreate</span>(.<span class="type">GenericRGB</span>, [<span class="number">0.792</span>, <span class="number">0.792</span>, <span class="number">0.816</span>, <span class="number">1</span>]))</span><br></pre></td></tr></table></figure>
<p>更简单了是不？而且显然会有<a href="https://developer.apple.com/videos/play/wwdc2015-408/" target="_blank" rel="noopener">更多的方式</a>对 <code>Core Graphics</code> 类型进行扩展，以使其适应你的需求。</p>
<h2 id="Auto-Layout-中的重复标识符"><a href="#Auto-Layout-中的重复标识符" class="headerlink" title="Auto Layout 中的重复标识符"></a>Auto Layout 中的重复标识符</h2><p>下面的代码看起来熟悉么？</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">spaceConstraint = NSLayoutConstraint(</span><br><span class="line">    item: label,</span><br><span class="line">    attribute: .Leading,</span><br><span class="line">    relatedBy: .Equal,</span><br><span class="line">    toItem: button,</span><br><span class="line">    attribute: .Trailing,</span><br><span class="line">    multiplier: 1, constant: 20)</span><br><span class="line">widthConstraint = NSLayoutConstraint(</span><br><span class="line">    item: label,</span><br><span class="line">    attribute: .Width,</span><br><span class="line">    relatedBy: .LessThanOrEqual,</span><br><span class="line">    toItem: nil,</span><br><span class="line">    attribute: .NotAnAttribute,</span><br><span class="line">    multiplier: 0, constant: 200)</span><br><span class="line"></span><br><span class="line">spaceConstraint.active = true</span><br><span class="line">widthConstraint.active = true</span><br></pre></td></tr></table></figure>
<p>理解起来相当困难，是么？Apple 认识到这是个普遍存在的问题，所以重新设计了新的 <code>NSLayoutAnchor</code> API（在 iOS9 和 OS X 10.11 上适用）来处理这个问题：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">spaceConstraint = label.leadingAnchor.constraintEqualToAnchor(button.trailingAnchor, constant: <span class="number">20</span>)</span><br><span class="line">widthConstraint = label.widthAnchor.constraintLessThanOrEqualToConstant(<span class="number">200</span>)</span><br><span class="line">spaceConstraint.active = <span class="literal">true</span></span><br><span class="line">widthConstraint.active = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>然而，我认为还可以做的更好。在我看来，下面的代码比内置的接口更容易阅读和使用：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">spaceConstraint = label.constrain(.<span class="type">Leading</span>, .<span class="type">Equal</span>, to: button, .<span class="type">Trailing</span>, plus: <span class="number">20</span>)</span><br><span class="line">widthConstraint = label.constrain(.<span class="type">Width</span>, .<span class="type">LessThanOrEqual</span>, to: <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// "设置 label 的 leading edge 和 button 的 trailing edge 相距 20"</span></span><br><span class="line"><span class="comment">// "设置 label 的 width 小于等于 200。"</span></span><br></pre></td></tr></table></figure>
<p>上面的代码是通过给 <code>UIView</code> 或者 <code>NSView</code> 添加一些 <code>extension</code> 来实现的。这些辅助函数看起来可能会有些拙劣，但是用起来会特别方便，而且很容易维护。（这里我已经提供了另外一些包含默认值的参数——一个 <code>multiplier</code>，<code>priority</code> 和 <code>identifier</code> ——所以你可以选择更进一步滴进行自定义约束。）</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIView</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">constrain</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        attribute: NSLayoutAttribute,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> relation: NSLayoutRelation,</span></span></span><br><span class="line"><span class="function"><span class="params">        to otherView: UIView,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> otherAttribute: NSLayoutAttribute,</span></span></span><br><span class="line"><span class="function"><span class="params">        times multiplier: CGFloat = <span class="number">1</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        plus constant: CGFloat = <span class="number">0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        atPriority priority: UILayoutPriority = UILayoutPriorityRequired,</span></span></span><br><span class="line"><span class="function"><span class="params">        identifier: String? = <span class="literal">nil</span>)</span></span></span><br><span class="line">        -&gt; <span class="type">NSLayoutConstraint</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> constraint = <span class="type">NSLayoutConstraint</span>(</span><br><span class="line">            item: <span class="keyword">self</span>,</span><br><span class="line">            attribute: attribute,</span><br><span class="line">            relatedBy: relation,</span><br><span class="line">            toItem: otherView,</span><br><span class="line">            attribute: otherAttribute,</span><br><span class="line">            multiplier: multiplier,</span><br><span class="line">            constant: constant)</span><br><span class="line">        constraint.priority = priority</span><br><span class="line">        constraint.identifier = identifier</span><br><span class="line">        constraint.active = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">return</span> constraint</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">constrain</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        attribute: NSLayoutAttribute,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> relation: NSLayoutRelation,</span></span></span><br><span class="line"><span class="function"><span class="params">        to constant: CGFloat,</span></span></span><br><span class="line"><span class="function"><span class="params">        atPriority priority: UILayoutPriority = UILayoutPriorityRequired,</span></span></span><br><span class="line"><span class="function"><span class="params">        identifier: String? = <span class="literal">nil</span>)</span></span></span><br><span class="line">        -&gt; <span class="type">NSLayoutConstraint</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> constraint = <span class="type">NSLayoutConstraint</span>(</span><br><span class="line">            item: <span class="keyword">self</span>,</span><br><span class="line">            attribute: attribute,</span><br><span class="line">            relatedBy: relation,</span><br><span class="line">            toItem: <span class="literal">nil</span>,</span><br><span class="line">            attribute: .<span class="type">NotAnAttribute</span>,</span><br><span class="line">            multiplier: <span class="number">0</span>,</span><br><span class="line">            constant: constant)</span><br><span class="line">        constraint.priority = priority</span><br><span class="line">        constraint.identifier = identifier</span><br><span class="line">        constraint.active = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">return</span> constraint</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="你好～操作符"><a href="#你好～操作符" class="headerlink" title="你好～操作符"></a>你好～操作符</h1><p>首先我必须提醒一下：如果要使用自定义操作符，一定要<strong>三思而后行</strong>。使用它们很简单，但最终可能会得到一堆像屎一样的代码。一定要对代码的健康性持怀疑态度，然后你会发现在某些场景下，自定义操作符确实是很有用的。</p>
<h2 id="重载它们"><a href="#重载它们" class="headerlink" title="重载它们"></a>重载它们</h2><p>如果你有开发过拖动手势相关的功能，你可能会写过类似下面的代码：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 触摸开始 / 鼠标按下:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> touchPos = touch.locationInView(container)</span><br><span class="line">objectOffset = <span class="type">CGPoint</span>(x: object.center.x - touchPos.x, y: object.center.y - touchPos.y)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 触摸移动 / 鼠标拖动:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> touchPos = touch.locationInView(container)</span><br><span class="line">object.center = <span class="type">CGPoint</span>(x: touchPos.x + objectOffset.x, y: touchPos.y + objectOffset.y)</span><br></pre></td></tr></table></figure>
<p>在这段代码里面我们只做了简单的加法和减法，但因为 <code>CGPoint</code> <a href="https://en.wikipedia.org/wiki/User:Giraffedata/comprised_of" target="_blank" rel="noopener">包含</a> <code>x</code> 和 <code>y</code>，所以每个表达式我们都要写两次。所以我们需要一些简化操作的函数。</p>
<p><code>objectOffset</code> 代表触摸位置和对象位置的距离。描述这种距离最好的方式并不是 <code>CGPoint</code>，而是不那么为人所知的 <a href="https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CGGeometry/#//apple_ref/c/tdef/CGVector" target="_blank" rel="noopener">CGVector</a>， 它不使用 <code>x</code> 和 <code>y</code>，而是用 <code>dx</code> 和 <code>dy</code> 来表示距离或者 “deltas“。</p>
<p><img src="/img/articles/help-yourself-to-some-swift/201512151428497511452821418.99237" alt="这里写图片描述"></p>
<p>所以两个点相减得到一个向量就比较符合逻辑了，这样一来我们就得到了 <code>-</code> 操作符的一个重载：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// - 返回: 从 `rhs` 到 `lhs`的向量。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> -<span class="params">(lhs: CGPoint, rhs: CGPoint)</span></span> -&gt; <span class="type">CGVector</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">CGVector</span>(dx: lhs.x - rhs.x, dy: lhs.y - rhs.y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后，相反滴，把一个向量和一个点相加得到另外一个点：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// - 返回: `lhs` 偏移`rhs` 之后得到的一个点</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> +<span class="params">(lhs: CGPoint, rhs: CGVector)</span></span> -&gt; <span class="type">CGPoint</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">CGPoint</span>(x: lhs.x + rhs.dx, y: lhs.y + rhs.dy)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在下面的代码看起来就感觉很好了！</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 触摸开始:</span></span><br><span class="line">objectOffset = object.center - touch.locationInView(container)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 触摸移动:</span></span><br><span class="line">object.center = touch.locationInView(container) + objectOffset</span><br></pre></td></tr></table></figure>
<blockquote>
<p>练习：想一想其它可以用在点和向量上的操作符，并对它们进行重载。<br>建议：<code>-(CGPoint, CGVector)</code>、<code>*(CGVector, CGFloat)</code> 和 <code>-(CGVector)</code>。</p>
</blockquote>
<h2 id="独门绝技"><a href="#独门绝技" class="headerlink" title="独门绝技"></a>独门绝技</h2><p>下面是一些更有创造性的内容。Swift 提供了一些<em>复合赋值操作符</em>，这些操作符在执行某个操作的同时进行赋值：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">a += b   <span class="comment">// 等价于 "a = a + b"</span></span><br><span class="line">a %= b   <span class="comment">// 等价于 "a = a % b"</span></span><br></pre></td></tr></table></figure>
<p>但是仍然存在其它不包含内置复合赋值形式的操作符。最常见的例子就是 <code>??</code>，空合并运算符。也就是 <a href="http://ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/syntax.html#assign" target="_blank" rel="noopener">Ruby 中的 <code>||=</code></a>，例如，首先实现只有在变量是 <code>nil</code> （或者不是）的情况下才赋值的版本。这对 Swift 中的可选值意义非凡，而且实现起来也很简单：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">infix</span> <span class="keyword">operator</span> ??= &#123; <span class="keyword">associativity</span> <span class="keyword">right</span> <span class="keyword">precedence</span> <span class="number">90</span> assignment &#125; <span class="comment">// 匹配其它的赋值操作符</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/// 如果 `lhs` 为 `nil`, 把 `rhs` 的值赋给它</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> ??=&lt;T&gt;<span class="params">(<span class="keyword">inout</span> lhs: T?, @autoclosure rhs: <span class="params">()</span></span></span> -&gt; <span class="type">T</span>)</span><br><span class="line">&#123;</span><br><span class="line">    lhs = lhs ?? rhs()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码看起来可能很复杂——这里我们做了下面几件事情。</p>
<ul>
<li><code>infix operator</code> 声明用来告诉 Swift 把 <code>??=</code> 当作一个操作符。</li>
<li>使用 <code>&lt;T&gt;</code> 将函数泛型化，从而使其可以支持任何类型的值。</li>
<li><code>inout</code> 表示允许修改左侧的运算数</li>
<li><code>@autoclosure</code> 用来支持<a href="https://en.wikipedia.org/wiki/Short-circuit_evaluation" target="_blank" rel="noopener">短路赋值</a>，有需要的话可以只对右侧做赋值操作。（着也依赖于 <code>??</code> 本身对短路的支持。）</li>
</ul>
<p>但在我看来，上述代码实现的功能是非常清晰而且易用的：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">a ??= b   <span class="comment">// 等价于 "a = a ?? b"</span></span><br></pre></td></tr></table></figure>
<h1 id="调度"><a href="#调度" class="headerlink" title="调度"></a>调度</h1><blockquote>
<p>关于如何在 Swift 中使用 GCD，最好的方式是阅读官方文档，但在本文中我仍然会介绍一些基础知识点。如果想了解更多，请参照<a href="https://gist.github.com/jtbandes/a5ce62019585dd4f998e" target="_blank" rel="noopener">这份概要</a>。</p>
</blockquote>
<p>Swift 2 引入了<a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Protocols.html#//apple_ref/doc/uid/TP40014097-CH25-ID521" target="_blank" rel="noopener">协议扩展</a>，因此，很多之前的全局标准库函数变成了准成员函数：如 <code>map(seq, transform)</code>  变成了现在的 <code>seq.map(transform)</code>，<code>join(separator, seq)</code> 变成了现在的 <code>seq.joinWithSeparator(separator)</code>  等等。这样的话，那些<em>严格说来</em>不属于类实例方法的函数仍然可以用 <code>.</code> 符号访问，而且还减少了逗号（PS：原文为parentheses，可能是作者笔误）的数目，从而不会把代码弄得<a href="https://xkcd.com/297/" target="_blank" rel="noopener">太乱</a>。</p>
<p>然而这种变化并没有应用到 Swift 标准库外的自由函数，比如 <code>dispatch_async()</code> 和 <code>UIImageJPEGRepresentation()</code>。这些函数仍然很难用，如果你经常使用它们，还是很值得思考一下如何利用 Swift 来帮你改造一下它们。下面是一些入门的 GCD 例子。</p>
<h2 id="sync-或者非-sync"><a href="#sync-或者非-sync" class="headerlink" title="sync 或者非 sync"></a><code>sync</code> 或者非 <code>sync</code></h2><p>这些都很简单；我们马上开始：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">dispatch_queue_t</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="function"><span class="keyword">func</span> <span class="title">async</span><span class="params">(block: dispatch_block_t)</span></span> &#123;</span><br><span class="line">        dispatch_async(<span class="keyword">self</span>, block)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 这里的 `block` 需要是 @noescape 的, 但不能是链接中这样的： &lt;http://openradar.me/19770770&gt;</span></span><br><span class="line">    <span class="keyword">final</span> <span class="function"><span class="keyword">func</span> <span class="title">sync</span><span class="params">(block: dispatch_block_t)</span></span> &#123;</span><br><span class="line">        dispatch_sync(<span class="keyword">self</span>, block)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面简化的两个函数直接调用了普通的调度函数，但可以让我们通过 <code>.</code> 符号调用它们，这是我们之前做不到的。</p>
<blockquote>
<p>注：GCD 对象是以一种古怪的方式导出到 Swift 的，尽管以类的方式也可以实现，但实际上 <code>dispatch_queue_t</code> 只是一个协议而已。在这里我把两个函数都标注了 <code>final</code> 来表明我们的意图：我们不希望在这里使用动态调度，尽管在我看来这种情况下使用协议扩展是很好的，<a href="http://nomothetis.svbtle.com/the-ghost-of-swift-bugs-future" target="_blank" rel="noopener">但是不要在哪都用。</a></p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">mySerialQueue.sync &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I’m on the queue!"</span>)</span><br><span class="line">    threadsafeNum++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dispatch_get_global_queue(<span class="type">QOS_CLASS_BACKGROUND</span>, <span class="number">0</span>).async &#123;</span><br><span class="line">    expensivelyReticulateSplines()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Done!"</span>)</span><br><span class="line">    </span><br><span class="line">    dispatch_get_main_queue().async &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Back on the main queue."</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>更进一步的 <code>sync</code> 的版本是从 Swift 标准库函数中的 <code>with*</code> 家族获取到的灵感，我们要做的事情是返回一个在闭包中计算得到的结果：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">dispatch_queue_t</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="function"><span class="keyword">func</span> <span class="title">sync</span>&lt;Result&gt;<span class="params">(block: <span class="params">()</span></span></span> -&gt; <span class="type">Result</span>) -&gt; <span class="type">Result</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> result: <span class="type">Result</span>?</span><br><span class="line">        dispatch_sync(<span class="keyword">self</span>) &#123;</span><br><span class="line">            result = block()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result!</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在串行队列上抓取一些数据</span></span><br><span class="line"><span class="keyword">let</span> currentItems = mySerialQueue.sync &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I’m on the queue!"</span>)</span><br><span class="line">    <span class="keyword">return</span> mutableItems.copy()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="群体思维"><a href="#群体思维" class="headerlink" title="群体思维"></a>群体思维</h2><p>另外两个简单的扩展可以让我们很好的使用 <a href="https://developer.apple.com/library/ios/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW30" target="_blank" rel="noopener"><code>dispatch group</code></a>：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">dispatch_queue_t</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="function"><span class="keyword">func</span> <span class="title">async</span><span class="params">(group: dispatch_group_t, <span class="number">_</span> block: dispatch_block_t)</span></span> &#123;</span><br><span class="line">        dispatch_group_async(group, <span class="keyword">self</span>, block)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">dispatch_group_t</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="function"><span class="keyword">func</span> <span class="title">waitForever</span><span class="params">()</span></span> &#123;</span><br><span class="line">        dispatch_group_wait(<span class="keyword">self</span>, <span class="type">DISPATCH_TIME_FOREVER</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在调用 <code>async</code> 的时候就可以包含一个额外的 <code>group</code> 参数了。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> group = dispatch_group_create()</span><br><span class="line"></span><br><span class="line">concurrentQueue.async(group) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I’m part of the group"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">concurrentQueue.async(group) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I’m independent, but part of the same group"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">group.waitForever()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Everything in the group has now executed"</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：我们可以很简单滴选择 <code>group.async(queue)</code> 或者 <code>queue.async(group)</code>。具体用哪个全看你自己——或者你甚至可以两个都实现。</p>
</blockquote>
<h1 id="优雅的重定义"><a href="#优雅的重定义" class="headerlink" title="优雅的重定义"></a>优雅的重定义</h1><p>如果你的项目同时包含 Objective-C 和 Swift，你可能会碰到这种让人头大的情况：Obj-C 的 API 看起来不是那么 Swift 化。需要 <code>NS_REFINED_FOR_SWIFT</code> 来拯救我们了。</p>
<p>在 Obj-C 中使用标记了 <a href="https://developer.apple.com/library/ios/releasenotes/DeveloperTools/RN-Xcode/Chapters/xc7_release_notes.html" target="_blank" rel="noopener">(new in Xcode 7) </a> 宏的函数、方法和变量是正常的，但是导出到 Swift 之后，它们会包含一个 “<code>__</code>“前缀。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@interface MyClass : NSObject</span><br><span class="line"></span><br><span class="line">/// @返回 @c 东西的下标, 如果没有提供就返回 NSNotFound。</span><br><span class="line">- (NSUInteger)indexOfThing:(id)thing NS_REFINED_FOR_SWIFT;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">// 当导出到 Swift 时, 它就变成了:</span><br><span class="line"></span><br><span class="line">public class MyClass: NSObject</span><br><span class="line">&#123;</span><br><span class="line">    public func __indexOfThing(thing: AnyObject) -&gt; UInt</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在把 Obj-C 的方法放到一边，你可以重用同样的名字来提供一个更友好的 Swift 版本 API（实现方式通常是调用带“<code>__</code>“前缀的原始版本）：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MyClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/// - 返回: 给定 `thing` 的下标, 如果没有就返回 `nil`。</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">indexOfThing</span><span class="params">(thing: AnyObject)</span></span> -&gt; <span class="type">Int</span>?</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> idx = <span class="type">Int</span>(__indexOfThing(thing)) <span class="comment">// 调用原始方法</span></span><br><span class="line">        <span class="keyword">if</span> idx == <span class="type">NSNotFound</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">        <span class="keyword">return</span> idx</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在你可以心满意足滴 “<code>if let</code>“了！</p>
<h1 id="更进一步"><a href="#更进一步" class="headerlink" title="更进一步"></a>更进一步</h1><p>Swift 还很年轻，它各个代码库的风格也都是不同的。而大量的第三方微型库也涌现出来，这些库的代码体现了作者在操作符，辅助函数和命名规范上所持的不同观点。这种情况也就需要在处理依赖关系以及在团队中建立规范时更挑剔。</p>
<p>使用本文中技术最重要的原因不是写最新潮和最酷炫的 Swift 代码。当然，负责维护你代码的人——也许是未来的你——可能会持不同的观点。为了他们，亲爱的读者，你需要在为了让代码变的清晰合理的情况下扩展 Swift，而不是为了让代码变的简单而去扩展它。</p>
<p>译者：<a href="https://github.com/mmoaay/MBPlayGroundForSwiftGG/tree/master/HelpYourselfToSomeSwiftPlayground.playground" target="_blank" rel="noopener">Playground已经上传到github！</a></p>
<blockquote>
<p>本文由 SwiftGG 翻译组翻译，已经获得作者翻译授权，最新文章请访问 <a href="http://swift.gg">http://swift.gg</a>。</p>
</blockquote>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Jacob-Bandes-Storch/">Jacob Bandes-Storch</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Swift-进阶/">Swift 进阶</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="https://swift.gg/2016/01/15/help-yourself-to-some-swift/" data-title="要不要来点 Swift | SwiftGG" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2016/01/16/open-source-swift-weekly-4/" title="Swift 一周简讯 #4">
  <strong>上一篇</strong><br/>
  <span>
  Swift 一周简讯 #4</span>
</a>
</div>


<div class="next">
<a href="/2016/01/14/another-take-on-guard/"  title="关于 guard 的另一种观点">
 <strong>下一篇</strong><br/> 
 <span>关于 guard 的另一种观点
</span>
</a>
</div>

</nav>

	


<section id="comments" class="comment">
  <div id="gitcomment">
  </div>
  <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
  <script>
    var gitment = new Gitment({
      id: "2016/01/15/help-yourself-to-some-swift/",
      owner: "SwiftGGBot",
      repo: "gg-comment",
      oauth: {
        client_id: "8ed6aa0071e9d92f7ffc",
        client_secret: "29cc2c70290fad40a967780e5b49d86501348ddf",
      },
    })
    gitment.render('gitcomment')
    </script>
</section>



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#存在争议的重复标识符"><span class="toc-number">1.</span> <span class="toc-text">存在争议的重复标识符</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Context-中的重复标识符"><span class="toc-number">1.1.</span> <span class="toc-text">Context 中的重复标识符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Auto-Layout-中的重复标识符"><span class="toc-number">1.2.</span> <span class="toc-text">Auto Layout 中的重复标识符</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#你好～操作符"><span class="toc-number">2.</span> <span class="toc-text">你好～操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#重载它们"><span class="toc-number">2.1.</span> <span class="toc-text">重载它们</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#独门绝技"><span class="toc-number">2.2.</span> <span class="toc-text">独门绝技</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#调度"><span class="toc-number">3.</span> <span class="toc-text">调度</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sync-或者非-sync"><span class="toc-number">3.1.</span> <span class="toc-text">sync 或者非 sync</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#群体思维"><span class="toc-number">3.2.</span> <span class="toc-text">群体思维</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#优雅的重定义"><span class="toc-number">4.</span> <span class="toc-text">优雅的重定义</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#更进一步"><span class="toc-number">5.</span> <span class="toc-text">更进一步</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/APPVENTURE/" title="APPVENTURE">APPVENTURE<sup>14</sup></a></li>
		  
		
		  
			<li><a href="/categories/Andyy-Hope/" title="Andyy Hope">Andyy Hope<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/AppCoda/" title="AppCoda">AppCoda<sup>43</sup></a></li>
		  
		
		  
			<li><a href="/categories/Arthur-Knopper/" title="Arthur Knopper">Arthur Knopper<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Big-O-Note-Taking/" title="Big O Note-Taking">Big O Note-Taking<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Coding-Explorer-Blog/" title="Coding Explorer Blog">Coding Explorer Blog<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Crunchy-Development/" title="Crunchy Development">Crunchy Development<sup>24</sup></a></li>
		  
		
		  
			<li><a href="/categories/Erica-Sadun/" title="Erica Sadun">Erica Sadun<sup>67</sup></a></li>
		  
		
		  
			<li><a href="/categories/IOSCREATOR/" title="IOSCREATOR">IOSCREATOR<sup>29</sup></a></li>
		  
		
		  
			<li><a href="/categories/Jacob-Bandes-Storch/" title="Jacob Bandes-Storch">Jacob Bandes-Storch<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Jameson-Quave/" title="Jameson Quave">Jameson Quave<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/JamesonQuave-com/" title="JamesonQuave.com">JamesonQuave.com<sup>18</sup></a></li>
		  
		
		  
			<li><a href="/categories/Jesse-Squires/" title="Jesse Squires">Jesse Squires<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/KHANLOU/" title="KHANLOU">KHANLOU<sup>22</sup></a></li>
		  
		
		  
			<li><a href="/categories/Khanlou/" title="Khanlou">Khanlou<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Mike-Ash/" title="Mike Ash">Mike Ash<sup>15</sup></a></li>
		  
		
		  
			<li><a href="/categories/Swift/NSHipster/" title="NSHipster">NSHipster<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/NSHipster/" title="NSHipster">NSHipster<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Natasha-The-Robot/" title="Natasha The Robot">Natasha The Robot<sup>48</sup></a></li>
		  
		
		  
			<li><a href="/categories/Ole-Begemann/" title="Ole Begemann">Ole Begemann<sup>36</sup></a></li>
		  
		
		  
			<li><a href="/categories/Ole-Begemannh/" title="Ole Begemannh">Ole Begemannh<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Open-Source-Swift/" title="Open Source Swift">Open Source Swift<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/Raj-Kandathi/" title="Raj Kandathi">Raj Kandathi<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/Reinder-de-Vries/" title="Reinder de Vries">Reinder de Vries<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Russ-Bishop/" title="Russ Bishop">Russ Bishop<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/Soroush-Khanlou/" title="Soroush Khanlou">Soroush Khanlou<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Mike-Ash/Swift/" title="Swift">Swift<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Swift/" title="Swift">Swift<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/Swift-and-Painless/" title="Swift and Painless">Swift and Painless<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/Swift-入门/" title="Swift 入门">Swift 入门<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Swift-进阶/" title="Swift 进阶">Swift 进阶<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Think-and-Build/" title="Think and Build">Think and Build<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Thomas-Hanning/" title="Thomas Hanning">Thomas Hanning<sup>22</sup></a></li>
		  
		
		  
			<li><a href="/categories/Thoughtbot/" title="Thoughtbot">Thoughtbot<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Tomasz-Szulc/" title="Tomasz Szulc">Tomasz Szulc<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/Wooji-Juice/" title="Wooji Juice">Wooji Juice<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/alisoftware/" title="alisoftware">alisoftware<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/alloc-init/" title="alloc-init">alloc-init<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/appcoda/" title="appcoda">appcoda<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/codingexplorer/" title="codingexplorer">codingexplorer<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/iAchieved-it/" title="iAchieved.it">iAchieved.it<sup>24</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/" title="iOS">iOS<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-开发/" title="iOS 开发">iOS 开发<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/iOS-开发/" title="iOS 开发">iOS 开发<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/khanlou-com/" title="khanlou.com">khanlou.com<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/machinethink/" title="machinethink">machinethink<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/medium-com/" title="medium.com">medium.com<sup>12</sup></a></li>
		  
		
		  
			<li><a href="/categories/mikeash-com/" title="mikeash.com">mikeash.com<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/radex-io/" title="radex.io">radex.io<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/swift-org/" title="swift.org">swift.org<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/swiftandpainless/" title="swiftandpainless">swiftandpainless<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/uraimo/" title="uraimo">uraimo<sup>15</sup></a></li>
		  
		
		  
			<li><a href="/categories/原创文章/" title="原创文章">原创文章<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/投稿/" title="投稿">投稿<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/直播资源/" title="直播资源">直播资源<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/社区问答/" title="社区问答">社区问答<sup>19</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Swift-进阶/" title="Swift 进阶">Swift 进阶<sup>169</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-入门/" title="Swift 入门">Swift 入门<sup>130</sup></a></li>
			
		
			
				<li><a href="/tags/Swift/" title="Swift">Swift<sup>96</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-开发/" title="iOS 开发">iOS 开发<sup>83</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-跨平台/" title="Swift 跨平台">Swift 跨平台<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-开源信息/" title="Swift 开源信息">Swift 开源信息<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/WatchOS-2/" title="WatchOS 2">WatchOS 2<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-3/" title="Swift 3">Swift 3<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-入门/" title="iOS 入门">iOS 入门<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Xcode/" title="Xcode">Xcode<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/NSHipster/" title="NSHipster">NSHipster<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Apple-TV-开发/" title="Apple TV 开发">Apple TV 开发<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/教程/" title="教程">教程<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-9/" title="iOS 9">iOS 9<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/IOSCREATOR/" title="IOSCREATOR">IOSCREATOR<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/社区问答/" title="社区问答">社区问答<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Swift-2/" title="Swift 2">Swift 2<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Jesse-Squires/" title="Jesse Squires">Jesse Squires<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Design-Patterns/" title="Design Patterns">Design Patterns<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Objective-C/" title="Objective-C">Objective-C<sup>2</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://c4ios.swift.gg" target="_blank" title="C4iOS 教程">C4iOS 教程</a>
            
          </li>
        
          <li>
            
            	<a href="http://swift.gg/2016/03/14/live-video/" target="_blank" title="SwiftGG直播">SwiftGG直播</a>
            
          </li>
        
          <li>
            
            	<a href="http://t.swift.gg/" target="_blank" title="T 沙龙">T 沙龙</a>
            
          </li>
        
          <li>
            
            	<a href="http://codebuild.me" target="_blank" title="Code Build Me">Code Build Me</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.saitjr.com" target="_blank" title="//TODO:">//TODO:</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.5isjyx.com/" target="_blank" title="chiba">chiba</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.cee.moe" target="_blank" title="Perfect Freeze">Perfect Freeze</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.swiftyper.com" target="_blank" title="小锅的 swift 之路">小锅的 swift 之路</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.futantan.com/" target="_blank" title="Prayer 的博客">Prayer 的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.csdn.net/mmoaay" target="_blank" title="画渣程序猿 mmoaay">画渣程序猿 mmoaay</a>
            
          </li>
        
          <li>
            
            	<a href="http://linusling.com" target="_blank" title="小铁匠的 swift 之路">小铁匠的 swift 之路</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.jianshu.com/users/596f2ba91ce9/latest_articles" target="_blank" title="ppppppmst 的简书博客">ppppppmst 的简书博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://chenmingbiao.github.io/" target="_blank" title="CMB 的博客">CMB 的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://wxgbridgeq.github.io/" target="_blank" title="BridgeQ">BridgeQ</a>
            
          </li>
        
          <li>
            
            	<a href="http://chengway.in" target="_blank" title="walkingway 的博客">walkingway 的博客</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.dianqk.org" target="_blank" title="靛青K">靛青K</a>
            
          </li>
        
          <li>
            
            	<a href="http://ijack.pw/" target="_blank" title="JackAlan">JackAlan</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.swiftconchina.com" target="_blank" title="SwiftConChina">SwiftConChina</a>
            
          </li>
        
          <li>
            
            	<a href="http://swiftcn.io" target="_blank" title="Swift 中国">Swift 中国</a>
            
          </li>
        
          <li>
            
            	<a href="https://boxueio.com/" target="_blank" title="泊学">泊学</a>
            
          </li>
        
          <li>
            
            	<a href="https://bearychat.com/" target="_blank" title="BearyChat">BearyChat</a>
            
          </li>
        
          <li>
            
            	<a href="http://bbs.php-z.com" target="_blank" title="PHP-Z 论坛">PHP-Z 论坛</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.swiftguide.cn" target="_blank" title="官方文档">官方文档</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.upyun.com/" target="_blank" title="又拍云赞助图床">又拍云赞助图床</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="wechatpart">
	<p class="asidetitle">微信公众号</p>
	<img src="/img/wechat.jpg" />
</div>

</aside>
</div>
    </div>
    <footer>


<div id="footer" >
	
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2019 
		
		<a href="/about" target="_blank" title="SwiftGG">SwiftGG</a>
		
		 | 
		<a href="http://www.miitbeian.gov.cn" target="_blank">浙ICP备14022870号-3</a>
		</p>
</div>
<img src="/img/logo_new.jpg" style="position: fixed; top: -9999px;height: 500px;width: 500px;">
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>
<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script src="/js/mm.js"></script>
<script src="/js/subscribe.js"></script>

<div id="swiftweekly" style="display:none;">
  <img id="closeme" src="/img/close.png">
  <span id="sw_slogan">SwiftGG 专属 Reveal 优惠：<b><a style="color: white;text-decoration:underline;" target="_blank" href="https://j.youzan.com/XzKhGY">领取立减 143 元！</a></b>&nbsp;</span>
  <!-- <form id="content"> -->
    <!-- <input name="email" id="sw_email" placeholder="输入邮箱地址" type="email" /><a class="sw_sub">订阅</a> -->
  <!-- </form> -->
</div>

<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<script type="text/javascript">
$(document).ready(function(){

  

  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66150920-1', 'auto');
  ga('send', 'pageview');

</script>





<!-- Analytics End -->

<!-- Totop Begin -->
<!--
	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>
-->
<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
